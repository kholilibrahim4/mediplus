(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))_(x);new MutationObserver(x=>{for(const C of x)if(C.type==="childList")for(const b of C.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&_(b)}).observe(document,{childList:!0,subtree:!0});function d(x){const C={};return x.integrity&&(C.integrity=x.integrity),x.referrerPolicy&&(C.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?C.credentials="include":x.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function _(x){if(x.ep)return;x.ep=!0;const C=d(x);fetch(x.href,C)}})();var s1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var o1={exports:{}},Nf={},a1={exports:{}},Bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ld=Symbol.for("react.element"),ET=Symbol.for("react.portal"),kT=Symbol.for("react.fragment"),zT=Symbol.for("react.strict_mode"),AT=Symbol.for("react.profiler"),RT=Symbol.for("react.provider"),DT=Symbol.for("react.context"),LT=Symbol.for("react.forward_ref"),jT=Symbol.for("react.suspense"),FT=Symbol.for("react.memo"),BT=Symbol.for("react.lazy"),Bx=Symbol.iterator;function OT(r){return r===null||typeof r!="object"?null:(r=Bx&&r[Bx]||r["@@iterator"],typeof r=="function"?r:null)}var l1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},c1=Object.assign,u1={};function ru(r,o,d){this.props=r,this.context=o,this.refs=u1,this.updater=d||l1}ru.prototype.isReactComponent={};ru.prototype.setState=function(r,o){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,o,"setState")};ru.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function h1(){}h1.prototype=ru.prototype;function X_(r,o,d){this.props=r,this.context=o,this.refs=u1,this.updater=d||l1}var Y_=X_.prototype=new h1;Y_.constructor=X_;c1(Y_,ru.prototype);Y_.isPureReactComponent=!0;var Ox=Array.isArray,d1=Object.prototype.hasOwnProperty,K_={current:null},p1={key:!0,ref:!0,__self:!0,__source:!0};function f1(r,o,d){var _,x={},C=null,b=null;if(o!=null)for(_ in o.ref!==void 0&&(b=o.ref),o.key!==void 0&&(C=""+o.key),o)d1.call(o,_)&&!p1.hasOwnProperty(_)&&(x[_]=o[_]);var c=arguments.length-2;if(c===1)x.children=d;else if(1<c){for(var Z=Array(c),K=0;K<c;K++)Z[K]=arguments[K+2];x.children=Z}if(r&&r.defaultProps)for(_ in c=r.defaultProps,c)x[_]===void 0&&(x[_]=c[_]);return{$$typeof:ld,type:r,key:C,ref:b,props:x,_owner:K_.current}}function NT(r,o){return{$$typeof:ld,type:r.type,key:o,ref:r.ref,props:r.props,_owner:r._owner}}function Q_(r){return typeof r=="object"&&r!==null&&r.$$typeof===ld}function $T(r){var o={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(d){return o[d]})}var Nx=/\/+/g;function Tg(r,o){return typeof r=="object"&&r!==null&&r.key!=null?$T(""+r.key):o.toString(36)}function ef(r,o,d,_,x){var C=typeof r;(C==="undefined"||C==="boolean")&&(r=null);var b=!1;if(r===null)b=!0;else switch(C){case"string":case"number":b=!0;break;case"object":switch(r.$$typeof){case ld:case ET:b=!0}}if(b)return b=r,x=x(b),r=_===""?"."+Tg(b,0):_,Ox(x)?(d="",r!=null&&(d=r.replace(Nx,"$&/")+"/"),ef(x,o,d,"",function(K){return K})):x!=null&&(Q_(x)&&(x=NT(x,d+(!x.key||b&&b.key===x.key?"":(""+x.key).replace(Nx,"$&/")+"/")+r)),o.push(x)),1;if(b=0,_=_===""?".":_+":",Ox(r))for(var c=0;c<r.length;c++){C=r[c];var Z=_+Tg(C,c);b+=ef(C,o,d,Z,x)}else if(Z=OT(r),typeof Z=="function")for(r=Z.call(r),c=0;!(C=r.next()).done;)C=C.value,Z=_+Tg(C,c++),b+=ef(C,o,d,Z,x);else if(C==="object")throw o=String(r),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return b}function Mp(r,o,d){if(r==null)return r;var _=[],x=0;return ef(r,_,"","",function(C){return o.call(d,C,x++)}),_}function VT(r){if(r._status===-1){var o=r._result;o=o(),o.then(function(d){(r._status===0||r._status===-1)&&(r._status=1,r._result=d)},function(d){(r._status===0||r._status===-1)&&(r._status=2,r._result=d)}),r._status===-1&&(r._status=0,r._result=o)}if(r._status===1)return r._result.default;throw r._result}var $i={current:null},tf={transition:null},UT={ReactCurrentDispatcher:$i,ReactCurrentBatchConfig:tf,ReactCurrentOwner:K_};function m1(){throw Error("act(...) is not supported in production builds of React.")}Bt.Children={map:Mp,forEach:function(r,o,d){Mp(r,function(){o.apply(this,arguments)},d)},count:function(r){var o=0;return Mp(r,function(){o++}),o},toArray:function(r){return Mp(r,function(o){return o})||[]},only:function(r){if(!Q_(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};Bt.Component=ru;Bt.Fragment=kT;Bt.Profiler=AT;Bt.PureComponent=X_;Bt.StrictMode=zT;Bt.Suspense=jT;Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UT;Bt.act=m1;Bt.cloneElement=function(r,o,d){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var _=c1({},r.props),x=r.key,C=r.ref,b=r._owner;if(o!=null){if(o.ref!==void 0&&(C=o.ref,b=K_.current),o.key!==void 0&&(x=""+o.key),r.type&&r.type.defaultProps)var c=r.type.defaultProps;for(Z in o)d1.call(o,Z)&&!p1.hasOwnProperty(Z)&&(_[Z]=o[Z]===void 0&&c!==void 0?c[Z]:o[Z])}var Z=arguments.length-2;if(Z===1)_.children=d;else if(1<Z){c=Array(Z);for(var K=0;K<Z;K++)c[K]=arguments[K+2];_.children=c}return{$$typeof:ld,type:r.type,key:x,ref:C,props:_,_owner:b}};Bt.createContext=function(r){return r={$$typeof:DT,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:RT,_context:r},r.Consumer=r};Bt.createElement=f1;Bt.createFactory=function(r){var o=f1.bind(null,r);return o.type=r,o};Bt.createRef=function(){return{current:null}};Bt.forwardRef=function(r){return{$$typeof:LT,render:r}};Bt.isValidElement=Q_;Bt.lazy=function(r){return{$$typeof:BT,_payload:{_status:-1,_result:r},_init:VT}};Bt.memo=function(r,o){return{$$typeof:FT,type:r,compare:o===void 0?null:o}};Bt.startTransition=function(r){var o=tf.transition;tf.transition={};try{r()}finally{tf.transition=o}};Bt.unstable_act=m1;Bt.useCallback=function(r,o){return $i.current.useCallback(r,o)};Bt.useContext=function(r){return $i.current.useContext(r)};Bt.useDebugValue=function(){};Bt.useDeferredValue=function(r){return $i.current.useDeferredValue(r)};Bt.useEffect=function(r,o){return $i.current.useEffect(r,o)};Bt.useId=function(){return $i.current.useId()};Bt.useImperativeHandle=function(r,o,d){return $i.current.useImperativeHandle(r,o,d)};Bt.useInsertionEffect=function(r,o){return $i.current.useInsertionEffect(r,o)};Bt.useLayoutEffect=function(r,o){return $i.current.useLayoutEffect(r,o)};Bt.useMemo=function(r,o){return $i.current.useMemo(r,o)};Bt.useReducer=function(r,o,d){return $i.current.useReducer(r,o,d)};Bt.useRef=function(r){return $i.current.useRef(r)};Bt.useState=function(r){return $i.current.useState(r)};Bt.useSyncExternalStore=function(r,o,d){return $i.current.useSyncExternalStore(r,o,d)};Bt.useTransition=function(){return $i.current.useTransition()};Bt.version="18.3.1";a1.exports=Bt;var Ie=a1.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZT=Ie,GT=Symbol.for("react.element"),qT=Symbol.for("react.fragment"),WT=Object.prototype.hasOwnProperty,HT=ZT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,XT={key:!0,ref:!0,__self:!0,__source:!0};function g1(r,o,d){var _,x={},C=null,b=null;d!==void 0&&(C=""+d),o.key!==void 0&&(C=""+o.key),o.ref!==void 0&&(b=o.ref);for(_ in o)WT.call(o,_)&&!XT.hasOwnProperty(_)&&(x[_]=o[_]);if(r&&r.defaultProps)for(_ in o=r.defaultProps,o)x[_]===void 0&&(x[_]=o[_]);return{$$typeof:GT,type:r,key:C,ref:b,props:x,_owner:HT.current}}Nf.Fragment=qT;Nf.jsx=g1;Nf.jsxs=g1;o1.exports=Nf;var z=o1.exports,_1={exports:{}},_n={},y1={exports:{}},v1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function o(st,xt){var wt=st.length;st.push(xt);e:for(;0<wt;){var Ft=wt-1>>>1,vt=st[Ft];if(0<x(vt,xt))st[Ft]=xt,st[wt]=vt,wt=Ft;else break e}}function d(st){return st.length===0?null:st[0]}function _(st){if(st.length===0)return null;var xt=st[0],wt=st.pop();if(wt!==xt){st[0]=wt;e:for(var Ft=0,vt=st.length,ii=vt>>>1;Ft<ii;){var Er=2*(Ft+1)-1,Zi=st[Er],ui=Er+1,nn=st[ui];if(0>x(Zi,wt))ui<vt&&0>x(nn,Zi)?(st[Ft]=nn,st[ui]=wt,Ft=ui):(st[Ft]=Zi,st[Er]=wt,Ft=Er);else if(ui<vt&&0>x(nn,wt))st[Ft]=nn,st[ui]=wt,Ft=ui;else break e}}return xt}function x(st,xt){var wt=st.sortIndex-xt.sortIndex;return wt!==0?wt:st.id-xt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var C=performance;r.unstable_now=function(){return C.now()}}else{var b=Date,c=b.now();r.unstable_now=function(){return b.now()-c}}var Z=[],K=[],ge=1,be=null,O=3,H=!1,ue=!1,Pe=!1,pe=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(st){for(var xt=d(K);xt!==null;){if(xt.callback===null)_(K);else if(xt.startTime<=st)_(K),xt.sortIndex=xt.expirationTime,o(Z,xt);else break;xt=d(K)}}function re(st){if(Pe=!1,N(st),!ue)if(d(Z)!==null)ue=!0,xn(Te);else{var xt=d(K);xt!==null&&rn(re,xt.startTime-st)}}function Te(st,xt){ue=!1,Pe&&(Pe=!1,E(Ge),Ge=-1),H=!0;var wt=O;try{for(N(xt),be=d(Z);be!==null&&(!(be.expirationTime>xt)||st&&!Gt());){var Ft=be.callback;if(typeof Ft=="function"){be.callback=null,O=be.priorityLevel;var vt=Ft(be.expirationTime<=xt);xt=r.unstable_now(),typeof vt=="function"?be.callback=vt:be===d(Z)&&_(Z),N(xt)}else _(Z);be=d(Z)}if(be!==null)var ii=!0;else{var Er=d(K);Er!==null&&rn(re,Er.startTime-xt),ii=!1}return ii}finally{be=null,O=wt,H=!1}}var Ce=!1,Ne=null,Ge=-1,ht=5,dt=-1;function Gt(){return!(r.unstable_now()-dt<ht)}function yr(){if(Ne!==null){var st=r.unstable_now();dt=st;var xt=!0;try{xt=Ne(!0,st)}finally{xt?Lr():(Ce=!1,Ne=null)}}else Ce=!1}var Lr;if(typeof R=="function")Lr=function(){R(yr)};else if(typeof MessageChannel<"u"){var vn=new MessageChannel,Ui=vn.port2;vn.port1.onmessage=yr,Lr=function(){Ui.postMessage(null)}}else Lr=function(){pe(yr,0)};function xn(st){Ne=st,Ce||(Ce=!0,Lr())}function rn(st,xt){Ge=pe(function(){st(r.unstable_now())},xt)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(st){st.callback=null},r.unstable_continueExecution=function(){ue||H||(ue=!0,xn(Te))},r.unstable_forceFrameRate=function(st){0>st||125<st?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ht=0<st?Math.floor(1e3/st):5},r.unstable_getCurrentPriorityLevel=function(){return O},r.unstable_getFirstCallbackNode=function(){return d(Z)},r.unstable_next=function(st){switch(O){case 1:case 2:case 3:var xt=3;break;default:xt=O}var wt=O;O=xt;try{return st()}finally{O=wt}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(st,xt){switch(st){case 1:case 2:case 3:case 4:case 5:break;default:st=3}var wt=O;O=st;try{return xt()}finally{O=wt}},r.unstable_scheduleCallback=function(st,xt,wt){var Ft=r.unstable_now();switch(typeof wt=="object"&&wt!==null?(wt=wt.delay,wt=typeof wt=="number"&&0<wt?Ft+wt:Ft):wt=Ft,st){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=wt+vt,st={id:ge++,callback:xt,priorityLevel:st,startTime:wt,expirationTime:vt,sortIndex:-1},wt>Ft?(st.sortIndex=wt,o(K,st),d(Z)===null&&st===d(K)&&(Pe?(E(Ge),Ge=-1):Pe=!0,rn(re,wt-Ft))):(st.sortIndex=vt,o(Z,st),ue||H||(ue=!0,xn(Te))),st},r.unstable_shouldYield=Gt,r.unstable_wrapCallback=function(st){var xt=O;return function(){var wt=O;O=xt;try{return st.apply(this,arguments)}finally{O=wt}}}})(v1);y1.exports=v1;var YT=y1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KT=Ie,gn=YT;function Qe(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,d=1;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var x1=new Set,Zh={};function Tl(r,o){Xc(r,o),Xc(r+"Capture",o)}function Xc(r,o){for(Zh[r]=o,r=0;r<o.length;r++)x1.add(o[r])}var ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jg=Object.prototype.hasOwnProperty,QT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$x={},Vx={};function JT(r){return Jg.call(Vx,r)?!0:Jg.call($x,r)?!1:QT.test(r)?Vx[r]=!0:($x[r]=!0,!1)}function eS(r,o,d,_){if(d!==null&&d.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return _?!1:d!==null?!d.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function tS(r,o,d,_){if(o===null||typeof o>"u"||eS(r,o,d,_))return!0;if(_)return!1;if(d!==null)switch(d.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Vi(r,o,d,_,x,C,b){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=_,this.attributeNamespace=x,this.mustUseProperty=d,this.propertyName=r,this.type=o,this.sanitizeURL=C,this.removeEmptyString=b}var vi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){vi[r]=new Vi(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];vi[o]=new Vi(o,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){vi[r]=new Vi(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){vi[r]=new Vi(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){vi[r]=new Vi(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){vi[r]=new Vi(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){vi[r]=new Vi(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){vi[r]=new Vi(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){vi[r]=new Vi(r,5,!1,r.toLowerCase(),null,!1,!1)});var J_=/[\-:]([a-z])/g;function ey(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(J_,ey);vi[o]=new Vi(o,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(J_,ey);vi[o]=new Vi(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(J_,ey);vi[o]=new Vi(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){vi[r]=new Vi(r,1,!1,r.toLowerCase(),null,!1,!1)});vi.xlinkHref=new Vi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){vi[r]=new Vi(r,1,!1,r.toLowerCase(),null,!0,!0)});function ty(r,o,d,_){var x=vi.hasOwnProperty(o)?vi[o]:null;(x!==null?x.type!==0:_||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(tS(o,d,x,_)&&(d=null),_||x===null?JT(o)&&(d===null?r.removeAttribute(o):r.setAttribute(o,""+d)):x.mustUseProperty?r[x.propertyName]=d===null?x.type===3?!1:"":d:(o=x.attributeName,_=x.attributeNamespace,d===null?r.removeAttribute(o):(x=x.type,d=x===3||x===4&&d===!0?"":""+d,_?r.setAttributeNS(_,o,d):r.setAttribute(o,d))))}var lo=KT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ip=Symbol.for("react.element"),kc=Symbol.for("react.portal"),zc=Symbol.for("react.fragment"),ry=Symbol.for("react.strict_mode"),e_=Symbol.for("react.profiler"),b1=Symbol.for("react.provider"),w1=Symbol.for("react.context"),iy=Symbol.for("react.forward_ref"),t_=Symbol.for("react.suspense"),r_=Symbol.for("react.suspense_list"),ny=Symbol.for("react.memo"),Go=Symbol.for("react.lazy"),T1=Symbol.for("react.offscreen"),Ux=Symbol.iterator;function vh(r){return r===null||typeof r!="object"?null:(r=Ux&&r[Ux]||r["@@iterator"],typeof r=="function"?r:null)}var Sr=Object.assign,Sg;function kh(r){if(Sg===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);Sg=o&&o[1]||""}return`
`+Sg+r}var Cg=!1;function Pg(r,o){if(!r||Cg)return"";Cg=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(K){var _=K}Reflect.construct(r,[],o)}else{try{o.call()}catch(K){_=K}r.call(o.prototype)}else{try{throw Error()}catch(K){_=K}r()}}catch(K){if(K&&_&&typeof K.stack=="string"){for(var x=K.stack.split(`
`),C=_.stack.split(`
`),b=x.length-1,c=C.length-1;1<=b&&0<=c&&x[b]!==C[c];)c--;for(;1<=b&&0<=c;b--,c--)if(x[b]!==C[c]){if(b!==1||c!==1)do if(b--,c--,0>c||x[b]!==C[c]){var Z=`
`+x[b].replace(" at new "," at ");return r.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",r.displayName)),Z}while(1<=b&&0<=c);break}}}finally{Cg=!1,Error.prepareStackTrace=d}return(r=r?r.displayName||r.name:"")?kh(r):""}function rS(r){switch(r.tag){case 5:return kh(r.type);case 16:return kh("Lazy");case 13:return kh("Suspense");case 19:return kh("SuspenseList");case 0:case 2:case 15:return r=Pg(r.type,!1),r;case 11:return r=Pg(r.type.render,!1),r;case 1:return r=Pg(r.type,!0),r;default:return""}}function i_(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case zc:return"Fragment";case kc:return"Portal";case e_:return"Profiler";case ry:return"StrictMode";case t_:return"Suspense";case r_:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case w1:return(r.displayName||"Context")+".Consumer";case b1:return(r._context.displayName||"Context")+".Provider";case iy:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ny:return o=r.displayName||null,o!==null?o:i_(r.type)||"Memo";case Go:o=r._payload,r=r._init;try{return i_(r(o))}catch{}}return null}function iS(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return i_(o);case 8:return o===ry?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function sa(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function S1(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function nS(r){var o=S1(r)?"checked":"value",d=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),_=""+r[o];if(!r.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,C=d.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return x.call(this)},set:function(b){_=""+b,C.call(this,b)}}),Object.defineProperty(r,o,{enumerable:d.enumerable}),{getValue:function(){return _},setValue:function(b){_=""+b},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Ep(r){r._valueTracker||(r._valueTracker=nS(r))}function C1(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var d=o.getValue(),_="";return r&&(_=S1(r)?r.checked?"true":"false":r.value),r=_,r!==d?(o.setValue(r),!0):!1}function mf(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function n_(r,o){var d=o.checked;return Sr({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??r._wrapperState.initialChecked})}function Zx(r,o){var d=o.defaultValue==null?"":o.defaultValue,_=o.checked!=null?o.checked:o.defaultChecked;d=sa(o.value!=null?o.value:d),r._wrapperState={initialChecked:_,initialValue:d,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function P1(r,o){o=o.checked,o!=null&&ty(r,"checked",o,!1)}function s_(r,o){P1(r,o);var d=sa(o.value),_=o.type;if(d!=null)_==="number"?(d===0&&r.value===""||r.value!=d)&&(r.value=""+d):r.value!==""+d&&(r.value=""+d);else if(_==="submit"||_==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?o_(r,o.type,d):o.hasOwnProperty("defaultValue")&&o_(r,o.type,sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function Gx(r,o,d){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var _=o.type;if(!(_!=="submit"&&_!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,d||o===r.value||(r.value=o),r.defaultValue=o}d=r.name,d!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,d!==""&&(r.name=d)}function o_(r,o,d){(o!=="number"||mf(r.ownerDocument)!==r)&&(d==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+d&&(r.defaultValue=""+d))}var zh=Array.isArray;function Uc(r,o,d,_){if(r=r.options,o){o={};for(var x=0;x<d.length;x++)o["$"+d[x]]=!0;for(d=0;d<r.length;d++)x=o.hasOwnProperty("$"+r[d].value),r[d].selected!==x&&(r[d].selected=x),x&&_&&(r[d].defaultSelected=!0)}else{for(d=""+sa(d),o=null,x=0;x<r.length;x++){if(r[x].value===d){r[x].selected=!0,_&&(r[x].defaultSelected=!0);return}o!==null||r[x].disabled||(o=r[x])}o!==null&&(o.selected=!0)}}function a_(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Qe(91));return Sr({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function qx(r,o){var d=o.value;if(d==null){if(d=o.children,o=o.defaultValue,d!=null){if(o!=null)throw Error(Qe(92));if(zh(d)){if(1<d.length)throw Error(Qe(93));d=d[0]}o=d}o==null&&(o=""),d=o}r._wrapperState={initialValue:sa(d)}}function M1(r,o){var d=sa(o.value),_=sa(o.defaultValue);d!=null&&(d=""+d,d!==r.value&&(r.value=d),o.defaultValue==null&&r.defaultValue!==d&&(r.defaultValue=d)),_!=null&&(r.defaultValue=""+_)}function Wx(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function I1(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function l_(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?I1(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var kp,E1=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,d,_,x){MSApp.execUnsafeLocalFunction(function(){return r(o,d,_,x)})}:r}(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for(kp=kp||document.createElement("div"),kp.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=kp.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function Gh(r,o){if(o){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=o;return}}r.textContent=o}var Dh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sS=["Webkit","ms","Moz","O"];Object.keys(Dh).forEach(function(r){sS.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),Dh[o]=Dh[r]})});function k1(r,o,d){return o==null||typeof o=="boolean"||o===""?"":d||typeof o!="number"||o===0||Dh.hasOwnProperty(r)&&Dh[r]?(""+o).trim():o+"px"}function z1(r,o){r=r.style;for(var d in o)if(o.hasOwnProperty(d)){var _=d.indexOf("--")===0,x=k1(d,o[d],_);d==="float"&&(d="cssFloat"),_?r.setProperty(d,x):r[d]=x}}var oS=Sr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function c_(r,o){if(o){if(oS[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Qe(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Qe(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Qe(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Qe(62))}}function u_(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var h_=null;function sy(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var d_=null,Zc=null,Gc=null;function Hx(r){if(r=hd(r)){if(typeof d_!="function")throw Error(Qe(280));var o=r.stateNode;o&&(o=Gf(o),d_(r.stateNode,r.type,o))}}function A1(r){Zc?Gc?Gc.push(r):Gc=[r]:Zc=r}function R1(){if(Zc){var r=Zc,o=Gc;if(Gc=Zc=null,Hx(r),o)for(r=0;r<o.length;r++)Hx(o[r])}}function D1(r,o){return r(o)}function L1(){}var Mg=!1;function j1(r,o,d){if(Mg)return r(o,d);Mg=!0;try{return D1(r,o,d)}finally{Mg=!1,(Zc!==null||Gc!==null)&&(L1(),R1())}}function qh(r,o){var d=r.stateNode;if(d===null)return null;var _=Gf(d);if(_===null)return null;d=_[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(r=r.type,_=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!_;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(Qe(231,o,typeof d));return d}var p_=!1;if(ro)try{var xh={};Object.defineProperty(xh,"passive",{get:function(){p_=!0}}),window.addEventListener("test",xh,xh),window.removeEventListener("test",xh,xh)}catch{p_=!1}function aS(r,o,d,_,x,C,b,c,Z){var K=Array.prototype.slice.call(arguments,3);try{o.apply(d,K)}catch(ge){this.onError(ge)}}var Lh=!1,gf=null,_f=!1,f_=null,lS={onError:function(r){Lh=!0,gf=r}};function cS(r,o,d,_,x,C,b,c,Z){Lh=!1,gf=null,aS.apply(lS,arguments)}function uS(r,o,d,_,x,C,b,c,Z){if(cS.apply(this,arguments),Lh){if(Lh){var K=gf;Lh=!1,gf=null}else throw Error(Qe(198));_f||(_f=!0,f_=K)}}function Sl(r){var o=r,d=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,o.flags&4098&&(d=o.return),r=o.return;while(r)}return o.tag===3?d:null}function F1(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function Xx(r){if(Sl(r)!==r)throw Error(Qe(188))}function hS(r){var o=r.alternate;if(!o){if(o=Sl(r),o===null)throw Error(Qe(188));return o!==r?null:r}for(var d=r,_=o;;){var x=d.return;if(x===null)break;var C=x.alternate;if(C===null){if(_=x.return,_!==null){d=_;continue}break}if(x.child===C.child){for(C=x.child;C;){if(C===d)return Xx(x),r;if(C===_)return Xx(x),o;C=C.sibling}throw Error(Qe(188))}if(d.return!==_.return)d=x,_=C;else{for(var b=!1,c=x.child;c;){if(c===d){b=!0,d=x,_=C;break}if(c===_){b=!0,_=x,d=C;break}c=c.sibling}if(!b){for(c=C.child;c;){if(c===d){b=!0,d=C,_=x;break}if(c===_){b=!0,_=C,d=x;break}c=c.sibling}if(!b)throw Error(Qe(189))}}if(d.alternate!==_)throw Error(Qe(190))}if(d.tag!==3)throw Error(Qe(188));return d.stateNode.current===d?r:o}function B1(r){return r=hS(r),r!==null?O1(r):null}function O1(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=O1(r);if(o!==null)return o;r=r.sibling}return null}var N1=gn.unstable_scheduleCallback,Yx=gn.unstable_cancelCallback,dS=gn.unstable_shouldYield,pS=gn.unstable_requestPaint,Dr=gn.unstable_now,fS=gn.unstable_getCurrentPriorityLevel,oy=gn.unstable_ImmediatePriority,$1=gn.unstable_UserBlockingPriority,yf=gn.unstable_NormalPriority,mS=gn.unstable_LowPriority,V1=gn.unstable_IdlePriority,$f=null,Ps=null;function gS(r){if(Ps&&typeof Ps.onCommitFiberRoot=="function")try{Ps.onCommitFiberRoot($f,r,void 0,(r.current.flags&128)===128)}catch{}}var ns=Math.clz32?Math.clz32:vS,_S=Math.log,yS=Math.LN2;function vS(r){return r>>>=0,r===0?32:31-(_S(r)/yS|0)|0}var zp=64,Ap=4194304;function Ah(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function vf(r,o){var d=r.pendingLanes;if(d===0)return 0;var _=0,x=r.suspendedLanes,C=r.pingedLanes,b=d&268435455;if(b!==0){var c=b&~x;c!==0?_=Ah(c):(C&=b,C!==0&&(_=Ah(C)))}else b=d&~x,b!==0?_=Ah(b):C!==0&&(_=Ah(C));if(_===0)return 0;if(o!==0&&o!==_&&!(o&x)&&(x=_&-_,C=o&-o,x>=C||x===16&&(C&4194240)!==0))return o;if(_&4&&(_|=d&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=_;0<o;)d=31-ns(o),x=1<<d,_|=r[d],o&=~x;return _}function xS(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bS(r,o){for(var d=r.suspendedLanes,_=r.pingedLanes,x=r.expirationTimes,C=r.pendingLanes;0<C;){var b=31-ns(C),c=1<<b,Z=x[b];Z===-1?(!(c&d)||c&_)&&(x[b]=xS(c,o)):Z<=o&&(r.expiredLanes|=c),C&=~c}}function m_(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function U1(){var r=zp;return zp<<=1,!(zp&4194240)&&(zp=64),r}function Ig(r){for(var o=[],d=0;31>d;d++)o.push(r);return o}function cd(r,o,d){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-ns(o),r[o]=d}function wS(r,o){var d=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var _=r.eventTimes;for(r=r.expirationTimes;0<d;){var x=31-ns(d),C=1<<x;o[x]=0,_[x]=-1,r[x]=-1,d&=~C}}function ay(r,o){var d=r.entangledLanes|=o;for(r=r.entanglements;d;){var _=31-ns(d),x=1<<_;x&o|r[_]&o&&(r[_]|=o),d&=~x}}var Kt=0;function Z1(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var G1,ly,q1,W1,H1,g_=!1,Rp=[],Ko=null,Qo=null,Jo=null,Wh=new Map,Hh=new Map,Wo=[],TS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kx(r,o){switch(r){case"focusin":case"focusout":Ko=null;break;case"dragenter":case"dragleave":Qo=null;break;case"mouseover":case"mouseout":Jo=null;break;case"pointerover":case"pointerout":Wh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hh.delete(o.pointerId)}}function bh(r,o,d,_,x,C){return r===null||r.nativeEvent!==C?(r={blockedOn:o,domEventName:d,eventSystemFlags:_,nativeEvent:C,targetContainers:[x]},o!==null&&(o=hd(o),o!==null&&ly(o)),r):(r.eventSystemFlags|=_,o=r.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),r)}function SS(r,o,d,_,x){switch(o){case"focusin":return Ko=bh(Ko,r,o,d,_,x),!0;case"dragenter":return Qo=bh(Qo,r,o,d,_,x),!0;case"mouseover":return Jo=bh(Jo,r,o,d,_,x),!0;case"pointerover":var C=x.pointerId;return Wh.set(C,bh(Wh.get(C)||null,r,o,d,_,x)),!0;case"gotpointercapture":return C=x.pointerId,Hh.set(C,bh(Hh.get(C)||null,r,o,d,_,x)),!0}return!1}function X1(r){var o=hl(r.target);if(o!==null){var d=Sl(o);if(d!==null){if(o=d.tag,o===13){if(o=F1(d),o!==null){r.blockedOn=o,H1(r.priority,function(){q1(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function rf(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var d=__(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(d===null){d=r.nativeEvent;var _=new d.constructor(d.type,d);h_=_,d.target.dispatchEvent(_),h_=null}else return o=hd(d),o!==null&&ly(o),r.blockedOn=d,!1;o.shift()}return!0}function Qx(r,o,d){rf(r)&&d.delete(o)}function CS(){g_=!1,Ko!==null&&rf(Ko)&&(Ko=null),Qo!==null&&rf(Qo)&&(Qo=null),Jo!==null&&rf(Jo)&&(Jo=null),Wh.forEach(Qx),Hh.forEach(Qx)}function wh(r,o){r.blockedOn===o&&(r.blockedOn=null,g_||(g_=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,CS)))}function Xh(r){function o(x){return wh(x,r)}if(0<Rp.length){wh(Rp[0],r);for(var d=1;d<Rp.length;d++){var _=Rp[d];_.blockedOn===r&&(_.blockedOn=null)}}for(Ko!==null&&wh(Ko,r),Qo!==null&&wh(Qo,r),Jo!==null&&wh(Jo,r),Wh.forEach(o),Hh.forEach(o),d=0;d<Wo.length;d++)_=Wo[d],_.blockedOn===r&&(_.blockedOn=null);for(;0<Wo.length&&(d=Wo[0],d.blockedOn===null);)X1(d),d.blockedOn===null&&Wo.shift()}var qc=lo.ReactCurrentBatchConfig,xf=!0;function PS(r,o,d,_){var x=Kt,C=qc.transition;qc.transition=null;try{Kt=1,cy(r,o,d,_)}finally{Kt=x,qc.transition=C}}function MS(r,o,d,_){var x=Kt,C=qc.transition;qc.transition=null;try{Kt=4,cy(r,o,d,_)}finally{Kt=x,qc.transition=C}}function cy(r,o,d,_){if(xf){var x=__(r,o,d,_);if(x===null)Bg(r,o,_,bf,d),Kx(r,_);else if(SS(x,r,o,d,_))_.stopPropagation();else if(Kx(r,_),o&4&&-1<TS.indexOf(r)){for(;x!==null;){var C=hd(x);if(C!==null&&G1(C),C=__(r,o,d,_),C===null&&Bg(r,o,_,bf,d),C===x)break;x=C}x!==null&&_.stopPropagation()}else Bg(r,o,_,null,d)}}var bf=null;function __(r,o,d,_){if(bf=null,r=sy(_),r=hl(r),r!==null)if(o=Sl(r),o===null)r=null;else if(d=o.tag,d===13){if(r=F1(o),r!==null)return r;r=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return bf=r,null}function Y1(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fS()){case oy:return 1;case $1:return 4;case yf:case mS:return 16;case V1:return 536870912;default:return 16}default:return 16}}var Xo=null,uy=null,nf=null;function K1(){if(nf)return nf;var r,o=uy,d=o.length,_,x="value"in Xo?Xo.value:Xo.textContent,C=x.length;for(r=0;r<d&&o[r]===x[r];r++);var b=d-r;for(_=1;_<=b&&o[d-_]===x[C-_];_++);return nf=x.slice(r,1<_?1-_:void 0)}function sf(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Dp(){return!0}function Jx(){return!1}function yn(r){function o(d,_,x,C,b){this._reactName=d,this._targetInst=x,this.type=_,this.nativeEvent=C,this.target=b,this.currentTarget=null;for(var c in r)r.hasOwnProperty(c)&&(d=r[c],this[c]=d?d(C):C[c]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Dp:Jx,this.isPropagationStopped=Jx,this}return Sr(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Dp)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Dp)},persist:function(){},isPersistent:Dp}),o}var iu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hy=yn(iu),ud=Sr({},iu,{view:0,detail:0}),IS=yn(ud),Eg,kg,Th,Vf=Sr({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dy,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Th&&(Th&&r.type==="mousemove"?(Eg=r.screenX-Th.screenX,kg=r.screenY-Th.screenY):kg=Eg=0,Th=r),Eg)},movementY:function(r){return"movementY"in r?r.movementY:kg}}),e0=yn(Vf),ES=Sr({},Vf,{dataTransfer:0}),kS=yn(ES),zS=Sr({},ud,{relatedTarget:0}),zg=yn(zS),AS=Sr({},iu,{animationName:0,elapsedTime:0,pseudoElement:0}),RS=yn(AS),DS=Sr({},iu,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),LS=yn(DS),jS=Sr({},iu,{data:0}),t0=yn(jS),FS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NS(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=OS[r])?!!o[r]:!1}function dy(){return NS}var $S=Sr({},ud,{key:function(r){if(r.key){var o=FS[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=sf(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?BS[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dy,charCode:function(r){return r.type==="keypress"?sf(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?sf(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),VS=yn($S),US=Sr({},Vf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),r0=yn(US),ZS=Sr({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dy}),GS=yn(ZS),qS=Sr({},iu,{propertyName:0,elapsedTime:0,pseudoElement:0}),WS=yn(qS),HS=Sr({},Vf,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),XS=yn(HS),YS=[9,13,27,32],py=ro&&"CompositionEvent"in window,jh=null;ro&&"documentMode"in document&&(jh=document.documentMode);var KS=ro&&"TextEvent"in window&&!jh,Q1=ro&&(!py||jh&&8<jh&&11>=jh),i0=" ",n0=!1;function J1(r,o){switch(r){case"keyup":return YS.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eb(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ac=!1;function QS(r,o){switch(r){case"compositionend":return eb(o);case"keypress":return o.which!==32?null:(n0=!0,i0);case"textInput":return r=o.data,r===i0&&n0?null:r;default:return null}}function JS(r,o){if(Ac)return r==="compositionend"||!py&&J1(r,o)?(r=K1(),nf=uy=Xo=null,Ac=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Q1&&o.locale!=="ko"?null:o.data;default:return null}}var eC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function s0(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!eC[r.type]:o==="textarea"}function tb(r,o,d,_){A1(_),o=wf(o,"onChange"),0<o.length&&(d=new hy("onChange","change",null,d,_),r.push({event:d,listeners:o}))}var Fh=null,Yh=null;function tC(r){db(r,0)}function Uf(r){var o=Lc(r);if(C1(o))return r}function rC(r,o){if(r==="change")return o}var rb=!1;if(ro){var Ag;if(ro){var Rg="oninput"in document;if(!Rg){var o0=document.createElement("div");o0.setAttribute("oninput","return;"),Rg=typeof o0.oninput=="function"}Ag=Rg}else Ag=!1;rb=Ag&&(!document.documentMode||9<document.documentMode)}function a0(){Fh&&(Fh.detachEvent("onpropertychange",ib),Yh=Fh=null)}function ib(r){if(r.propertyName==="value"&&Uf(Yh)){var o=[];tb(o,Yh,r,sy(r)),j1(tC,o)}}function iC(r,o,d){r==="focusin"?(a0(),Fh=o,Yh=d,Fh.attachEvent("onpropertychange",ib)):r==="focusout"&&a0()}function nC(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Uf(Yh)}function sC(r,o){if(r==="click")return Uf(o)}function oC(r,o){if(r==="input"||r==="change")return Uf(o)}function aC(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var os=typeof Object.is=="function"?Object.is:aC;function Kh(r,o){if(os(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var d=Object.keys(r),_=Object.keys(o);if(d.length!==_.length)return!1;for(_=0;_<d.length;_++){var x=d[_];if(!Jg.call(o,x)||!os(r[x],o[x]))return!1}return!0}function l0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function c0(r,o){var d=l0(r);r=0;for(var _;d;){if(d.nodeType===3){if(_=r+d.textContent.length,r<=o&&_>=o)return{node:d,offset:o-r};r=_}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=l0(d)}}function nb(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?nb(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function sb(){for(var r=window,o=mf();o instanceof r.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)r=o.contentWindow;else break;o=mf(r.document)}return o}function fy(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function lC(r){var o=sb(),d=r.focusedElem,_=r.selectionRange;if(o!==d&&d&&d.ownerDocument&&nb(d.ownerDocument.documentElement,d)){if(_!==null&&fy(d)){if(o=_.start,r=_.end,r===void 0&&(r=o),"selectionStart"in d)d.selectionStart=o,d.selectionEnd=Math.min(r,d.value.length);else if(r=(o=d.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var x=d.textContent.length,C=Math.min(_.start,x);_=_.end===void 0?C:Math.min(_.end,x),!r.extend&&C>_&&(x=_,_=C,C=x),x=c0(d,C);var b=c0(d,_);x&&b&&(r.rangeCount!==1||r.anchorNode!==x.node||r.anchorOffset!==x.offset||r.focusNode!==b.node||r.focusOffset!==b.offset)&&(o=o.createRange(),o.setStart(x.node,x.offset),r.removeAllRanges(),C>_?(r.addRange(o),r.extend(b.node,b.offset)):(o.setEnd(b.node,b.offset),r.addRange(o)))}}for(o=[],r=d;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<o.length;d++)r=o[d],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var cC=ro&&"documentMode"in document&&11>=document.documentMode,Rc=null,y_=null,Bh=null,v_=!1;function u0(r,o,d){var _=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;v_||Rc==null||Rc!==mf(_)||(_=Rc,"selectionStart"in _&&fy(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Bh&&Kh(Bh,_)||(Bh=_,_=wf(y_,"onSelect"),0<_.length&&(o=new hy("onSelect","select",null,o,d),r.push({event:o,listeners:_}),o.target=Rc)))}function Lp(r,o){var d={};return d[r.toLowerCase()]=o.toLowerCase(),d["Webkit"+r]="webkit"+o,d["Moz"+r]="moz"+o,d}var Dc={animationend:Lp("Animation","AnimationEnd"),animationiteration:Lp("Animation","AnimationIteration"),animationstart:Lp("Animation","AnimationStart"),transitionend:Lp("Transition","TransitionEnd")},Dg={},ob={};ro&&(ob=document.createElement("div").style,"AnimationEvent"in window||(delete Dc.animationend.animation,delete Dc.animationiteration.animation,delete Dc.animationstart.animation),"TransitionEvent"in window||delete Dc.transitionend.transition);function Zf(r){if(Dg[r])return Dg[r];if(!Dc[r])return r;var o=Dc[r],d;for(d in o)if(o.hasOwnProperty(d)&&d in ob)return Dg[r]=o[d];return r}var ab=Zf("animationend"),lb=Zf("animationiteration"),cb=Zf("animationstart"),ub=Zf("transitionend"),hb=new Map,h0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function aa(r,o){hb.set(r,o),Tl(o,[r])}for(var Lg=0;Lg<h0.length;Lg++){var jg=h0[Lg],uC=jg.toLowerCase(),hC=jg[0].toUpperCase()+jg.slice(1);aa(uC,"on"+hC)}aa(ab,"onAnimationEnd");aa(lb,"onAnimationIteration");aa(cb,"onAnimationStart");aa("dblclick","onDoubleClick");aa("focusin","onFocus");aa("focusout","onBlur");aa(ub,"onTransitionEnd");Xc("onMouseEnter",["mouseout","mouseover"]);Xc("onMouseLeave",["mouseout","mouseover"]);Xc("onPointerEnter",["pointerout","pointerover"]);Xc("onPointerLeave",["pointerout","pointerover"]);Tl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rh));function d0(r,o,d){var _=r.type||"unknown-event";r.currentTarget=d,uS(_,o,void 0,r),r.currentTarget=null}function db(r,o){o=(o&4)!==0;for(var d=0;d<r.length;d++){var _=r[d],x=_.event;_=_.listeners;e:{var C=void 0;if(o)for(var b=_.length-1;0<=b;b--){var c=_[b],Z=c.instance,K=c.currentTarget;if(c=c.listener,Z!==C&&x.isPropagationStopped())break e;d0(x,c,K),C=Z}else for(b=0;b<_.length;b++){if(c=_[b],Z=c.instance,K=c.currentTarget,c=c.listener,Z!==C&&x.isPropagationStopped())break e;d0(x,c,K),C=Z}}}if(_f)throw r=f_,_f=!1,f_=null,r}function pr(r,o){var d=o[S_];d===void 0&&(d=o[S_]=new Set);var _=r+"__bubble";d.has(_)||(pb(o,r,2,!1),d.add(_))}function Fg(r,o,d){var _=0;o&&(_|=4),pb(d,r,_,o)}var jp="_reactListening"+Math.random().toString(36).slice(2);function Qh(r){if(!r[jp]){r[jp]=!0,x1.forEach(function(d){d!=="selectionchange"&&(dC.has(d)||Fg(d,!1,r),Fg(d,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[jp]||(o[jp]=!0,Fg("selectionchange",!1,o))}}function pb(r,o,d,_){switch(Y1(o)){case 1:var x=PS;break;case 4:x=MS;break;default:x=cy}d=x.bind(null,o,d,r),x=void 0,!p_||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),_?x!==void 0?r.addEventListener(o,d,{capture:!0,passive:x}):r.addEventListener(o,d,!0):x!==void 0?r.addEventListener(o,d,{passive:x}):r.addEventListener(o,d,!1)}function Bg(r,o,d,_,x){var C=_;if(!(o&1)&&!(o&2)&&_!==null)e:for(;;){if(_===null)return;var b=_.tag;if(b===3||b===4){var c=_.stateNode.containerInfo;if(c===x||c.nodeType===8&&c.parentNode===x)break;if(b===4)for(b=_.return;b!==null;){var Z=b.tag;if((Z===3||Z===4)&&(Z=b.stateNode.containerInfo,Z===x||Z.nodeType===8&&Z.parentNode===x))return;b=b.return}for(;c!==null;){if(b=hl(c),b===null)return;if(Z=b.tag,Z===5||Z===6){_=C=b;continue e}c=c.parentNode}}_=_.return}j1(function(){var K=C,ge=sy(d),be=[];e:{var O=hb.get(r);if(O!==void 0){var H=hy,ue=r;switch(r){case"keypress":if(sf(d)===0)break e;case"keydown":case"keyup":H=VS;break;case"focusin":ue="focus",H=zg;break;case"focusout":ue="blur",H=zg;break;case"beforeblur":case"afterblur":H=zg;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=e0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=kS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=GS;break;case ab:case lb:case cb:H=RS;break;case ub:H=WS;break;case"scroll":H=IS;break;case"wheel":H=XS;break;case"copy":case"cut":case"paste":H=LS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=r0}var Pe=(o&4)!==0,pe=!Pe&&r==="scroll",E=Pe?O!==null?O+"Capture":null:O;Pe=[];for(var R=K,N;R!==null;){N=R;var re=N.stateNode;if(N.tag===5&&re!==null&&(N=re,E!==null&&(re=qh(R,E),re!=null&&Pe.push(Jh(R,re,N)))),pe)break;R=R.return}0<Pe.length&&(O=new H(O,ue,null,d,ge),be.push({event:O,listeners:Pe}))}}if(!(o&7)){e:{if(O=r==="mouseover"||r==="pointerover",H=r==="mouseout"||r==="pointerout",O&&d!==h_&&(ue=d.relatedTarget||d.fromElement)&&(hl(ue)||ue[io]))break e;if((H||O)&&(O=ge.window===ge?ge:(O=ge.ownerDocument)?O.defaultView||O.parentWindow:window,H?(ue=d.relatedTarget||d.toElement,H=K,ue=ue?hl(ue):null,ue!==null&&(pe=Sl(ue),ue!==pe||ue.tag!==5&&ue.tag!==6)&&(ue=null)):(H=null,ue=K),H!==ue)){if(Pe=e0,re="onMouseLeave",E="onMouseEnter",R="mouse",(r==="pointerout"||r==="pointerover")&&(Pe=r0,re="onPointerLeave",E="onPointerEnter",R="pointer"),pe=H==null?O:Lc(H),N=ue==null?O:Lc(ue),O=new Pe(re,R+"leave",H,d,ge),O.target=pe,O.relatedTarget=N,re=null,hl(ge)===K&&(Pe=new Pe(E,R+"enter",ue,d,ge),Pe.target=N,Pe.relatedTarget=pe,re=Pe),pe=re,H&&ue)t:{for(Pe=H,E=ue,R=0,N=Pe;N;N=Pc(N))R++;for(N=0,re=E;re;re=Pc(re))N++;for(;0<R-N;)Pe=Pc(Pe),R--;for(;0<N-R;)E=Pc(E),N--;for(;R--;){if(Pe===E||E!==null&&Pe===E.alternate)break t;Pe=Pc(Pe),E=Pc(E)}Pe=null}else Pe=null;H!==null&&p0(be,O,H,Pe,!1),ue!==null&&pe!==null&&p0(be,pe,ue,Pe,!0)}}e:{if(O=K?Lc(K):window,H=O.nodeName&&O.nodeName.toLowerCase(),H==="select"||H==="input"&&O.type==="file")var Te=rC;else if(s0(O))if(rb)Te=oC;else{Te=nC;var Ce=iC}else(H=O.nodeName)&&H.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(Te=sC);if(Te&&(Te=Te(r,K))){tb(be,Te,d,ge);break e}Ce&&Ce(r,O,K),r==="focusout"&&(Ce=O._wrapperState)&&Ce.controlled&&O.type==="number"&&o_(O,"number",O.value)}switch(Ce=K?Lc(K):window,r){case"focusin":(s0(Ce)||Ce.contentEditable==="true")&&(Rc=Ce,y_=K,Bh=null);break;case"focusout":Bh=y_=Rc=null;break;case"mousedown":v_=!0;break;case"contextmenu":case"mouseup":case"dragend":v_=!1,u0(be,d,ge);break;case"selectionchange":if(cC)break;case"keydown":case"keyup":u0(be,d,ge)}var Ne;if(py)e:{switch(r){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Ac?J1(r,d)&&(Ge="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(Ge="onCompositionStart");Ge&&(Q1&&d.locale!=="ko"&&(Ac||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Ac&&(Ne=K1()):(Xo=ge,uy="value"in Xo?Xo.value:Xo.textContent,Ac=!0)),Ce=wf(K,Ge),0<Ce.length&&(Ge=new t0(Ge,r,null,d,ge),be.push({event:Ge,listeners:Ce}),Ne?Ge.data=Ne:(Ne=eb(d),Ne!==null&&(Ge.data=Ne)))),(Ne=KS?QS(r,d):JS(r,d))&&(K=wf(K,"onBeforeInput"),0<K.length&&(ge=new t0("onBeforeInput","beforeinput",null,d,ge),be.push({event:ge,listeners:K}),ge.data=Ne))}db(be,o)})}function Jh(r,o,d){return{instance:r,listener:o,currentTarget:d}}function wf(r,o){for(var d=o+"Capture",_=[];r!==null;){var x=r,C=x.stateNode;x.tag===5&&C!==null&&(x=C,C=qh(r,d),C!=null&&_.unshift(Jh(r,C,x)),C=qh(r,o),C!=null&&_.push(Jh(r,C,x))),r=r.return}return _}function Pc(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function p0(r,o,d,_,x){for(var C=o._reactName,b=[];d!==null&&d!==_;){var c=d,Z=c.alternate,K=c.stateNode;if(Z!==null&&Z===_)break;c.tag===5&&K!==null&&(c=K,x?(Z=qh(d,C),Z!=null&&b.unshift(Jh(d,Z,c))):x||(Z=qh(d,C),Z!=null&&b.push(Jh(d,Z,c)))),d=d.return}b.length!==0&&r.push({event:o,listeners:b})}var pC=/\r\n?/g,fC=/\u0000|\uFFFD/g;function f0(r){return(typeof r=="string"?r:""+r).replace(pC,`
`).replace(fC,"")}function Fp(r,o,d){if(o=f0(o),f0(r)!==o&&d)throw Error(Qe(425))}function Tf(){}var x_=null,b_=null;function w_(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var T_=typeof setTimeout=="function"?setTimeout:void 0,mC=typeof clearTimeout=="function"?clearTimeout:void 0,m0=typeof Promise=="function"?Promise:void 0,gC=typeof queueMicrotask=="function"?queueMicrotask:typeof m0<"u"?function(r){return m0.resolve(null).then(r).catch(_C)}:T_;function _C(r){setTimeout(function(){throw r})}function Og(r,o){var d=o,_=0;do{var x=d.nextSibling;if(r.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"){if(_===0){r.removeChild(x),Xh(o);return}_--}else d!=="$"&&d!=="$?"&&d!=="$!"||_++;d=x}while(d);Xh(o)}function ea(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function g0(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return r;o--}else d==="/$"&&o++}r=r.previousSibling}return null}var nu=Math.random().toString(36).slice(2),Cs="__reactFiber$"+nu,ed="__reactProps$"+nu,io="__reactContainer$"+nu,S_="__reactEvents$"+nu,yC="__reactListeners$"+nu,vC="__reactHandles$"+nu;function hl(r){var o=r[Cs];if(o)return o;for(var d=r.parentNode;d;){if(o=d[io]||d[Cs]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(r=g0(r);r!==null;){if(d=r[Cs])return d;r=g0(r)}return o}r=d,d=r.parentNode}return null}function hd(r){return r=r[Cs]||r[io],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Lc(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(Qe(33))}function Gf(r){return r[ed]||null}var C_=[],jc=-1;function la(r){return{current:r}}function fr(r){0>jc||(r.current=C_[jc],C_[jc]=null,jc--)}function lr(r,o){jc++,C_[jc]=r.current,r.current=o}var oa={},Ei=la(oa),Ji=la(!1),_l=oa;function Yc(r,o){var d=r.type.contextTypes;if(!d)return oa;var _=r.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===o)return _.__reactInternalMemoizedMaskedChildContext;var x={},C;for(C in d)x[C]=o[C];return _&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=x),x}function en(r){return r=r.childContextTypes,r!=null}function Sf(){fr(Ji),fr(Ei)}function _0(r,o,d){if(Ei.current!==oa)throw Error(Qe(168));lr(Ei,o),lr(Ji,d)}function fb(r,o,d){var _=r.stateNode;if(o=o.childContextTypes,typeof _.getChildContext!="function")return d;_=_.getChildContext();for(var x in _)if(!(x in o))throw Error(Qe(108,iS(r)||"Unknown",x));return Sr({},d,_)}function Cf(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||oa,_l=Ei.current,lr(Ei,r),lr(Ji,Ji.current),!0}function y0(r,o,d){var _=r.stateNode;if(!_)throw Error(Qe(169));d?(r=fb(r,o,_l),_.__reactInternalMemoizedMergedChildContext=r,fr(Ji),fr(Ei),lr(Ei,r)):fr(Ji),lr(Ji,d)}var Ks=null,qf=!1,Ng=!1;function mb(r){Ks===null?Ks=[r]:Ks.push(r)}function xC(r){qf=!0,mb(r)}function ca(){if(!Ng&&Ks!==null){Ng=!0;var r=0,o=Kt;try{var d=Ks;for(Kt=1;r<d.length;r++){var _=d[r];do _=_(!0);while(_!==null)}Ks=null,qf=!1}catch(x){throw Ks!==null&&(Ks=Ks.slice(r+1)),N1(oy,ca),x}finally{Kt=o,Ng=!1}}return null}var Fc=[],Bc=0,Pf=null,Mf=0,kn=[],zn=0,yl=null,Qs=1,Js="";function ol(r,o){Fc[Bc++]=Mf,Fc[Bc++]=Pf,Pf=r,Mf=o}function gb(r,o,d){kn[zn++]=Qs,kn[zn++]=Js,kn[zn++]=yl,yl=r;var _=Qs;r=Js;var x=32-ns(_)-1;_&=~(1<<x),d+=1;var C=32-ns(o)+x;if(30<C){var b=x-x%5;C=(_&(1<<b)-1).toString(32),_>>=b,x-=b,Qs=1<<32-ns(o)+x|d<<x|_,Js=C+r}else Qs=1<<C|d<<x|_,Js=r}function my(r){r.return!==null&&(ol(r,1),gb(r,1,0))}function gy(r){for(;r===Pf;)Pf=Fc[--Bc],Fc[Bc]=null,Mf=Fc[--Bc],Fc[Bc]=null;for(;r===yl;)yl=kn[--zn],kn[zn]=null,Js=kn[--zn],kn[zn]=null,Qs=kn[--zn],kn[zn]=null}var mn=null,fn=null,gr=!1,is=null;function _b(r,o){var d=An(5,null,null,0);d.elementType="DELETED",d.stateNode=o,d.return=r,o=r.deletions,o===null?(r.deletions=[d],r.flags|=16):o.push(d)}function v0(r,o){switch(r.tag){case 5:var d=r.type;return o=o.nodeType!==1||d.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,mn=r,fn=ea(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,mn=r,fn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(d=yl!==null?{id:Qs,overflow:Js}:null,r.memoizedState={dehydrated:o,treeContext:d,retryLane:1073741824},d=An(18,null,null,0),d.stateNode=o,d.return=r,r.child=d,mn=r,fn=null,!0):!1;default:return!1}}function P_(r){return(r.mode&1)!==0&&(r.flags&128)===0}function M_(r){if(gr){var o=fn;if(o){var d=o;if(!v0(r,o)){if(P_(r))throw Error(Qe(418));o=ea(d.nextSibling);var _=mn;o&&v0(r,o)?_b(_,d):(r.flags=r.flags&-4097|2,gr=!1,mn=r)}}else{if(P_(r))throw Error(Qe(418));r.flags=r.flags&-4097|2,gr=!1,mn=r}}}function x0(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;mn=r}function Bp(r){if(r!==mn)return!1;if(!gr)return x0(r),gr=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!w_(r.type,r.memoizedProps)),o&&(o=fn)){if(P_(r))throw yb(),Error(Qe(418));for(;o;)_b(r,o),o=ea(o.nextSibling)}if(x0(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Qe(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"){if(o===0){fn=ea(r.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++}r=r.nextSibling}fn=null}}else fn=mn?ea(r.stateNode.nextSibling):null;return!0}function yb(){for(var r=fn;r;)r=ea(r.nextSibling)}function Kc(){fn=mn=null,gr=!1}function _y(r){is===null?is=[r]:is.push(r)}var bC=lo.ReactCurrentBatchConfig;function Sh(r,o,d){if(r=d.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(Qe(309));var _=d.stateNode}if(!_)throw Error(Qe(147,r));var x=_,C=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===C?o.ref:(o=function(b){var c=x.refs;b===null?delete c[C]:c[C]=b},o._stringRef=C,o)}if(typeof r!="string")throw Error(Qe(284));if(!d._owner)throw Error(Qe(290,r))}return r}function Op(r,o){throw r=Object.prototype.toString.call(o),Error(Qe(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function b0(r){var o=r._init;return o(r._payload)}function vb(r){function o(E,R){if(r){var N=E.deletions;N===null?(E.deletions=[R],E.flags|=16):N.push(R)}}function d(E,R){if(!r)return null;for(;R!==null;)o(E,R),R=R.sibling;return null}function _(E,R){for(E=new Map;R!==null;)R.key!==null?E.set(R.key,R):E.set(R.index,R),R=R.sibling;return E}function x(E,R){return E=na(E,R),E.index=0,E.sibling=null,E}function C(E,R,N){return E.index=N,r?(N=E.alternate,N!==null?(N=N.index,N<R?(E.flags|=2,R):N):(E.flags|=2,R)):(E.flags|=1048576,R)}function b(E){return r&&E.alternate===null&&(E.flags|=2),E}function c(E,R,N,re){return R===null||R.tag!==6?(R=Wg(N,E.mode,re),R.return=E,R):(R=x(R,N),R.return=E,R)}function Z(E,R,N,re){var Te=N.type;return Te===zc?ge(E,R,N.props.children,re,N.key):R!==null&&(R.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===Go&&b0(Te)===R.type)?(re=x(R,N.props),re.ref=Sh(E,R,N),re.return=E,re):(re=df(N.type,N.key,N.props,null,E.mode,re),re.ref=Sh(E,R,N),re.return=E,re)}function K(E,R,N,re){return R===null||R.tag!==4||R.stateNode.containerInfo!==N.containerInfo||R.stateNode.implementation!==N.implementation?(R=Hg(N,E.mode,re),R.return=E,R):(R=x(R,N.children||[]),R.return=E,R)}function ge(E,R,N,re,Te){return R===null||R.tag!==7?(R=gl(N,E.mode,re,Te),R.return=E,R):(R=x(R,N),R.return=E,R)}function be(E,R,N){if(typeof R=="string"&&R!==""||typeof R=="number")return R=Wg(""+R,E.mode,N),R.return=E,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Ip:return N=df(R.type,R.key,R.props,null,E.mode,N),N.ref=Sh(E,null,R),N.return=E,N;case kc:return R=Hg(R,E.mode,N),R.return=E,R;case Go:var re=R._init;return be(E,re(R._payload),N)}if(zh(R)||vh(R))return R=gl(R,E.mode,N,null),R.return=E,R;Op(E,R)}return null}function O(E,R,N,re){var Te=R!==null?R.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return Te!==null?null:c(E,R,""+N,re);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ip:return N.key===Te?Z(E,R,N,re):null;case kc:return N.key===Te?K(E,R,N,re):null;case Go:return Te=N._init,O(E,R,Te(N._payload),re)}if(zh(N)||vh(N))return Te!==null?null:ge(E,R,N,re,null);Op(E,N)}return null}function H(E,R,N,re,Te){if(typeof re=="string"&&re!==""||typeof re=="number")return E=E.get(N)||null,c(R,E,""+re,Te);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Ip:return E=E.get(re.key===null?N:re.key)||null,Z(R,E,re,Te);case kc:return E=E.get(re.key===null?N:re.key)||null,K(R,E,re,Te);case Go:var Ce=re._init;return H(E,R,N,Ce(re._payload),Te)}if(zh(re)||vh(re))return E=E.get(N)||null,ge(R,E,re,Te,null);Op(R,re)}return null}function ue(E,R,N,re){for(var Te=null,Ce=null,Ne=R,Ge=R=0,ht=null;Ne!==null&&Ge<N.length;Ge++){Ne.index>Ge?(ht=Ne,Ne=null):ht=Ne.sibling;var dt=O(E,Ne,N[Ge],re);if(dt===null){Ne===null&&(Ne=ht);break}r&&Ne&&dt.alternate===null&&o(E,Ne),R=C(dt,R,Ge),Ce===null?Te=dt:Ce.sibling=dt,Ce=dt,Ne=ht}if(Ge===N.length)return d(E,Ne),gr&&ol(E,Ge),Te;if(Ne===null){for(;Ge<N.length;Ge++)Ne=be(E,N[Ge],re),Ne!==null&&(R=C(Ne,R,Ge),Ce===null?Te=Ne:Ce.sibling=Ne,Ce=Ne);return gr&&ol(E,Ge),Te}for(Ne=_(E,Ne);Ge<N.length;Ge++)ht=H(Ne,E,Ge,N[Ge],re),ht!==null&&(r&&ht.alternate!==null&&Ne.delete(ht.key===null?Ge:ht.key),R=C(ht,R,Ge),Ce===null?Te=ht:Ce.sibling=ht,Ce=ht);return r&&Ne.forEach(function(Gt){return o(E,Gt)}),gr&&ol(E,Ge),Te}function Pe(E,R,N,re){var Te=vh(N);if(typeof Te!="function")throw Error(Qe(150));if(N=Te.call(N),N==null)throw Error(Qe(151));for(var Ce=Te=null,Ne=R,Ge=R=0,ht=null,dt=N.next();Ne!==null&&!dt.done;Ge++,dt=N.next()){Ne.index>Ge?(ht=Ne,Ne=null):ht=Ne.sibling;var Gt=O(E,Ne,dt.value,re);if(Gt===null){Ne===null&&(Ne=ht);break}r&&Ne&&Gt.alternate===null&&o(E,Ne),R=C(Gt,R,Ge),Ce===null?Te=Gt:Ce.sibling=Gt,Ce=Gt,Ne=ht}if(dt.done)return d(E,Ne),gr&&ol(E,Ge),Te;if(Ne===null){for(;!dt.done;Ge++,dt=N.next())dt=be(E,dt.value,re),dt!==null&&(R=C(dt,R,Ge),Ce===null?Te=dt:Ce.sibling=dt,Ce=dt);return gr&&ol(E,Ge),Te}for(Ne=_(E,Ne);!dt.done;Ge++,dt=N.next())dt=H(Ne,E,Ge,dt.value,re),dt!==null&&(r&&dt.alternate!==null&&Ne.delete(dt.key===null?Ge:dt.key),R=C(dt,R,Ge),Ce===null?Te=dt:Ce.sibling=dt,Ce=dt);return r&&Ne.forEach(function(yr){return o(E,yr)}),gr&&ol(E,Ge),Te}function pe(E,R,N,re){if(typeof N=="object"&&N!==null&&N.type===zc&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case Ip:e:{for(var Te=N.key,Ce=R;Ce!==null;){if(Ce.key===Te){if(Te=N.type,Te===zc){if(Ce.tag===7){d(E,Ce.sibling),R=x(Ce,N.props.children),R.return=E,E=R;break e}}else if(Ce.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===Go&&b0(Te)===Ce.type){d(E,Ce.sibling),R=x(Ce,N.props),R.ref=Sh(E,Ce,N),R.return=E,E=R;break e}d(E,Ce);break}else o(E,Ce);Ce=Ce.sibling}N.type===zc?(R=gl(N.props.children,E.mode,re,N.key),R.return=E,E=R):(re=df(N.type,N.key,N.props,null,E.mode,re),re.ref=Sh(E,R,N),re.return=E,E=re)}return b(E);case kc:e:{for(Ce=N.key;R!==null;){if(R.key===Ce)if(R.tag===4&&R.stateNode.containerInfo===N.containerInfo&&R.stateNode.implementation===N.implementation){d(E,R.sibling),R=x(R,N.children||[]),R.return=E,E=R;break e}else{d(E,R);break}else o(E,R);R=R.sibling}R=Hg(N,E.mode,re),R.return=E,E=R}return b(E);case Go:return Ce=N._init,pe(E,R,Ce(N._payload),re)}if(zh(N))return ue(E,R,N,re);if(vh(N))return Pe(E,R,N,re);Op(E,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,R!==null&&R.tag===6?(d(E,R.sibling),R=x(R,N),R.return=E,E=R):(d(E,R),R=Wg(N,E.mode,re),R.return=E,E=R),b(E)):d(E,R)}return pe}var Qc=vb(!0),xb=vb(!1),If=la(null),Ef=null,Oc=null,yy=null;function vy(){yy=Oc=Ef=null}function xy(r){var o=If.current;fr(If),r._currentValue=o}function I_(r,o,d){for(;r!==null;){var _=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,_!==null&&(_.childLanes|=o)):_!==null&&(_.childLanes&o)!==o&&(_.childLanes|=o),r===d)break;r=r.return}}function Wc(r,o){Ef=r,yy=Oc=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&o&&(Qi=!0),r.firstContext=null)}function Dn(r){var o=r._currentValue;if(yy!==r)if(r={context:r,memoizedValue:o,next:null},Oc===null){if(Ef===null)throw Error(Qe(308));Oc=r,Ef.dependencies={lanes:0,firstContext:r}}else Oc=Oc.next=r;return o}var dl=null;function by(r){dl===null?dl=[r]:dl.push(r)}function bb(r,o,d,_){var x=o.interleaved;return x===null?(d.next=d,by(o)):(d.next=x.next,x.next=d),o.interleaved=d,no(r,_)}function no(r,o){r.lanes|=o;var d=r.alternate;for(d!==null&&(d.lanes|=o),d=r,r=r.return;r!==null;)r.childLanes|=o,d=r.alternate,d!==null&&(d.childLanes|=o),d=r,r=r.return;return d.tag===3?d.stateNode:null}var qo=!1;function wy(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wb(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function eo(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function ta(r,o,d){var _=r.updateQueue;if(_===null)return null;if(_=_.shared,Zt&2){var x=_.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),_.pending=o,no(r,d)}return x=_.interleaved,x===null?(o.next=o,by(_)):(o.next=x.next,x.next=o),_.interleaved=o,no(r,d)}function of(r,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194240)!==0)){var _=o.lanes;_&=r.pendingLanes,d|=_,o.lanes=d,ay(r,d)}}function w0(r,o){var d=r.updateQueue,_=r.alternate;if(_!==null&&(_=_.updateQueue,d===_)){var x=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var b={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};C===null?x=C=b:C=C.next=b,d=d.next}while(d!==null);C===null?x=C=o:C=C.next=o}else x=C=o;d={baseState:_.baseState,firstBaseUpdate:x,lastBaseUpdate:C,shared:_.shared,effects:_.effects},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=o:r.next=o,d.lastBaseUpdate=o}function kf(r,o,d,_){var x=r.updateQueue;qo=!1;var C=x.firstBaseUpdate,b=x.lastBaseUpdate,c=x.shared.pending;if(c!==null){x.shared.pending=null;var Z=c,K=Z.next;Z.next=null,b===null?C=K:b.next=K,b=Z;var ge=r.alternate;ge!==null&&(ge=ge.updateQueue,c=ge.lastBaseUpdate,c!==b&&(c===null?ge.firstBaseUpdate=K:c.next=K,ge.lastBaseUpdate=Z))}if(C!==null){var be=x.baseState;b=0,ge=K=Z=null,c=C;do{var O=c.lane,H=c.eventTime;if((_&O)===O){ge!==null&&(ge=ge.next={eventTime:H,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var ue=r,Pe=c;switch(O=o,H=d,Pe.tag){case 1:if(ue=Pe.payload,typeof ue=="function"){be=ue.call(H,be,O);break e}be=ue;break e;case 3:ue.flags=ue.flags&-65537|128;case 0:if(ue=Pe.payload,O=typeof ue=="function"?ue.call(H,be,O):ue,O==null)break e;be=Sr({},be,O);break e;case 2:qo=!0}}c.callback!==null&&c.lane!==0&&(r.flags|=64,O=x.effects,O===null?x.effects=[c]:O.push(c))}else H={eventTime:H,lane:O,tag:c.tag,payload:c.payload,callback:c.callback,next:null},ge===null?(K=ge=H,Z=be):ge=ge.next=H,b|=O;if(c=c.next,c===null){if(c=x.shared.pending,c===null)break;O=c,c=O.next,O.next=null,x.lastBaseUpdate=O,x.shared.pending=null}}while(!0);if(ge===null&&(Z=be),x.baseState=Z,x.firstBaseUpdate=K,x.lastBaseUpdate=ge,o=x.shared.interleaved,o!==null){x=o;do b|=x.lane,x=x.next;while(x!==o)}else C===null&&(x.shared.lanes=0);xl|=b,r.lanes=b,r.memoizedState=be}}function T0(r,o,d){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var _=r[o],x=_.callback;if(x!==null){if(_.callback=null,_=d,typeof x!="function")throw Error(Qe(191,x));x.call(_)}}}var dd={},Ms=la(dd),td=la(dd),rd=la(dd);function pl(r){if(r===dd)throw Error(Qe(174));return r}function Ty(r,o){switch(lr(rd,o),lr(td,r),lr(Ms,dd),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:l_(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=l_(o,r)}fr(Ms),lr(Ms,o)}function Jc(){fr(Ms),fr(td),fr(rd)}function Tb(r){pl(rd.current);var o=pl(Ms.current),d=l_(o,r.type);o!==d&&(lr(td,r),lr(Ms,d))}function Sy(r){td.current===r&&(fr(Ms),fr(td))}var br=la(0);function zf(r){for(var o=r;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var $g=[];function Cy(){for(var r=0;r<$g.length;r++)$g[r]._workInProgressVersionPrimary=null;$g.length=0}var af=lo.ReactCurrentDispatcher,Vg=lo.ReactCurrentBatchConfig,vl=0,wr=null,ti=null,li=null,Af=!1,Oh=!1,id=0,wC=0;function Pi(){throw Error(Qe(321))}function Py(r,o){if(o===null)return!1;for(var d=0;d<o.length&&d<r.length;d++)if(!os(r[d],o[d]))return!1;return!0}function My(r,o,d,_,x,C){if(vl=C,wr=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,af.current=r===null||r.memoizedState===null?PC:MC,r=d(_,x),Oh){C=0;do{if(Oh=!1,id=0,25<=C)throw Error(Qe(301));C+=1,li=ti=null,o.updateQueue=null,af.current=IC,r=d(_,x)}while(Oh)}if(af.current=Rf,o=ti!==null&&ti.next!==null,vl=0,li=ti=wr=null,Af=!1,o)throw Error(Qe(300));return r}function Iy(){var r=id!==0;return id=0,r}function Ts(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return li===null?wr.memoizedState=li=r:li=li.next=r,li}function Ln(){if(ti===null){var r=wr.alternate;r=r!==null?r.memoizedState:null}else r=ti.next;var o=li===null?wr.memoizedState:li.next;if(o!==null)li=o,ti=r;else{if(r===null)throw Error(Qe(310));ti=r,r={memoizedState:ti.memoizedState,baseState:ti.baseState,baseQueue:ti.baseQueue,queue:ti.queue,next:null},li===null?wr.memoizedState=li=r:li=li.next=r}return li}function nd(r,o){return typeof o=="function"?o(r):o}function Ug(r){var o=Ln(),d=o.queue;if(d===null)throw Error(Qe(311));d.lastRenderedReducer=r;var _=ti,x=_.baseQueue,C=d.pending;if(C!==null){if(x!==null){var b=x.next;x.next=C.next,C.next=b}_.baseQueue=x=C,d.pending=null}if(x!==null){C=x.next,_=_.baseState;var c=b=null,Z=null,K=C;do{var ge=K.lane;if((vl&ge)===ge)Z!==null&&(Z=Z.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),_=K.hasEagerState?K.eagerState:r(_,K.action);else{var be={lane:ge,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};Z===null?(c=Z=be,b=_):Z=Z.next=be,wr.lanes|=ge,xl|=ge}K=K.next}while(K!==null&&K!==C);Z===null?b=_:Z.next=c,os(_,o.memoizedState)||(Qi=!0),o.memoizedState=_,o.baseState=b,o.baseQueue=Z,d.lastRenderedState=_}if(r=d.interleaved,r!==null){x=r;do C=x.lane,wr.lanes|=C,xl|=C,x=x.next;while(x!==r)}else x===null&&(d.lanes=0);return[o.memoizedState,d.dispatch]}function Zg(r){var o=Ln(),d=o.queue;if(d===null)throw Error(Qe(311));d.lastRenderedReducer=r;var _=d.dispatch,x=d.pending,C=o.memoizedState;if(x!==null){d.pending=null;var b=x=x.next;do C=r(C,b.action),b=b.next;while(b!==x);os(C,o.memoizedState)||(Qi=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),d.lastRenderedState=C}return[C,_]}function Sb(){}function Cb(r,o){var d=wr,_=Ln(),x=o(),C=!os(_.memoizedState,x);if(C&&(_.memoizedState=x,Qi=!0),_=_.queue,Ey(Ib.bind(null,d,_,r),[r]),_.getSnapshot!==o||C||li!==null&&li.memoizedState.tag&1){if(d.flags|=2048,sd(9,Mb.bind(null,d,_,x,o),void 0,null),ci===null)throw Error(Qe(349));vl&30||Pb(d,o,x)}return x}function Pb(r,o,d){r.flags|=16384,r={getSnapshot:o,value:d},o=wr.updateQueue,o===null?(o={lastEffect:null,stores:null},wr.updateQueue=o,o.stores=[r]):(d=o.stores,d===null?o.stores=[r]:d.push(r))}function Mb(r,o,d,_){o.value=d,o.getSnapshot=_,Eb(o)&&kb(r)}function Ib(r,o,d){return d(function(){Eb(o)&&kb(r)})}function Eb(r){var o=r.getSnapshot;r=r.value;try{var d=o();return!os(r,d)}catch{return!0}}function kb(r){var o=no(r,1);o!==null&&ss(o,r,1,-1)}function S0(r){var o=Ts();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nd,lastRenderedState:r},o.queue=r,r=r.dispatch=CC.bind(null,wr,r),[o.memoizedState,r]}function sd(r,o,d,_){return r={tag:r,create:o,destroy:d,deps:_,next:null},o=wr.updateQueue,o===null?(o={lastEffect:null,stores:null},wr.updateQueue=o,o.lastEffect=r.next=r):(d=o.lastEffect,d===null?o.lastEffect=r.next=r:(_=d.next,d.next=r,r.next=_,o.lastEffect=r)),r}function zb(){return Ln().memoizedState}function lf(r,o,d,_){var x=Ts();wr.flags|=r,x.memoizedState=sd(1|o,d,void 0,_===void 0?null:_)}function Wf(r,o,d,_){var x=Ln();_=_===void 0?null:_;var C=void 0;if(ti!==null){var b=ti.memoizedState;if(C=b.destroy,_!==null&&Py(_,b.deps)){x.memoizedState=sd(o,d,C,_);return}}wr.flags|=r,x.memoizedState=sd(1|o,d,C,_)}function C0(r,o){return lf(8390656,8,r,o)}function Ey(r,o){return Wf(2048,8,r,o)}function Ab(r,o){return Wf(4,2,r,o)}function Rb(r,o){return Wf(4,4,r,o)}function Db(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Lb(r,o,d){return d=d!=null?d.concat([r]):null,Wf(4,4,Db.bind(null,o,r),d)}function ky(){}function jb(r,o){var d=Ln();o=o===void 0?null:o;var _=d.memoizedState;return _!==null&&o!==null&&Py(o,_[1])?_[0]:(d.memoizedState=[r,o],r)}function Fb(r,o){var d=Ln();o=o===void 0?null:o;var _=d.memoizedState;return _!==null&&o!==null&&Py(o,_[1])?_[0]:(r=r(),d.memoizedState=[r,o],r)}function Bb(r,o,d){return vl&21?(os(d,o)||(d=U1(),wr.lanes|=d,xl|=d,r.baseState=!0),o):(r.baseState&&(r.baseState=!1,Qi=!0),r.memoizedState=d)}function TC(r,o){var d=Kt;Kt=d!==0&&4>d?d:4,r(!0);var _=Vg.transition;Vg.transition={};try{r(!1),o()}finally{Kt=d,Vg.transition=_}}function Ob(){return Ln().memoizedState}function SC(r,o,d){var _=ia(r);if(d={lane:_,action:d,hasEagerState:!1,eagerState:null,next:null},Nb(r))$b(o,d);else if(d=bb(r,o,d,_),d!==null){var x=Ni();ss(d,r,_,x),Vb(d,o,_)}}function CC(r,o,d){var _=ia(r),x={lane:_,action:d,hasEagerState:!1,eagerState:null,next:null};if(Nb(r))$b(o,x);else{var C=r.alternate;if(r.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var b=o.lastRenderedState,c=C(b,d);if(x.hasEagerState=!0,x.eagerState=c,os(c,b)){var Z=o.interleaved;Z===null?(x.next=x,by(o)):(x.next=Z.next,Z.next=x),o.interleaved=x;return}}catch{}finally{}d=bb(r,o,x,_),d!==null&&(x=Ni(),ss(d,r,_,x),Vb(d,o,_))}}function Nb(r){var o=r.alternate;return r===wr||o!==null&&o===wr}function $b(r,o){Oh=Af=!0;var d=r.pending;d===null?o.next=o:(o.next=d.next,d.next=o),r.pending=o}function Vb(r,o,d){if(d&4194240){var _=o.lanes;_&=r.pendingLanes,d|=_,o.lanes=d,ay(r,d)}}var Rf={readContext:Dn,useCallback:Pi,useContext:Pi,useEffect:Pi,useImperativeHandle:Pi,useInsertionEffect:Pi,useLayoutEffect:Pi,useMemo:Pi,useReducer:Pi,useRef:Pi,useState:Pi,useDebugValue:Pi,useDeferredValue:Pi,useTransition:Pi,useMutableSource:Pi,useSyncExternalStore:Pi,useId:Pi,unstable_isNewReconciler:!1},PC={readContext:Dn,useCallback:function(r,o){return Ts().memoizedState=[r,o===void 0?null:o],r},useContext:Dn,useEffect:C0,useImperativeHandle:function(r,o,d){return d=d!=null?d.concat([r]):null,lf(4194308,4,Db.bind(null,o,r),d)},useLayoutEffect:function(r,o){return lf(4194308,4,r,o)},useInsertionEffect:function(r,o){return lf(4,2,r,o)},useMemo:function(r,o){var d=Ts();return o=o===void 0?null:o,r=r(),d.memoizedState=[r,o],r},useReducer:function(r,o,d){var _=Ts();return o=d!==void 0?d(o):o,_.memoizedState=_.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},_.queue=r,r=r.dispatch=SC.bind(null,wr,r),[_.memoizedState,r]},useRef:function(r){var o=Ts();return r={current:r},o.memoizedState=r},useState:S0,useDebugValue:ky,useDeferredValue:function(r){return Ts().memoizedState=r},useTransition:function(){var r=S0(!1),o=r[0];return r=TC.bind(null,r[1]),Ts().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,d){var _=wr,x=Ts();if(gr){if(d===void 0)throw Error(Qe(407));d=d()}else{if(d=o(),ci===null)throw Error(Qe(349));vl&30||Pb(_,o,d)}x.memoizedState=d;var C={value:d,getSnapshot:o};return x.queue=C,C0(Ib.bind(null,_,C,r),[r]),_.flags|=2048,sd(9,Mb.bind(null,_,C,d,o),void 0,null),d},useId:function(){var r=Ts(),o=ci.identifierPrefix;if(gr){var d=Js,_=Qs;d=(_&~(1<<32-ns(_)-1)).toString(32)+d,o=":"+o+"R"+d,d=id++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=wC++,o=":"+o+"r"+d.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},MC={readContext:Dn,useCallback:jb,useContext:Dn,useEffect:Ey,useImperativeHandle:Lb,useInsertionEffect:Ab,useLayoutEffect:Rb,useMemo:Fb,useReducer:Ug,useRef:zb,useState:function(){return Ug(nd)},useDebugValue:ky,useDeferredValue:function(r){var o=Ln();return Bb(o,ti.memoizedState,r)},useTransition:function(){var r=Ug(nd)[0],o=Ln().memoizedState;return[r,o]},useMutableSource:Sb,useSyncExternalStore:Cb,useId:Ob,unstable_isNewReconciler:!1},IC={readContext:Dn,useCallback:jb,useContext:Dn,useEffect:Ey,useImperativeHandle:Lb,useInsertionEffect:Ab,useLayoutEffect:Rb,useMemo:Fb,useReducer:Zg,useRef:zb,useState:function(){return Zg(nd)},useDebugValue:ky,useDeferredValue:function(r){var o=Ln();return ti===null?o.memoizedState=r:Bb(o,ti.memoizedState,r)},useTransition:function(){var r=Zg(nd)[0],o=Ln().memoizedState;return[r,o]},useMutableSource:Sb,useSyncExternalStore:Cb,useId:Ob,unstable_isNewReconciler:!1};function Jn(r,o){if(r&&r.defaultProps){o=Sr({},o),r=r.defaultProps;for(var d in r)o[d]===void 0&&(o[d]=r[d]);return o}return o}function E_(r,o,d,_){o=r.memoizedState,d=d(_,o),d=d==null?o:Sr({},o,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var Hf={isMounted:function(r){return(r=r._reactInternals)?Sl(r)===r:!1},enqueueSetState:function(r,o,d){r=r._reactInternals;var _=Ni(),x=ia(r),C=eo(_,x);C.payload=o,d!=null&&(C.callback=d),o=ta(r,C,x),o!==null&&(ss(o,r,x,_),of(o,r,x))},enqueueReplaceState:function(r,o,d){r=r._reactInternals;var _=Ni(),x=ia(r),C=eo(_,x);C.tag=1,C.payload=o,d!=null&&(C.callback=d),o=ta(r,C,x),o!==null&&(ss(o,r,x,_),of(o,r,x))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var d=Ni(),_=ia(r),x=eo(d,_);x.tag=2,o!=null&&(x.callback=o),o=ta(r,x,_),o!==null&&(ss(o,r,_,d),of(o,r,_))}};function P0(r,o,d,_,x,C,b){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(_,C,b):o.prototype&&o.prototype.isPureReactComponent?!Kh(d,_)||!Kh(x,C):!0}function Ub(r,o,d){var _=!1,x=oa,C=o.contextType;return typeof C=="object"&&C!==null?C=Dn(C):(x=en(o)?_l:Ei.current,_=o.contextTypes,C=(_=_!=null)?Yc(r,x):oa),o=new o(d,C),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Hf,r.stateNode=o,o._reactInternals=r,_&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=x,r.__reactInternalMemoizedMaskedChildContext=C),o}function M0(r,o,d,_){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,_),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,_),o.state!==r&&Hf.enqueueReplaceState(o,o.state,null)}function k_(r,o,d,_){var x=r.stateNode;x.props=d,x.state=r.memoizedState,x.refs={},wy(r);var C=o.contextType;typeof C=="object"&&C!==null?x.context=Dn(C):(C=en(o)?_l:Ei.current,x.context=Yc(r,C)),x.state=r.memoizedState,C=o.getDerivedStateFromProps,typeof C=="function"&&(E_(r,o,C,d),x.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(o=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),o!==x.state&&Hf.enqueueReplaceState(x,x.state,null),kf(r,d,x,_),x.state=r.memoizedState),typeof x.componentDidMount=="function"&&(r.flags|=4194308)}function eu(r,o){try{var d="",_=o;do d+=rS(_),_=_.return;while(_);var x=d}catch(C){x=`
Error generating stack: `+C.message+`
`+C.stack}return{value:r,source:o,stack:x,digest:null}}function Gg(r,o,d){return{value:r,source:null,stack:d??null,digest:o??null}}function z_(r,o){try{console.error(o.value)}catch(d){setTimeout(function(){throw d})}}var EC=typeof WeakMap=="function"?WeakMap:Map;function Zb(r,o,d){d=eo(-1,d),d.tag=3,d.payload={element:null};var _=o.value;return d.callback=function(){Lf||(Lf=!0,$_=_),z_(r,o)},d}function Gb(r,o,d){d=eo(-1,d),d.tag=3;var _=r.type.getDerivedStateFromError;if(typeof _=="function"){var x=o.value;d.payload=function(){return _(x)},d.callback=function(){z_(r,o)}}var C=r.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(d.callback=function(){z_(r,o),typeof _!="function"&&(ra===null?ra=new Set([this]):ra.add(this));var b=o.stack;this.componentDidCatch(o.value,{componentStack:b!==null?b:""})}),d}function I0(r,o,d){var _=r.pingCache;if(_===null){_=r.pingCache=new EC;var x=new Set;_.set(o,x)}else x=_.get(o),x===void 0&&(x=new Set,_.set(o,x));x.has(d)||(x.add(d),r=UC.bind(null,r,o,d),o.then(r,r))}function E0(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function k0(r,o,d,_,x){return r.mode&1?(r.flags|=65536,r.lanes=x,r):(r===o?r.flags|=65536:(r.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(o=eo(-1,1),o.tag=2,ta(d,o,1))),d.lanes|=1),r)}var kC=lo.ReactCurrentOwner,Qi=!1;function Oi(r,o,d,_){o.child=r===null?xb(o,null,d,_):Qc(o,r.child,d,_)}function z0(r,o,d,_,x){d=d.render;var C=o.ref;return Wc(o,x),_=My(r,o,d,_,C,x),d=Iy(),r!==null&&!Qi?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~x,so(r,o,x)):(gr&&d&&my(o),o.flags|=1,Oi(r,o,_,x),o.child)}function A0(r,o,d,_,x){if(r===null){var C=d.type;return typeof C=="function"&&!By(C)&&C.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(o.tag=15,o.type=C,qb(r,o,C,_,x)):(r=df(d.type,null,_,o,o.mode,x),r.ref=o.ref,r.return=o,o.child=r)}if(C=r.child,!(r.lanes&x)){var b=C.memoizedProps;if(d=d.compare,d=d!==null?d:Kh,d(b,_)&&r.ref===o.ref)return so(r,o,x)}return o.flags|=1,r=na(C,_),r.ref=o.ref,r.return=o,o.child=r}function qb(r,o,d,_,x){if(r!==null){var C=r.memoizedProps;if(Kh(C,_)&&r.ref===o.ref)if(Qi=!1,o.pendingProps=_=C,(r.lanes&x)!==0)r.flags&131072&&(Qi=!0);else return o.lanes=r.lanes,so(r,o,x)}return A_(r,o,d,_,x)}function Wb(r,o,d){var _=o.pendingProps,x=_.children,C=r!==null?r.memoizedState:null;if(_.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},lr($c,pn),pn|=d;else{if(!(d&1073741824))return r=C!==null?C.baseLanes|d:d,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,lr($c,pn),pn|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=C!==null?C.baseLanes:d,lr($c,pn),pn|=_}else C!==null?(_=C.baseLanes|d,o.memoizedState=null):_=d,lr($c,pn),pn|=_;return Oi(r,o,x,d),o.child}function Hb(r,o){var d=o.ref;(r===null&&d!==null||r!==null&&r.ref!==d)&&(o.flags|=512,o.flags|=2097152)}function A_(r,o,d,_,x){var C=en(d)?_l:Ei.current;return C=Yc(o,C),Wc(o,x),d=My(r,o,d,_,C,x),_=Iy(),r!==null&&!Qi?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~x,so(r,o,x)):(gr&&_&&my(o),o.flags|=1,Oi(r,o,d,x),o.child)}function R0(r,o,d,_,x){if(en(d)){var C=!0;Cf(o)}else C=!1;if(Wc(o,x),o.stateNode===null)cf(r,o),Ub(o,d,_),k_(o,d,_,x),_=!0;else if(r===null){var b=o.stateNode,c=o.memoizedProps;b.props=c;var Z=b.context,K=d.contextType;typeof K=="object"&&K!==null?K=Dn(K):(K=en(d)?_l:Ei.current,K=Yc(o,K));var ge=d.getDerivedStateFromProps,be=typeof ge=="function"||typeof b.getSnapshotBeforeUpdate=="function";be||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(c!==_||Z!==K)&&M0(o,b,_,K),qo=!1;var O=o.memoizedState;b.state=O,kf(o,_,b,x),Z=o.memoizedState,c!==_||O!==Z||Ji.current||qo?(typeof ge=="function"&&(E_(o,d,ge,_),Z=o.memoizedState),(c=qo||P0(o,d,c,_,O,Z,K))?(be||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=_,o.memoizedState=Z),b.props=_,b.state=Z,b.context=K,_=c):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),_=!1)}else{b=o.stateNode,wb(r,o),c=o.memoizedProps,K=o.type===o.elementType?c:Jn(o.type,c),b.props=K,be=o.pendingProps,O=b.context,Z=d.contextType,typeof Z=="object"&&Z!==null?Z=Dn(Z):(Z=en(d)?_l:Ei.current,Z=Yc(o,Z));var H=d.getDerivedStateFromProps;(ge=typeof H=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(c!==be||O!==Z)&&M0(o,b,_,Z),qo=!1,O=o.memoizedState,b.state=O,kf(o,_,b,x);var ue=o.memoizedState;c!==be||O!==ue||Ji.current||qo?(typeof H=="function"&&(E_(o,d,H,_),ue=o.memoizedState),(K=qo||P0(o,d,K,_,O,ue,Z)||!1)?(ge||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(_,ue,Z),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(_,ue,Z)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||c===r.memoizedProps&&O===r.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||c===r.memoizedProps&&O===r.memoizedState||(o.flags|=1024),o.memoizedProps=_,o.memoizedState=ue),b.props=_,b.state=ue,b.context=Z,_=K):(typeof b.componentDidUpdate!="function"||c===r.memoizedProps&&O===r.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||c===r.memoizedProps&&O===r.memoizedState||(o.flags|=1024),_=!1)}return R_(r,o,d,_,C,x)}function R_(r,o,d,_,x,C){Hb(r,o);var b=(o.flags&128)!==0;if(!_&&!b)return x&&y0(o,d,!1),so(r,o,C);_=o.stateNode,kC.current=o;var c=b&&typeof d.getDerivedStateFromError!="function"?null:_.render();return o.flags|=1,r!==null&&b?(o.child=Qc(o,r.child,null,C),o.child=Qc(o,null,c,C)):Oi(r,o,c,C),o.memoizedState=_.state,x&&y0(o,d,!0),o.child}function Xb(r){var o=r.stateNode;o.pendingContext?_0(r,o.pendingContext,o.pendingContext!==o.context):o.context&&_0(r,o.context,!1),Ty(r,o.containerInfo)}function D0(r,o,d,_,x){return Kc(),_y(x),o.flags|=256,Oi(r,o,d,_),o.child}var D_={dehydrated:null,treeContext:null,retryLane:0};function L_(r){return{baseLanes:r,cachePool:null,transitions:null}}function Yb(r,o,d){var _=o.pendingProps,x=br.current,C=!1,b=(o.flags&128)!==0,c;if((c=b)||(c=r!==null&&r.memoizedState===null?!1:(x&2)!==0),c?(C=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(x|=1),lr(br,x&1),r===null)return M_(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(o.mode&1?r.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(b=_.children,r=_.fallback,C?(_=o.mode,C=o.child,b={mode:"hidden",children:b},!(_&1)&&C!==null?(C.childLanes=0,C.pendingProps=b):C=Kf(b,_,0,null),r=gl(r,_,d,null),C.return=o,r.return=o,C.sibling=r,o.child=C,o.child.memoizedState=L_(d),o.memoizedState=D_,r):zy(o,b));if(x=r.memoizedState,x!==null&&(c=x.dehydrated,c!==null))return zC(r,o,b,_,c,x,d);if(C){C=_.fallback,b=o.mode,x=r.child,c=x.sibling;var Z={mode:"hidden",children:_.children};return!(b&1)&&o.child!==x?(_=o.child,_.childLanes=0,_.pendingProps=Z,o.deletions=null):(_=na(x,Z),_.subtreeFlags=x.subtreeFlags&14680064),c!==null?C=na(c,C):(C=gl(C,b,d,null),C.flags|=2),C.return=o,_.return=o,_.sibling=C,o.child=_,_=C,C=o.child,b=r.child.memoizedState,b=b===null?L_(d):{baseLanes:b.baseLanes|d,cachePool:null,transitions:b.transitions},C.memoizedState=b,C.childLanes=r.childLanes&~d,o.memoizedState=D_,_}return C=r.child,r=C.sibling,_=na(C,{mode:"visible",children:_.children}),!(o.mode&1)&&(_.lanes=d),_.return=o,_.sibling=null,r!==null&&(d=o.deletions,d===null?(o.deletions=[r],o.flags|=16):d.push(r)),o.child=_,o.memoizedState=null,_}function zy(r,o){return o=Kf({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function Np(r,o,d,_){return _!==null&&_y(_),Qc(o,r.child,null,d),r=zy(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function zC(r,o,d,_,x,C,b){if(d)return o.flags&256?(o.flags&=-257,_=Gg(Error(Qe(422))),Np(r,o,b,_)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):(C=_.fallback,x=o.mode,_=Kf({mode:"visible",children:_.children},x,0,null),C=gl(C,x,b,null),C.flags|=2,_.return=o,C.return=o,_.sibling=C,o.child=_,o.mode&1&&Qc(o,r.child,null,b),o.child.memoizedState=L_(b),o.memoizedState=D_,C);if(!(o.mode&1))return Np(r,o,b,null);if(x.data==="$!"){if(_=x.nextSibling&&x.nextSibling.dataset,_)var c=_.dgst;return _=c,C=Error(Qe(419)),_=Gg(C,_,void 0),Np(r,o,b,_)}if(c=(b&r.childLanes)!==0,Qi||c){if(_=ci,_!==null){switch(b&-b){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=x&(_.suspendedLanes|b)?0:x,x!==0&&x!==C.retryLane&&(C.retryLane=x,no(r,x),ss(_,r,x,-1))}return Fy(),_=Gg(Error(Qe(421))),Np(r,o,b,_)}return x.data==="$?"?(o.flags|=128,o.child=r.child,o=ZC.bind(null,r),x._reactRetry=o,null):(r=C.treeContext,fn=ea(x.nextSibling),mn=o,gr=!0,is=null,r!==null&&(kn[zn++]=Qs,kn[zn++]=Js,kn[zn++]=yl,Qs=r.id,Js=r.overflow,yl=o),o=zy(o,_.children),o.flags|=4096,o)}function L0(r,o,d){r.lanes|=o;var _=r.alternate;_!==null&&(_.lanes|=o),I_(r.return,o,d)}function qg(r,o,d,_,x){var C=r.memoizedState;C===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:_,tail:d,tailMode:x}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=_,C.tail=d,C.tailMode=x)}function Kb(r,o,d){var _=o.pendingProps,x=_.revealOrder,C=_.tail;if(Oi(r,o,_.children,d),_=br.current,_&2)_=_&1|2,o.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&L0(r,d,o);else if(r.tag===19)L0(r,d,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}_&=1}if(lr(br,_),!(o.mode&1))o.memoizedState=null;else switch(x){case"forwards":for(d=o.child,x=null;d!==null;)r=d.alternate,r!==null&&zf(r)===null&&(x=d),d=d.sibling;d=x,d===null?(x=o.child,o.child=null):(x=d.sibling,d.sibling=null),qg(o,!1,x,d,C);break;case"backwards":for(d=null,x=o.child,o.child=null;x!==null;){if(r=x.alternate,r!==null&&zf(r)===null){o.child=x;break}r=x.sibling,x.sibling=d,d=x,x=r}qg(o,!0,d,null,C);break;case"together":qg(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function cf(r,o){!(o.mode&1)&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function so(r,o,d){if(r!==null&&(o.dependencies=r.dependencies),xl|=o.lanes,!(d&o.childLanes))return null;if(r!==null&&o.child!==r.child)throw Error(Qe(153));if(o.child!==null){for(r=o.child,d=na(r,r.pendingProps),o.child=d,d.return=o;r.sibling!==null;)r=r.sibling,d=d.sibling=na(r,r.pendingProps),d.return=o;d.sibling=null}return o.child}function AC(r,o,d){switch(o.tag){case 3:Xb(o),Kc();break;case 5:Tb(o);break;case 1:en(o.type)&&Cf(o);break;case 4:Ty(o,o.stateNode.containerInfo);break;case 10:var _=o.type._context,x=o.memoizedProps.value;lr(If,_._currentValue),_._currentValue=x;break;case 13:if(_=o.memoizedState,_!==null)return _.dehydrated!==null?(lr(br,br.current&1),o.flags|=128,null):d&o.child.childLanes?Yb(r,o,d):(lr(br,br.current&1),r=so(r,o,d),r!==null?r.sibling:null);lr(br,br.current&1);break;case 19:if(_=(d&o.childLanes)!==0,r.flags&128){if(_)return Kb(r,o,d);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),lr(br,br.current),_)break;return null;case 22:case 23:return o.lanes=0,Wb(r,o,d)}return so(r,o,d)}var Qb,j_,Jb,ew;Qb=function(r,o){for(var d=o.child;d!==null;){if(d.tag===5||d.tag===6)r.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return;d=d.return}d.sibling.return=d.return,d=d.sibling}};j_=function(){};Jb=function(r,o,d,_){var x=r.memoizedProps;if(x!==_){r=o.stateNode,pl(Ms.current);var C=null;switch(d){case"input":x=n_(r,x),_=n_(r,_),C=[];break;case"select":x=Sr({},x,{value:void 0}),_=Sr({},_,{value:void 0}),C=[];break;case"textarea":x=a_(r,x),_=a_(r,_),C=[];break;default:typeof x.onClick!="function"&&typeof _.onClick=="function"&&(r.onclick=Tf)}c_(d,_);var b;d=null;for(K in x)if(!_.hasOwnProperty(K)&&x.hasOwnProperty(K)&&x[K]!=null)if(K==="style"){var c=x[K];for(b in c)c.hasOwnProperty(b)&&(d||(d={}),d[b]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(Zh.hasOwnProperty(K)?C||(C=[]):(C=C||[]).push(K,null));for(K in _){var Z=_[K];if(c=x!=null?x[K]:void 0,_.hasOwnProperty(K)&&Z!==c&&(Z!=null||c!=null))if(K==="style")if(c){for(b in c)!c.hasOwnProperty(b)||Z&&Z.hasOwnProperty(b)||(d||(d={}),d[b]="");for(b in Z)Z.hasOwnProperty(b)&&c[b]!==Z[b]&&(d||(d={}),d[b]=Z[b])}else d||(C||(C=[]),C.push(K,d)),d=Z;else K==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,c=c?c.__html:void 0,Z!=null&&c!==Z&&(C=C||[]).push(K,Z)):K==="children"?typeof Z!="string"&&typeof Z!="number"||(C=C||[]).push(K,""+Z):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(Zh.hasOwnProperty(K)?(Z!=null&&K==="onScroll"&&pr("scroll",r),C||c===Z||(C=[])):(C=C||[]).push(K,Z))}d&&(C=C||[]).push("style",d);var K=C;(o.updateQueue=K)&&(o.flags|=4)}};ew=function(r,o,d,_){d!==_&&(o.flags|=4)};function Ch(r,o){if(!gr)switch(r.tailMode){case"hidden":o=r.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var _=null;d!==null;)d.alternate!==null&&(_=d),d=d.sibling;_===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:_.sibling=null}}function Mi(r){var o=r.alternate!==null&&r.alternate.child===r.child,d=0,_=0;if(o)for(var x=r.child;x!==null;)d|=x.lanes|x.childLanes,_|=x.subtreeFlags&14680064,_|=x.flags&14680064,x.return=r,x=x.sibling;else for(x=r.child;x!==null;)d|=x.lanes|x.childLanes,_|=x.subtreeFlags,_|=x.flags,x.return=r,x=x.sibling;return r.subtreeFlags|=_,r.childLanes=d,o}function RC(r,o,d){var _=o.pendingProps;switch(gy(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mi(o),null;case 1:return en(o.type)&&Sf(),Mi(o),null;case 3:return _=o.stateNode,Jc(),fr(Ji),fr(Ei),Cy(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(r===null||r.child===null)&&(Bp(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,is!==null&&(Z_(is),is=null))),j_(r,o),Mi(o),null;case 5:Sy(o);var x=pl(rd.current);if(d=o.type,r!==null&&o.stateNode!=null)Jb(r,o,d,_,x),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!_){if(o.stateNode===null)throw Error(Qe(166));return Mi(o),null}if(r=pl(Ms.current),Bp(o)){_=o.stateNode,d=o.type;var C=o.memoizedProps;switch(_[Cs]=o,_[ed]=C,r=(o.mode&1)!==0,d){case"dialog":pr("cancel",_),pr("close",_);break;case"iframe":case"object":case"embed":pr("load",_);break;case"video":case"audio":for(x=0;x<Rh.length;x++)pr(Rh[x],_);break;case"source":pr("error",_);break;case"img":case"image":case"link":pr("error",_),pr("load",_);break;case"details":pr("toggle",_);break;case"input":Zx(_,C),pr("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!C.multiple},pr("invalid",_);break;case"textarea":qx(_,C),pr("invalid",_)}c_(d,C),x=null;for(var b in C)if(C.hasOwnProperty(b)){var c=C[b];b==="children"?typeof c=="string"?_.textContent!==c&&(C.suppressHydrationWarning!==!0&&Fp(_.textContent,c,r),x=["children",c]):typeof c=="number"&&_.textContent!==""+c&&(C.suppressHydrationWarning!==!0&&Fp(_.textContent,c,r),x=["children",""+c]):Zh.hasOwnProperty(b)&&c!=null&&b==="onScroll"&&pr("scroll",_)}switch(d){case"input":Ep(_),Gx(_,C,!0);break;case"textarea":Ep(_),Wx(_);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(_.onclick=Tf)}_=x,o.updateQueue=_,_!==null&&(o.flags|=4)}else{b=x.nodeType===9?x:x.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=I1(d)),r==="http://www.w3.org/1999/xhtml"?d==="script"?(r=b.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof _.is=="string"?r=b.createElement(d,{is:_.is}):(r=b.createElement(d),d==="select"&&(b=r,_.multiple?b.multiple=!0:_.size&&(b.size=_.size))):r=b.createElementNS(r,d),r[Cs]=o,r[ed]=_,Qb(r,o,!1,!1),o.stateNode=r;e:{switch(b=u_(d,_),d){case"dialog":pr("cancel",r),pr("close",r),x=_;break;case"iframe":case"object":case"embed":pr("load",r),x=_;break;case"video":case"audio":for(x=0;x<Rh.length;x++)pr(Rh[x],r);x=_;break;case"source":pr("error",r),x=_;break;case"img":case"image":case"link":pr("error",r),pr("load",r),x=_;break;case"details":pr("toggle",r),x=_;break;case"input":Zx(r,_),x=n_(r,_),pr("invalid",r);break;case"option":x=_;break;case"select":r._wrapperState={wasMultiple:!!_.multiple},x=Sr({},_,{value:void 0}),pr("invalid",r);break;case"textarea":qx(r,_),x=a_(r,_),pr("invalid",r);break;default:x=_}c_(d,x),c=x;for(C in c)if(c.hasOwnProperty(C)){var Z=c[C];C==="style"?z1(r,Z):C==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,Z!=null&&E1(r,Z)):C==="children"?typeof Z=="string"?(d!=="textarea"||Z!=="")&&Gh(r,Z):typeof Z=="number"&&Gh(r,""+Z):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(Zh.hasOwnProperty(C)?Z!=null&&C==="onScroll"&&pr("scroll",r):Z!=null&&ty(r,C,Z,b))}switch(d){case"input":Ep(r),Gx(r,_,!1);break;case"textarea":Ep(r),Wx(r);break;case"option":_.value!=null&&r.setAttribute("value",""+sa(_.value));break;case"select":r.multiple=!!_.multiple,C=_.value,C!=null?Uc(r,!!_.multiple,C,!1):_.defaultValue!=null&&Uc(r,!!_.multiple,_.defaultValue,!0);break;default:typeof x.onClick=="function"&&(r.onclick=Tf)}switch(d){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Mi(o),null;case 6:if(r&&o.stateNode!=null)ew(r,o,r.memoizedProps,_);else{if(typeof _!="string"&&o.stateNode===null)throw Error(Qe(166));if(d=pl(rd.current),pl(Ms.current),Bp(o)){if(_=o.stateNode,d=o.memoizedProps,_[Cs]=o,(C=_.nodeValue!==d)&&(r=mn,r!==null))switch(r.tag){case 3:Fp(_.nodeValue,d,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Fp(_.nodeValue,d,(r.mode&1)!==0)}C&&(o.flags|=4)}else _=(d.nodeType===9?d:d.ownerDocument).createTextNode(_),_[Cs]=o,o.stateNode=_}return Mi(o),null;case 13:if(fr(br),_=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(gr&&fn!==null&&o.mode&1&&!(o.flags&128))yb(),Kc(),o.flags|=98560,C=!1;else if(C=Bp(o),_!==null&&_.dehydrated!==null){if(r===null){if(!C)throw Error(Qe(318));if(C=o.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(Qe(317));C[Cs]=o}else Kc(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Mi(o),C=!1}else is!==null&&(Z_(is),is=null),C=!0;if(!C)return o.flags&65536?o:null}return o.flags&128?(o.lanes=d,o):(_=_!==null,_!==(r!==null&&r.memoizedState!==null)&&_&&(o.child.flags|=8192,o.mode&1&&(r===null||br.current&1?ri===0&&(ri=3):Fy())),o.updateQueue!==null&&(o.flags|=4),Mi(o),null);case 4:return Jc(),j_(r,o),r===null&&Qh(o.stateNode.containerInfo),Mi(o),null;case 10:return xy(o.type._context),Mi(o),null;case 17:return en(o.type)&&Sf(),Mi(o),null;case 19:if(fr(br),C=o.memoizedState,C===null)return Mi(o),null;if(_=(o.flags&128)!==0,b=C.rendering,b===null)if(_)Ch(C,!1);else{if(ri!==0||r!==null&&r.flags&128)for(r=o.child;r!==null;){if(b=zf(r),b!==null){for(o.flags|=128,Ch(C,!1),_=b.updateQueue,_!==null&&(o.updateQueue=_,o.flags|=4),o.subtreeFlags=0,_=d,d=o.child;d!==null;)C=d,r=_,C.flags&=14680066,b=C.alternate,b===null?(C.childLanes=0,C.lanes=r,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=b.childLanes,C.lanes=b.lanes,C.child=b.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=b.memoizedProps,C.memoizedState=b.memoizedState,C.updateQueue=b.updateQueue,C.type=b.type,r=b.dependencies,C.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),d=d.sibling;return lr(br,br.current&1|2),o.child}r=r.sibling}C.tail!==null&&Dr()>tu&&(o.flags|=128,_=!0,Ch(C,!1),o.lanes=4194304)}else{if(!_)if(r=zf(b),r!==null){if(o.flags|=128,_=!0,d=r.updateQueue,d!==null&&(o.updateQueue=d,o.flags|=4),Ch(C,!0),C.tail===null&&C.tailMode==="hidden"&&!b.alternate&&!gr)return Mi(o),null}else 2*Dr()-C.renderingStartTime>tu&&d!==1073741824&&(o.flags|=128,_=!0,Ch(C,!1),o.lanes=4194304);C.isBackwards?(b.sibling=o.child,o.child=b):(d=C.last,d!==null?d.sibling=b:o.child=b,C.last=b)}return C.tail!==null?(o=C.tail,C.rendering=o,C.tail=o.sibling,C.renderingStartTime=Dr(),o.sibling=null,d=br.current,lr(br,_?d&1|2:d&1),o):(Mi(o),null);case 22:case 23:return jy(),_=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==_&&(o.flags|=8192),_&&o.mode&1?pn&1073741824&&(Mi(o),o.subtreeFlags&6&&(o.flags|=8192)):Mi(o),null;case 24:return null;case 25:return null}throw Error(Qe(156,o.tag))}function DC(r,o){switch(gy(o),o.tag){case 1:return en(o.type)&&Sf(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Jc(),fr(Ji),fr(Ei),Cy(),r=o.flags,r&65536&&!(r&128)?(o.flags=r&-65537|128,o):null;case 5:return Sy(o),null;case 13:if(fr(br),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(Qe(340));Kc()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return fr(br),null;case 4:return Jc(),null;case 10:return xy(o.type._context),null;case 22:case 23:return jy(),null;case 24:return null;default:return null}}var $p=!1,Ii=!1,LC=typeof WeakSet=="function"?WeakSet:Set,at=null;function Nc(r,o){var d=r.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(_){Ir(r,o,_)}else d.current=null}function F_(r,o,d){try{d()}catch(_){Ir(r,o,_)}}var j0=!1;function jC(r,o){if(x_=xf,r=sb(),fy(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var _=d.getSelection&&d.getSelection();if(_&&_.rangeCount!==0){d=_.anchorNode;var x=_.anchorOffset,C=_.focusNode;_=_.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var b=0,c=-1,Z=-1,K=0,ge=0,be=r,O=null;t:for(;;){for(var H;be!==d||x!==0&&be.nodeType!==3||(c=b+x),be!==C||_!==0&&be.nodeType!==3||(Z=b+_),be.nodeType===3&&(b+=be.nodeValue.length),(H=be.firstChild)!==null;)O=be,be=H;for(;;){if(be===r)break t;if(O===d&&++K===x&&(c=b),O===C&&++ge===_&&(Z=b),(H=be.nextSibling)!==null)break;be=O,O=be.parentNode}be=H}d=c===-1||Z===-1?null:{start:c,end:Z}}else d=null}d=d||{start:0,end:0}}else d=null;for(b_={focusedElem:r,selectionRange:d},xf=!1,at=o;at!==null;)if(o=at,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,at=r;else for(;at!==null;){o=at;try{var ue=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ue!==null){var Pe=ue.memoizedProps,pe=ue.memoizedState,E=o.stateNode,R=E.getSnapshotBeforeUpdate(o.elementType===o.type?Pe:Jn(o.type,Pe),pe);E.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var N=o.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qe(163))}}catch(re){Ir(o,o.return,re)}if(r=o.sibling,r!==null){r.return=o.return,at=r;break}at=o.return}return ue=j0,j0=!1,ue}function Nh(r,o,d){var _=o.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var x=_=_.next;do{if((x.tag&r)===r){var C=x.destroy;x.destroy=void 0,C!==void 0&&F_(o,d,C)}x=x.next}while(x!==_)}}function Xf(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var d=o=o.next;do{if((d.tag&r)===r){var _=d.create;d.destroy=_()}d=d.next}while(d!==o)}}function B_(r){var o=r.ref;if(o!==null){var d=r.stateNode;switch(r.tag){case 5:r=d;break;default:r=d}typeof o=="function"?o(r):o.current=r}}function tw(r){var o=r.alternate;o!==null&&(r.alternate=null,tw(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[Cs],delete o[ed],delete o[S_],delete o[yC],delete o[vC])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function rw(r){return r.tag===5||r.tag===3||r.tag===4}function F0(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||rw(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function O_(r,o,d){var _=r.tag;if(_===5||_===6)r=r.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(r,o):d.insertBefore(r,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(r,d)):(o=d,o.appendChild(r)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=Tf));else if(_!==4&&(r=r.child,r!==null))for(O_(r,o,d),r=r.sibling;r!==null;)O_(r,o,d),r=r.sibling}function N_(r,o,d){var _=r.tag;if(_===5||_===6)r=r.stateNode,o?d.insertBefore(r,o):d.appendChild(r);else if(_!==4&&(r=r.child,r!==null))for(N_(r,o,d),r=r.sibling;r!==null;)N_(r,o,d),r=r.sibling}var _i=null,ts=!1;function Zo(r,o,d){for(d=d.child;d!==null;)iw(r,o,d),d=d.sibling}function iw(r,o,d){if(Ps&&typeof Ps.onCommitFiberUnmount=="function")try{Ps.onCommitFiberUnmount($f,d)}catch{}switch(d.tag){case 5:Ii||Nc(d,o);case 6:var _=_i,x=ts;_i=null,Zo(r,o,d),_i=_,ts=x,_i!==null&&(ts?(r=_i,d=d.stateNode,r.nodeType===8?r.parentNode.removeChild(d):r.removeChild(d)):_i.removeChild(d.stateNode));break;case 18:_i!==null&&(ts?(r=_i,d=d.stateNode,r.nodeType===8?Og(r.parentNode,d):r.nodeType===1&&Og(r,d),Xh(r)):Og(_i,d.stateNode));break;case 4:_=_i,x=ts,_i=d.stateNode.containerInfo,ts=!0,Zo(r,o,d),_i=_,ts=x;break;case 0:case 11:case 14:case 15:if(!Ii&&(_=d.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){x=_=_.next;do{var C=x,b=C.destroy;C=C.tag,b!==void 0&&(C&2||C&4)&&F_(d,o,b),x=x.next}while(x!==_)}Zo(r,o,d);break;case 1:if(!Ii&&(Nc(d,o),_=d.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=d.memoizedProps,_.state=d.memoizedState,_.componentWillUnmount()}catch(c){Ir(d,o,c)}Zo(r,o,d);break;case 21:Zo(r,o,d);break;case 22:d.mode&1?(Ii=(_=Ii)||d.memoizedState!==null,Zo(r,o,d),Ii=_):Zo(r,o,d);break;default:Zo(r,o,d)}}function B0(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var d=r.stateNode;d===null&&(d=r.stateNode=new LC),o.forEach(function(_){var x=GC.bind(null,r,_);d.has(_)||(d.add(_),_.then(x,x))})}}function Kn(r,o){var d=o.deletions;if(d!==null)for(var _=0;_<d.length;_++){var x=d[_];try{var C=r,b=o,c=b;e:for(;c!==null;){switch(c.tag){case 5:_i=c.stateNode,ts=!1;break e;case 3:_i=c.stateNode.containerInfo,ts=!0;break e;case 4:_i=c.stateNode.containerInfo,ts=!0;break e}c=c.return}if(_i===null)throw Error(Qe(160));iw(C,b,x),_i=null,ts=!1;var Z=x.alternate;Z!==null&&(Z.return=null),x.return=null}catch(K){Ir(x,o,K)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)nw(o,r),o=o.sibling}function nw(r,o){var d=r.alternate,_=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Kn(o,r),ws(r),_&4){try{Nh(3,r,r.return),Xf(3,r)}catch(Pe){Ir(r,r.return,Pe)}try{Nh(5,r,r.return)}catch(Pe){Ir(r,r.return,Pe)}}break;case 1:Kn(o,r),ws(r),_&512&&d!==null&&Nc(d,d.return);break;case 5:if(Kn(o,r),ws(r),_&512&&d!==null&&Nc(d,d.return),r.flags&32){var x=r.stateNode;try{Gh(x,"")}catch(Pe){Ir(r,r.return,Pe)}}if(_&4&&(x=r.stateNode,x!=null)){var C=r.memoizedProps,b=d!==null?d.memoizedProps:C,c=r.type,Z=r.updateQueue;if(r.updateQueue=null,Z!==null)try{c==="input"&&C.type==="radio"&&C.name!=null&&P1(x,C),u_(c,b);var K=u_(c,C);for(b=0;b<Z.length;b+=2){var ge=Z[b],be=Z[b+1];ge==="style"?z1(x,be):ge==="dangerouslySetInnerHTML"?E1(x,be):ge==="children"?Gh(x,be):ty(x,ge,be,K)}switch(c){case"input":s_(x,C);break;case"textarea":M1(x,C);break;case"select":var O=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!C.multiple;var H=C.value;H!=null?Uc(x,!!C.multiple,H,!1):O!==!!C.multiple&&(C.defaultValue!=null?Uc(x,!!C.multiple,C.defaultValue,!0):Uc(x,!!C.multiple,C.multiple?[]:"",!1))}x[ed]=C}catch(Pe){Ir(r,r.return,Pe)}}break;case 6:if(Kn(o,r),ws(r),_&4){if(r.stateNode===null)throw Error(Qe(162));x=r.stateNode,C=r.memoizedProps;try{x.nodeValue=C}catch(Pe){Ir(r,r.return,Pe)}}break;case 3:if(Kn(o,r),ws(r),_&4&&d!==null&&d.memoizedState.isDehydrated)try{Xh(o.containerInfo)}catch(Pe){Ir(r,r.return,Pe)}break;case 4:Kn(o,r),ws(r);break;case 13:Kn(o,r),ws(r),x=r.child,x.flags&8192&&(C=x.memoizedState!==null,x.stateNode.isHidden=C,!C||x.alternate!==null&&x.alternate.memoizedState!==null||(Dy=Dr())),_&4&&B0(r);break;case 22:if(ge=d!==null&&d.memoizedState!==null,r.mode&1?(Ii=(K=Ii)||ge,Kn(o,r),Ii=K):Kn(o,r),ws(r),_&8192){if(K=r.memoizedState!==null,(r.stateNode.isHidden=K)&&!ge&&r.mode&1)for(at=r,ge=r.child;ge!==null;){for(be=at=ge;at!==null;){switch(O=at,H=O.child,O.tag){case 0:case 11:case 14:case 15:Nh(4,O,O.return);break;case 1:Nc(O,O.return);var ue=O.stateNode;if(typeof ue.componentWillUnmount=="function"){_=O,d=O.return;try{o=_,ue.props=o.memoizedProps,ue.state=o.memoizedState,ue.componentWillUnmount()}catch(Pe){Ir(_,d,Pe)}}break;case 5:Nc(O,O.return);break;case 22:if(O.memoizedState!==null){N0(be);continue}}H!==null?(H.return=O,at=H):N0(be)}ge=ge.sibling}e:for(ge=null,be=r;;){if(be.tag===5){if(ge===null){ge=be;try{x=be.stateNode,K?(C=x.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(c=be.stateNode,Z=be.memoizedProps.style,b=Z!=null&&Z.hasOwnProperty("display")?Z.display:null,c.style.display=k1("display",b))}catch(Pe){Ir(r,r.return,Pe)}}}else if(be.tag===6){if(ge===null)try{be.stateNode.nodeValue=K?"":be.memoizedProps}catch(Pe){Ir(r,r.return,Pe)}}else if((be.tag!==22&&be.tag!==23||be.memoizedState===null||be===r)&&be.child!==null){be.child.return=be,be=be.child;continue}if(be===r)break e;for(;be.sibling===null;){if(be.return===null||be.return===r)break e;ge===be&&(ge=null),be=be.return}ge===be&&(ge=null),be.sibling.return=be.return,be=be.sibling}}break;case 19:Kn(o,r),ws(r),_&4&&B0(r);break;case 21:break;default:Kn(o,r),ws(r)}}function ws(r){var o=r.flags;if(o&2){try{e:{for(var d=r.return;d!==null;){if(rw(d)){var _=d;break e}d=d.return}throw Error(Qe(160))}switch(_.tag){case 5:var x=_.stateNode;_.flags&32&&(Gh(x,""),_.flags&=-33);var C=F0(r);N_(r,C,x);break;case 3:case 4:var b=_.stateNode.containerInfo,c=F0(r);O_(r,c,b);break;default:throw Error(Qe(161))}}catch(Z){Ir(r,r.return,Z)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function FC(r,o,d){at=r,sw(r)}function sw(r,o,d){for(var _=(r.mode&1)!==0;at!==null;){var x=at,C=x.child;if(x.tag===22&&_){var b=x.memoizedState!==null||$p;if(!b){var c=x.alternate,Z=c!==null&&c.memoizedState!==null||Ii;c=$p;var K=Ii;if($p=b,(Ii=Z)&&!K)for(at=x;at!==null;)b=at,Z=b.child,b.tag===22&&b.memoizedState!==null?$0(x):Z!==null?(Z.return=b,at=Z):$0(x);for(;C!==null;)at=C,sw(C),C=C.sibling;at=x,$p=c,Ii=K}O0(r)}else x.subtreeFlags&8772&&C!==null?(C.return=x,at=C):O0(r)}}function O0(r){for(;at!==null;){var o=at;if(o.flags&8772){var d=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Ii||Xf(5,o);break;case 1:var _=o.stateNode;if(o.flags&4&&!Ii)if(d===null)_.componentDidMount();else{var x=o.elementType===o.type?d.memoizedProps:Jn(o.type,d.memoizedProps);_.componentDidUpdate(x,d.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var C=o.updateQueue;C!==null&&T0(o,C,_);break;case 3:var b=o.updateQueue;if(b!==null){if(d=null,o.child!==null)switch(o.child.tag){case 5:d=o.child.stateNode;break;case 1:d=o.child.stateNode}T0(o,b,d)}break;case 5:var c=o.stateNode;if(d===null&&o.flags&4){d=c;var Z=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":Z.autoFocus&&d.focus();break;case"img":Z.src&&(d.src=Z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var K=o.alternate;if(K!==null){var ge=K.memoizedState;if(ge!==null){var be=ge.dehydrated;be!==null&&Xh(be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qe(163))}Ii||o.flags&512&&B_(o)}catch(O){Ir(o,o.return,O)}}if(o===r){at=null;break}if(d=o.sibling,d!==null){d.return=o.return,at=d;break}at=o.return}}function N0(r){for(;at!==null;){var o=at;if(o===r){at=null;break}var d=o.sibling;if(d!==null){d.return=o.return,at=d;break}at=o.return}}function $0(r){for(;at!==null;){var o=at;try{switch(o.tag){case 0:case 11:case 15:var d=o.return;try{Xf(4,o)}catch(Z){Ir(o,d,Z)}break;case 1:var _=o.stateNode;if(typeof _.componentDidMount=="function"){var x=o.return;try{_.componentDidMount()}catch(Z){Ir(o,x,Z)}}var C=o.return;try{B_(o)}catch(Z){Ir(o,C,Z)}break;case 5:var b=o.return;try{B_(o)}catch(Z){Ir(o,b,Z)}}}catch(Z){Ir(o,o.return,Z)}if(o===r){at=null;break}var c=o.sibling;if(c!==null){c.return=o.return,at=c;break}at=o.return}}var BC=Math.ceil,Df=lo.ReactCurrentDispatcher,Ay=lo.ReactCurrentOwner,Rn=lo.ReactCurrentBatchConfig,Zt=0,ci=null,Gr=null,yi=0,pn=0,$c=la(0),ri=0,od=null,xl=0,Yf=0,Ry=0,$h=null,Ki=null,Dy=0,tu=1/0,Ys=null,Lf=!1,$_=null,ra=null,Vp=!1,Yo=null,jf=0,Vh=0,V_=null,uf=-1,hf=0;function Ni(){return Zt&6?Dr():uf!==-1?uf:uf=Dr()}function ia(r){return r.mode&1?Zt&2&&yi!==0?yi&-yi:bC.transition!==null?(hf===0&&(hf=U1()),hf):(r=Kt,r!==0||(r=window.event,r=r===void 0?16:Y1(r.type)),r):1}function ss(r,o,d,_){if(50<Vh)throw Vh=0,V_=null,Error(Qe(185));cd(r,d,_),(!(Zt&2)||r!==ci)&&(r===ci&&(!(Zt&2)&&(Yf|=d),ri===4&&Ho(r,yi)),tn(r,_),d===1&&Zt===0&&!(o.mode&1)&&(tu=Dr()+500,qf&&ca()))}function tn(r,o){var d=r.callbackNode;bS(r,o);var _=vf(r,r===ci?yi:0);if(_===0)d!==null&&Yx(d),r.callbackNode=null,r.callbackPriority=0;else if(o=_&-_,r.callbackPriority!==o){if(d!=null&&Yx(d),o===1)r.tag===0?xC(V0.bind(null,r)):mb(V0.bind(null,r)),gC(function(){!(Zt&6)&&ca()}),d=null;else{switch(Z1(_)){case 1:d=oy;break;case 4:d=$1;break;case 16:d=yf;break;case 536870912:d=V1;break;default:d=yf}d=pw(d,ow.bind(null,r))}r.callbackPriority=o,r.callbackNode=d}}function ow(r,o){if(uf=-1,hf=0,Zt&6)throw Error(Qe(327));var d=r.callbackNode;if(Hc()&&r.callbackNode!==d)return null;var _=vf(r,r===ci?yi:0);if(_===0)return null;if(_&30||_&r.expiredLanes||o)o=Ff(r,_);else{o=_;var x=Zt;Zt|=2;var C=lw();(ci!==r||yi!==o)&&(Ys=null,tu=Dr()+500,ml(r,o));do try{$C();break}catch(c){aw(r,c)}while(!0);vy(),Df.current=C,Zt=x,Gr!==null?o=0:(ci=null,yi=0,o=ri)}if(o!==0){if(o===2&&(x=m_(r),x!==0&&(_=x,o=U_(r,x))),o===1)throw d=od,ml(r,0),Ho(r,_),tn(r,Dr()),d;if(o===6)Ho(r,_);else{if(x=r.current.alternate,!(_&30)&&!OC(x)&&(o=Ff(r,_),o===2&&(C=m_(r),C!==0&&(_=C,o=U_(r,C))),o===1))throw d=od,ml(r,0),Ho(r,_),tn(r,Dr()),d;switch(r.finishedWork=x,r.finishedLanes=_,o){case 0:case 1:throw Error(Qe(345));case 2:al(r,Ki,Ys);break;case 3:if(Ho(r,_),(_&130023424)===_&&(o=Dy+500-Dr(),10<o)){if(vf(r,0)!==0)break;if(x=r.suspendedLanes,(x&_)!==_){Ni(),r.pingedLanes|=r.suspendedLanes&x;break}r.timeoutHandle=T_(al.bind(null,r,Ki,Ys),o);break}al(r,Ki,Ys);break;case 4:if(Ho(r,_),(_&4194240)===_)break;for(o=r.eventTimes,x=-1;0<_;){var b=31-ns(_);C=1<<b,b=o[b],b>x&&(x=b),_&=~C}if(_=x,_=Dr()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*BC(_/1960))-_,10<_){r.timeoutHandle=T_(al.bind(null,r,Ki,Ys),_);break}al(r,Ki,Ys);break;case 5:al(r,Ki,Ys);break;default:throw Error(Qe(329))}}}return tn(r,Dr()),r.callbackNode===d?ow.bind(null,r):null}function U_(r,o){var d=$h;return r.current.memoizedState.isDehydrated&&(ml(r,o).flags|=256),r=Ff(r,o),r!==2&&(o=Ki,Ki=d,o!==null&&Z_(o)),r}function Z_(r){Ki===null?Ki=r:Ki.push.apply(Ki,r)}function OC(r){for(var o=r;;){if(o.flags&16384){var d=o.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var _=0;_<d.length;_++){var x=d[_],C=x.getSnapshot;x=x.value;try{if(!os(C(),x))return!1}catch{return!1}}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ho(r,o){for(o&=~Ry,o&=~Yf,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var d=31-ns(o),_=1<<d;r[d]=-1,o&=~_}}function V0(r){if(Zt&6)throw Error(Qe(327));Hc();var o=vf(r,0);if(!(o&1))return tn(r,Dr()),null;var d=Ff(r,o);if(r.tag!==0&&d===2){var _=m_(r);_!==0&&(o=_,d=U_(r,_))}if(d===1)throw d=od,ml(r,0),Ho(r,o),tn(r,Dr()),d;if(d===6)throw Error(Qe(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,al(r,Ki,Ys),tn(r,Dr()),null}function Ly(r,o){var d=Zt;Zt|=1;try{return r(o)}finally{Zt=d,Zt===0&&(tu=Dr()+500,qf&&ca())}}function bl(r){Yo!==null&&Yo.tag===0&&!(Zt&6)&&Hc();var o=Zt;Zt|=1;var d=Rn.transition,_=Kt;try{if(Rn.transition=null,Kt=1,r)return r()}finally{Kt=_,Rn.transition=d,Zt=o,!(Zt&6)&&ca()}}function jy(){pn=$c.current,fr($c)}function ml(r,o){r.finishedWork=null,r.finishedLanes=0;var d=r.timeoutHandle;if(d!==-1&&(r.timeoutHandle=-1,mC(d)),Gr!==null)for(d=Gr.return;d!==null;){var _=d;switch(gy(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Sf();break;case 3:Jc(),fr(Ji),fr(Ei),Cy();break;case 5:Sy(_);break;case 4:Jc();break;case 13:fr(br);break;case 19:fr(br);break;case 10:xy(_.type._context);break;case 22:case 23:jy()}d=d.return}if(ci=r,Gr=r=na(r.current,null),yi=pn=o,ri=0,od=null,Ry=Yf=xl=0,Ki=$h=null,dl!==null){for(o=0;o<dl.length;o++)if(d=dl[o],_=d.interleaved,_!==null){d.interleaved=null;var x=_.next,C=d.pending;if(C!==null){var b=C.next;C.next=x,_.next=b}d.pending=_}dl=null}return r}function aw(r,o){do{var d=Gr;try{if(vy(),af.current=Rf,Af){for(var _=wr.memoizedState;_!==null;){var x=_.queue;x!==null&&(x.pending=null),_=_.next}Af=!1}if(vl=0,li=ti=wr=null,Oh=!1,id=0,Ay.current=null,d===null||d.return===null){ri=1,od=o,Gr=null;break}e:{var C=r,b=d.return,c=d,Z=o;if(o=yi,c.flags|=32768,Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var K=Z,ge=c,be=ge.tag;if(!(ge.mode&1)&&(be===0||be===11||be===15)){var O=ge.alternate;O?(ge.updateQueue=O.updateQueue,ge.memoizedState=O.memoizedState,ge.lanes=O.lanes):(ge.updateQueue=null,ge.memoizedState=null)}var H=E0(b);if(H!==null){H.flags&=-257,k0(H,b,c,C,o),H.mode&1&&I0(C,K,o),o=H,Z=K;var ue=o.updateQueue;if(ue===null){var Pe=new Set;Pe.add(Z),o.updateQueue=Pe}else ue.add(Z);break e}else{if(!(o&1)){I0(C,K,o),Fy();break e}Z=Error(Qe(426))}}else if(gr&&c.mode&1){var pe=E0(b);if(pe!==null){!(pe.flags&65536)&&(pe.flags|=256),k0(pe,b,c,C,o),_y(eu(Z,c));break e}}C=Z=eu(Z,c),ri!==4&&(ri=2),$h===null?$h=[C]:$h.push(C),C=b;do{switch(C.tag){case 3:C.flags|=65536,o&=-o,C.lanes|=o;var E=Zb(C,Z,o);w0(C,E);break e;case 1:c=Z;var R=C.type,N=C.stateNode;if(!(C.flags&128)&&(typeof R.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(ra===null||!ra.has(N)))){C.flags|=65536,o&=-o,C.lanes|=o;var re=Gb(C,c,o);w0(C,re);break e}}C=C.return}while(C!==null)}uw(d)}catch(Te){o=Te,Gr===d&&d!==null&&(Gr=d=d.return);continue}break}while(!0)}function lw(){var r=Df.current;return Df.current=Rf,r===null?Rf:r}function Fy(){(ri===0||ri===3||ri===2)&&(ri=4),ci===null||!(xl&268435455)&&!(Yf&268435455)||Ho(ci,yi)}function Ff(r,o){var d=Zt;Zt|=2;var _=lw();(ci!==r||yi!==o)&&(Ys=null,ml(r,o));do try{NC();break}catch(x){aw(r,x)}while(!0);if(vy(),Zt=d,Df.current=_,Gr!==null)throw Error(Qe(261));return ci=null,yi=0,ri}function NC(){for(;Gr!==null;)cw(Gr)}function $C(){for(;Gr!==null&&!dS();)cw(Gr)}function cw(r){var o=dw(r.alternate,r,pn);r.memoizedProps=r.pendingProps,o===null?uw(r):Gr=o,Ay.current=null}function uw(r){var o=r;do{var d=o.alternate;if(r=o.return,o.flags&32768){if(d=DC(d,o),d!==null){d.flags&=32767,Gr=d;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{ri=6,Gr=null;return}}else if(d=RC(d,o,pn),d!==null){Gr=d;return}if(o=o.sibling,o!==null){Gr=o;return}Gr=o=r}while(o!==null);ri===0&&(ri=5)}function al(r,o,d){var _=Kt,x=Rn.transition;try{Rn.transition=null,Kt=1,VC(r,o,d,_)}finally{Rn.transition=x,Kt=_}return null}function VC(r,o,d,_){do Hc();while(Yo!==null);if(Zt&6)throw Error(Qe(327));d=r.finishedWork;var x=r.finishedLanes;if(d===null)return null;if(r.finishedWork=null,r.finishedLanes=0,d===r.current)throw Error(Qe(177));r.callbackNode=null,r.callbackPriority=0;var C=d.lanes|d.childLanes;if(wS(r,C),r===ci&&(Gr=ci=null,yi=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||Vp||(Vp=!0,pw(yf,function(){return Hc(),null})),C=(d.flags&15990)!==0,d.subtreeFlags&15990||C){C=Rn.transition,Rn.transition=null;var b=Kt;Kt=1;var c=Zt;Zt|=4,Ay.current=null,jC(r,d),nw(d,r),lC(b_),xf=!!x_,b_=x_=null,r.current=d,FC(d),pS(),Zt=c,Kt=b,Rn.transition=C}else r.current=d;if(Vp&&(Vp=!1,Yo=r,jf=x),C=r.pendingLanes,C===0&&(ra=null),gS(d.stateNode),tn(r,Dr()),o!==null)for(_=r.onRecoverableError,d=0;d<o.length;d++)x=o[d],_(x.value,{componentStack:x.stack,digest:x.digest});if(Lf)throw Lf=!1,r=$_,$_=null,r;return jf&1&&r.tag!==0&&Hc(),C=r.pendingLanes,C&1?r===V_?Vh++:(Vh=0,V_=r):Vh=0,ca(),null}function Hc(){if(Yo!==null){var r=Z1(jf),o=Rn.transition,d=Kt;try{if(Rn.transition=null,Kt=16>r?16:r,Yo===null)var _=!1;else{if(r=Yo,Yo=null,jf=0,Zt&6)throw Error(Qe(331));var x=Zt;for(Zt|=4,at=r.current;at!==null;){var C=at,b=C.child;if(at.flags&16){var c=C.deletions;if(c!==null){for(var Z=0;Z<c.length;Z++){var K=c[Z];for(at=K;at!==null;){var ge=at;switch(ge.tag){case 0:case 11:case 15:Nh(8,ge,C)}var be=ge.child;if(be!==null)be.return=ge,at=be;else for(;at!==null;){ge=at;var O=ge.sibling,H=ge.return;if(tw(ge),ge===K){at=null;break}if(O!==null){O.return=H,at=O;break}at=H}}}var ue=C.alternate;if(ue!==null){var Pe=ue.child;if(Pe!==null){ue.child=null;do{var pe=Pe.sibling;Pe.sibling=null,Pe=pe}while(Pe!==null)}}at=C}}if(C.subtreeFlags&2064&&b!==null)b.return=C,at=b;else e:for(;at!==null;){if(C=at,C.flags&2048)switch(C.tag){case 0:case 11:case 15:Nh(9,C,C.return)}var E=C.sibling;if(E!==null){E.return=C.return,at=E;break e}at=C.return}}var R=r.current;for(at=R;at!==null;){b=at;var N=b.child;if(b.subtreeFlags&2064&&N!==null)N.return=b,at=N;else e:for(b=R;at!==null;){if(c=at,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Xf(9,c)}}catch(Te){Ir(c,c.return,Te)}if(c===b){at=null;break e}var re=c.sibling;if(re!==null){re.return=c.return,at=re;break e}at=c.return}}if(Zt=x,ca(),Ps&&typeof Ps.onPostCommitFiberRoot=="function")try{Ps.onPostCommitFiberRoot($f,r)}catch{}_=!0}return _}finally{Kt=d,Rn.transition=o}}return!1}function U0(r,o,d){o=eu(d,o),o=Zb(r,o,1),r=ta(r,o,1),o=Ni(),r!==null&&(cd(r,1,o),tn(r,o))}function Ir(r,o,d){if(r.tag===3)U0(r,r,d);else for(;o!==null;){if(o.tag===3){U0(o,r,d);break}else if(o.tag===1){var _=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(ra===null||!ra.has(_))){r=eu(d,r),r=Gb(o,r,1),o=ta(o,r,1),r=Ni(),o!==null&&(cd(o,1,r),tn(o,r));break}}o=o.return}}function UC(r,o,d){var _=r.pingCache;_!==null&&_.delete(o),o=Ni(),r.pingedLanes|=r.suspendedLanes&d,ci===r&&(yi&d)===d&&(ri===4||ri===3&&(yi&130023424)===yi&&500>Dr()-Dy?ml(r,0):Ry|=d),tn(r,o)}function hw(r,o){o===0&&(r.mode&1?(o=Ap,Ap<<=1,!(Ap&130023424)&&(Ap=4194304)):o=1);var d=Ni();r=no(r,o),r!==null&&(cd(r,o,d),tn(r,d))}function ZC(r){var o=r.memoizedState,d=0;o!==null&&(d=o.retryLane),hw(r,d)}function GC(r,o){var d=0;switch(r.tag){case 13:var _=r.stateNode,x=r.memoizedState;x!==null&&(d=x.retryLane);break;case 19:_=r.stateNode;break;default:throw Error(Qe(314))}_!==null&&_.delete(o),hw(r,d)}var dw;dw=function(r,o,d){if(r!==null)if(r.memoizedProps!==o.pendingProps||Ji.current)Qi=!0;else{if(!(r.lanes&d)&&!(o.flags&128))return Qi=!1,AC(r,o,d);Qi=!!(r.flags&131072)}else Qi=!1,gr&&o.flags&1048576&&gb(o,Mf,o.index);switch(o.lanes=0,o.tag){case 2:var _=o.type;cf(r,o),r=o.pendingProps;var x=Yc(o,Ei.current);Wc(o,d),x=My(null,o,_,r,x,d);var C=Iy();return o.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,en(_)?(C=!0,Cf(o)):C=!1,o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,wy(o),x.updater=Hf,o.stateNode=x,x._reactInternals=o,k_(o,_,r,d),o=R_(null,o,_,!0,C,d)):(o.tag=0,gr&&C&&my(o),Oi(null,o,x,d),o=o.child),o;case 16:_=o.elementType;e:{switch(cf(r,o),r=o.pendingProps,x=_._init,_=x(_._payload),o.type=_,x=o.tag=WC(_),r=Jn(_,r),x){case 0:o=A_(null,o,_,r,d);break e;case 1:o=R0(null,o,_,r,d);break e;case 11:o=z0(null,o,_,r,d);break e;case 14:o=A0(null,o,_,Jn(_.type,r),d);break e}throw Error(Qe(306,_,""))}return o;case 0:return _=o.type,x=o.pendingProps,x=o.elementType===_?x:Jn(_,x),A_(r,o,_,x,d);case 1:return _=o.type,x=o.pendingProps,x=o.elementType===_?x:Jn(_,x),R0(r,o,_,x,d);case 3:e:{if(Xb(o),r===null)throw Error(Qe(387));_=o.pendingProps,C=o.memoizedState,x=C.element,wb(r,o),kf(o,_,null,d);var b=o.memoizedState;if(_=b.element,C.isDehydrated)if(C={element:_,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){x=eu(Error(Qe(423)),o),o=D0(r,o,_,d,x);break e}else if(_!==x){x=eu(Error(Qe(424)),o),o=D0(r,o,_,d,x);break e}else for(fn=ea(o.stateNode.containerInfo.firstChild),mn=o,gr=!0,is=null,d=xb(o,null,_,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Kc(),_===x){o=so(r,o,d);break e}Oi(r,o,_,d)}o=o.child}return o;case 5:return Tb(o),r===null&&M_(o),_=o.type,x=o.pendingProps,C=r!==null?r.memoizedProps:null,b=x.children,w_(_,x)?b=null:C!==null&&w_(_,C)&&(o.flags|=32),Hb(r,o),Oi(r,o,b,d),o.child;case 6:return r===null&&M_(o),null;case 13:return Yb(r,o,d);case 4:return Ty(o,o.stateNode.containerInfo),_=o.pendingProps,r===null?o.child=Qc(o,null,_,d):Oi(r,o,_,d),o.child;case 11:return _=o.type,x=o.pendingProps,x=o.elementType===_?x:Jn(_,x),z0(r,o,_,x,d);case 7:return Oi(r,o,o.pendingProps,d),o.child;case 8:return Oi(r,o,o.pendingProps.children,d),o.child;case 12:return Oi(r,o,o.pendingProps.children,d),o.child;case 10:e:{if(_=o.type._context,x=o.pendingProps,C=o.memoizedProps,b=x.value,lr(If,_._currentValue),_._currentValue=b,C!==null)if(os(C.value,b)){if(C.children===x.children&&!Ji.current){o=so(r,o,d);break e}}else for(C=o.child,C!==null&&(C.return=o);C!==null;){var c=C.dependencies;if(c!==null){b=C.child;for(var Z=c.firstContext;Z!==null;){if(Z.context===_){if(C.tag===1){Z=eo(-1,d&-d),Z.tag=2;var K=C.updateQueue;if(K!==null){K=K.shared;var ge=K.pending;ge===null?Z.next=Z:(Z.next=ge.next,ge.next=Z),K.pending=Z}}C.lanes|=d,Z=C.alternate,Z!==null&&(Z.lanes|=d),I_(C.return,d,o),c.lanes|=d;break}Z=Z.next}}else if(C.tag===10)b=C.type===o.type?null:C.child;else if(C.tag===18){if(b=C.return,b===null)throw Error(Qe(341));b.lanes|=d,c=b.alternate,c!==null&&(c.lanes|=d),I_(b,d,o),b=C.sibling}else b=C.child;if(b!==null)b.return=C;else for(b=C;b!==null;){if(b===o){b=null;break}if(C=b.sibling,C!==null){C.return=b.return,b=C;break}b=b.return}C=b}Oi(r,o,x.children,d),o=o.child}return o;case 9:return x=o.type,_=o.pendingProps.children,Wc(o,d),x=Dn(x),_=_(x),o.flags|=1,Oi(r,o,_,d),o.child;case 14:return _=o.type,x=Jn(_,o.pendingProps),x=Jn(_.type,x),A0(r,o,_,x,d);case 15:return qb(r,o,o.type,o.pendingProps,d);case 17:return _=o.type,x=o.pendingProps,x=o.elementType===_?x:Jn(_,x),cf(r,o),o.tag=1,en(_)?(r=!0,Cf(o)):r=!1,Wc(o,d),Ub(o,_,x),k_(o,_,x,d),R_(null,o,_,!0,r,d);case 19:return Kb(r,o,d);case 22:return Wb(r,o,d)}throw Error(Qe(156,o.tag))};function pw(r,o){return N1(r,o)}function qC(r,o,d,_){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function An(r,o,d,_){return new qC(r,o,d,_)}function By(r){return r=r.prototype,!(!r||!r.isReactComponent)}function WC(r){if(typeof r=="function")return By(r)?1:0;if(r!=null){if(r=r.$$typeof,r===iy)return 11;if(r===ny)return 14}return 2}function na(r,o){var d=r.alternate;return d===null?(d=An(r.tag,o,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=o,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&14680064,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,o=r.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d}function df(r,o,d,_,x,C){var b=2;if(_=r,typeof r=="function")By(r)&&(b=1);else if(typeof r=="string")b=5;else e:switch(r){case zc:return gl(d.children,x,C,o);case ry:b=8,x|=8;break;case e_:return r=An(12,d,o,x|2),r.elementType=e_,r.lanes=C,r;case t_:return r=An(13,d,o,x),r.elementType=t_,r.lanes=C,r;case r_:return r=An(19,d,o,x),r.elementType=r_,r.lanes=C,r;case T1:return Kf(d,x,C,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case b1:b=10;break e;case w1:b=9;break e;case iy:b=11;break e;case ny:b=14;break e;case Go:b=16,_=null;break e}throw Error(Qe(130,r==null?r:typeof r,""))}return o=An(b,d,o,x),o.elementType=r,o.type=_,o.lanes=C,o}function gl(r,o,d,_){return r=An(7,r,_,o),r.lanes=d,r}function Kf(r,o,d,_){return r=An(22,r,_,o),r.elementType=T1,r.lanes=d,r.stateNode={isHidden:!1},r}function Wg(r,o,d){return r=An(6,r,null,o),r.lanes=d,r}function Hg(r,o,d){return o=An(4,r.children!==null?r.children:[],r.key,o),o.lanes=d,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function HC(r,o,d,_,x){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ig(0),this.expirationTimes=Ig(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ig(0),this.identifierPrefix=_,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function Oy(r,o,d,_,x,C,b,c,Z){return r=new HC(r,o,d,c,Z),o===1?(o=1,C===!0&&(o|=8)):o=0,C=An(3,null,null,o),r.current=C,C.stateNode=r,C.memoizedState={element:_,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},wy(C),r}function XC(r,o,d){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kc,key:_==null?null:""+_,children:r,containerInfo:o,implementation:d}}function fw(r){if(!r)return oa;r=r._reactInternals;e:{if(Sl(r)!==r||r.tag!==1)throw Error(Qe(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(en(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Qe(171))}if(r.tag===1){var d=r.type;if(en(d))return fb(r,d,o)}return o}function mw(r,o,d,_,x,C,b,c,Z){return r=Oy(d,_,!0,r,x,C,b,c,Z),r.context=fw(null),d=r.current,_=Ni(),x=ia(d),C=eo(_,x),C.callback=o??null,ta(d,C,x),r.current.lanes=x,cd(r,x,_),tn(r,_),r}function Qf(r,o,d,_){var x=o.current,C=Ni(),b=ia(x);return d=fw(d),o.context===null?o.context=d:o.pendingContext=d,o=eo(C,b),o.payload={element:r},_=_===void 0?null:_,_!==null&&(o.callback=_),r=ta(x,o,b),r!==null&&(ss(r,x,b,C),of(r,x,b)),b}function Bf(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Z0(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<o?d:o}}function Ny(r,o){Z0(r,o),(r=r.alternate)&&Z0(r,o)}function YC(){return null}var gw=typeof reportError=="function"?reportError:function(r){console.error(r)};function $y(r){this._internalRoot=r}Jf.prototype.render=$y.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(Qe(409));Qf(r,o,null,null)};Jf.prototype.unmount=$y.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;bl(function(){Qf(null,r,null,null)}),o[io]=null}};function Jf(r){this._internalRoot=r}Jf.prototype.unstable_scheduleHydration=function(r){if(r){var o=W1();r={blockedOn:null,target:r,priority:o};for(var d=0;d<Wo.length&&o!==0&&o<Wo[d].priority;d++);Wo.splice(d,0,r),d===0&&X1(r)}};function Vy(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function em(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function G0(){}function KC(r,o,d,_,x){if(x){if(typeof _=="function"){var C=_;_=function(){var K=Bf(b);C.call(K)}}var b=mw(o,_,r,0,null,!1,!1,"",G0);return r._reactRootContainer=b,r[io]=b.current,Qh(r.nodeType===8?r.parentNode:r),bl(),b}for(;x=r.lastChild;)r.removeChild(x);if(typeof _=="function"){var c=_;_=function(){var K=Bf(Z);c.call(K)}}var Z=Oy(r,0,!1,null,null,!1,!1,"",G0);return r._reactRootContainer=Z,r[io]=Z.current,Qh(r.nodeType===8?r.parentNode:r),bl(function(){Qf(o,Z,d,_)}),Z}function tm(r,o,d,_,x){var C=d._reactRootContainer;if(C){var b=C;if(typeof x=="function"){var c=x;x=function(){var Z=Bf(b);c.call(Z)}}Qf(o,b,r,x)}else b=KC(d,o,r,x,_);return Bf(b)}G1=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var d=Ah(o.pendingLanes);d!==0&&(ay(o,d|1),tn(o,Dr()),!(Zt&6)&&(tu=Dr()+500,ca()))}break;case 13:bl(function(){var _=no(r,1);if(_!==null){var x=Ni();ss(_,r,1,x)}}),Ny(r,1)}};ly=function(r){if(r.tag===13){var o=no(r,134217728);if(o!==null){var d=Ni();ss(o,r,134217728,d)}Ny(r,134217728)}};q1=function(r){if(r.tag===13){var o=ia(r),d=no(r,o);if(d!==null){var _=Ni();ss(d,r,o,_)}Ny(r,o)}};W1=function(){return Kt};H1=function(r,o){var d=Kt;try{return Kt=r,o()}finally{Kt=d}};d_=function(r,o,d){switch(o){case"input":if(s_(r,d),o=d.name,d.type==="radio"&&o!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<d.length;o++){var _=d[o];if(_!==r&&_.form===r.form){var x=Gf(_);if(!x)throw Error(Qe(90));C1(_),s_(_,x)}}}break;case"textarea":M1(r,d);break;case"select":o=d.value,o!=null&&Uc(r,!!d.multiple,o,!1)}};D1=Ly;L1=bl;var QC={usingClientEntryPoint:!1,Events:[hd,Lc,Gf,A1,R1,Ly]},Ph={findFiberByHostInstance:hl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JC={bundleType:Ph.bundleType,version:Ph.version,rendererPackageName:Ph.rendererPackageName,rendererConfig:Ph.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=B1(r),r===null?null:r.stateNode},findFiberByHostInstance:Ph.findFiberByHostInstance||YC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Up=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Up.isDisabled&&Up.supportsFiber)try{$f=Up.inject(JC),Ps=Up}catch{}}_n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QC;_n.createPortal=function(r,o){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vy(o))throw Error(Qe(200));return XC(r,o,null,d)};_n.createRoot=function(r,o){if(!Vy(r))throw Error(Qe(299));var d=!1,_="",x=gw;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),o=Oy(r,1,!1,null,null,d,!1,_,x),r[io]=o.current,Qh(r.nodeType===8?r.parentNode:r),new $y(o)};_n.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(Qe(188)):(r=Object.keys(r).join(","),Error(Qe(268,r)));return r=B1(o),r=r===null?null:r.stateNode,r};_n.flushSync=function(r){return bl(r)};_n.hydrate=function(r,o,d){if(!em(o))throw Error(Qe(200));return tm(null,r,o,!0,d)};_n.hydrateRoot=function(r,o,d){if(!Vy(r))throw Error(Qe(405));var _=d!=null&&d.hydratedSources||null,x=!1,C="",b=gw;if(d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(C=d.identifierPrefix),d.onRecoverableError!==void 0&&(b=d.onRecoverableError)),o=mw(o,null,r,1,d??null,x,!1,C,b),r[io]=o.current,Qh(r),_)for(r=0;r<_.length;r++)d=_[r],x=d._getVersion,x=x(d._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[d,x]:o.mutableSourceEagerHydrationData.push(d,x);return new Jf(o)};_n.render=function(r,o,d){if(!em(o))throw Error(Qe(200));return tm(null,r,o,!1,d)};_n.unmountComponentAtNode=function(r){if(!em(r))throw Error(Qe(40));return r._reactRootContainer?(bl(function(){tm(null,null,r,!1,function(){r._reactRootContainer=null,r[io]=null})}),!0):!1};_n.unstable_batchedUpdates=Ly;_n.unstable_renderSubtreeIntoContainer=function(r,o,d,_){if(!em(d))throw Error(Qe(200));if(r==null||r._reactInternals===void 0)throw Error(Qe(38));return tm(r,o,d,!1,_)};_n.version="18.3.1-next-f1338f8080-20240426";function _w(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_w)}catch(r){console.error(r)}}_w(),_1.exports=_n;var eP=_1.exports,yw,q0=eP;yw=q0.createRoot,q0.hydrateRoot;const tP="_proFeatures_jrztc_1",rP="_title_jrztc_51",iP="_bigTitle_jrztc_53",nP="_button_jrztc_83",sP="_getPro_jrztc_113",oP="_active_jrztc_163",nl={proFeatures:tP,title:rP,bigTitle:iP,button:nP,getPro:sP,active:oP};function aP({children:r}){const[o,d]=Ie.useState(!1),_=()=>{d(!o)};return z.jsxs(z.Fragment,{children:[z.jsxs("ul",{className:o?`${nl.proFeatures} ${nl.active}`:`${nl.proFeatures} `,children:[z.jsx("a",{className:`${nl.getPro}`,onClick:_,children:"Get Pro"}),z.jsx("li",{className:`${nl.bigTitle}`,children:"Pro Version Available on Themeforest"}),z.jsx("li",{className:`${nl.title}`,children:"Pro Version Features"}),z.jsx("li",{children:"2+ premade home pages"}),z.jsx("li",{children:"20+ html pages"}),z.jsx("li",{children:"Color Plate With 12+ Colors"}),z.jsx("li",{children:"Sticky Header / Sticky Filters"}),z.jsx("li",{children:"Working Contact Form With Google Map"}),z.jsxs("div",{className:`${nl.button}`,children:[z.jsx("a",{href:"http://preview.themeforest.net/item/mediplus-medical-and-doctor-html-template/full_screen_preview/26665910?_ga=2.145092285.888558928.1591971968-344530658.1588061879",target:"_blank",className:"btn",children:"Pro Version Demo"}),z.jsx("a",{href:"https://themeforest.net/item/mediplus-medical-and-doctor-html-template/26665910",target:"_blank",className:"btn",children:"Buy Pro Version"})]})]}),r]})}var vw={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var o={}.hasOwnProperty;function d(){for(var C="",b=0;b<arguments.length;b++){var c=arguments[b];c&&(C=x(C,_(c)))}return C}function _(C){if(typeof C=="string"||typeof C=="number")return C;if(typeof C!="object")return"";if(Array.isArray(C))return d.apply(null,C);if(C.toString!==Object.prototype.toString&&!C.toString.toString().includes("[native code]"))return C.toString();var b="";for(var c in C)o.call(C,c)&&C[c]&&(b=x(b,c));return b}function x(C,b){return b?C?C+" "+b:C+b:C}r.exports?(d.default=d,r.exports=d):window.classNames=d})()})(vw);var lP=vw.exports;const rm=H_(lP),cP=["xxl","xl","lg","md","sm","xs"],uP="xs",im=Ie.createContext({prefixes:{},breakpoints:cP,minBreakpoint:uP}),{Consumer:_A,Provider:yA}=im;function Uy(r,o){const{prefixes:d}=Ie.useContext(im);return r||d[o]||o}function xw(){const{breakpoints:r}=Ie.useContext(im);return r}function bw(){const{minBreakpoint:r}=Ie.useContext(im);return r}function hP({as:r,bsPrefix:o,className:d,..._}){o=Uy(o,"col");const x=xw(),C=bw(),b=[],c=[];return x.forEach(Z=>{const K=_[Z];delete _[Z];let ge,be,O;typeof K=="object"&&K!=null?{span:ge,offset:be,order:O}=K:ge=K;const H=Z!==C?`-${Z}`:"";ge&&b.push(ge===!0?`${o}${H}`:`${o}${H}-${ge}`),O!=null&&c.push(`order${H}-${O}`),be!=null&&c.push(`offset${H}-${be}`)}),[{..._,className:rm(d,...b,...c)},{as:r,bsPrefix:o,spans:b}]}const _t=Ie.forwardRef((r,o)=>{const[{className:d,..._},{as:x="div",bsPrefix:C,spans:b}]=hP(r);return z.jsx(x,{..._,ref:o,className:rm(d,!b.length&&C)})});_t.displayName="Col";const _r=Ie.forwardRef(({bsPrefix:r,fluid:o=!1,as:d="div",className:_,...x},C)=>{const b=Uy(r,"container"),c=typeof o=="string"?`-${o}`:"-fluid";return z.jsx(d,{ref:C,...x,className:rm(_,o?`${b}${c}`:b)})});_r.displayName="Container";const jt=Ie.forwardRef(({bsPrefix:r,className:o,as:d="div",..._},x)=>{const C=Uy(r,"row"),b=xw(),c=bw(),Z=`${C}-cols`,K=[];return b.forEach(ge=>{const be=_[ge];delete _[ge];let O;be!=null&&typeof be=="object"?{cols:O}=be:O=be;const H=ge!==c?`-${ge}`:"";O!=null&&K.push(`${Z}${H}-${O}`)}),z.jsx(d,{ref:x,..._,className:rm(o,C,...K)})});jt.displayName="Row";const dP="_topbar_10kzn_3",pP="_topLink_10kzn_17",fP="_topContact_10kzn_53",Xg={topbar:dP,topLink:pP,topContact:fP};function mP(){return z.jsx("div",{className:`${Xg.topbar}`,children:z.jsx(_r,{children:z.jsxs(jt,{children:[z.jsx(_t,{lg:6,md:5,children:z.jsxs("ul",{className:`${Xg.topLink}`,children:[z.jsx("li",{children:z.jsx("a",{href:"#",children:"About"})}),z.jsx("li",{children:z.jsx("a",{href:"#",children:"Doctors"})}),z.jsx("li",{children:z.jsx("a",{href:"#",children:"Contact"})}),z.jsx("li",{children:z.jsx("a",{href:"#",children:"FAQ"})})]})}),z.jsx(_t,{lg:6,md:7,children:z.jsxs("ul",{className:`${Xg.topContact}`,children:[z.jsxs("li",{children:[z.jsx("i",{className:"fa fa-phone"}),"+880 1234 56789"]}),z.jsxs("li",{children:[z.jsx("i",{className:"fa fa-envelope"}),z.jsx("a",{href:"mailto:support@yourmail.com",children:"support@yourmail.com"})]})]})})]})})})}const gP="/mediplus/logo.png",_P="_logo_1wxcy_1",yP="_mobileNavBtn_1wxcy_39",vP="_mobileNavTigger_1wxcy_47",xP="_tigger_1wxcy_79",Mh={logo:_P,mobileNavBtn:yP,mobileNavTigger:vP,tigger:xP};var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0});Zy.parse=MP;Zy.serialize=IP;const bP=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,wP=/^[\u0021-\u003A\u003C-\u007E]*$/,TP=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,SP=/^[\u0020-\u003A\u003D-\u007E]*$/,CP=Object.prototype.toString,PP=(()=>{const r=function(){};return r.prototype=Object.create(null),r})();function MP(r,o){const d=new PP,_=r.length;if(_<2)return d;const x=(o==null?void 0:o.decode)||EP;let C=0;do{const b=r.indexOf("=",C);if(b===-1)break;const c=r.indexOf(";",C),Z=c===-1?_:c;if(b>Z){C=r.lastIndexOf(";",b-1)+1;continue}const K=W0(r,C,b),ge=H0(r,b,K),be=r.slice(K,ge);if(d[be]===void 0){let O=W0(r,b+1,Z),H=H0(r,Z,O);const ue=x(r.slice(O,H));d[be]=ue}C=Z+1}while(C<_);return d}function W0(r,o,d){do{const _=r.charCodeAt(o);if(_!==32&&_!==9)return o}while(++o<d);return d}function H0(r,o,d){for(;o>d;){const _=r.charCodeAt(--o);if(_!==32&&_!==9)return o+1}return d}function IP(r,o,d){const _=(d==null?void 0:d.encode)||encodeURIComponent;if(!bP.test(r))throw new TypeError(`argument name is invalid: ${r}`);const x=_(o);if(!wP.test(x))throw new TypeError(`argument val is invalid: ${o}`);let C=r+"="+x;if(!d)return C;if(d.maxAge!==void 0){if(!Number.isInteger(d.maxAge))throw new TypeError(`option maxAge is invalid: ${d.maxAge}`);C+="; Max-Age="+d.maxAge}if(d.domain){if(!TP.test(d.domain))throw new TypeError(`option domain is invalid: ${d.domain}`);C+="; Domain="+d.domain}if(d.path){if(!SP.test(d.path))throw new TypeError(`option path is invalid: ${d.path}`);C+="; Path="+d.path}if(d.expires){if(!kP(d.expires)||!Number.isFinite(d.expires.valueOf()))throw new TypeError(`option expires is invalid: ${d.expires}`);C+="; Expires="+d.expires.toUTCString()}if(d.httpOnly&&(C+="; HttpOnly"),d.secure&&(C+="; Secure"),d.partitioned&&(C+="; Partitioned"),d.priority)switch(typeof d.priority=="string"?d.priority.toLowerCase():void 0){case"low":C+="; Priority=Low";break;case"medium":C+="; Priority=Medium";break;case"high":C+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${d.priority}`)}if(d.sameSite)switch(typeof d.sameSite=="string"?d.sameSite.toLowerCase():d.sameSite){case!0:case"strict":C+="; SameSite=Strict";break;case"lax":C+="; SameSite=Lax";break;case"none":C+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${d.sameSite}`)}return C}function EP(r){if(r.indexOf("%")===-1)return r;try{return decodeURIComponent(r)}catch{return r}}function kP(r){return CP.call(r)==="[object Date]"}var X0="popstate";function zP(r={}){function o(_,x){let{pathname:C,search:b,hash:c}=_.location;return G_("",{pathname:C,search:b,hash:c},x.state&&x.state.usr||null,x.state&&x.state.key||"default")}function d(_,x){return typeof x=="string"?x:ad(x)}return RP(o,d,null,r)}function Tr(r,o){if(r===!1||r===null||typeof r>"u")throw new Error(o)}function Is(r,o){if(!r){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function AP(){return Math.random().toString(36).substring(2,10)}function Y0(r,o){return{usr:r.state,key:r.key,idx:o}}function G_(r,o,d=null,_){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof o=="string"?su(o):o,state:d,key:o&&o.key||_||AP()}}function ad({pathname:r="/",search:o="",hash:d=""}){return o&&o!=="?"&&(r+=o.charAt(0)==="?"?o:"?"+o),d&&d!=="#"&&(r+=d.charAt(0)==="#"?d:"#"+d),r}function su(r){let o={};if(r){let d=r.indexOf("#");d>=0&&(o.hash=r.substring(d),r=r.substring(0,d));let _=r.indexOf("?");_>=0&&(o.search=r.substring(_),r=r.substring(0,_)),r&&(o.pathname=r)}return o}function RP(r,o,d,_={}){let{window:x=document.defaultView,v5Compat:C=!1}=_,b=x.history,c="POP",Z=null,K=ge();K==null&&(K=0,b.replaceState({...b.state,idx:K},""));function ge(){return(b.state||{idx:null}).idx}function be(){c="POP";let pe=ge(),E=pe==null?null:pe-K;K=pe,Z&&Z({action:c,location:Pe.location,delta:E})}function O(pe,E){c="PUSH";let R=G_(Pe.location,pe,E);K=ge()+1;let N=Y0(R,K),re=Pe.createHref(R);try{b.pushState(N,"",re)}catch(Te){if(Te instanceof DOMException&&Te.name==="DataCloneError")throw Te;x.location.assign(re)}C&&Z&&Z({action:c,location:Pe.location,delta:1})}function H(pe,E){c="REPLACE";let R=G_(Pe.location,pe,E);K=ge();let N=Y0(R,K),re=Pe.createHref(R);b.replaceState(N,"",re),C&&Z&&Z({action:c,location:Pe.location,delta:0})}function ue(pe){return DP(pe)}let Pe={get action(){return c},get location(){return r(x,b)},listen(pe){if(Z)throw new Error("A history only accepts one active listener");return x.addEventListener(X0,be),Z=pe,()=>{x.removeEventListener(X0,be),Z=null}},createHref(pe){return o(x,pe)},createURL:ue,encodeLocation(pe){let E=ue(pe);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:O,replace:H,go(pe){return b.go(pe)}};return Pe}function DP(r,o=!1){let d="http://localhost";typeof window<"u"&&(d=window.location.origin!=="null"?window.location.origin:window.location.href),Tr(d,"No window.location.(origin|href) available to create URL");let _=typeof r=="string"?r:ad(r);return _=_.replace(/ $/,"%20"),!o&&_.startsWith("//")&&(_=d+_),new URL(_,d)}function ww(r,o,d="/"){return LP(r,o,d,!1)}function LP(r,o,d,_){let x=typeof o=="string"?su(o):o,C=oo(x.pathname||"/",d);if(C==null)return null;let b=Tw(r);jP(b);let c=null;for(let Z=0;c==null&&Z<b.length;++Z){let K=WP(C);c=GP(b[Z],K,_)}return c}function Tw(r,o=[],d=[],_=""){let x=(C,b,c)=>{let Z={relativePath:c===void 0?C.path||"":c,caseSensitive:C.caseSensitive===!0,childrenIndex:b,route:C};Z.relativePath.startsWith("/")&&(Tr(Z.relativePath.startsWith(_),`Absolute route path "${Z.relativePath}" nested under path "${_}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),Z.relativePath=Z.relativePath.slice(_.length));let K=to([_,Z.relativePath]),ge=d.concat(Z);C.children&&C.children.length>0&&(Tr(C.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${K}".`),Tw(C.children,o,ge,K)),!(C.path==null&&!C.index)&&o.push({path:K,score:UP(K,C.index),routesMeta:ge})};return r.forEach((C,b)=>{var c;if(C.path===""||!((c=C.path)!=null&&c.includes("?")))x(C,b);else for(let Z of Sw(C.path))x(C,b,Z)}),o}function Sw(r){let o=r.split("/");if(o.length===0)return[];let[d,..._]=o,x=d.endsWith("?"),C=d.replace(/\?$/,"");if(_.length===0)return x?[C,""]:[C];let b=Sw(_.join("/")),c=[];return c.push(...b.map(Z=>Z===""?C:[C,Z].join("/"))),x&&c.push(...b),c.map(Z=>r.startsWith("/")&&Z===""?"/":Z)}function jP(r){r.sort((o,d)=>o.score!==d.score?d.score-o.score:ZP(o.routesMeta.map(_=>_.childrenIndex),d.routesMeta.map(_=>_.childrenIndex)))}var FP=/^:[\w-]+$/,BP=3,OP=2,NP=1,$P=10,VP=-2,K0=r=>r==="*";function UP(r,o){let d=r.split("/"),_=d.length;return d.some(K0)&&(_+=VP),o&&(_+=OP),d.filter(x=>!K0(x)).reduce((x,C)=>x+(FP.test(C)?BP:C===""?NP:$P),_)}function ZP(r,o){return r.length===o.length&&r.slice(0,-1).every((_,x)=>_===o[x])?r[r.length-1]-o[o.length-1]:0}function GP(r,o,d=!1){let{routesMeta:_}=r,x={},C="/",b=[];for(let c=0;c<_.length;++c){let Z=_[c],K=c===_.length-1,ge=C==="/"?o:o.slice(C.length)||"/",be=Of({path:Z.relativePath,caseSensitive:Z.caseSensitive,end:K},ge),O=Z.route;if(!be&&K&&d&&!_[_.length-1].route.index&&(be=Of({path:Z.relativePath,caseSensitive:Z.caseSensitive,end:!1},ge)),!be)return null;Object.assign(x,be.params),b.push({params:x,pathname:to([C,be.pathname]),pathnameBase:KP(to([C,be.pathnameBase])),route:O}),be.pathnameBase!=="/"&&(C=to([C,be.pathnameBase]))}return b}function Of(r,o){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[d,_]=qP(r.path,r.caseSensitive,r.end),x=o.match(d);if(!x)return null;let C=x[0],b=C.replace(/(.)\/+$/,"$1"),c=x.slice(1);return{params:_.reduce((K,{paramName:ge,isOptional:be},O)=>{if(ge==="*"){let ue=c[O]||"";b=C.slice(0,C.length-ue.length).replace(/(.)\/+$/,"$1")}const H=c[O];return be&&!H?K[ge]=void 0:K[ge]=(H||"").replace(/%2F/g,"/"),K},{}),pathname:C,pathnameBase:b,pattern:r}}function qP(r,o=!1,d=!0){Is(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let _=[],x="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(b,c,Z)=>(_.push({paramName:c,isOptional:Z!=null}),Z?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(_.push({paramName:"*"}),x+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):d?x+="\\/*$":r!==""&&r!=="/"&&(x+="(?:(?=\\/|$))"),[new RegExp(x,o?void 0:"i"),_]}function WP(r){try{return r.split("/").map(o=>decodeURIComponent(o).replace(/\//g,"%2F")).join("/")}catch(o){return Is(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${o}).`),r}}function oo(r,o){if(o==="/")return r;if(!r.toLowerCase().startsWith(o.toLowerCase()))return null;let d=o.endsWith("/")?o.length-1:o.length,_=r.charAt(d);return _&&_!=="/"?null:r.slice(d)||"/"}function HP(r,o="/"){let{pathname:d,search:_="",hash:x=""}=typeof r=="string"?su(r):r;return{pathname:d?d.startsWith("/")?d:XP(d,o):o,search:QP(_),hash:JP(x)}}function XP(r,o){let d=o.replace(/\/+$/,"").split("/");return r.split("/").forEach(x=>{x===".."?d.length>1&&d.pop():x!=="."&&d.push(x)}),d.length>1?d.join("/"):"/"}function Yg(r,o,d,_){return`Cannot include a '${r}' character in a manually specified \`to.${o}\` field [${JSON.stringify(_)}].  Please separate it out to the \`to.${d}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function YP(r){return r.filter((o,d)=>d===0||o.route.path&&o.route.path.length>0)}function Cw(r){let o=YP(r);return o.map((d,_)=>_===o.length-1?d.pathname:d.pathnameBase)}function Pw(r,o,d,_=!1){let x;typeof r=="string"?x=su(r):(x={...r},Tr(!x.pathname||!x.pathname.includes("?"),Yg("?","pathname","search",x)),Tr(!x.pathname||!x.pathname.includes("#"),Yg("#","pathname","hash",x)),Tr(!x.search||!x.search.includes("#"),Yg("#","search","hash",x)));let C=r===""||x.pathname==="",b=C?"/":x.pathname,c;if(b==null)c=d;else{let be=o.length-1;if(!_&&b.startsWith("..")){let O=b.split("/");for(;O[0]==="..";)O.shift(),be-=1;x.pathname=O.join("/")}c=be>=0?o[be]:"/"}let Z=HP(x,c),K=b&&b!=="/"&&b.endsWith("/"),ge=(C||b===".")&&d.endsWith("/");return!Z.pathname.endsWith("/")&&(K||ge)&&(Z.pathname+="/"),Z}var to=r=>r.join("/").replace(/\/\/+/g,"/"),KP=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),QP=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,JP=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function eM(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var Mw=["POST","PUT","PATCH","DELETE"];new Set(Mw);var tM=["GET",...Mw];new Set(tM);var ou=Ie.createContext(null);ou.displayName="DataRouter";var nm=Ie.createContext(null);nm.displayName="DataRouterState";var Iw=Ie.createContext({isTransitioning:!1});Iw.displayName="ViewTransition";var rM=Ie.createContext(new Map);rM.displayName="Fetchers";var iM=Ie.createContext(null);iM.displayName="Await";var Es=Ie.createContext(null);Es.displayName="Navigation";var pd=Ie.createContext(null);pd.displayName="Location";var co=Ie.createContext({outlet:null,matches:[],isDataRoute:!1});co.displayName="Route";var Gy=Ie.createContext(null);Gy.displayName="RouteError";function nM(r,{relative:o}={}){Tr(fd(),"useHref() may be used only in the context of a <Router> component.");let{basename:d,navigator:_}=Ie.useContext(Es),{hash:x,pathname:C,search:b}=md(r,{relative:o}),c=C;return d!=="/"&&(c=C==="/"?d:to([d,C])),_.createHref({pathname:c,search:b,hash:x})}function fd(){return Ie.useContext(pd)!=null}function Cl(){return Tr(fd(),"useLocation() may be used only in the context of a <Router> component."),Ie.useContext(pd).location}var Ew="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function kw(r){Ie.useContext(Es).static||Ie.useLayoutEffect(r)}function sM(){let{isDataRoute:r}=Ie.useContext(co);return r?yM():oM()}function oM(){Tr(fd(),"useNavigate() may be used only in the context of a <Router> component.");let r=Ie.useContext(ou),{basename:o,navigator:d}=Ie.useContext(Es),{matches:_}=Ie.useContext(co),{pathname:x}=Cl(),C=JSON.stringify(Cw(_)),b=Ie.useRef(!1);return kw(()=>{b.current=!0}),Ie.useCallback((Z,K={})=>{if(Is(b.current,Ew),!b.current)return;if(typeof Z=="number"){d.go(Z);return}let ge=Pw(Z,JSON.parse(C),x,K.relative==="path");r==null&&o!=="/"&&(ge.pathname=ge.pathname==="/"?o:to([o,ge.pathname])),(K.replace?d.replace:d.push)(ge,K.state,K)},[o,d,C,x,r])}Ie.createContext(null);function md(r,{relative:o}={}){let{matches:d}=Ie.useContext(co),{pathname:_}=Cl(),x=JSON.stringify(Cw(d));return Ie.useMemo(()=>Pw(r,JSON.parse(x),_,o==="path"),[r,x,_,o])}function aM(r,o){return zw(r,o)}function zw(r,o,d,_){var R;Tr(fd(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:x,static:C}=Ie.useContext(Es),{matches:b}=Ie.useContext(co),c=b[b.length-1],Z=c?c.params:{},K=c?c.pathname:"/",ge=c?c.pathnameBase:"/",be=c&&c.route;{let N=be&&be.path||"";Aw(K,!be||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${K}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let O=Cl(),H;if(o){let N=typeof o=="string"?su(o):o;Tr(ge==="/"||((R=N.pathname)==null?void 0:R.startsWith(ge)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${ge}" but pathname "${N.pathname}" was given in the \`location\` prop.`),H=N}else H=O;let ue=H.pathname||"/",Pe=ue;if(ge!=="/"){let N=ge.replace(/^\//,"").split("/");Pe="/"+ue.replace(/^\//,"").split("/").slice(N.length).join("/")}let pe=!C&&d&&d.matches&&d.matches.length>0?d.matches:ww(r,{pathname:Pe});Is(be||pe!=null,`No routes matched location "${H.pathname}${H.search}${H.hash}" `),Is(pe==null||pe[pe.length-1].route.element!==void 0||pe[pe.length-1].route.Component!==void 0||pe[pe.length-1].route.lazy!==void 0,`Matched leaf route at location "${H.pathname}${H.search}${H.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=dM(pe&&pe.map(N=>Object.assign({},N,{params:Object.assign({},Z,N.params),pathname:to([ge,x.encodeLocation?x.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?ge:to([ge,x.encodeLocation?x.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),b,d,_);return o&&E?Ie.createElement(pd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...H},navigationType:"POP"}},E):E}function lM(){let r=_M(),o=eM(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),d=r instanceof Error?r.stack:null,_="rgba(200,200,200, 0.5)",x={padding:"0.5rem",backgroundColor:_},C={padding:"2px 4px",backgroundColor:_},b=null;return console.error("Error handled by React Router default ErrorBoundary:",r),b=Ie.createElement(Ie.Fragment,null,Ie.createElement("p",null,"💿 Hey developer 👋"),Ie.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ie.createElement("code",{style:C},"ErrorBoundary")," or"," ",Ie.createElement("code",{style:C},"errorElement")," prop on your route.")),Ie.createElement(Ie.Fragment,null,Ie.createElement("h2",null,"Unexpected Application Error!"),Ie.createElement("h3",{style:{fontStyle:"italic"}},o),d?Ie.createElement("pre",{style:x},d):null,b)}var cM=Ie.createElement(lM,null),uM=class extends Ie.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,o){return o.location!==r.location||o.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:o.error,location:o.location,revalidation:r.revalidation||o.revalidation}}componentDidCatch(r,o){console.error("React Router caught the following error during render",r,o)}render(){return this.state.error!==void 0?Ie.createElement(co.Provider,{value:this.props.routeContext},Ie.createElement(Gy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function hM({routeContext:r,match:o,children:d}){let _=Ie.useContext(ou);return _&&_.static&&_.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(_.staticContext._deepestRenderedBoundaryId=o.route.id),Ie.createElement(co.Provider,{value:r},d)}function dM(r,o=[],d=null,_=null){if(r==null){if(!d)return null;if(d.errors)r=d.matches;else if(o.length===0&&!d.initialized&&d.matches.length>0)r=d.matches;else return null}let x=r,C=d==null?void 0:d.errors;if(C!=null){let Z=x.findIndex(K=>K.route.id&&(C==null?void 0:C[K.route.id])!==void 0);Tr(Z>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(C).join(",")}`),x=x.slice(0,Math.min(x.length,Z+1))}let b=!1,c=-1;if(d)for(let Z=0;Z<x.length;Z++){let K=x[Z];if((K.route.HydrateFallback||K.route.hydrateFallbackElement)&&(c=Z),K.route.id){let{loaderData:ge,errors:be}=d,O=K.route.loader&&!ge.hasOwnProperty(K.route.id)&&(!be||be[K.route.id]===void 0);if(K.route.lazy||O){b=!0,c>=0?x=x.slice(0,c+1):x=[x[0]];break}}}return x.reduceRight((Z,K,ge)=>{let be,O=!1,H=null,ue=null;d&&(be=C&&K.route.id?C[K.route.id]:void 0,H=K.route.errorElement||cM,b&&(c<0&&ge===0?(Aw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),O=!0,ue=null):c===ge&&(O=!0,ue=K.route.hydrateFallbackElement||null)));let Pe=o.concat(x.slice(0,ge+1)),pe=()=>{let E;return be?E=H:O?E=ue:K.route.Component?E=Ie.createElement(K.route.Component,null):K.route.element?E=K.route.element:E=Z,Ie.createElement(hM,{match:K,routeContext:{outlet:Z,matches:Pe,isDataRoute:d!=null},children:E})};return d&&(K.route.ErrorBoundary||K.route.errorElement||ge===0)?Ie.createElement(uM,{location:d.location,revalidation:d.revalidation,component:H,error:be,children:pe(),routeContext:{outlet:null,matches:Pe,isDataRoute:!0}}):pe()},null)}function qy(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pM(r){let o=Ie.useContext(ou);return Tr(o,qy(r)),o}function fM(r){let o=Ie.useContext(nm);return Tr(o,qy(r)),o}function mM(r){let o=Ie.useContext(co);return Tr(o,qy(r)),o}function Wy(r){let o=mM(r),d=o.matches[o.matches.length-1];return Tr(d.route.id,`${r} can only be used on routes that contain a unique "id"`),d.route.id}function gM(){return Wy("useRouteId")}function _M(){var _;let r=Ie.useContext(Gy),o=fM("useRouteError"),d=Wy("useRouteError");return r!==void 0?r:(_=o.errors)==null?void 0:_[d]}function yM(){let{router:r}=pM("useNavigate"),o=Wy("useNavigate"),d=Ie.useRef(!1);return kw(()=>{d.current=!0}),Ie.useCallback(async(x,C={})=>{Is(d.current,Ew),d.current&&(typeof x=="number"?r.navigate(x):await r.navigate(x,{fromRouteId:o,...C}))},[r,o])}var Q0={};function Aw(r,o,d){!o&&!Q0[r]&&(Q0[r]=!0,Is(!1,d))}Ie.memo(vM);function vM({routes:r,future:o,state:d}){return zw(r,void 0,d,o)}function ll(r){Tr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xM({basename:r="/",children:o=null,location:d,navigationType:_="POP",navigator:x,static:C=!1}){Tr(!fd(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let b=r.replace(/^\/*/,"/"),c=Ie.useMemo(()=>({basename:b,navigator:x,static:C,future:{}}),[b,x,C]);typeof d=="string"&&(d=su(d));let{pathname:Z="/",search:K="",hash:ge="",state:be=null,key:O="default"}=d,H=Ie.useMemo(()=>{let ue=oo(Z,b);return ue==null?null:{location:{pathname:ue,search:K,hash:ge,state:be,key:O},navigationType:_}},[b,Z,K,ge,be,O,_]);return Is(H!=null,`<Router basename="${b}"> is not able to match the URL "${Z}${K}${ge}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:Ie.createElement(Es.Provider,{value:c},Ie.createElement(pd.Provider,{children:o,value:H}))}function bM({children:r,location:o}){return aM(q_(r),o)}function q_(r,o=[]){let d=[];return Ie.Children.forEach(r,(_,x)=>{if(!Ie.isValidElement(_))return;let C=[...o,x];if(_.type===Ie.Fragment){d.push.apply(d,q_(_.props.children,C));return}Tr(_.type===ll,`[${typeof _.type=="string"?_.type:_.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Tr(!_.props.index||!_.props.children,"An index route cannot have child routes.");let b={id:_.props.id||C.join("-"),caseSensitive:_.props.caseSensitive,element:_.props.element,Component:_.props.Component,index:_.props.index,path:_.props.path,loader:_.props.loader,action:_.props.action,hydrateFallbackElement:_.props.hydrateFallbackElement,HydrateFallback:_.props.HydrateFallback,errorElement:_.props.errorElement,ErrorBoundary:_.props.ErrorBoundary,hasErrorBoundary:_.props.hasErrorBoundary===!0||_.props.ErrorBoundary!=null||_.props.errorElement!=null,shouldRevalidate:_.props.shouldRevalidate,handle:_.props.handle,lazy:_.props.lazy};_.props.children&&(b.children=q_(_.props.children,C)),d.push(b)}),d}var pf="get",ff="application/x-www-form-urlencoded";function sm(r){return r!=null&&typeof r.tagName=="string"}function wM(r){return sm(r)&&r.tagName.toLowerCase()==="button"}function TM(r){return sm(r)&&r.tagName.toLowerCase()==="form"}function SM(r){return sm(r)&&r.tagName.toLowerCase()==="input"}function CM(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function PM(r,o){return r.button===0&&(!o||o==="_self")&&!CM(r)}var Zp=null;function MM(){if(Zp===null)try{new FormData(document.createElement("form"),0),Zp=!1}catch{Zp=!0}return Zp}var IM=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kg(r){return r!=null&&!IM.has(r)?(Is(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ff}"`),null):r}function EM(r,o){let d,_,x,C,b;if(TM(r)){let c=r.getAttribute("action");_=c?oo(c,o):null,d=r.getAttribute("method")||pf,x=Kg(r.getAttribute("enctype"))||ff,C=new FormData(r)}else if(wM(r)||SM(r)&&(r.type==="submit"||r.type==="image")){let c=r.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let Z=r.getAttribute("formaction")||c.getAttribute("action");if(_=Z?oo(Z,o):null,d=r.getAttribute("formmethod")||c.getAttribute("method")||pf,x=Kg(r.getAttribute("formenctype"))||Kg(c.getAttribute("enctype"))||ff,C=new FormData(c,r),!MM()){let{name:K,type:ge,value:be}=r;if(ge==="image"){let O=K?`${K}.`:"";C.append(`${O}x`,"0"),C.append(`${O}y`,"0")}else K&&C.append(K,be)}}else{if(sm(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');d=pf,_=null,x=ff,b=r}return C&&x==="text/plain"&&(b=C,C=void 0),{action:_,method:d.toLowerCase(),encType:x,formData:C,body:b}}function Hy(r,o){if(r===!1||r===null||typeof r>"u")throw new Error(o)}async function kM(r,o){if(r.id in o)return o[r.id];try{let d=await import(r.module);return o[r.id]=d,d}catch(d){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(d),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function zM(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function AM(r,o,d){let _=await Promise.all(r.map(async x=>{let C=o.routes[x.route.id];if(C){let b=await kM(C,d);return b.links?b.links():[]}return[]}));return jM(_.flat(1).filter(zM).filter(x=>x.rel==="stylesheet"||x.rel==="preload").map(x=>x.rel==="stylesheet"?{...x,rel:"prefetch",as:"style"}:{...x,rel:"prefetch"}))}function J0(r,o,d,_,x,C){let b=(Z,K)=>d[K]?Z.route.id!==d[K].route.id:!0,c=(Z,K)=>{var ge;return d[K].pathname!==Z.pathname||((ge=d[K].route.path)==null?void 0:ge.endsWith("*"))&&d[K].params["*"]!==Z.params["*"]};return C==="assets"?o.filter((Z,K)=>b(Z,K)||c(Z,K)):C==="data"?o.filter((Z,K)=>{var be;let ge=_.routes[Z.route.id];if(!ge||!ge.hasLoader)return!1;if(b(Z,K)||c(Z,K))return!0;if(Z.route.shouldRevalidate){let O=Z.route.shouldRevalidate({currentUrl:new URL(x.pathname+x.search+x.hash,window.origin),currentParams:((be=d[0])==null?void 0:be.params)||{},nextUrl:new URL(r,window.origin),nextParams:Z.params,defaultShouldRevalidate:!0});if(typeof O=="boolean")return O}return!0}):[]}function RM(r,o,{includeHydrateFallback:d}={}){return DM(r.map(_=>{let x=o.routes[_.route.id];if(!x)return[];let C=[x.module];return x.clientActionModule&&(C=C.concat(x.clientActionModule)),x.clientLoaderModule&&(C=C.concat(x.clientLoaderModule)),d&&x.hydrateFallbackModule&&(C=C.concat(x.hydrateFallbackModule)),x.imports&&(C=C.concat(x.imports)),C}).flat(1))}function DM(r){return[...new Set(r)]}function LM(r){let o={},d=Object.keys(r).sort();for(let _ of d)o[_]=r[_];return o}function jM(r,o){let d=new Set;return new Set(o),r.reduce((_,x)=>{let C=JSON.stringify(LM(x));return d.has(C)||(d.add(C),_.push({key:C,link:x})),_},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var FM=new Set([100,101,204,205]);function BM(r,o){let d=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return d.pathname==="/"?d.pathname="_root.data":o&&oo(d.pathname,o)==="/"?d.pathname=`${o.replace(/\/$/,"")}/_root.data`:d.pathname=`${d.pathname.replace(/\/$/,"")}.data`,d}function Rw(){let r=Ie.useContext(ou);return Hy(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function OM(){let r=Ie.useContext(nm);return Hy(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var Xy=Ie.createContext(void 0);Xy.displayName="FrameworkContext";function Dw(){let r=Ie.useContext(Xy);return Hy(r,"You must render this element inside a <HydratedRouter> element"),r}function NM(r,o){let d=Ie.useContext(Xy),[_,x]=Ie.useState(!1),[C,b]=Ie.useState(!1),{onFocus:c,onBlur:Z,onMouseEnter:K,onMouseLeave:ge,onTouchStart:be}=o,O=Ie.useRef(null);Ie.useEffect(()=>{if(r==="render"&&b(!0),r==="viewport"){let Pe=E=>{E.forEach(R=>{b(R.isIntersecting)})},pe=new IntersectionObserver(Pe,{threshold:.5});return O.current&&pe.observe(O.current),()=>{pe.disconnect()}}},[r]),Ie.useEffect(()=>{if(_){let Pe=setTimeout(()=>{b(!0)},100);return()=>{clearTimeout(Pe)}}},[_]);let H=()=>{x(!0)},ue=()=>{x(!1),b(!1)};return d?r!=="intent"?[C,O,{}]:[C,O,{onFocus:Ih(c,H),onBlur:Ih(Z,ue),onMouseEnter:Ih(K,H),onMouseLeave:Ih(ge,ue),onTouchStart:Ih(be,H)}]:[!1,O,{}]}function Ih(r,o){return d=>{r&&r(d),d.defaultPrevented||o(d)}}function $M({page:r,...o}){let{router:d}=Rw(),_=Ie.useMemo(()=>ww(d.routes,r,d.basename),[d.routes,r,d.basename]);return _?Ie.createElement(UM,{page:r,matches:_,...o}):null}function VM(r){let{manifest:o,routeModules:d}=Dw(),[_,x]=Ie.useState([]);return Ie.useEffect(()=>{let C=!1;return AM(r,o,d).then(b=>{C||x(b)}),()=>{C=!0}},[r,o,d]),_}function UM({page:r,matches:o,...d}){let _=Cl(),{manifest:x,routeModules:C}=Dw(),{basename:b}=Rw(),{loaderData:c,matches:Z}=OM(),K=Ie.useMemo(()=>J0(r,o,Z,x,_,"data"),[r,o,Z,x,_]),ge=Ie.useMemo(()=>J0(r,o,Z,x,_,"assets"),[r,o,Z,x,_]),be=Ie.useMemo(()=>{if(r===_.pathname+_.search+_.hash)return[];let ue=new Set,Pe=!1;if(o.forEach(E=>{var N;let R=x.routes[E.route.id];!R||!R.hasLoader||(!K.some(re=>re.route.id===E.route.id)&&E.route.id in c&&((N=C[E.route.id])!=null&&N.shouldRevalidate)||R.hasClientLoader?Pe=!0:ue.add(E.route.id))}),ue.size===0)return[];let pe=BM(r,b);return Pe&&ue.size>0&&pe.searchParams.set("_routes",o.filter(E=>ue.has(E.route.id)).map(E=>E.route.id).join(",")),[pe.pathname+pe.search]},[b,c,_,x,K,o,r,C]),O=Ie.useMemo(()=>RM(ge,x),[ge,x]),H=VM(ge);return Ie.createElement(Ie.Fragment,null,be.map(ue=>Ie.createElement("link",{key:ue,rel:"prefetch",as:"fetch",href:ue,...d})),O.map(ue=>Ie.createElement("link",{key:ue,rel:"modulepreload",href:ue,...d})),H.map(({key:ue,link:Pe})=>Ie.createElement("link",{key:ue,...Pe})))}function ZM(...r){return o=>{r.forEach(d=>{typeof d=="function"?d(o):d!=null&&(d.current=o)})}}var Lw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Lw&&(window.__reactRouterVersion="7.6.0")}catch{}function GM({basename:r,children:o,window:d}){let _=Ie.useRef();_.current==null&&(_.current=zP({window:d,v5Compat:!0}));let x=_.current,[C,b]=Ie.useState({action:x.action,location:x.location}),c=Ie.useCallback(Z=>{Ie.startTransition(()=>b(Z))},[b]);return Ie.useLayoutEffect(()=>x.listen(c),[x,c]),Ie.createElement(xM,{basename:r,children:o,location:C.location,navigationType:C.action,navigator:x})}var jw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wl=Ie.forwardRef(function({onClick:o,discover:d="render",prefetch:_="none",relative:x,reloadDocument:C,replace:b,state:c,target:Z,to:K,preventScrollReset:ge,viewTransition:be,...O},H){let{basename:ue}=Ie.useContext(Es),Pe=typeof K=="string"&&jw.test(K),pe,E=!1;if(typeof K=="string"&&Pe&&(pe=K,Lw))try{let ht=new URL(window.location.href),dt=K.startsWith("//")?new URL(ht.protocol+K):new URL(K),Gt=oo(dt.pathname,ue);dt.origin===ht.origin&&Gt!=null?K=Gt+dt.search+dt.hash:E=!0}catch{Is(!1,`<Link to="${K}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let R=nM(K,{relative:x}),[N,re,Te]=NM(_,O),Ce=XM(K,{replace:b,state:c,target:Z,preventScrollReset:ge,relative:x,viewTransition:be});function Ne(ht){o&&o(ht),ht.defaultPrevented||Ce(ht)}let Ge=Ie.createElement("a",{...O,...Te,href:pe||R,onClick:E||C?o:Ne,ref:ZM(H,re),target:Z,"data-discover":!Pe&&d==="render"?"true":void 0});return N&&!Pe?Ie.createElement(Ie.Fragment,null,Ge,Ie.createElement($M,{page:R})):Ge});wl.displayName="Link";var qM=Ie.forwardRef(function({"aria-current":o="page",caseSensitive:d=!1,className:_="",end:x=!1,style:C,to:b,viewTransition:c,children:Z,...K},ge){let be=md(b,{relative:K.relative}),O=Cl(),H=Ie.useContext(nm),{navigator:ue,basename:Pe}=Ie.useContext(Es),pe=H!=null&&eI(be)&&c===!0,E=ue.encodeLocation?ue.encodeLocation(be).pathname:be.pathname,R=O.pathname,N=H&&H.navigation&&H.navigation.location?H.navigation.location.pathname:null;d||(R=R.toLowerCase(),N=N?N.toLowerCase():null,E=E.toLowerCase()),N&&Pe&&(N=oo(N,Pe)||N);const re=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let Te=R===E||!x&&R.startsWith(E)&&R.charAt(re)==="/",Ce=N!=null&&(N===E||!x&&N.startsWith(E)&&N.charAt(E.length)==="/"),Ne={isActive:Te,isPending:Ce,isTransitioning:pe},Ge=Te?o:void 0,ht;typeof _=="function"?ht=_(Ne):ht=[_,Te?"active":null,Ce?"pending":null,pe?"transitioning":null].filter(Boolean).join(" ");let dt=typeof C=="function"?C(Ne):C;return Ie.createElement(wl,{...K,"aria-current":Ge,className:ht,ref:ge,style:dt,to:b,viewTransition:c},typeof Z=="function"?Z(Ne):Z)});qM.displayName="NavLink";var WM=Ie.forwardRef(({discover:r="render",fetcherKey:o,navigate:d,reloadDocument:_,replace:x,state:C,method:b=pf,action:c,onSubmit:Z,relative:K,preventScrollReset:ge,viewTransition:be,...O},H)=>{let ue=QM(),Pe=JM(c,{relative:K}),pe=b.toLowerCase()==="get"?"get":"post",E=typeof c=="string"&&jw.test(c),R=N=>{if(Z&&Z(N),N.defaultPrevented)return;N.preventDefault();let re=N.nativeEvent.submitter,Te=(re==null?void 0:re.getAttribute("formmethod"))||b;ue(re||N.currentTarget,{fetcherKey:o,method:Te,navigate:d,replace:x,state:C,relative:K,preventScrollReset:ge,viewTransition:be})};return Ie.createElement("form",{ref:H,method:pe,action:Pe,onSubmit:_?Z:R,...O,"data-discover":!E&&r==="render"?"true":void 0})});WM.displayName="Form";function HM(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Fw(r){let o=Ie.useContext(ou);return Tr(o,HM(r)),o}function XM(r,{target:o,replace:d,state:_,preventScrollReset:x,relative:C,viewTransition:b}={}){let c=sM(),Z=Cl(),K=md(r,{relative:C});return Ie.useCallback(ge=>{if(PM(ge,o)){ge.preventDefault();let be=d!==void 0?d:ad(Z)===ad(K);c(r,{replace:be,state:_,preventScrollReset:x,relative:C,viewTransition:b})}},[Z,c,K,d,_,o,r,x,C,b])}var YM=0,KM=()=>`__${String(++YM)}__`;function QM(){let{router:r}=Fw("useSubmit"),{basename:o}=Ie.useContext(Es),d=gM();return Ie.useCallback(async(_,x={})=>{let{action:C,method:b,encType:c,formData:Z,body:K}=EM(_,o);if(x.navigate===!1){let ge=x.fetcherKey||KM();await r.fetch(ge,d,x.action||C,{preventScrollReset:x.preventScrollReset,formData:Z,body:K,formMethod:x.method||b,formEncType:x.encType||c,flushSync:x.flushSync})}else await r.navigate(x.action||C,{preventScrollReset:x.preventScrollReset,formData:Z,body:K,formMethod:x.method||b,formEncType:x.encType||c,replace:x.replace,state:x.state,fromRouteId:d,flushSync:x.flushSync,viewTransition:x.viewTransition})},[r,o,d])}function JM(r,{relative:o}={}){let{basename:d}=Ie.useContext(Es),_=Ie.useContext(co);Tr(_,"useFormAction must be used inside a RouteContext");let[x]=_.matches.slice(-1),C={...md(r||".",{relative:o})},b=Cl();if(r==null){C.search=b.search;let c=new URLSearchParams(C.search),Z=c.getAll("index");if(Z.some(ge=>ge==="")){c.delete("index"),Z.filter(be=>be).forEach(be=>c.append("index",be));let ge=c.toString();C.search=ge?`?${ge}`:""}}return(!r||r===".")&&x.route.index&&(C.search=C.search?C.search.replace(/^\?/,"?index&"):"?index"),d!=="/"&&(C.pathname=C.pathname==="/"?d:to([d,C.pathname])),ad(C)}function eI(r,o={}){let d=Ie.useContext(Iw);Tr(d!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:_}=Fw("useViewTransitionState"),x=md(r,{relative:o.relative});if(!d.isTransitioning)return!1;let C=oo(d.currentLocation.pathname,_)||d.currentLocation.pathname,b=oo(d.nextLocation.pathname,_)||d.nextLocation.pathname;return Of(x.pathname,b)!=null||Of(x.pathname,C)!=null}[...FM];function tI({tiggerAct:r,setTiggerAct:o}){const[d,_]=Ie.useState(!1),x=()=>{o(!r)};function C(){window.innerWidth<768?_(!0):_(!1)}return window.addEventListener("resize",C),Ie.useEffect(()=>{C()}),z.jsxs(_t,{lg:3,md:3,sm:12,children:[z.jsx("div",{className:`${Mh.logo}`,children:z.jsx(wl,{to:"/",children:z.jsx("img",{src:gP,alt:"Logo"})})}),z.jsx("div",{className:r?`${Mh.mobileNavBtn} ${Mh.tigger}`:`${Mh.mobileNavBtn}`,children:z.jsxs("div",{className:d?`${Mh.mobileNavTigger}`:"",onClick:x,children:[z.jsx("span",{}),z.jsx("span",{}),z.jsx("span",{})]})})]})}const rI="_navBar_1k4oy_37",iI="_active_1k4oy_103",nI="_dropdown_1k4oy_149",sI="_mobileMenu_1k4oy_281",oI="_mainMenuActMobile_1k4oy_287",Mc={navBar:rI,active:iI,dropdown:nI,mobileMenu:sI,mainMenuActMobile:oI},Nt=Ie.createContext();function aI({children:r}){const o={navBar:[{text:"Home",link:"/"},{text:"Doctos",link:"/"},{text:"Dropdown",link:"/",dropdown:[{text:"Dropdown 1.1",link:"/"},{text:"Dropdown 1.2",link:"/"},{text:"Dropdown 1.3",link:"/",dropdown:[{text:"Dropdown 2.1",link:"/"},{text:"Dropdown 2.2",link:"/"}]}]},{text:"Pages",link:"#",dropdown:[{text:"404",link:"/404"}]},{text:"Blogs",link:"#",dropdown:[{text:"Blog",link:"/blog"}]},{text:"Contact Us",link:"/contact"}],hero:[{title:"We Provide Medical Services That You Can Trust!",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris sed nisl pellentesque, faucibus libero eu, gravida quam.",bgImg:"slider/slider.jpg",btn:[{text:"Get Appointment",link:"/"},{text:"Learn More",link:"/"}]},{title:"We Provide Medical Services That You Can Trust!",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris sed nisl pellentesque, faucibus libero eu, gravida quam.",bgImg:"slider/slider2.jpg",btn:[{text:"Get Appointment",link:"/"},{text:"About Us",link:"/"}]},{title:"We Provide Medical Services That You Can Trust!",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris sed nisl pellentesque, faucibus libero eu, gravida quam.",bgImg:"slider/slider3.jpg",btn:[{text:"Get Appointment",link:"/"},{text:"Conatct Now",link:"/"}]}],schedule:[{icon:"icofont-ambulance-cross",tagline:"Lorem Amet",title:"Emergency Cases",desc:"Lorem ipsum sit amet consectetur adipiscing elit. Vivamus et erat in lacus convallis sodales.",btnText:"LEARN MORE",btnIcon:"fa-arrow-right-long"},{icon:"icofont-prescription",tagline:"Fusce Porttitor",title:"Doctors Timetable",desc:"Lorem ipsum sit amet consectetur adipiscing elit. Vivamus et erat in lacus convallis sodales.",btnText:"LEARN MORE",btnIcon:"fa-arrow-right-long"},{icon:"icofont-ui-clock",tagline:"Donec luctus",title:"Opening Hours",desc:[{days:"Monday - Friday ",time:"8.00-20.00"},{days:"Saturday ",time:"9.00-18.30"},{days:"Monday - Thusday ",time:"9.00-15.00"}],btnText:"LEARN MORE",btnIcon:"fa-arrow-right-long"}],features:{secTitle:"We Are Always Ready to Help You & Your Family",secDesc:"Lorem ipsum dolor sit amet consectetur adipiscing elit praesent aliquet. pretiumts",featureItems:[{icon:"icofont-ambulance-cross",title:"Emergency Help",desc:"Lorem ipsum sit, consectetur adipiscing elit. Maecenas mi quam vulputate."},{icon:"icofont-medical-sign-alt",title:"Enriched Pharmecy",desc:"Lorem ipsum sit, consectetur adipiscing elit. Maecenas mi quam vulputate."},{icon:"icofont-stethoscope",title:"Medical Treatment",desc:"Lorem ipsum sit, consectetur adipiscing elit. Maecenas mi quam vulputate."}]},funFacts:{item:[{icon:"icofont-home",counter:3468,tagline:"Hospital Rooms"},{icon:"icofont-user-alt-3",counter:557,tagline:"Specialist Doctors"},{icon:"icofont-simple-smile",counter:4379,tagline:"Happy Patients"},{icon:"icofont-table",counter:32,tagline:"Years of Experience"}]},whyChoose:{secTitle:"We Offer Different Services To Improve Your Health",secDesc:"Lorem ipsum dolor sit amet consectetur adipiscing elit praesent aliquet. pretiumts",whoWeAre:{title:"Who We Are",des1:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas pharetra antege vel est lobortis, a commodo magna rhoncus. In quis nisi non emet quam pharetra commodo. ",des2:"Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.",list:[["Maecenas vitae luctus nibh. ","Duis massa massa.","Aliquam feugiat interdum."],["Maecenas vitae luctus nibh. ","Duis massa massa.","Aliquam feugiat interdum.","Aliquam feugiat interdum.","Aliquam feugiat interdum."]]}},callToAction:{secTitle:"Do you need Emergency Medical Care? Call @ 1234 56789",secDesc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque porttitor dictum turpis nec gravida."},portfolio:{secTitle:"We Maintain Cleanliness Rules Inside Our Hospital",secDesc:"Lorem ipsum dolor sit amet consectetur adipiscing elit praesent aliquet. pretiumts",portfolioItem:[{img:"portfolio/pf1.jpg",btnText:"View Details",link:"/portfolio"},{img:"portfolio/pf2.jpg",btnText:"View Details",link:"/portfolio"},{img:"portfolio/pf3.jpg",btnText:"View Details",link:"/portfolio"},{img:"portfolio/pf4.jpg",btnText:"View Details",link:"/portfolio"}],portfolioPage:{secTitle:"Portfolio Single",portfolioSlider:["/call-bg.jpg","/call-bg.jpg","/call-bg.jpg"],portfolioInfo:{date:[{category:"Category :",details:"Heart Surgery"},{category:"Date :",details:"April 20, 2019"},{category:"Client :",details:"Suke Agency"},{category:"Age :",details:"Typo"}],infos:{title:"Here is the name of this project here",desc:["Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor a ti incididunt ut labore et dolore to in magna aliqua. Ut enim ad minim veniam, quis to the in nostrud.abore et dolore magna aliqua uis nostrud.Lorem ipsum dolor sit amet, in a in to in a consectetur.ncididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis to the in nostrud.abore et dolore magna in a aliqua uis nostrud.Lorem ipsum dolor sit amet, in aed do eiusmod","ncididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis to the in nostrud.abore et dolore magna to in aliqua uis nostrud.Lorem ipsum dolor sit amet, in aed do eiusmod.ncididunt ut labore et dolore magna aliqua.","ncididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis to the in nostrud.abore et dolore magna a aliqua uis nostrud.Lorem ipsum dolor sit amet, in aed do eiusmod.ncididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis to the in nostrud.abore et dolore magna aliqua uis nostrud.Lorem ipsum dolor sit amet, in aed do eiusmod. dolor sit amet, in aed do eiusmod.ncididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis to the in nostrud.abore et dolore magna aliqua uis nostrud."]}}}},services:{secTitle:"We Offer Different Services To Improve Your Health",secDesc:"Lorem ipsum dolor sit amet consectetur adipiscing elit praesent aliquet. pretiumts",service:[{icon:"icofont-prescription",title:"General Treatment",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus dictum eros ut imperdiet."},{icon:"icofont-tooth",title:"Teeth Whitening",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus dictum eros ut imperdiet."},{icon:"icofont-heart-alt",title:"Heart Surgery",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus dictum eros ut imperdiet."},{icon:"icofont-listening",title:"Ear Treatment",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus dictum eros ut imperdiet."},{icon:"icofont-eye-alt",title:"Vision Problems",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus dictum eros ut imperdiet."},{icon:"icofont-blood",title:"Blood Transfusion",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus dictum eros ut imperdiet."}]},pricing:{secTitle:"We Provide You The Best Treatment In Resonable Price",secDesc:"Lorem ipsum dolor sit amet consectetur adipiscing elit praesent aliquet. pretiumts",pricesSec:[{icon:"icofont-ui-cut",title:"Plastic Suggery",amount:"$199",visit:"/ Per Visit",priceList:[{check:!0,list:"Lorem ipsum dolor sit"},{check:!0,list:"Cubitur sollicitudin fentum"},{check:!1,list:"Nullam interdum enim"},{check:!1,list:"Donec ultricies metus"},{check:!1,list:"Pellentesque eget nibh"}],btnText:"Book Now"},{icon:"icofont-tooth",title:"Teeth Whitening",amount:"$299",visit:"/ Per Visit",priceList:[{check:!0,list:"Lorem ipsum dolor sit"},{check:!0,list:"Cubitur sollicitudin fentum"},{check:!0,list:"Nullam interdum enim"},{check:!1,list:"Donec ultricies metus"},{check:!1,list:"Pellentesque eget nibh"}],btnText:"Book Now"},{icon:"icofont-heart-beat",title:"Heart Suggery",amount:"$399",visit:"/ Per Visit",priceList:[{check:!0,list:"Lorem ipsum dolor sit"},{check:!0,list:"Cubitur sollicitudin fentum"},{check:!0,list:"Nullam interdum enim"},{check:!0,list:"Donec ultricies metus"},{check:!0,list:"Pellentesque eget nibh"}],btnText:"Book Now",link:"/"}]},blogs:{secTitle:"Keep up with Our Most Recent Medical News.",secDesc:"Lorem ipsum dolor sit amet consectetur adipiscing elit praesent aliquet. pretiumts",blogItems:[{img:"blog/blog1.jpg",date:"22 Aug, 2020",title:"We have annnocuced our new product.",desc:"Lorem ipsum dolor a sit ameti, consectetur adipisicing elit, sed do eiusmod tempor incididunt sed do incididunt sed.",link:""},{img:"blog/blog2.jpg",date:"15 Jul, 2020",title:"Top five way for solving teeth problems.",desc:"Lorem ipsum dolor a sit ameti, consectetur adipisicing elit, sed do eiusmod tempor incididunt sed do incididunt sed.",link:""},{img:"blog/blog3.jpg",date:"05 Jan, 2020",title:"We provide highly business soliutions.",desc:"Lorem ipsum dolor a sit ameti, consectetur adipisicing elit, sed do eiusmod tempor incididunt sed do incididunt sed.",link:""}],blogPage:{secTitle:"Blog Single",news:{newsImg:"blog/blog1.jpg",newsTitle:{title:"More than 80 clinical trials launch to test of the coronavirus .",titleLink:"/"},authorDetails:{authorImg:"author/author1.jpg",authorName:"Aothor Name",postDate:"03 Feb 2019",commentsCount:"05 Comments",viewsCount:"33K Views"},newsTexts:{text1:["Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse facilisis ultricies tortor, nec sollicitudin lorem sagittis vitae. Curabitur rhoncus commodo rutrum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam nec lacus pulvinar, laoreet dolor quis, pellentesque ante. Cras nulla orci, pharetra at dictum consequat, pretium pretium nulla. Suspendisse porttitor nunc a sodales tempor. Mauris sed felis maximus, interdum metus vel, tincidunt diam.","Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam nec lacus pulvinar, laoreet dolor quis, pellentesque ante. Cras nulla orci, pharetra at dictum consequat, pretium pretium nulla. Suspendisse porttitor nunc a sodales tempor. Mauris sed felis maximus, interdum metus vel, tincidunt diam. Nam ac risus vitae sem vehicula egestas. Sed velit nulla, viverra non commod"],text2:["Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse facilisis ultricies tortor, nec sollicitudin lorem sagittis vitae. Curabitur rhoncus commodo rutrum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam nec lacus pulvinar, laoreet dolor quis, pellentesque ante. Cras nulla orci, pharetra at dictum consequat, pretium pretium nulla. Suspendisse porttitor nunc a sodales tempor. Mauris sed felis maximus, interdum metus vel, tincidunt diam."],text3:["Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse facilisis ultricies tortor, nec sollicitudin lorem sagittis vitae. Curabitur rhoncus commodo rutrum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam nec lacus pulvinar, laoreet dolor quis, pellentesque ante. Cras nulla orci, pharetra at dictum consequat, pretium pretium nulla. Suspendisse porttitor nunc a sodales tempor. Mauris sed felis maximus, interdum metus vel, tincidunt diam.","Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse facilisis ultricies tortor, nec sollicitudin lorem sagittis vitae. Curabitur rhoncus commodo rutrum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam nec lacus pulvinar, laoreet dolor quis, pellentesque ante. Cras nulla orci, pharetra at dictum consequat, pretium pretium nulla. Suspendisse porttitor nunc a sodales tempor. Mauris sed felis maximus, interdum metus vel, tincidunt diam."]},newsGallery:["blog/blog2.jpg","blog/blog3.jpg"],blockquoteText:["Aliquam nec lacus pulvinar, laoreet dolor quis, pellentesque ante. Cras nulla orci, pharetra at dictum consequat, pretium pretium nulla. Suspendisse porttitor nunc a sodales tempor. Mauris sed felis maximus, interdum metus vel, tincidunt diam. Nam ac risus vitae sem vehicula egestas. Sed velit nulla, viverra non commodo et, sodales"],comments:{title:"All Comments",comment:[{authorImg:"author/author1.jpg",authorName:"Aothor Name",postDate:"03 Feb 2019",postTime:"03:38 AM",commentText:"Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words Mirum est notare quam littera gothica, quam nunc putamus parum claram, anteposuerit litterarum formas",replayLink:"/"},{authorImg:"author/author2.jpg",authorName:"Aothor Name",postDate:"03 Feb 2019",postTime:"03:38 AM",commentText:"Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words Mirum est notare quam littera gothica, quam nunc putamus parum claram, anteposuerit litterarum formas",replayLink:"/",replay:!0},{authorImg:"author/author3.jpg",authorName:"Aothor Name",postDate:"03 Feb 2019",postTime:"03:38 AM",commentText:"Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words Mirum est notare quam littera gothica, quam nunc putamus parum claram, anteposuerit litterarum formas",replayLink:"/"}],leaveComments:{title:"Leave Comments",form:{input:[{name:"fName",tpye:"text",placeholder:"First name",icon:"fa-user"},{name:"lName",tpye:"text",placeholder:"Last name",icon:"fa-user"},{name:"email",type:"email",placeholder:"Your Email",icon:"fa-envelope"}],msg:[{name:"message",placeholder:"Type Your Message Here",icon:"fa-pencil"}],submitText:"Submit Comment"}}},sideBar:{widget:{categorys:{title:"Blog Categories",categoryItem:["Men's Apparel","Women's Apparel","Bags Collection","Accessories","Sun Glasses"]},recentPost:{title:"Recent post",post:[{img:"blog/blog-sidebar1.jpg",title:"We have annnocuced our new product.",date:"Jan 11, 2020",comments:35},{img:"blog/blog-sidebar2.jpg",title:"Top five way for solving teeth problems.",date:"Jan 11, 2020",comments:35},{img:"blog/blog-sidebar3.jpg",title:"We provide highly business soliutions.",date:"Jan 11, 2020",comments:35}]},tags:{title:"Tagas",tag:["business","wordpress","html","multipurpose","education","template","Ecommerce"]}}}}}},clients:["client/client1.png","client/client2.png","client/client3.png","client/client4.png","client/client5.png"],appointment:{secTitle:"We Are Always Ready to Help You. Book An Appointment",secDesc:"Lorem ipsum dolor sit amet consectetur adipiscing elit praesent aliquet. pretiumts",form:{input:[{name:"name",tpye:"text",placeholder:"Name"},{name:"email",type:"email",placeholder:"Email"},{name:"phone",type:"text",placeholder:"Phone"}],department:["Department","Cardiac Clinic","Neurology","Dentistry","Gastroenterology"],doctor:["Doctor","Dr. Akther Hossain","Dr. Dery Alex","Dr. Jovis Karon"],date:[{name:"date",tpye:"date",placeholder:"Date"}],msg:[{name:"message",placeholder:"Write Your Message Here....."}],submitText:"Book An Appointment",confirmWillText:"( We will be confirm by an Text Message )"}},newsletter:{secTitle:"Sign up for newsletter",secDesc:"Cu qui soleat partiendo urbanitas. Eum aperiri indoctum eu, homero alterum.",form:{input:[{name:"email",type:"email",placeholder:"Your email address"}],submitText:"Subscribe"}},error:{secTitle:"404",tagline:"Oop's  sorry we can't find that page!",secDesc:"Aenean eget sollicitudin lorem, et pretium felis. Nullam euismod diam libero, sed dapibus leo laoreet ut. Suspendisse potenti. Phasellus urna lacus"},contactPage:{secTitle:"Contact Us",secDesc:"If you have any questions please fell free to contact with us.",inputForm:[{type:"text",name:"name",placeholder:"Name"},{type:"email",name:"email",placeholder:"Email"},{type:"text",name:"subject",placeholder:"Subject"},{type:"email",name:"email",placeholder:"Email"}],textareaForm:[{name:"message",placeholder:"Your Message"}],contactInfo:[{icon:"icofont icofont-ui-call",title:"+(000) 1234 56789",desc:"info@company.com"},{icon:"icofont icofont-google-map",title:"2 Fir e Brigade Road",desc:"Chittagonj, Lakshmipur"},{icon:"icofont icofont-wall-clock",title:"Mon - Sat: 8am - 5pm",desc:"Sunday Closed"}],maps:{longitude:90.356331,latitude:23.684994}},footer:{aboutTitle:{secTitle:"About Us",secDesc:"Lorem ipsum dolor sit am consectetur adipisicing elit do eiusmod tempor incididunt ut labore dolore magna."},quickTitle:{secTitle:"Quick Links",secDesc:""},openHourTitle:{secTitle:"Open Hours",secDesc:"Lorem ipsum dolor sit am consectetur adipisicing elit do eiusmod tempor incididunt ut labore dolore magna."},newsletterTitle:{secTitle:"Newsletter",secDesc:"subscribe to our newsletter to get allour news in your inbox.. Lorem ipsum dolor sit amet, consectetur adipisicing elit",input:[{name:"email",tpye:"email",placeholder:"Email Address",btnIcon:"icofont-paper-plane"}]},footerSocial:[{link:"/",icon:"icofont-facebook"},{link:"/",icon:"icofont-google-plus"},{link:"/",icon:"icofont-twitter"},{link:"/",icon:"icofont-vimeo"},{link:"/",icon:"icofont-pinterest"}],quickLinks:{link1:[{link:"/",text:"Home"},{link:"/",text:"About Us"},{link:"/",text:"Services"},{link:"/",text:"Our Cases"},{link:"/",text:"Other Links"}],link2:[{link:"/",text:"Consuling"},{link:"/",text:"Finance"},{link:"/",text:"Testimonials"},{link:"/",text:"FAQ"},{link:"/",text:"Contact Us"}]},openHourSchedule:{schedule:[{days:"Monday - Friday ",time:"8.00-20.00"},{days:"Saturday ",time:"9.00-18.30"},{days:"Monday - Thusday ",time:"9.00-15.00"}]},copyRight:{copyRightText:"© Copyright 2018  |  All Rights Reserved by ",webLink:"/",webText:"wpthemesgrid.com"}}};return z.jsx(Nt.Provider,{value:o,children:r})}function lI({tiggerAct:r}){const{navBar:o}=Ie.useContext(Nt),[d,_]=Ie.useState(!1);function x(){window.innerWidth<768?_(!0):_(!1)}window.addEventListener("resize",x),Ie.useEffect(()=>{x()});const C=b=>z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fa fa-angle-down"}),z.jsx("ul",{className:`${Mc.dropdown}`,children:b.map((c,Z)=>z.jsxs("li",{children:[z.jsx(wl,{to:c.link,children:c.text}),c.dropdown&&C(c.dropdown)]},Z))})]});return z.jsx(_t,{lg:7,md:9,sm:12,children:z.jsx("div",{className:r?`${Mc.mainMenuActMobile}`:"",children:z.jsx("nav",{className:"navigation",children:z.jsx("ul",{className:d?`${Mc.navBar} ${Mc.mobileMenu}`:`${Mc.navBar}`,children:o.map((b,c)=>{const{text:Z,link:K,dropdown:ge}=b;return z.jsxs("li",{className:Z=="Home"?`${Mc.active}`:"",children:[z.jsx(wl,{to:K,children:Z}),ge&&C(ge)," "]},c)})})})})})}const cI="_getQuote_1w4ab_1",uI="_btn_1w4ab_9",e1={getQuote:cI,btn:uI};function hI(){return z.jsx(_t,{lg:2,sm:12,children:z.jsx("div",{className:`${e1.getQuote}`,children:z.jsx("a",{href:"appointment.html",className:`${e1.btn} btn`,children:"Book Appointment"})})})}const dI="_headerInner_nt6xg_1",pI="_inner_nt6xg_47",t1={headerInner:dI,inner:pI};function fI({tiggerAct:r,setTiggerAct:o}){const[d,_]=Ie.useState(!1);function x(){window.scrollY>200?_(!0):_(!1)}return window.addEventListener("scroll",x),z.jsx("div",{className:d?`${t1.headerInner}`:"",children:z.jsx(_r,{children:z.jsx("div",{className:`${t1.inner}`,children:z.jsxs(jt,{children:[z.jsx(tI,{tiggerAct:r,setTiggerAct:o}),z.jsx(lI,{tiggerAct:r}),z.jsx(hI,{})]})})})})}function mI({children:r}){const[o,d]=Ie.useState(!1);return z.jsxs(z.Fragment,{children:[z.jsx(mP,{}),z.jsx(fI,{tiggerAct:o,setTiggerAct:d}),r]})}const gI="/mediplus/section-img.png",_I="_sectionTitle_hl8yc_1",yI={sectionTitle:_I};function Pl({title:r,desc:o}){return z.jsx(_t,{lg:12,children:z.jsxs("div",{className:`${yI.sectionTitle}`,children:[z.jsx("h2",{children:r}),z.jsx("img",{src:gI,alt:"#"}),z.jsx("p",{children:o})]})})}const vI="_singleFeatures_6gxlw_25",xI="_signleIcon_6gxlw_57",r1={singleFeatures:vI,signleIcon:xI};function bI({icon:r,title:o,desc:d,extraClass:_}){return z.jsx(_t,{lg:4,sm:12,children:z.jsxs("div",{className:`${r1.singleFeatures} ${_}`,children:[z.jsx("div",{className:`${r1.signleIcon}`,children:z.jsx("i",{className:`icofont ${r}`})}),z.jsx("h3",{children:o}),z.jsx("p",{children:d})]})})}function wI(){const{features:r}=Ie.useContext(Nt),{secTitle:o,secDesc:d,featureItems:_}=r;return z.jsx("section",{className:"Feautes section",children:z.jsxs(_r,{children:[z.jsx(jt,{children:z.jsx(Pl,{title:o,desc:d})}),z.jsx(jt,{children:_.map((x,C)=>{const b=C==2?"last":"";return z.jsx(bI,{extraClass:b,icon:x.icon,title:x.title,desc:x.desc},Math.random())})})]})})}const TI="_funFacts_cfe4k_7",SI="_section_cfe4k_13",CI="_singleFun_cfe4k_31",PI="_content_cfe4k_97",Uh={funFacts:TI,section:SI,singleFun:CI,content:PI};function MI({icon:r,counter:o,tagline:d}){return z.jsx(_t,{lg:3,md:6,sm:12,children:z.jsxs("div",{className:`${Uh.singleFun}`,children:[z.jsx("i",{className:`icofont ${r}`}),z.jsxs("div",{className:`${Uh.content}`,children:[z.jsx("span",{className:`${Uh.counter}`,children:o}),z.jsx("p",{children:d})]})]})})}function II(){const{funFacts:r}=Ie.useContext(Nt),{item:o}=r;return z.jsx("div",{id:"fun-facts",className:`${Uh.funFacts} ${Uh.section} overlay`,children:z.jsx(_r,{children:z.jsx(jt,{children:o.map(d=>z.jsx(MI,{icon:d.icon,counter:d.counter,tagline:d.tagline},Math.random()))})})})}const EI="_chooseLeft_6u8lh_7",kI="_list_6u8lh_47",zI="_whyChoose_6u8lh_89",AI="_chooseRight_6u8lh_95",RI="_video_6u8lh_113",DI="_waves_6u8lh_157",LI="_wave1_6u8lh_217",jI="_wave2_6u8lh_225",FI="_wave3_6u8lh_233",rs={chooseLeft:EI,list:kI,whyChoose:zI,chooseRight:AI,video:RI,waves:DI,wave1:LI,wave2:jI,wave3:FI};function BI({list:r}){return z.jsx(_t,{lg:6,children:z.jsx("ul",{className:`${rs.list}`,children:r.map((o,d)=>z.jsxs("li",{children:[z.jsx("i",{className:"fa fa-caret-right"}),o," "]},d))})})}function OI(){return z.jsxs("div",{className:"videoImage",children:[z.jsx("div",{className:"promo-video",children:z.jsxs("div",{className:"wavesBlock",children:[z.jsx("div",{className:`${rs.waves} ${rs.wave1}`}),z.jsx("div",{className:`${rs.waves} ${rs.wave2}`}),z.jsx("div",{className:`${rs.waves} ${rs.wave3}`})]})}),z.jsx("a",{href:"https://www.youtube.com/watch?v=RFVXy6CRVR4",className:`${rs.video} video-popup mfp-iframe`,children:z.jsx("i",{className:"fa fa-play"})})]})}function NI(){const{whyChoose:{whoWeAre:{title:r,des1:o,des2:d,list:_}}}=Ie.useContext(Nt);return z.jsxs(z.Fragment,{children:[z.jsx(_t,{lg:6,sm:12,children:z.jsxs("div",{className:`${rs.chooseLeft}`,children:[z.jsx("h3",{children:r}),z.jsx("p",{children:o}),z.jsx("p",{children:d}),z.jsx(jt,{children:_.map((x,C)=>z.jsx(BI,{list:x},C))})]})}),z.jsx(_t,{lg:6,sm:12,children:z.jsx("div",{className:`${rs.chooseRight}`,children:z.jsx(OI,{})})})]})}function $I(){const{whyChoose:{secTitle:r,secDesc:o}}=Ie.useContext(Nt);return z.jsx("section",{className:`${rs.whyChoose} section}`,children:z.jsxs(_r,{children:[z.jsx(jt,{children:z.jsx(Pl,{title:r,desc:o})}),z.jsx(jt,{children:z.jsx(NI,{})})]})})}const VI="_schedule_1v6s9_7",UI="_scheduleInner_1v6s9_19",ZI="_singleSchedule_1v6s9_29",GI="_inner_1v6s9_53",qI="_icon_1v6s9_115",WI="_timeSidual_1v6s9_231",Vc={schedule:VI,scheduleInner:UI,singleSchedule:ZI,inner:GI,icon:qI,timeSidual:WI};function HI({icon:r,title:o,tagline:d,desc:_,btnTxt:x,btnIcon:C}){return z.jsx(_t,{lg:4,md:6,sm:12,children:z.jsx("div",{className:`${Vc.singleSchedule}`,children:z.jsxs("div",{className:`${Vc.inner}`,children:[z.jsx("div",{className:`${Vc.icon}`,children:z.jsx("i",{className:`fa ${r}`})}),z.jsxs("div",{className:"single-content",children:[z.jsx("span",{children:d}),z.jsx("h4",{children:o}),z.jsx("ul",{className:Vc.timeSidual,children:_ instanceof Array?_.map((b,c)=>z.jsxs("li",{className:"day",children:[b.days," ",z.jsx("span",{children:b.time})]},c)):z.jsx("p",{children:_})}),z.jsxs("a",{href:"#",children:[x,z.jsx("i",{className:`fa-solid ${C}`})]})]})]})})})}function XI(){const{schedule:r}=Ie.useContext(Nt);return z.jsx("section",{className:`${Vc.schedule}`,children:z.jsx(_r,{children:z.jsx("div",{className:`${Vc.scheduleInner}`,children:z.jsx(jt,{children:r.map(o=>z.jsx(HI,{icon:o.icon,title:o.title,tagline:o.tagline,desc:o.desc,btnTxt:o.btnText,btnIcon:o.btnIcon},Math.random()))})})})})}const YI="_callAction_jjn8m_7",KI="_content_jjn8m_29",QI="_button_jjn8m_59",JI="_btn_jjn8m_59",eE="_second_jjn8m_93",Ic={callAction:YI,content:KI,button:QI,btn:JI,second:eE};function tE(){const{callToAction:{secTitle:r,secDesc:o}}=Ie.useContext(Nt);return z.jsx("section",{className:`${Ic.callAction} overlay`,"data-stellar-background-ratio":"0.5",children:z.jsx(_r,{children:z.jsx(jt,{children:z.jsx(_t,{lg:12,md:12,children:z.jsxs("div",{className:`${Ic.content}`,children:[z.jsx("h2",{children:r}),z.jsx("p",{children:o}),z.jsxs("div",{className:`${Ic.button}`,children:[z.jsx("a",{href:"#",className:`${Ic.btn} btn`,children:"Contact Now"}),z.jsxs("a",{href:"#",className:`${Ic.btn} btn ${Ic.second}`,children:["Learn More",z.jsx("i",{className:"fa fa-long-arrow-right"})]})]})]})})})})})}const rE="_portfolio_2sw85_7",iE="_singlePf_2sw85_13",nE="_btn_2sw85_65",W_={portfolio:rE,singlePf:iE,btn:nE};function sE({img:r,btnText:o,link:d}){return z.jsxs("div",{className:`${W_.singlePf}`,children:[z.jsx("img",{src:r,alt:"#"}),z.jsx(wl,{to:d,className:`${W_.btn} btn`,children:o})]})}var Bw={exports:{}};(function(r,o){(function(d,_){r.exports=_(Ie)})(s1,function(d){var _="default"in d?d.default:d;/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation. All rights reserved.
	    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	    this file except in compliance with the License. You may obtain a copy of the
	    License at http://www.apache.org/licenses/LICENSE-2.0

	    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	    MERCHANTABLITY OR NON-INFRINGEMENT.

	    See the Apache Version 2.0 License for specific language governing permissions
	    and limitations under the License.
	    ***************************************************************************** */var x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,H){O.__proto__=H}||function(O,H){for(var ue in H)H.hasOwnProperty(ue)&&(O[ue]=H[ue])};function C(O,H){x(O,H);function ue(){this.constructor=O}O.prototype=H===null?Object.create(H):(ue.prototype=H.prototype,new ue)}var b=Object.assign||function(H){for(var ue,Pe=1,pe=arguments.length;Pe<pe;Pe++){ue=arguments[Pe];for(var E in ue)Object.prototype.hasOwnProperty.call(ue,E)&&(H[E]=ue[E])}return H};function c(O,H){var ue={};for(var Pe in O)Object.prototype.hasOwnProperty.call(O,Pe)&&H.indexOf(Pe)<0&&(ue[Pe]=O[Pe]);if(O!=null&&typeof Object.getOwnPropertySymbols=="function")for(var pe=0,Pe=Object.getOwnPropertySymbols(O);pe<Pe.length;pe++)H.indexOf(Pe[pe])<0&&(ue[Pe[pe]]=O[Pe[pe]]);return ue}(function(O,H,ue,Pe){function pe(E,R){this.settings=null,this.options=O.extend({},pe.Defaults,R),this.$element=O(E),this._handlers={},this._plugins={},this._supress={},this._current=null,this._speed=null,this._coordinates=[],this._breakpoint=null,this._width=null,this._items=[],this._clones=[],this._mergers=[],this._widths=[],this._invalidated={},this._pipe=[],this._drag={time:null,target:null,pointer:null,stage:{start:null,current:null},direction:null},this._states={current:{},tags:{initializing:["busy"],animating:["busy"],dragging:["interacting"]}},O.each(["onResize","onThrottledResize"],O.proxy(function(N,re){this._handlers[re]=O.proxy(this[re],this)},this)),O.each(pe.Plugins,O.proxy(function(N,re){this._plugins[N.charAt(0).toLowerCase()+N.slice(1)]=new re(this)},this)),O.each(pe.Workers,O.proxy(function(N,re){this._pipe.push({filter:re.filter,run:O.proxy(re.run,this)})},this)),this.setup(),this.initialize()}pe.Defaults={items:3,loop:!1,center:!1,rewind:!1,checkVisibility:!0,mouseDrag:!0,touchDrag:!0,pullDrag:!0,freeDrag:!1,margin:0,stagePadding:0,merge:!1,mergeFit:!0,autoWidth:!1,startPosition:0,rtl:!1,smartSpeed:250,fluidSpeed:!1,dragEndSpeed:!1,responsive:{},responsiveRefreshRate:200,responsiveBaseElement:H,fallbackEasing:"swing",slideTransition:"",info:!1,nestedItemSelector:!1,itemElement:"div",stageElement:"div",refreshClass:"owl-refresh",loadedClass:"owl-loaded",loadingClass:"owl-loading",rtlClass:"owl-rtl",responsiveClass:"owl-responsive",dragClass:"owl-drag",itemClass:"owl-item",stageClass:"owl-stage",stageOuterClass:"owl-stage-outer",grabClass:"owl-grab"},pe.Width={Default:"default",Inner:"inner",Outer:"outer"},pe.Type={Event:"event",State:"state"},pe.Plugins={},pe.Workers=[{filter:["width","settings"],run:function(){this._width=this.$element.width()}},{filter:["width","items","settings"],run:function(E){E.current=this._items&&this._items[this.relative(this._current)]}},{filter:["items","settings"],run:function(){this.$stage.children(".cloned").remove()}},{filter:["width","items","settings"],run:function(E){var R=this.settings.margin||"",N=!this.settings.autoWidth,re=this.settings.rtl,Te={width:"auto","margin-left":re?R:"","margin-right":re?"":R};!N&&this.$stage.children().css(Te),E.css=Te}},{filter:["width","items","settings"],run:function(E){var R=(this.width()/this.settings.items).toFixed(3)-this.settings.margin,N=null,re=this._items.length,Te=!this.settings.autoWidth,Ce=[];for(E.items={merge:!1,width:R};re--;)N=this._mergers[re],N=this.settings.mergeFit&&Math.min(N,this.settings.items)||N,E.items.merge=N>1||E.items.merge,Ce[re]=Te?R*N:this._items[re].width();this._widths=Ce}},{filter:["items","settings"],run:function(){var E=[],R=this._items,N=this.settings,re=Math.max(N.items*2,4),Te=Math.ceil(R.length/2)*2,Ce=N.loop&&R.length?N.rewind?re:Math.max(re,Te):0,Ne="",Ge="";for(Ce/=2;Ce>0;)E.push(this.normalize(E.length/2,!0)),Ne=Ne+R[E[E.length-1]][0].outerHTML,E.push(this.normalize(R.length-1-(E.length-1)/2,!0)),Ge=R[E[E.length-1]][0].outerHTML+Ge,Ce-=1;this._clones=E,O(Ne).addClass("cloned").appendTo(this.$stage),O(Ge).addClass("cloned").prependTo(this.$stage)}},{filter:["width","items","settings"],run:function(){for(var E=this.settings.rtl?1:-1,R=this._clones.length+this._items.length,N=-1,re=0,Te=0,Ce=[];++N<R;)re=Ce[N-1]||0,Te=this._widths[this.relative(N)]+this.settings.margin,Ce.push(re+Te*E);this._coordinates=Ce}},{filter:["width","items","settings"],run:function(){var E=this.settings.stagePadding,R=this._coordinates,N={width:Math.ceil(Math.abs(R[R.length-1]))+E*2,"padding-left":E||"","padding-right":E||""};this.$stage.css(N)}},{filter:["width","items","settings"],run:function(E){var R=this._coordinates.length,N=!this.settings.autoWidth,re=this.$stage.children();if(N&&E.items.merge)for(;R--;)E.css.width=this._widths[this.relative(R)],re.eq(R).css(E.css);else N&&(E.css.width=E.items.width,re.css(E.css))}},{filter:["items"],run:function(){this._coordinates.length<1&&this.$stage.removeAttr("style")}},{filter:["width","items","settings"],run:function(E){E.current=E.current?this.$stage.children().index(E.current):0,E.current=Math.max(this.minimum(),Math.min(this.maximum(),E.current)),this.reset(E.current)}},{filter:["position"],run:function(){this.animate(this.coordinates(this._current))}},{filter:["width","position","items","settings"],run:function(){var E=this.settings.rtl?1:-1,R=this.settings.stagePadding*2,N=this.coordinates(this.current())+R,re=N+this.width()*E,Te,Ce,Ne=[],Ge,ht;for(Ge=0,ht=this._coordinates.length;Ge<ht;Ge++)Te=this._coordinates[Ge-1]||0,Ce=Math.abs(this._coordinates[Ge])+R*E,(this.op(Te,"<=",N)&&this.op(Te,">",re)||this.op(Ce,"<",N)&&this.op(Ce,">",re))&&Ne.push(Ge);this.$stage.children(".active").removeClass("active"),this.$stage.children(":eq("+Ne.join("), :eq(")+")").addClass("active"),this.$stage.children(".center").removeClass("center"),this.settings.center&&this.$stage.children().eq(this.current()).addClass("center")}}],pe.prototype.initializeStage=function(){this.$stage=this.$element.find("."+this.settings.stageClass),!this.$stage.length&&(this.$element.addClass(this.options.loadingClass),this.$stage=O("<"+this.settings.stageElement+">",{class:this.settings.stageClass}).wrap(O("<div/>",{class:this.settings.stageOuterClass})),this.$element.append(this.$stage.parent()))},pe.prototype.initializeItems=function(){var E=this.$element.find(".owl-item");if(E.length){this._items=E.get().map(function(R){return O(R)}),this._mergers=this._items.map(function(){return 1}),this.refresh();return}this.replace(this.$element.children().not(this.$stage.parent())),this.isVisible()?this.refresh():this.invalidate("width"),this.$element.removeClass(this.options.loadingClass).addClass(this.options.loadedClass)},pe.prototype.initialize=function(){if(this.enter("initializing"),this.trigger("initialize"),this.$element.toggleClass(this.settings.rtlClass,this.settings.rtl),this.settings.autoWidth&&!this.is("pre-loading")){var E,R,N;E=this.$element.find("img"),R=this.settings.nestedItemSelector?"."+this.settings.nestedItemSelector:Pe,N=this.$element.children(R).width(),E.length&&N<=0&&this.preloadAutoWidthImages(E)}this.initializeStage(),this.initializeItems(),this.registerEventHandlers(),this.leave("initializing"),this.trigger("initialized")},pe.prototype.isVisible=function(){return this.settings.checkVisibility?this.$element.is(":visible"):!0},pe.prototype.setup=function(){var E=this.viewport(),R=this.options.responsive,N=-1,re=null;R?(O.each(R,function(Te){Te<=E&&Te>N&&(N=Number(Te))}),re=O.extend({},this.options,R[N]),typeof re.stagePadding=="function"&&(re.stagePadding=re.stagePadding()),delete re.responsive,re.responsiveClass&&this.$element.attr("class",this.$element.attr("class").replace(new RegExp("("+this.options.responsiveClass+"-)\\S+\\s","g"),"$1"+N))):re=O.extend({},this.options),this.trigger("change",{property:{name:"settings",value:re}}),this._breakpoint=N,this.settings=re,this.invalidate("settings"),this.trigger("changed",{property:{name:"settings",value:this.settings}})},pe.prototype.optionsLogic=function(){this.settings.autoWidth&&(this.settings.stagePadding=!1,this.settings.merge=!1)},pe.prototype.prepare=function(E){var R=this.trigger("prepare",{content:E});return R.data||(R.data=O("<"+this.settings.itemElement+"/>").addClass(this.options.itemClass).append(E)),this.trigger("prepared",{content:R.data}),R.data},pe.prototype.update=function(){for(var E=0,R=this._pipe.length,N=O.proxy(function(Te){return this[Te]},this._invalidated),re={};E<R;)(this._invalidated.all||O.grep(this._pipe[E].filter,N).length>0)&&this._pipe[E].run(re),E++;this._invalidated={},!this.is("valid")&&this.enter("valid")},pe.prototype.width=function(E){switch(E=E||pe.Width.Default,E){case pe.Width.Inner:case pe.Width.Outer:return this._width;default:return this._width-this.settings.stagePadding*2+this.settings.margin}},pe.prototype.refresh=function(){this.enter("refreshing"),this.trigger("refresh"),this.setup(),this.optionsLogic(),this.$element.addClass(this.options.refreshClass),this.update(),this.$element.removeClass(this.options.refreshClass),this.leave("refreshing"),this.trigger("refreshed")},pe.prototype.onThrottledResize=function(){H.clearTimeout(this.resizeTimer),this.resizeTimer=H.setTimeout(this._handlers.onResize,this.settings.responsiveRefreshRate)},pe.prototype.onResize=function(){if(!this._items.length||this._width===this.$element.width()||!this.isVisible())return!1;if(this.enter("resizing"),this.trigger("resize").isDefaultPrevented())return this.leave("resizing"),!1;this.invalidate("width"),this.refresh(),this.leave("resizing"),this.trigger("resized")},pe.prototype.registerEventHandlers=function(){O.support.transition&&this.$stage.on(O.support.transition.end+".owl.core",O.proxy(this.onTransitionEnd,this)),this.settings.responsive!==!1&&this.on(H,"resize",this._handlers.onThrottledResize),this.settings.mouseDrag&&(this.$element.addClass(this.options.dragClass),this.$stage.on("mousedown.owl.core",O.proxy(this.onDragStart,this)),this.$stage.on("dragstart.owl.core selectstart.owl.core",function(){return!1})),this.settings.touchDrag&&(this.$stage.on("touchstart.owl.core",O.proxy(this.onDragStart,this)),this.$stage.on("touchcancel.owl.core",O.proxy(this.onDragEnd,this)))},pe.prototype.onDragStart=function(E){var R=null;E.which!==3&&(O.support.transform?(R=this.$stage.css("transform").replace(/.*\(|\)| /g,"").split(","),R={x:R[R.length===16?12:4],y:R[R.length===16?13:5]}):(R=this.$stage.position(),R={x:this.settings.rtl?R.left+this.$stage.width()-this.width()+this.settings.margin:R.left,y:R.top}),this.is("animating")&&(O.support.transform?this.animate(R.x):this.$stage.stop(),this.invalidate("position")),this.$element.toggleClass(this.options.grabClass,E.type==="mousedown"),this.speed(0),this._drag.time=new Date().getTime(),this._drag.target=O(E.target),this._drag.stage.start=R,this._drag.stage.current=R,this._drag.pointer=this.pointer(E),O(ue).on("mouseup.owl.core touchend.owl.core",O.proxy(this.onDragEnd,this)),O(ue).one("mousemove.owl.core touchmove.owl.core",O.proxy(function(N){var re=this.difference(this._drag.pointer,this.pointer(N));O(ue).on("mousemove.owl.core touchmove.owl.core",O.proxy(this.onDragMove,this)),!(Math.abs(re.x)<Math.abs(re.y)&&this.is("valid"))&&(N.preventDefault(),this.enter("dragging"),this.trigger("drag"))},this)))},pe.prototype.onDragMove=function(E){var R=null,N=null,re=null,Te=this.difference(this._drag.pointer,this.pointer(E)),Ce=this.difference(this._drag.stage.start,Te);this.is("dragging")&&(E.preventDefault(),this.settings.loop?(R=this.coordinates(this.minimum()),N=this.coordinates(this.maximum()+1)-R,Ce.x=((Ce.x-R)%N+N)%N+R):(R=this.settings.rtl?this.coordinates(this.maximum()):this.coordinates(this.minimum()),N=this.settings.rtl?this.coordinates(this.minimum()):this.coordinates(this.maximum()),re=this.settings.pullDrag?-1*Te.x/5:0,Ce.x=Math.max(Math.min(Ce.x,R+re),N+re)),this._drag.stage.current=Ce,this.animate(Ce.x))},pe.prototype.onDragEnd=function(E){var R=this.difference(this._drag.pointer,this.pointer(E)),N=this._drag.stage.current,re=R.x>0^this.settings.rtl?"left":"right";O(ue).off(".owl.core"),this.$element.removeClass(this.options.grabClass),(R.x!==0&&this.is("dragging")||!this.is("valid"))&&(this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed),this.current(this.closest(N.x,R.x!==0?re:this._drag.direction)),this.invalidate("position"),this.update(),this._drag.direction=re,(Math.abs(R.x)>3||new Date().getTime()-this._drag.time>300)&&this._drag.target.one("click.owl.core",function(){return!1})),this.is("dragging")&&(this.leave("dragging"),this.trigger("dragged"))},pe.prototype.closest=function(E,R){var N=-1,re=30,Te=this.width(),Ce=this.coordinates();return this.settings.freeDrag||O.each(Ce,O.proxy(function(Ne,Ge){return R==="left"&&E>Ge-re&&E<Ge+re?N=Ne:R==="right"&&E>Ge-Te-re&&E<Ge-Te+re?N=Ne+1:this.op(E,"<",Ge)&&this.op(E,">",Ce[Ne+1]!==Pe?Ce[Ne+1]:Ge-Te)&&(N=R==="left"?Ne+1:Ne),N===-1},this)),this.settings.loop||(this.op(E,">",Ce[this.minimum()])?N=E=this.minimum():this.op(E,"<",Ce[this.maximum()])&&(N=E=this.maximum())),N},pe.prototype.animate=function(E){var R=this.speed()>0;this.is("animating")&&this.onTransitionEnd(),R&&(this.enter("animating"),this.trigger("translate")),O.support.transform3d&&O.support.transition?this.$stage.css({transform:"translate3d("+E+"px,0px,0px)",transition:this.speed()/1e3+"s"+(this.settings.slideTransition?" "+this.settings.slideTransition:"")}):R?this.$stage.animate({left:E+"px"},this.speed(),this.settings.fallbackEasing,O.proxy(this.onTransitionEnd,this)):this.$stage.css({left:E+"px"})},pe.prototype.is=function(E){return this._states.current[E]&&this._states.current[E]>0},pe.prototype.current=function(E){if(E===Pe)return this._current;if(this._items.length===0)return Pe;if(E=this.normalize(E),this._current!==E){var R=this.trigger("change",{property:{name:"position",value:E}});R.data!==Pe&&(E=this.normalize(R.data)),this._current=E,this.invalidate("position"),this.trigger("changed",{property:{name:"position",value:this._current}})}return this._current},pe.prototype.invalidate=function(E){return O.type(E)==="string"&&(this._invalidated[E]=!0,this.is("valid")&&this.leave("valid")),O.map(this._invalidated,function(R,N){return N})},pe.prototype.reset=function(E){E=this.normalize(E),E!==Pe&&(this._speed=0,this._current=E,this.suppress(["translate","translated"]),this.animate(this.coordinates(E)),this.release(["translate","translated"]))},pe.prototype.normalize=function(E,R){var N=this._items.length,re=R?0:this._clones.length;return!this.isNumeric(E)||N<1?E=Pe:(E<0||E>=N+re)&&(E=((E-re/2)%N+N)%N+re/2),E},pe.prototype.relative=function(E){return E-=this._clones.length/2,this.normalize(E,!0)},pe.prototype.maximum=function(E){var R=this.settings,N=this._coordinates.length,re,Te,Ce;if(R.loop)N=this._clones.length/2+this._items.length-1;else if(R.autoWidth||R.merge){if(re=this._items.length,re)for(Te=this._items[--re].width(),Ce=this.$element.width();re--&&(Te+=this._items[re].width()+this.settings.margin,!(Te>Ce)););N=re+1}else R.center?N=this._items.length-1:N=this._items.length-R.items;return E&&(N-=this._clones.length/2),Math.max(N,0)},pe.prototype.minimum=function(E){return E?0:this._clones.length/2},pe.prototype.items=function(E){return E===Pe?this._items.slice():(E=this.normalize(E,!0),this._items[E])},pe.prototype.mergers=function(E){return E===Pe?this._mergers.slice():(E=this.normalize(E,!0),this._mergers[E])},pe.prototype.clones=function(E){var R=this._clones.length/2,N=R+this._items.length,re=function(Te){return Te%2===0?N+Te/2:R-(Te+1)/2};return E===Pe?O.map(this._clones,function(Te,Ce){return re(Ce)}):O.map(this._clones,function(Te,Ce){return Te===E?re(Ce):null})},pe.prototype.speed=function(E){return E!==Pe&&(this._speed=E),this._speed},pe.prototype.coordinates=function(E){var R=1,N=E-1,re;return E===Pe?O.map(this._coordinates,O.proxy(function(Te,Ce){return this.coordinates(Ce)},this)):(this.settings.center?(this.settings.rtl&&(R=-1,N=E+1),re=this._coordinates[E],re+=(this.width()-re+(this._coordinates[N]||0))/2*R):re=this._coordinates[N]||0,re=Math.ceil(re),re)},pe.prototype.duration=function(E,R,N){return N===0?0:Math.min(Math.max(Math.abs(R-E),1),6)*Math.abs(N||this.settings.smartSpeed)},pe.prototype.to=function(E,R){var N=this.current(),re=null,Te=E-this.relative(N),Ce=(Te>0)-(Te<0),Ne=this._items.length,Ge=this.minimum(),ht=this.maximum();this.settings.loop?(!this.settings.rewind&&Math.abs(Te)>Ne/2&&(Te+=Ce*-1*Ne),E=N+Te,re=((E-Ge)%Ne+Ne)%Ne+Ge,re!==E&&re-Te<=ht&&re-Te>0&&(N=re-Te,E=re,this.reset(N))):this.settings.rewind?(ht+=1,E=(E%ht+ht)%ht):E=Math.max(Ge,Math.min(ht,E)),this.speed(this.duration(N,E,R)),this.current(E),this.isVisible()&&this.update()},pe.prototype.next=function(E){E=E||!1,this.to(this.relative(this.current())+1,E)},pe.prototype.prev=function(E){E=E||!1,this.to(this.relative(this.current())-1,E)},pe.prototype.onTransitionEnd=function(E){if(E!==Pe&&(E.stopPropagation(),(E.target||E.srcElement||E.originalTarget)!==this.$stage.get(0)))return!1;this.leave("animating"),this.trigger("translated")},pe.prototype.viewport=function(){var E;return this.options.responsiveBaseElement!==H?E=O(this.options.responsiveBaseElement).width():H.innerWidth?E=H.innerWidth:ue.documentElement&&ue.documentElement.clientWidth?E=ue.documentElement.clientWidth:console.warn("Can not detect viewport width."),E},pe.prototype.replace=function(E){this.$stage.empty(),this._items=[],E&&(E=E instanceof jQuery?E:O(E)),this.settings.nestedItemSelector&&(E=E.find("."+this.settings.nestedItemSelector)),E.filter(function(){return this.nodeType===1}).each(O.proxy(function(R,N){N=this.prepare(N),this.$stage.append(N),this._items.push(N),this._mergers.push(N.find("[data-merge]").addBack("[data-merge]").attr("data-merge")*1||1)},this)),this.reset(this.isNumeric(this.settings.startPosition)?this.settings.startPosition:0),this.invalidate("items")},pe.prototype.add=function(E,R){var N=this.relative(this._current);R=R===Pe?this._items.length:this.normalize(R,!0),E=E instanceof jQuery?E:O(E),this.trigger("add",{content:E,position:R}),E=this.prepare(E),this._items.length===0||R===this._items.length?(this._items.length===0&&this.$stage.append(E),this._items.length!==0&&this._items[R-1].after(E),this._items.push(E),this._mergers.push(E.find("[data-merge]").addBack("[data-merge]").attr("data-merge")*1||1)):(this._items[R].before(E),this._items.splice(R,0,E),this._mergers.splice(R,0,E.find("[data-merge]").addBack("[data-merge]").attr("data-merge")*1||1)),this._items[N]&&this.reset(this._items[N].index()),this.invalidate("items"),this.trigger("added",{content:E,position:R})},pe.prototype.remove=function(E){E=this.normalize(E,!0),E!==Pe&&(this.trigger("remove",{content:this._items[E],position:E}),this._items[E].remove(),this._items.splice(E,1),this._mergers.splice(E,1),this.invalidate("items"),this.trigger("removed",{content:null,position:E}))},pe.prototype.preloadAutoWidthImages=function(E){E.each(O.proxy(function(R,N){this.enter("pre-loading"),N=O(N),O(new Image).one("load",O.proxy(function(re){N.attr("src",re.target.src),N.css("opacity",1),this.leave("pre-loading"),!this.is("pre-loading")&&!this.is("initializing")&&this.refresh()},this)).attr("src",N.attr("src")||N.attr("data-src")||N.attr("data-src-retina"))},this))},pe.prototype.destroy=function(){this.$element.off(".owl.core"),this.$stage.off(".owl.core"),O(ue).off(".owl.core"),this.settings.responsive!==!1&&(H.clearTimeout(this.resizeTimer),this.off(H,"resize",this._handlers.onThrottledResize));for(var E in this._plugins)this._plugins[E].destroy();this.$stage.children(".cloned").remove(),this.$stage.unwrap(),this.$stage.children().contents().unwrap(),this.$stage.children().unwrap(),this.$stage.remove(),this.$element.removeClass(this.options.refreshClass).removeClass(this.options.loadingClass).removeClass(this.options.loadedClass).removeClass(this.options.rtlClass).removeClass(this.options.dragClass).removeClass(this.options.grabClass).attr("class",this.$element.attr("class").replace(new RegExp(this.options.responsiveClass+"-\\S+\\s","g"),"")).removeData("owl.carousel")},pe.prototype.op=function(E,R,N){var re=this.settings.rtl;switch(R){case"<":return re?E>N:E<N;case">":return re?E<N:E>N;case">=":return re?E<=N:E>=N;case"<=":return re?E>=N:E<=N}},pe.prototype.on=function(E,R,N,re){E.addEventListener?E.addEventListener(R,N,re):E.attachEvent&&E.attachEvent("on"+R,N)},pe.prototype.off=function(E,R,N,re){E.removeEventListener?E.removeEventListener(R,N,re):E.detachEvent&&E.detachEvent("on"+R,N)},pe.prototype.trigger=function(E,R,N,re,Te){var Ce={item:{count:this._items.length,index:this.current()}},Ne=O.camelCase(O.grep(["on",E,N],function(ht){return ht}).join("-").toLowerCase()),Ge=O.Event([E,"owl",N||"carousel"].join(".").toLowerCase(),O.extend({relatedTarget:this},Ce,R));return this._supress[E]||(O.each(this._plugins,function(ht,dt){dt.onTrigger&&dt.onTrigger(Ge)}),this.register({type:pe.Type.Event,name:E}),this.$element.trigger(Ge),this.settings&&typeof this.settings[Ne]=="function"&&this.settings[Ne].call(this,Ge)),Ge},pe.prototype.enter=function(E){O.each([E].concat(this._states.tags[E]||[]),O.proxy(function(R,N){this._states.current[N]===Pe&&(this._states.current[N]=0),this._states.current[N]++},this))},pe.prototype.leave=function(E){O.each([E].concat(this._states.tags[E]||[]),O.proxy(function(R,N){this._states.current[N]--},this))},pe.prototype.register=function(E){if(E.type===pe.Type.Event){if(O.event.special[E.name]||(O.event.special[E.name]={}),!O.event.special[E.name].owl){var R=O.event.special[E.name]._default;O.event.special[E.name]._default=function(N){return R&&R.apply&&(!N.namespace||N.namespace.indexOf("owl")===-1)?R.apply(this,arguments):N.namespace&&N.namespace.indexOf("owl")>-1},O.event.special[E.name].owl=!0}}else E.type===pe.Type.State&&(this._states.tags[E.name]?this._states.tags[E.name]=this._states.tags[E.name].concat(E.tags):this._states.tags[E.name]=E.tags,this._states.tags[E.name]=O.grep(this._states.tags[E.name],O.proxy(function(N,re){return O.inArray(N,this._states.tags[E.name])===re},this)))},pe.prototype.suppress=function(E){O.each(E,O.proxy(function(R,N){this._supress[N]=!0},this))},pe.prototype.release=function(E){O.each(E,O.proxy(function(R,N){delete this._supress[N]},this))},pe.prototype.pointer=function(E){var R={x:null,y:null};return E=E.originalEvent||E||H.event,E=E.touches&&E.touches.length?E.touches[0]:E.changedTouches&&E.changedTouches.length?E.changedTouches[0]:E,E.pageX?(R.x=E.pageX,R.y=E.pageY):(R.x=E.clientX,R.y=E.clientY),R},pe.prototype.isNumeric=function(E){return!isNaN(parseFloat(E))},pe.prototype.difference=function(E,R){return{x:E.x-R.x,y:E.y-R.y}},O.fn.owlCarousel=function(E){var R=Array.prototype.slice.call(arguments,1);return this.each(function(){var N=O(this),re=N.data("owl.carousel");re||(re=new pe(this,typeof E=="object"&&E),N.data("owl.carousel",re),O.each(["next","prev","to","destroy","refresh","replace","add","remove"],function(Te,Ce){re.register({type:pe.Type.Event,name:Ce}),re.$element.on(Ce+".owl.carousel.core",O.proxy(function(Ne){Ne.namespace&&Ne.relatedTarget!==this&&(this.suppress([Ce]),re[Ce].apply(this,[].slice.call(arguments,1)),this.release([Ce]))},re))})),typeof E=="string"&&E.charAt(0)!=="_"&&re[E].apply(re,R)})},O.fn.owlCarousel.Constructor=pe})(window.Zepto||window.jQuery,window,document),function(O,H,ue,Pe){var pe=function(E){this._core=E,this._interval=null,this._visible=null,this._handlers={"initialized.owl.carousel":O.proxy(function(R){R.namespace&&this._core.settings.autoRefresh&&this.watch()},this)},this._core.options=O.extend({},pe.Defaults,this._core.options),this._core.$element.on(this._handlers)};pe.Defaults={autoRefresh:!0,autoRefreshInterval:500},pe.prototype.watch=function(){this._interval||(this._visible=this._core.isVisible(),this._interval=H.setInterval(O.proxy(this.refresh,this),this._core.settings.autoRefreshInterval))},pe.prototype.refresh=function(){this._core.isVisible()!==this._visible&&(this._visible=!this._visible,this._core.$element.toggleClass("owl-hidden",!this._visible),this._visible&&this._core.invalidate("width")&&this._core.refresh())},pe.prototype.destroy=function(){var E,R;H.clearInterval(this._interval);for(E in this._handlers)this._core.$element.off(E,this._handlers[E]);for(R in Object.getOwnPropertyNames(this))typeof this[R]!="function"&&(this[R]=null)},O.fn.owlCarousel.Constructor.Plugins.AutoRefresh=pe}(window.Zepto||window.jQuery,window),function(O,H,ue,Pe){var pe=function(E){this._core=E,this._loaded=[],this._handlers={"initialized.owl.carousel change.owl.carousel resized.owl.carousel":O.proxy(function(R){if(R.namespace&&!(!this._core.settings||!this._core.settings.lazyLoad)&&(R.property&&R.property.name=="position"||R.type=="initialized")){var N=this._core.settings,re=N.center&&Math.ceil(N.items/2)||N.items,Te=N.center&&re*-1||0,Ce=(R.property&&R.property.value!==Pe?R.property.value:this._core.current())+Te,Ne=this._core.clones().length,Ge=O.proxy(function(ht,dt){this.load(dt)},this);for(N.lazyLoadEager>0&&(re+=N.lazyLoadEager,N.loop&&(Ce-=N.lazyLoadEager,re++));Te++<re;)this.load(Ne/2+this._core.relative(Ce)),Ne&&O.each(this._core.clones(this._core.relative(Ce)),Ge),Ce++}},this)},this._core.options=O.extend({},pe.Defaults,this._core.options),this._core.$element.on(this._handlers)};pe.Defaults={lazyLoad:!1,lazyLoadEager:0},pe.prototype.load=function(E){var R=this._core.$stage.children().eq(E),N=R&&R.find(".owl-lazy");!N||O.inArray(R.get(0),this._loaded)>-1||(N.each(O.proxy(function(re,Te){var Ce=O(Te),Ne,Ge=H.devicePixelRatio>1&&Ce.attr("data-src-retina")||Ce.attr("data-src")||Ce.attr("data-srcset");this._core.trigger("load",{element:Ce,url:Ge},"lazy"),Ce.is("img")?Ce.one("load.owl.lazy",O.proxy(function(){Ce.css("opacity",1),this._core.trigger("loaded",{element:Ce,url:Ge},"lazy")},this)).attr("src",Ge):Ce.is("source")?Ce.one("load.owl.lazy",O.proxy(function(){this._core.trigger("loaded",{element:Ce,url:Ge},"lazy")},this)).attr("srcset",Ge):(Ne=new Image,Ne.onload=O.proxy(function(){Ce.css({"background-image":'url("'+Ge+'")',opacity:"1"}),this._core.trigger("loaded",{element:Ce,url:Ge},"lazy")},this),Ne.src=Ge)},this)),this._loaded.push(R.get(0)))},pe.prototype.destroy=function(){var E,R;for(E in this.handlers)this._core.$element.off(E,this.handlers[E]);for(R in Object.getOwnPropertyNames(this))typeof this[R]!="function"&&(this[R]=null)},O.fn.owlCarousel.Constructor.Plugins.Lazy=pe}(window.Zepto||window.jQuery,window),function(O,H,ue,Pe){var pe=function(E){this._core=E,this._previousHeight=null,this._handlers={"initialized.owl.carousel refreshed.owl.carousel":O.proxy(function(N){N.namespace&&this._core.settings.autoHeight&&this.update()},this),"changed.owl.carousel":O.proxy(function(N){N.namespace&&this._core.settings.autoHeight&&N.property.name==="position"&&this.update()},this),"loaded.owl.lazy":O.proxy(function(N){N.namespace&&this._core.settings.autoHeight&&N.element.closest("."+this._core.settings.itemClass).index()===this._core.current()&&this.update()},this)},this._core.options=O.extend({},pe.Defaults,this._core.options),this._core.$element.on(this._handlers),this._intervalId=null;var R=this;O(H).on("load",function(){R._core.settings.autoHeight&&R.update()}),O(H).resize(function(){R._core.settings.autoHeight&&(R._intervalId!=null&&clearTimeout(R._intervalId),R._intervalId=setTimeout(function(){R.update()},250))})};pe.Defaults={autoHeight:!1,autoHeightClass:"owl-height"},pe.prototype.update=function(){var E=this._core._current,R=E+this._core.settings.items,N=this._core.settings.lazyLoad,re=this._core.$stage.children().toArray().slice(E,R),Te=[],Ce=0;O.each(re,function(Ne,Ge){Te.push(O(Ge).height())}),Ce=Math.max.apply(null,Te),Ce<=1&&N&&this._previousHeight&&(Ce=this._previousHeight),this._previousHeight=Ce,this._core.$stage.parent().height(Ce).addClass(this._core.settings.autoHeightClass)},pe.prototype.destroy=function(){var E,R;for(E in this._handlers)this._core.$element.off(E,this._handlers[E]);for(R in Object.getOwnPropertyNames(this))typeof this[R]!="function"&&(this[R]=null)},O.fn.owlCarousel.Constructor.Plugins.AutoHeight=pe}(window.Zepto||window.jQuery,window),function(O,H,ue,Pe){var pe=function(E){this._core=E,this._videos={},this._playing=null,this._handlers={"initialized.owl.carousel":O.proxy(function(R){R.namespace&&this._core.register({type:"state",name:"playing",tags:["interacting"]})},this),"resize.owl.carousel":O.proxy(function(R){R.namespace&&this._core.settings.video&&this.isInFullScreen()&&R.preventDefault()},this),"refreshed.owl.carousel":O.proxy(function(R){R.namespace&&this._core.is("resizing")&&this._core.$stage.find(".cloned .owl-video-frame").remove()},this),"changed.owl.carousel":O.proxy(function(R){R.namespace&&R.property.name==="position"&&this._playing&&this.stop()},this),"prepared.owl.carousel":O.proxy(function(R){if(R.namespace){var N=O(R.content).find(".owl-video");N.length&&(N.css("display","none"),this.fetch(N,O(R.content)))}},this)},this._core.options=O.extend({},pe.Defaults,this._core.options),this._core.$element.on(this._handlers),this._core.$element.on("click.owl.video",".owl-video-play-icon",O.proxy(function(R){this.play(R)},this))};pe.Defaults={video:!1,videoHeight:!1,videoWidth:!1},pe.prototype.fetch=function(E,R){var N=function(){return E.attr("data-vimeo-id")?"vimeo":E.attr("data-vzaar-id")?"vzaar":"youtube"}(),re=E.attr("data-vimeo-id")||E.attr("data-youtube-id")||E.attr("data-vzaar-id"),Te=E.attr("data-width")||this._core.settings.videoWidth,Ce=E.attr("data-height")||this._core.settings.videoHeight,Ne=E.attr("href");if(Ne){if(re=Ne.match(/(http:|https:|)\/\/(player.|www.|app.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com|be\-nocookie\.com)|vzaar\.com)\/(video\/|videos\/|embed\/|channels\/.+\/|groups\/.+\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),re[3].indexOf("youtu")>-1)N="youtube";else if(re[3].indexOf("vimeo")>-1)N="vimeo";else if(re[3].indexOf("vzaar")>-1)N="vzaar";else throw new Error("Video URL not supported.");re=re[6]}else throw new Error("Missing video URL.");this._videos[Ne]={type:N,id:re,width:Te,height:Ce},R.attr("data-video",Ne),this.thumbnail(E,this._videos[Ne])},pe.prototype.thumbnail=function(E,R){var N,re,Te,Ce=R.width&&R.height?"width:"+R.width+"px;height:"+R.height+"px;":"",Ne=E.find("img"),Ge="src",ht="",dt=this._core.settings,Gt=function(yr){re='<div class="owl-video-play-icon"></div>',dt.lazyLoad?N=O("<div/>",{class:"owl-video-tn "+ht,srcType:yr}):N=O("<div/>",{class:"owl-video-tn",style:"opacity:1;background-image:url("+yr+")"}),E.after(N),E.after(re)};if(E.wrap(O("<div/>",{class:"owl-video-wrapper",style:Ce})),this._core.settings.lazyLoad&&(Ge="data-src",ht="owl-lazy"),Ne.length)return Gt(Ne.attr(Ge)),Ne.remove(),!1;R.type==="youtube"?(Te="//img.youtube.com/vi/"+R.id+"/hqdefault.jpg",Gt(Te)):R.type==="vimeo"?O.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+R.id+".json",jsonp:"callback",dataType:"jsonp",success:function(yr){Te=yr[0].thumbnail_large,Gt(Te)}}):R.type==="vzaar"&&O.ajax({type:"GET",url:"//vzaar.com/api/videos/"+R.id+".json",jsonp:"callback",dataType:"jsonp",success:function(yr){Te=yr.framegrab_url,Gt(Te)}})},pe.prototype.stop=function(){this._core.trigger("stop",null,"video"),this._playing.find(".owl-video-frame").remove(),this._playing.removeClass("owl-video-playing"),this._playing=null,this._core.leave("playing"),this._core.trigger("stopped",null,"video")},pe.prototype.play=function(E){var R=O(E.target),N=R.closest("."+this._core.settings.itemClass),re=this._videos[N.attr("data-video")],Te=re.width||"100%",Ce=re.height||this._core.$stage.height(),Ne;this._playing||(this._core.enter("playing"),this._core.trigger("play",null,"video"),N=this._core.items(this._core.relative(N.index())),this._core.reset(N.index()),Ne=O('<iframe frameborder="0" allowfullscreen mozallowfullscreen webkitAllowFullScreen ></iframe>'),Ne.attr("height",Ce),Ne.attr("width",Te),re.type==="youtube"?Ne.attr("src","//www.youtube.com/embed/"+re.id+"?autoplay=1&rel=0&v="+re.id):re.type==="vimeo"?Ne.attr("src","//player.vimeo.com/video/"+re.id+"?autoplay=1"):re.type==="vzaar"&&Ne.attr("src","//view.vzaar.com/"+re.id+"/player?autoplay=true"),O(Ne).wrap('<div class="owl-video-frame" />').insertAfter(N.find(".owl-video")),this._playing=N.addClass("owl-video-playing"))},pe.prototype.isInFullScreen=function(){var E=ue.fullscreenElement||ue.mozFullScreenElement||ue.webkitFullscreenElement;return E&&O(E).parent().hasClass("owl-video-frame")},pe.prototype.destroy=function(){var E,R;this._core.$element.off("click.owl.video");for(E in this._handlers)this._core.$element.off(E,this._handlers[E]);for(R in Object.getOwnPropertyNames(this))typeof this[R]!="function"&&(this[R]=null)},O.fn.owlCarousel.Constructor.Plugins.Video=pe}(window.Zepto||window.jQuery,window,document),function(O,H,ue,Pe){var pe=function(E){this.core=E,this.core.options=O.extend({},pe.Defaults,this.core.options),this.swapping=!0,this.previous=Pe,this.next=Pe,this.handlers={"change.owl.carousel":O.proxy(function(R){R.namespace&&R.property.name=="position"&&(this.previous=this.core.current(),this.next=R.property.value)},this),"drag.owl.carousel dragged.owl.carousel translated.owl.carousel":O.proxy(function(R){R.namespace&&(this.swapping=R.type=="translated")},this),"translate.owl.carousel":O.proxy(function(R){R.namespace&&this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)&&this.swap()},this)},this.core.$element.on(this.handlers)};pe.Defaults={animateOut:!1,animateIn:!1},pe.prototype.swap=function(){if(this.core.settings.items===1&&!(!O.support.animation||!O.support.transition)){this.core.speed(0);var E,R=O.proxy(this.clear,this),N=this.core.$stage.children().eq(this.previous),re=this.core.$stage.children().eq(this.next),Te=this.core.settings.animateIn,Ce=this.core.settings.animateOut;this.core.current()!==this.previous&&(Ce&&(E=this.core.coordinates(this.previous)-this.core.coordinates(this.next),N.one(O.support.animation.end,R).css({left:E+"px"}).addClass("animated owl-animated-out").addClass(Ce)),Te&&re.one(O.support.animation.end,R).addClass("animated owl-animated-in").addClass(Te))}},pe.prototype.clear=function(E){O(E.target).css({left:""}).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut),this.core.onTransitionEnd()},pe.prototype.destroy=function(){var E,R;for(E in this.handlers)this.core.$element.off(E,this.handlers[E]);for(R in Object.getOwnPropertyNames(this))typeof this[R]!="function"&&(this[R]=null)},O.fn.owlCarousel.Constructor.Plugins.Animate=pe}(window.Zepto||window.jQuery),function(O,H,ue,Pe){var pe=function(E){this._core=E,this._call=null,this._time=0,this._timeout=0,this._paused=!0,this._handlers={"changed.owl.carousel":O.proxy(function(R){R.namespace&&R.property.name==="settings"?this._core.settings.autoplay?this.play():this.stop():R.namespace&&R.property.name==="position"&&this._paused&&(this._time=0)},this),"initialized.owl.carousel":O.proxy(function(R){R.namespace&&this._core.settings.autoplay&&this.play()},this),"play.owl.autoplay":O.proxy(function(R,N,re){R.namespace&&this.play(N,re)},this),"stop.owl.autoplay":O.proxy(function(R){R.namespace&&this.stop()},this),"mouseover.owl.autoplay":O.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"mouseleave.owl.autoplay":O.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.play()},this),"touchstart.owl.core":O.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"touchend.owl.core":O.proxy(function(){this._core.settings.autoplayHoverPause&&this.play()},this)},this._core.$element.on(this._handlers),this._core.options=O.extend({},pe.Defaults,this._core.options)};pe.Defaults={autoplay:!1,autoplayTimeout:5e3,autoplayHoverPause:!1,autoplaySpeed:!1},pe.prototype._next=function(E){this._call=H.setTimeout(O.proxy(this._next,this,E),this._timeout*(Math.round(this.read()/this._timeout)+1)-this.read()),!(this._core.is("interacting")||ue.hidden)&&this._core.next(E||this._core.settings.autoplaySpeed)},pe.prototype.read=function(){return new Date().getTime()-this._time},pe.prototype.play=function(E,R){var N;this._core.is("rotating")||this._core.enter("rotating"),E=E||this._core.settings.autoplayTimeout,N=Math.min(this._time%(this._timeout||E),E),this._paused?(this._time=this.read(),this._paused=!1):H.clearTimeout(this._call),this._time+=this.read()%E-N,this._timeout=E,this._call=H.setTimeout(O.proxy(this._next,this,R),E-N)},pe.prototype.stop=function(){this._core.is("rotating")&&(this._time=0,this._paused=!0,H.clearTimeout(this._call),this._core.leave("rotating"))},pe.prototype.pause=function(){this._core.is("rotating")&&!this._paused&&(this._time=this.read(),this._paused=!0,H.clearTimeout(this._call))},pe.prototype.destroy=function(){var E,R;this.stop();for(E in this._handlers)this._core.$element.off(E,this._handlers[E]);for(R in Object.getOwnPropertyNames(this))typeof this[R]!="function"&&(this[R]=null)},O.fn.owlCarousel.Constructor.Plugins.autoplay=pe}(window.Zepto||window.jQuery,window,document),function(O,H,ue,Pe){var pe=function(E){this._core=E,this._initialized=!1,this._pages=[],this._controls={},this._templates=[],this.$element=this._core.$element,this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to},this._handlers={"prepared.owl.carousel":O.proxy(function(R){R.namespace&&this._core.settings.dotsData&&this._templates.push('<div class="'+this._core.settings.dotClass+'">'+O(R.content).find("[data-dot]").addBack("[data-dot]").attr("data-dot")+"</div>")},this),"added.owl.carousel":O.proxy(function(R){R.namespace&&this._core.settings.dotsData&&this._templates.splice(R.position,0,this._templates.pop())},this),"remove.owl.carousel":O.proxy(function(R){R.namespace&&this._core.settings.dotsData&&this._templates.splice(R.position,1)},this),"changed.owl.carousel":O.proxy(function(R){R.namespace&&R.property.name=="position"&&this.draw()},this),"initialized.owl.carousel":O.proxy(function(R){R.namespace&&!this._initialized&&(this._core.trigger("initialize",null,"navigation"),this.initialize(),this.update(),this.draw(),this._initialized=!0,this._core.trigger("initialized",null,"navigation"))},this),"refreshed.owl.carousel":O.proxy(function(R){R.namespace&&this._initialized&&(this._core.trigger("refresh",null,"navigation"),this.update(),this.draw(),this._core.trigger("refreshed",null,"navigation"))},this)},this._core.options=O.extend({},pe.Defaults,this._core.options),this.$element.on(this._handlers)};pe.Defaults={nav:!1,navText:['<span aria-label="Previous">&#x2039;</span>','<span aria-label="Next">&#x203a;</span>'],navSpeed:!1,navElement:'button type="button" role="presentation"',navContainer:!1,navContainerClass:"owl-nav",navClass:["owl-prev","owl-next"],slideBy:1,dotClass:"owl-dot",dotsClass:"owl-dots",dots:!0,dotsEach:!1,dotsData:!1,dotsSpeed:!1,dotsContainer:!1},pe.prototype.initialize=function(){var E,R=this._core.settings;this._controls.$relative=(R.navContainer?O(R.navContainer):O("<div>").addClass(R.navContainerClass).appendTo(this.$element)).addClass("disabled"),this._controls.$previous=O("<"+R.navElement+">").addClass(R.navClass[0]).html(R.navText[0]).prependTo(this._controls.$relative).on("click",O.proxy(function(N){this.prev(R.navSpeed)},this)),this._controls.$next=O("<"+R.navElement+">").addClass(R.navClass[1]).html(R.navText[1]).appendTo(this._controls.$relative).on("click",O.proxy(function(N){this.next(R.navSpeed)},this)),R.dotsData||(this._templates=[O('<button role="button">').addClass(R.dotClass).append(O("<span>")).prop("outerHTML")]),this._controls.$absolute=(R.dotsContainer?O(R.dotsContainer):O("<div>").addClass(R.dotsClass).appendTo(this.$element)).addClass("disabled"),this._controls.$absolute.on("click","button",O.proxy(function(N){var re=O(N.target).parent().is(this._controls.$absolute)?O(N.target).index():O(N.target).parent().index();N.preventDefault(),this.to(re,R.dotsSpeed)},this));for(E in this._overrides)this._core[E]=O.proxy(this[E],this)},pe.prototype.destroy=function(){var E,R,N,re,Te;Te=this._core.settings;for(E in this._handlers)this.$element.off(E,this._handlers[E]);for(R in this._controls)R==="$relative"&&Te.navContainer?this._controls[R].html(""):this._controls[R].remove();for(re in this.overides)this._core[re]=this._overrides[re];for(N in Object.getOwnPropertyNames(this))typeof this[N]!="function"&&(this[N]=null)},pe.prototype.update=function(){var E,R,N=this._core.clones().length/2,re=N+this._core.items().length,Te=this._core.maximum(!0),Ce=this._core.settings,Ne=Ce.center||Ce.autoWidth||Ce.dotsData?1:Ce.dotsEach||Ce.items;if(Ce.slideBy!=="page"&&(Ce.slideBy=Math.min(Ce.slideBy,Ce.items)),Ce.dots||Ce.slideBy=="page")for(this._pages=[],E=N,R=0,0;E<re;E++){if(R>=Ne||R===0){if(this._pages.push({start:Math.min(Te,E-N),end:E-N+Ne-1}),Math.min(Te,E-N)===Te)break;R=0}R+=this._core.mergers(this._core.relative(E))}},pe.prototype.draw=function(){var E,R=this._core.settings,N=this._core.items().length<=R.items,re=this._core.relative(this._core.current()),Te=R.loop||R.rewind;this._controls.$relative.toggleClass("disabled",!R.nav||N),R.nav&&(this._controls.$previous.toggleClass("disabled",!Te&&re<=this._core.minimum(!0)),this._controls.$next.toggleClass("disabled",!Te&&re>=this._core.maximum(!0))),this._controls.$absolute.toggleClass("disabled",!R.dots||N),R.dots&&(E=this._pages.length-this._controls.$absolute.children().length,R.dotsData&&E!==0?this._controls.$absolute.html(this._templates.join("")):E>0?this._controls.$absolute.append(new Array(E+1).join(this._templates[0])):E<0&&this._controls.$absolute.children().slice(E).remove(),this._controls.$absolute.find(".active").removeClass("active"),this._controls.$absolute.children().eq(O.inArray(this.current(),this._pages)).addClass("active"))},pe.prototype.onTrigger=function(E){var R=this._core.settings;E.page={index:O.inArray(this.current(),this._pages),count:this._pages.length,size:R&&(R.center||R.autoWidth||R.dotsData?1:R.dotsEach||R.items)}},pe.prototype.current=function(){var E=this._core.relative(this._core.current());return O.grep(this._pages,O.proxy(function(R,N){return R.start<=E&&R.end>=E},this)).pop()},pe.prototype.getPosition=function(E){var R,N,re=this._core.settings;return re.slideBy=="page"?(R=O.inArray(this.current(),this._pages),N=this._pages.length,E?++R:--R,R=this._pages[(R%N+N)%N].start):(R=this._core.relative(this._core.current()),N=this._core.items().length,E?R+=re.slideBy:R-=re.slideBy),R},pe.prototype.next=function(E){O.proxy(this._overrides.to,this._core)(this.getPosition(!0),E)},pe.prototype.prev=function(E){O.proxy(this._overrides.to,this._core)(this.getPosition(!1),E)},pe.prototype.to=function(E,R,N){var re;!N&&this._pages.length?(re=this._pages.length,O.proxy(this._overrides.to,this._core)(this._pages[(E%re+re)%re].start,R)):O.proxy(this._overrides.to,this._core)(E,R)},O.fn.owlCarousel.Constructor.Plugins.Navigation=pe}(window.Zepto||window.jQuery),function(O,H,ue,Pe){var pe=function(E){this._core=E,this._hashes={},this.$element=this._core.$element,this._handlers={"initialized.owl.carousel":O.proxy(function(R){R.namespace&&this._core.settings.startPosition==="URLHash"&&O(H).trigger("hashchange.owl.navigation")},this),"prepared.owl.carousel":O.proxy(function(R){if(R.namespace){var N=O(R.content).find("[data-hash]").addBack("[data-hash]").attr("data-hash");if(!N)return;this._hashes[N]=R.content}},this),"changed.owl.carousel":O.proxy(function(R){if(R.namespace&&R.property.name==="position"){var N=this._core.items(this._core.relative(this._core.current())),re=O.map(this._hashes,function(Te,Ce){return Te===N?Ce:null}).join();if(!re||H.location.hash.slice(1)===re)return;H.location.hash=re}},this)},this._core.options=O.extend({},pe.Defaults,this._core.options),this.$element.on(this._handlers),O(H).on("hashchange.owl.navigation",O.proxy(function(R){var N=H.location.hash.substring(1),re=this._core.$stage.children(),Te=this._hashes[N]&&re.index(this._hashes[N]);Te===Pe||Te===this._core.current()||this._core.to(this._core.relative(Te),!1,!0)},this))};pe.Defaults={URLhashListener:!1},pe.prototype.destroy=function(){var E,R;O(H).off("hashchange.owl.navigation");for(E in this._handlers)this._core.$element.off(E,this._handlers[E]);for(R in Object.getOwnPropertyNames(this))typeof this[R]!="function"&&(this[R]=null)},O.fn.owlCarousel.Constructor.Plugins.Hash=pe}(window.Zepto||window.jQuery,window),function(O,H,ue,Pe){var pe=O("<support>").get(0).style,E="Webkit Moz O ms".split(" "),R={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},N={csstransforms:function(){return!!re("transform")},csstransforms3d:function(){return!!re("perspective")},csstransitions:function(){return!!re("transition")},cssanimations:function(){return!!re("animation")}};function re(Ce,Ne){var Ge=!1,ht=Ce.charAt(0).toUpperCase()+Ce.slice(1);return O.each((Ce+" "+E.join(ht+" ")+ht).split(" "),function(dt,Gt){if(pe[Gt]!==Pe)return Ge=Ne?Gt:!0,!1}),Ge}function Te(Ce){return re(Ce,!0)}N.csstransitions()&&(O.support.transition=new String(Te("transition")),O.support.transition.end=R.transition.end[O.support.transition]),N.cssanimations()&&(O.support.animation=new String(Te("animation")),O.support.animation.end=R.animation.end[O.support.animation]),N.csstransforms()&&(O.support.transform=new String(Te("transform")),O.support.transform3d=N.csstransforms3d())}(window.Zepto||window.jQuery);var Z=window.jQuery,K=function(O){C(H,O);function H(ue){var Pe=O.call(this,ue)||this;Pe.containerRef=function(N){Pe.container=N};var pe=be(Pe.props),E=pe[0],R=pe[1];return Pe.options=E,Pe.propsWithoutOptions=R,Pe}return H.prototype.componentDidMount=function(){this.$ele=Z(this.container),this.create()},H.prototype.UNSAFE_componentWillReceiveProps=function(){this.destory()},H.prototype.componentDidUpdate=function(){var ue=be(this.props),Pe=ue[0],pe=ue[1];this.options=Pe,this.propsWithoutOptions=pe,this.create()},H.prototype.next=function(ue){if(!this.$ele)throw new Error("OwlCarousel is not created");typeof ue=="number"?this.$ele.trigger("next.owl.carousel",[ue]):this.$ele.trigger("next.owl.carousel",ue)},H.prototype.prev=function(ue){if(!this.$ele)throw new Error("OwlCarousel is not created");typeof ue=="number"?this.$ele.trigger("prev.owl.carousel",[ue]):this.$ele.trigger("prev.owl.carousel",ue)},H.prototype.to=function(ue,Pe){if(!this.$ele)throw new Error("OwlCarousel is not created");typeof ue=="number"&&typeof Pe=="number"?this.$ele.trigger("to.owl.carousel",[ue,Pe]):this.$ele.trigger("to.owl.carousel")},H.prototype.create=function(ue){if(!this.$ele)throw new Error("OwlCarousel is not created");this.$ele.owlCarousel(ue||this.options)},H.prototype.destory=function(){if(!this.$ele)throw new Error("OwlCarousel is not created");this.$ele.trigger("destroy.owl.carousel")},H.prototype.play=function(ue,Pe){if(!this.$ele)throw new Error("OwlCarousel is not created");typeof ue=="number"&&typeof Pe=="number"?this.$ele.trigger("play.owl.autoplay",[ue,Pe]):this.$ele.trigger("play.owl.autoplay")},H.prototype.stop=function(){if(!this.$ele)throw new Error("OwlCarousel is not created");this.$ele.trigger("stop.owl.autoplay")},H.prototype.render=function(){var ue=this.propsWithoutOptions,Pe=ue.className,pe=c(ue,["className"]);return _.createElement("div",b({className:"owl-carousel "+Pe,ref:this.containerRef},pe))},H}(d.Component),ge=new Set(["items","margin","loop","center","mouseDrag","touchDrag","pullDrag","freeDrag","stagePadding","merge","mergeFit","autoWidth","startPosition","URLhashListener","nav","rewind","navText","navElement","slideBy","dots","dotsEach","dotData","lazyLoad","lazyContent","autoplay","autoplayTimeout","autoplayHoverPause","smartSpeed","fluidSpeed","autoplaySpeed","navSpeed","dotsSpeed","dragEndSpeed","callbacks","responsive","responsiveRefreshRate","responsiveBaseElement","video","videoHeight","videoWidth","animateOut","animateIn","fallbackEasing","info","nestedItemSelector","itemElement","stageElement","navContainer","dotsContainer","refreshClass","loadingClass","loadedClass","rtlClass","dragClass","grabClass","stageClass","stageOuterClass","navContainerClass","navClass","controlsClass","dotClass","dotsClass","autoHeightClass","responsiveClass","onInitialize","onInitialized","onResize","onResized","onRefresh","onRefreshed","onDrag","onDragged","onTranslate","onTranslated","onChange","onChanged","onLoadLazy","onLoadedLazy","onStopVideo","onPlayVideo"]);function be(O){var H={},ue={};return Object.keys(O).forEach(function(Pe){ge.has(Pe)?H[Pe]=O[Pe]:ue[Pe]=O[Pe]}),[H,ue]}return K})})(Bw);var oE=Bw.exports;const om=H_(oE);function aE(){const{portfolio:{secTitle:r,secDesc:o,portfolioItem:d}}=Ie.useContext(Nt),[_,x]=Ie.useState("4");function C(){window.innerWidth<600?x("1"):window.innerWidth<768?x("2"):x("4")}return Ie.useEffect(()=>{C(),window.scroll(0,0)},[]),window.addEventListener("resize",C),z.jsxs("section",{className:`${W_.portfolio} section`,children:[z.jsx(_r,{children:z.jsx(jt,{children:z.jsx(Pl,{title:r,desc:o})})}),z.jsx(_r,{fluid:!0,children:z.jsx(jt,{children:z.jsx(_t,{lg:12,md:12,children:z.jsx(om,{className:"",loop:!0,margin:15,smartSpeed:500,nav:!1,items:_,autoplay:!0,dots:!1,children:d.map(b=>z.jsx(sE,{img:b.img,btnText:b.btnText,link:b.link},Math.random()))})})})})]})}const lE="_services_j9x6p_7",cE="_singleService_j9x6p_7",Ow={services:lE,singleService:cE};function uE({icon:r,title:o,desc:d}){return z.jsx(_t,{lg:4,md:6,children:z.jsxs("div",{className:`${Ow.singleService}`,children:[z.jsx("i",{className:`icofont ${r}`}),z.jsx("h4",{children:z.jsx("a",{href:"#",children:o})}),z.jsx("p",{children:d})]})})}function hE(){const{services:{secTitle:r,secDesc:o,service:d}}=Ie.useContext(Nt);return z.jsx("section",{className:`${Ow.services} section`,children:z.jsxs(_r,{children:[z.jsx(jt,{children:z.jsx(Pl,{title:r,desc:o})}),z.jsx(jt,{children:d.map(_=>z.jsx(uE,{icon:_.icon,title:_.title,desc:_.desc},Math.random()))})]})})}const dE="_pricingTable_1slht_9",pE="_singleTable_1slht_17",fE="_tableHead_1slht_37",mE="_icon_1slht_43",gE="_title_1slht_51",_E="_amount_1slht_63",yE="_tableList_1slht_89",vE="_cross_1slht_119",xE="_tableBottom_1slht_159",bE="_btn_1slht_165",Qn={pricingTable:dE,singleTable:pE,tableHead:fE,icon:mE,title:gE,amount:_E,tableList:yE,cross:vE,tableBottom:xE,btn:bE};function wE({icon:r,title:o,amount:d,visit:_,btnText:x,priceList:C}){return z.jsx(_t,{lg:4,md:12,children:z.jsxs("div",{className:`${Qn.singleTable}`,children:[z.jsxs("div",{className:`${Qn.tableHead}`,children:[z.jsx("div",{className:`${Qn.icon}`,children:z.jsx("i",{className:`icofont ${r}`})}),z.jsx("h4",{className:`${Qn.title}`,children:o}),z.jsx("div",{className:`${Qn.price}`,children:z.jsxs("p",{className:`${Qn.amount}`,children:[d,z.jsx("span",{children:_})]})})]}),z.jsx("ul",{className:`${Qn.tableList}`,children:C.map((b,c)=>z.jsxs("li",{className:b.check?"":`${Qn.cross}`,children:[z.jsx("i",{className:`icofont ${b.check?"icofont-ui-check":"icofont-ui-close"}`}),b.list]},c))}),z.jsx("div",{className:`${Qn.tableBottom}`,children:z.jsx("a",{className:`${Qn.btn} btn`,href:"#",children:x})})]})})}function TE(){const{pricing:{secTitle:r,secDesc:o,pricesSec:d}}=Ie.useContext(Nt);return z.jsx("section",{className:`${Qn.pricingTable} section`,children:z.jsxs(_r,{children:[z.jsx(jt,{children:z.jsx(Pl,{title:r,desc:o})}),z.jsx(jt,{children:d.map(_=>z.jsx(wE,{icon:_.icon,title:_.title,amount:_.amount,visit:_.visit,btnText:_.btnText,priceList:_.priceList},Math.random()))})]})})}const SE="_blog_1kvpf_7",CE="_singleNews_1kvpf_19",PE="_newsHead_1kvpf_51",ME="_newsContent_1kvpf_59",IE="_newsBody_1kvpf_115",EE="_date_1kvpf_155",cl={blog:SE,singleNews:CE,newsHead:PE,newsContent:ME,newsBody:IE,date:EE};function kE({img:r,date:o,title:d,desc:_,link:x}){return z.jsx(_t,{lg:4,md:6,sm:12,children:z.jsxs("div",{className:`${cl.singleNews}`,children:[z.jsx("div",{className:`${cl.newsHead}`,children:z.jsx("img",{src:r,alt:"#"})}),z.jsx("div",{className:`${cl.newsBody}`,children:z.jsxs("div",{className:`${cl.newsContent}`,children:[z.jsx("div",{className:`${cl.date}`,children:o}),z.jsx("h2",{children:z.jsx("a",{href:x,children:d})}),z.jsx("p",{className:`${cl.text}`,children:_})]})})]})})}function zE(){const{blogs:{secTitle:r,secDesc:o,blogItems:d}}=Ie.useContext(Nt);return z.jsx("section",{className:`${cl.blog} section`,id:"blog",children:z.jsxs(_r,{children:[z.jsx(jt,{children:z.jsx(Pl,{title:r,desc:o})}),z.jsx(jt,{children:d.map(_=>z.jsx(kE,{img:_.img,date:_.date,title:_.title,desc:_.desc,link:_.link},Math.random()))})]})})}const AE="_clients_17cfq_1",RE="_singleClients_17cfq_15",Nw={clients:AE,singleClients:RE};function DE({img:r}){return z.jsx("div",{className:`${Nw.singleClients}`,children:z.jsx("img",{src:r,alt:"#"})})}function LE(){const{clients:r}=Ie.useContext(Nt),[o,d]=Ie.useState("5");function _(){window.innerWidth<600?d("2"):window.innerWidth<768?d("3"):d("5")}return Ie.useEffect(()=>{_()},[]),window.addEventListener("resize",_),z.jsx("div",{className:`${Nw.clients} overlay`,children:z.jsx(_r,{children:z.jsx(jt,{children:z.jsx(_t,{lg:12,md:12,children:z.jsx(om,{className:"clientSlider",loop:!0,margin:10,smartSpeed:500,nav:!1,items:o,autoplay:!0,dots:!1,children:r.map(x=>z.jsx(DE,{img:x},Math.random()))})})})})})}function Ml({children:r,...o}){return z.jsx("form",{...o,children:r})}function ao({...r}){return z.jsx("input",{...r})}function Yy({...r}){return z.jsx("textarea",{...r})}function au({text:r,children:o,...d}){return z.jsxs("button",{...d,children:[o,r]})}const jE="_appointment_o0mfm_7",FE="_form_o0mfm_55",BE="_selectBorder_o0mfm_91",OE="_appointmentImage_o0mfm_189",Eh={appointment:jE,form:FE,selectBorder:BE,appointmentImage:OE};function NE(){const{appointment:{secTitle:r,secDesc:o,form:{input:d,department:_,doctor:x,date:C,msg:b,submitText:c,confirmWillText:Z}}}=Ie.useContext(Nt);return z.jsx("section",{className:`${Eh.appointment}`,children:z.jsxs(_r,{children:[z.jsx(jt,{children:z.jsx(Pl,{title:r,desc:o})}),z.jsxs(jt,{children:[z.jsx(_t,{lg:6,md:12,children:z.jsxs(Ml,{className:`${Eh.form}`,action:"#",children:[z.jsxs(jt,{children:[d.map((K,ge)=>z.jsx(_t,{lg:6,md:12,sm:12,className:"mb-4",children:z.jsx("div",{className:"form-group",children:z.jsx(ao,{name:K.name,type:K.type,placeholder:K.placeholder})})},ge)),z.jsx(_t,{lg:6,md:12,sm:12,children:z.jsx("div",{className:"form-group",children:z.jsx("select",{className:`form-select form-select-lg mb-4 ${Eh.selectBorder}`,children:_.map((K,ge)=>z.jsx("option",{value:K,children:K},ge))})})}),z.jsx(_t,{lg:6,md:12,sm:12,children:z.jsx("div",{className:"form-group",children:z.jsx("select",{className:`form-select form-select-lg mb-4 ${Eh.selectBorder}`,children:x.map((K,ge)=>z.jsx("option",{value:K,children:K},ge))})})}),C.map((K,ge)=>z.jsx(_t,{lg:6,md:12,sm:12,className:"mb-4",children:z.jsx("div",{className:"form-group",children:z.jsx(ao,{name:K.name,type:K.type,placeholder:K.placeholder})})},ge)),b.map((K,ge)=>z.jsx(_t,{lg:12,className:"mb-4",children:z.jsx("div",{className:"form-group",children:z.jsx(Yy,{name:K.name,placeholder:K.placeholder})})},ge))]}),z.jsxs(jt,{children:[z.jsx(_t,{lg:5,md:4,sm:12,className:"mb-4",children:z.jsx("div",{className:"form-group",children:z.jsx("div",{className:"button",children:z.jsx(au,{text:c,type:"submit",className:"btn"})})})}),z.jsx(_t,{lg:7,md:8,sm:12,className:"mb-4",children:z.jsx("p",{children:Z})})]})]})}),z.jsx(_t,{lg:6,md:12,children:z.jsx("div",{className:`${Eh.appointmentImage}`,children:z.jsx("img",{src:"/contact-img.png",alt:""})})})]})]})})}const $E="_newsletter_1fw63_9",VE="_subscribeText_1fw63_15",UE="_commonInput_1fw63_35",ZE="_btn_1fw63_63",Gp={newsletter:$E,subscribeText:VE,commonInput:UE,btn:ZE};function GE(){const{newsletter:{secTitle:r,secDesc:o,form:{input:d,submitText:_}}}=Ie.useContext(Nt),[x,C]=Ie.useState(d[0].placeholder),b=()=>{C(d[0].placeholder="")};return z.jsx("section",{className:`${Gp.newsletter} section`,children:z.jsx(_r,{children:z.jsxs(jt,{children:[z.jsx(_t,{lg:6,sm:12,children:z.jsxs("div",{className:`${Gp.subscribeText}`,children:[z.jsx("h6",{children:r}),z.jsx("p",{className:"",children:o})]})}),z.jsx(_t,{lg:6,sm:12,children:z.jsx("div",{className:"subscribe-form ",children:z.jsxs(Ml,{action:"",method:"get",target:"_blank",className:"newsletter-inner",children:[d.map((c,Z)=>z.jsx(ao,{name:c.name,type:c.type,placeholder:x,className:`${Gp.commonInput}`,onFocus:b},Z)),z.jsx(au,{text:_,type:"submit",className:`${Gp.btn} btn`})]})})})]})})})}function qp({title:r,desc:o}){return z.jsxs(z.Fragment,{children:[z.jsx("h2",{children:r}),z.jsx("p",{children:o})]})}const qE="_footer_7qpcb_7",WE="_footerTop_7qpcb_13",HE="_singleFooter_7qpcb_47",XE="_social_7qpcb_53",YE="_fLink_7qpcb_115",KE="_timeSidual_7qpcb_197",QE="_newsletterInner_7qpcb_243",JE="_button_7qpcb_331",ek="_copyright_7qpcb_395",tk="_copyrightContent_7qpcb_405",rk="_commonInput_7qpcb_425",es={footer:qE,footerTop:WE,singleFooter:HE,social:XE,fLink:YE,timeSidual:KE,newsletterInner:QE,button:JE,copyright:ek,copyrightContent:tk,commonInput:rk};function Wp({children:r,otherClass:o}){return z.jsx("div",{className:`${es.singleFooter} ${o}`,children:r})}function ik({copyRightText:r,webLink:o,webText:d}){return z.jsx("div",{className:`${es.copyright}`,children:z.jsx(_r,{children:z.jsx(jt,{children:z.jsx(_t,{lg:12,children:z.jsx("div",{className:`${es.copyrightContent}`,children:z.jsxs("p",{children:[r," ",z.jsx("a",{href:o,target:"_blank",children:d})," "]})})})})})})}function nk({children:r}){const{footer:{aboutTitle:o,quickTitle:d,openHourTitle:_,quickLinks:{link1:x,link2:C},footerSocial:b,openHourSchedule:{schedule:c},newsletterTitle:Z,copyRight:{copyRightText:K,webLink:ge,webText:be}},newsletter:{form:{input:O}}}=Ie.useContext(Nt);return z.jsxs(z.Fragment,{children:[r,z.jsxs("footer",{id:"footer",className:es.footer,children:[z.jsx("div",{className:es.footerTop,children:z.jsx(_r,{children:z.jsxs(jt,{children:[z.jsx(_t,{lg:3,md:6,sm:12,children:z.jsxs(Wp,{children:[z.jsx(qp,{title:o.secTitle,desc:o.secDesc}),z.jsx("ul",{className:es.social,children:b.map((H,ue)=>z.jsx("li",{children:z.jsx("a",{href:H.link,children:z.jsx("i",{className:H.icon})})},ue))})]})}),z.jsx(_t,{lg:3,md:6,sm:12,children:z.jsxs(Wp,{otherClass:es.fLink,children:[z.jsx(qp,{title:d.secTitle,desc:d.secDesc}),z.jsxs(jt,{children:[z.jsx(_t,{lg:6,md:6,sm:12,children:z.jsx("ul",{children:x.map((H,ue)=>z.jsx("li",{children:z.jsxs("a",{href:H.link,children:[z.jsx("i",{className:"fa fa-caret-right","aria-hidden":"true"}),H.text]})},ue))})}),z.jsx(_t,{lg:6,md:6,sm:12,children:z.jsx("ul",{children:C.map((H,ue)=>z.jsx("li",{children:z.jsxs("a",{href:H.link,children:[z.jsx("i",{className:"fa fa-caret-right","aria-hidden":"true"}),H.text]})},ue))})})]})]})}),z.jsx(_t,{lg:3,md:6,sm:12,children:z.jsxs(Wp,{children:[z.jsx(qp,{title:_.secTitle,desc:_.secDesc}),z.jsx("ul",{className:es.timeSidual,children:c.map((H,ue)=>z.jsxs("li",{className:"day",children:[H.days," ",z.jsx("span",{children:H.time})]},ue))})]})}),z.jsx(_t,{lg:3,md:6,sm:12,children:z.jsxs(Wp,{children:[z.jsx(qp,{title:Z.secTitle,desc:Z.secDesc}),z.jsxs(Ml,{action:"",method:"get",target:"_blank",className:`${es.newsletterInner}`,children:[O.map((H,ue)=>z.jsx(ao,{name:H.name,type:H.type,placeholder:H.placeholder,className:`${es.commonInput}`},ue)),z.jsx(au,{className:`${es.button}`,children:z.jsx("i",{className:"icofont icofont-paper-plane"})})]})]})})]})})}),z.jsx(ik,{copyRightText:K,webLink:ge,webText:be})]})]})}const sk="_slider_q0m9b_7",ok="_singleSlider_q0m9b_13",ak="_text_q0m9b_53",lk="_button_q0m9b_97",ck="_btn_q0m9b_103",uk="_primary_q0m9b_125",ul={slider:sk,singleSlider:ok,text:ak,button:lk,btn:ck,primary:uk};function hk({title:r,desc:o,btn:d,bgImg:_,owlClass:x}){return z.jsx("div",{className:`${ul.singleSlider} ${x}`,style:{backgroundImage:`url(${_})`},children:z.jsx(_r,{children:z.jsx(jt,{children:z.jsx(_t,{lg:7,children:z.jsxs("div",{className:`${ul.text}`,children:[z.jsx("h1",{children:r}),z.jsx("p",{children:o}),z.jsx("div",{className:`${ul.button}`,children:d.map((C,b)=>z.jsx("a",{href:C.link,className:b==1?`${ul.primary} btn`:`${ul.btn} btn`,children:C.text},b))})]})})})})})}function dk(){const{hero:r}=Ie.useContext(Nt);return z.jsx("section",{className:`${ul.slider}`,children:z.jsx(om,{className:`${ul.heroSlider} owl-theme`,loop:!0,margin:10,smartSpeed:500,nav:!0,items:1,autoplay:!0,dots:!1,children:r.map((o,d)=>z.jsx(hk,{title:o.title,desc:o.desc,btn:o.btn,bgImg:o.bgImg,owlClass:"item"},d))})})}function i1(){return Ie.useEffect(()=>{window.scroll(0,0)},[]),z.jsxs(z.Fragment,{children:[z.jsx(dk,{}),z.jsx(XI,{}),z.jsx(wI,{}),z.jsx(II,{}),z.jsx($I,{}),z.jsx(tE,{}),z.jsx(aE,{}),z.jsx(hE,{}),z.jsx(TE,{}),z.jsx(zE,{}),z.jsx(LE,{}),z.jsx(NE,{}),z.jsx(GE,{})]})}const pk="_breadcrumbs_4v0ei_3",fk="_breadInner_4v0ei_19",mk="_breadList_4v0ei_43",gk="_active_4v0ei_101",Hp={breadcrumbs:pk,breadInner:fk,breadList:mk,active:gk};function Ky({secTitle:r}){return z.jsx("div",{className:`${Hp.breadcrumbs} overlay`,children:z.jsx(_r,{children:z.jsx("div",{className:`${Hp.breadInner}`,children:z.jsx(jt,{children:z.jsxs(_t,{lg:12,children:[z.jsx("h2",{children:r}),z.jsxs("ul",{className:`${Hp.breadList}`,children:[z.jsx("li",{children:z.jsx(wl,{to:"/",children:"Home"})}),z.jsx("li",{children:z.jsx("i",{className:"icofont-simple-right"})}),z.jsx("li",{className:`${Hp.active}`,children:r})]})]})})})})})}const _k="_newsHead_1kcbf_1",yk={newsHead:_k};function vk(){const{blogs:{blogPage:{news:{newsImg:r}}}}=Ie.useContext(Nt);return z.jsx("div",{className:`${yk.newsHead}`,children:z.jsx("img",{src:r,alt:"#"})})}const xk="_newsTitle_12uq0_1",bk={newsTitle:xk};function wk(){const{blogs:{blogPage:{news:{newsTitle:{title:r,titleLink:o}}}}}=Ie.useContext(Nt);return z.jsx("h1",{className:`${bk.newsTitle}`,children:z.jsx("a",{href:o,children:r})})}const Tk="_meta_164kl_3",Sk="_metaLeft_164kl_49",Ck="_author_164kl_55",Pk="_date_164kl_73",Mk="_metaRight_164kl_79",sl={meta:Tk,metaLeft:Sk,author:Ck,date:Pk,metaRight:Mk};function Ik(){const{blogs:{blogPage:{news:{authorDetails:{authorImg:r,authorName:o,postDate:d,commentsCount:_,viewsCount:x}}}}}=Ie.useContext(Nt);return z.jsxs("div",{className:`${sl.meta}`,children:[z.jsxs("div",{className:`${sl.metaLeft}`,children:[z.jsx("span",{className:`${sl.author}`,children:z.jsxs("a",{href:"#",children:[z.jsx("img",{src:r,alt:"#"}),o]})}),z.jsxs("span",{className:`${sl.date}`,children:[z.jsx("i",{className:"fa fa-clock-o"}),d]})]}),z.jsxs("div",{className:`${sl.metaRight}`,children:[z.jsx("span",{className:`${sl.comments}`,children:z.jsxs("a",{href:"#",children:[z.jsx("i",{className:"fa fa-comments"}),_]})}),z.jsxs("span",{className:`${sl.views}`,children:[z.jsx("i",{className:"fa fa-eye"}),x]})]})]})}const Ek="_newsText_u6fzm_1",kk={newsText:Ek},zk="_imageGallery_eaqya_3",Ak="_singleImage_eaqya_9",$w={imageGallery:zk,singleImage:Ak};function Rk({img:r}){return z.jsx(_t,{lg:6,md:6,sm:12,children:z.jsx("div",{className:`${$w.singleImage}`,children:z.jsx("img",{src:r,alt:"#"})})})}function Dk(){const{blogs:{blogPage:{news:{newsGallery:r}}}}=Ie.useContext(Nt);return z.jsx("div",{className:`${$w.imageGallery}`,children:z.jsx(jt,{children:r.map((o,d)=>z.jsx(Rk,{img:o},d))})})}function Lk({children:r}){return z.jsx("blockquote",{className:"overlay",children:r})}function jk(){const{blogs:{blogPage:{news:{newsTexts:{text1:r,text2:o,text3:d},blockquoteText:_}}}}=Ie.useContext(Nt),x=C=>C.map((b,c)=>z.jsx("p",{children:b},c));return z.jsxs("div",{className:`${kk.newsText}`,children:[x(r),z.jsx(Dk,{}),x(o),z.jsx(Lk,{children:x(_)}),x(d)]})}const Fk="_singleMain_coopt_1",Bk={singleMain:Fk},Ok="_blogBottom_2jf9c_1",Nk={blogBottom:Ok},$k="_socialShare_tsfia_3",Vk="_facebook_tsfia_21",Uk="_twitter_tsfia_27",Zk="_googlePlus_tsfia_33",Gk="_linkedin_tsfia_39",qk="_pinterest_tsfia_45",Ec={socialShare:$k,facebook:Vk,twitter:Uk,googlePlus:Zk,linkedin:Gk,pinterest:qk};function Wk(){return z.jsxs("ul",{className:`${Ec.socialShare}`,children:[z.jsx("li",{className:`${Ec.facebook}`,children:z.jsxs("a",{href:"#",children:[z.jsx("i",{className:"fa-brands fa-facebook-f"}),z.jsx("span",{children:"Facebook"})]})}),z.jsx("li",{className:`${Ec.twitter}`,children:z.jsxs("a",{href:"#",children:[z.jsx("i",{className:"fa-brands fa-twitter"}),z.jsx("span",{children:"Twitter"})]})}),z.jsx("li",{className:`${Ec.googlePlus}`,children:z.jsx("a",{href:"#",children:z.jsx("i",{className:"fa-brands fa-google-plus-g"})})}),z.jsx("li",{className:`${Ec.linkedin}`,children:z.jsx("a",{href:"#",children:z.jsx("i",{className:"fa-brands fa-linkedin-in"})})}),z.jsx("li",{className:`${Ec.pinterest}`,children:z.jsx("a",{href:"#",children:z.jsx("i",{className:"fa-brands fa-pinterest-p"})})})]})}const Hk="_prevNext_11x0w_3",Xk={prevNext:Hk};function Yk(){return z.jsxs("ul",{className:`${Xk.prevNext}`,children:[z.jsx("li",{className:"prev",children:z.jsxs("a",{href:"#",children:[z.jsx("i",{className:"fa fa-angle-double-left"})," "]})}),z.jsx("li",{className:"next",children:z.jsxs("a",{href:"#",children:[z.jsx("i",{className:"fa fa-angle-double-right"})," "]})})]})}function Kk(){return z.jsxs("div",{className:`${Nk.blogBottom}`,children:[z.jsx(Wk,{}),z.jsx(Yk,{})]})}const Qk="_blogComments_163rm_3",Jk="_singleComments_163rm_41",ez="_main_163rm_55",tz="_head_163rm_93",rz="_body_163rm_119",iz="_commentMeta_163rm_169",nz="_meta_163rm_175",Xs={blogComments:Qk,singleComments:Jk,main:ez,head:tz,body:rz,commentMeta:iz,meta:nz};function sz({authorImg:r,authorName:o,postDate:d,postTime:_,commentText:x,replayLink:C,replayClass:b}){const[c,Z]=Ie.useState(!0),K=()=>{window.innerWidth<769?Z(!1):Z(!0)};return window.addEventListener("resize",K),Ie.useEffect(()=>{K()}),z.jsx("div",{className:c?`${Xs.singleComments} ${b}`:`${Xs.singleComments}`,children:z.jsxs("div",{className:`${Xs.main}`,children:[z.jsx("div",{className:`${Xs.head}`,children:z.jsx("img",{src:r,alt:"#"})}),z.jsxs("div",{className:`${Xs.body} body`,children:[z.jsx("h4",{children:o}),z.jsxs("div",{className:`${Xs.commentMeta}`,children:[z.jsxs("span",{className:`${Xs.meta}`,children:[z.jsx("i",{className:"fa-solid fa-calendar-days"}),d]}),z.jsxs("span",{className:`${Xs.meta}`,children:[z.jsx("i",{className:"fa-regular fa-clock"}),_]})]}),z.jsx("p",{children:x}),z.jsxs("a",{href:C,children:[z.jsx("i",{className:"fa fa-reply"}),"replay"]})]})]})})}function oz(){const{blogs:{blogPage:{news:{comments:{title:r,comment:o}}}}}=Ie.useContext(Nt);return z.jsxs("div",{className:`${Xs.blogComments}`,children:[z.jsx("h2",{children:r}),z.jsx("div",{className:"commentsBody",children:o.map(d=>z.jsx(sz,{authorImg:d.authorImg,authorName:d.authorName,postDate:d.postDate,postTime:d.postTime,commentText:d.commentText,replayLink:d.replayLink,replayClass:d.replay?"replay":""},Math.random()))})]})}const az="_commentsForm_1tyat_1",lz="_formGroup_1tyat_35",cz="_message_1tyat_133",Xp={commentsForm:az,formGroup:lz,message:cz};function uz(){const{blogs:{blogPage:{news:{comments:{leaveComments:{title:r,form:{input:o,msg:d,submitText:_}}}}}}}=Ie.useContext(Nt);return z.jsxs("div",{className:`${Xp.commentsForm}`,children:[z.jsx("h2",{children:r}),z.jsx(Ml,{method:"post",action:"mail/mail.php",children:z.jsxs(jt,{children:[o.map((x,C)=>z.jsx(_t,{lg:4,md:4,sm:12,children:z.jsxs("div",{className:`form-group ${Xp.formGroup}`,children:[z.jsx("i",{className:`fa ${x.icon}`}),z.jsx(ao,{type:x.type,name:x.name,placeholder:x.placeholder,required:"required"})]})},C)),d.map((x,C)=>z.jsx(_t,{lg:12,children:z.jsxs("div",{className:`form-group ${Xp.formGroup} ${Xp.message}`,children:[z.jsx("i",{className:`fa ${x.icon}`}),z.jsx(Yy,{type:x.type,name:x.name,placeholder:x.placeholder,required:"required"})]})},C)),z.jsx(_t,{lg:12,children:z.jsx("div",{className:"form-group button",children:z.jsx(au,{type:"submit",className:"btn primary",text:_,children:z.jsx("i",{className:"fa-solid fa-paper-plane"})})})})]})})]})}const hz="_mainSidebar_1ue9g_1",dz={mainSidebar:hz},pz="_singleWidget_7ew06_1",fz="_search_7ew06_69",mz="_form_7ew06_63",gz="_button_7ew06_109",Yp={singleWidget:pz,search:fz,form:mz,button:gz};function _z(){return z.jsx("div",{className:`${Yp.singleWidget} ${Yp.search}`,children:z.jsxs(Ml,{className:`${Yp.form}`,children:[z.jsx(ao,{type:"email",placeholder:"Search Here..."}),z.jsxs("a",{className:`${Yp.button}`,href:"#",children:["**",z.jsx("i",{className:"fa fa-search"})]})]})})}const yz="_singleWidget_1w5n8_1",vz="_title_1w5n8_19",xz="_categorList_1w5n8_61",Kp={singleWidget:yz,title:vz,categorList:xz};function bz(){const{blogs:{blogPage:{news:{sideBar:{widget:{categorys:{title:r,categoryItem:o}}}}}}}=Ie.useContext(Nt);return z.jsxs("div",{className:`${Kp.singleWidget} ${Kp.category}`,children:[z.jsx("h3",{className:`${Kp.title}`,children:r}),z.jsx("ul",{className:`${Kp.categorList}`,children:o.map(d=>z.jsx("li",{children:z.jsx("a",{href:"#",children:d})},Math.random()))})]})}const wz="_singleWidget_he6r7_1",Tz="_title_he6r7_19",Sz="_singlePost_he6r7_63",Cz="_image_he6r7_83",Pz="_content_he6r7_95",Mz="_comment_he6r7_133",fl={singleWidget:wz,title:Tz,singlePost:Sz,image:Cz,content:Pz,comment:Mz};function Iz({img:r,title:o,date:d,comments:_}){return z.jsxs("div",{className:`${fl.singlePost}`,children:[z.jsx("div",{className:`${fl.image}`,children:z.jsx("img",{src:r,alt:"#"})}),z.jsxs("div",{className:`${fl.content}`,children:[z.jsx("h5",{children:z.jsx("a",{href:"#",children:o})}),z.jsxs("ul",{className:`${fl.comment}`,children:[z.jsxs("li",{children:[z.jsx("i",{className:"fa-solid fa-calendar-days","aria-hidden":"true"}),d]}),z.jsxs("li",{children:[z.jsx("i",{className:"fa-regular fa-comment-dots","aria-hidden":"true"}),_]})]})]})]})}function Ez(){const{blogs:{blogPage:{news:{sideBar:{widget:{recentPost:{title:r,post:o}}}}}}}=Ie.useContext(Nt);return z.jsxs("div",{className:`${fl.singleWidget} ${fl.recentPost}`,children:[z.jsx("h3",{className:`${fl.title}`,children:r}),o.map(d=>z.jsx(Iz,{img:d.img,title:d.title,date:d.date,comments:d.comments},Math.random()))]})}const kz="_singleWidget_uzst3_1",zz="_title_uzst3_19",Az="_sideTags_uzst3_59",Rz="_tag_uzst3_59",Qp={singleWidget:kz,title:zz,sideTags:Az,tag:Rz};function Dz(){const{blogs:{blogPage:{news:{sideBar:{widget:{tags:{title:r,tag:o}}}}}}}=Ie.useContext(Nt);return z.jsxs("div",{className:`${Qp.singleWidget} ${Qp.sideTags}`,children:[z.jsx("h3",{className:`${Qp.title}`,children:r}),z.jsx("ul",{className:`${Qp.tag}`,children:o.map(d=>z.jsx("li",{children:z.jsx("a",{href:"#",children:d})},Math.random()))})]})}function Lz(){return z.jsxs("div",{className:`${dz.mainSidebar}`,children:[z.jsx(_z,{}),z.jsx(bz,{}),z.jsx(Ez,{}),z.jsx(Dz,{})]})}function jz(){return z.jsx("section",{className:"news-single section",children:z.jsx(_r,{children:z.jsxs(jt,{children:[z.jsx(_t,{lg:8,md:12,children:z.jsxs(jt,{children:[z.jsx(_t,{lg:12,children:z.jsxs("div",{className:`${Bk.singleMain}`,children:[z.jsx(vk,{}),z.jsx(wk,{}),z.jsx(Ik,{}),z.jsx(jk,{}),z.jsx(Kk,{})]})}),z.jsx(_t,{lg:12,children:z.jsx(oz,{})}),z.jsx(_t,{lg:12,children:z.jsx(uz,{})})]})}),z.jsx(_t,{lg:4,sm:12,children:z.jsx(Lz,{})})]})})})}function Fz(){const{blogs:{blogPage:{secTitle:r}}}=Ie.useContext(Nt);return Ie.useEffect(()=>{window.scroll(0,0)},[]),z.jsxs(z.Fragment,{children:[z.jsx(Ky,{secTitle:r}),z.jsx(jz,{})]})}function Bz({img:r}){return z.jsx("img",{src:r})}const Oz="_imageSlider_1pmrf_1",Nz={imageSlider:Oz};function $z(){const{portfolio:{portfolioPage:{portfolioSlider:r}}}=Ie.useContext(Nt);return z.jsx("div",{className:`${Nz.imageSlider}`,children:z.jsx(om,{className:"pf-details-slider",loop:!0,margin:10,smartSpeed:500,nav:!0,items:1,autoplay:!0,dots:!1,children:r.map(o=>z.jsx(Bz,{img:o}))})})}const Vz="_date_1by2c_1",Uz={date:Vz};function Zz(){const{portfolio:{portfolioPage:{portfolioInfo:{date:r}}}}=Ie.useContext(Nt);return z.jsx("div",{className:`${Uz.date}`,children:z.jsx("ul",{children:r.map(o=>z.jsxs("li",{children:[z.jsx("span",{children:o.category})," ",o.details]},Math.random()))})})}function Gz(){return z.jsx("section",{className:"pf-details section",children:z.jsx(_r,{children:z.jsx(jt,{children:z.jsx(_t,{lg:12,children:z.jsxs("div",{className:"inner-content",children:[z.jsx($z,{}),z.jsx(Zz,{})]})})})})})}function qz(){const{portfolio:{portfolioPage:{secTitle:r}}}=Ie.useContext(Nt);return Ie.useEffect(()=>{window.scroll(0,0)},[]),z.jsxs(z.Fragment,{children:[z.jsx(Ky,{secTitle:r}),z.jsx(Gz,{})]})}const Wz="_errorPage_1kii6_7",Hz="_errorInner_1kii6_17",Xz="_searchForm_1kii6_55",Yz="_btn_1kii6_95",Jp={errorPage:Wz,errorInner:Hz,searchForm:Xz,btn:Yz};function Kz(){const{error:{secTitle:r,tagline:o,secDesc:d}}=Ie.useContext(Nt);return z.jsx("section",{className:`${Jp.errorPage} section`,children:z.jsx(_r,{children:z.jsx(jt,{children:z.jsx("div",{className:"col-lg-6 offset-lg-3 col-12",children:z.jsxs("div",{className:Jp.errorInner,children:[z.jsxs("h1",{children:[r,z.jsx("span",{children:o})]}),z.jsx("p",{children:d}),z.jsxs(Ml,{className:Jp.searchForm,children:[z.jsx(ao,{placeholder:"Search from Here",type:"text"}),z.jsx(au,{className:`${Jp.btn} btn`,type:"submit",children:z.jsx("i",{className:"fa fa-search"})})]})]})})})})})}function Qz(){return Ie.useEffect(()=>{window.scroll(0,0)},[]),z.jsx(z.Fragment,{children:z.jsx(Kz,{})})}const Jz="_contactUs_uojn2_7",eA="_inner_uojn2_7",tA="_contactUsForm_uojn2_25",rA="_form_uojn2_85",iA="_formGroup_uojn2_91",nA="_loginBtn_uojn2_141",sA="_btn_uojn2_153",oA="_checkbox_uojn2_175",Ss={contactUs:Jz,inner:eA,contactUsForm:tA,form:rA,formGroup:iA,loginBtn:nA,btn:sA,checkbox:oA};function aA(){const{contactPage:{secTitle:r,secDesc:o,inputForm:d,textareaForm:_}}=Ie.useContext(Nt),[x,C]=Ie.useState(!1),b=c=>{C(!x),console.log(x)};return z.jsxs("div",{className:`${Ss.contactUsForm}`,children:[z.jsx("h2",{children:r}),z.jsx("p",{children:o}),z.jsx(Ml,{className:`${Ss.form}`,method:"post",action:"mail/mail.php",children:z.jsxs(jt,{children:[d.map((c,Z)=>{const{name:K,type:ge,placeholder:be}=c;return z.jsx(_t,{lg:6,children:z.jsx("div",{className:`${Ss.formGroup} form-group`,children:z.jsx(ao,{type:ge,name:K,placeholder:be,required:""})})},Z)}),_.map((c,Z)=>z.jsx(_t,{lg:12,children:z.jsx("div",{className:`${Ss.formGroup} form-group`,children:z.jsx(Yy,{name:"message",placeholder:"Your Message",required:""})})},Z)),z.jsxs("div",{className:"col-12",children:[z.jsx("div",{className:`${Ss.formGroup} ${Ss.loginBtn} form-group `,children:z.jsx(au,{className:`${Ss.btn} btn`,type:"submit",children:"Send"})}),z.jsx("div",{className:`${Ss.checkbox} checkbox`,children:z.jsxs("label",{className:`${x?"checked":""}`,onChange:()=>b(),htmlFor:"2",children:[z.jsx(ao,{type:"checkbox",name:"",id:"2"}),"Do you want to subscribe our Newsletter ?"]})})]})]})})]})}const lA="_contactInfo_1tch7_1",cA="_singleInfo_1tch7_11",uA="_content_1tch7_97",Qg={contactInfo:lA,singleInfo:cA,content:uA};function hA(){const{contactPage:{contactInfo:r}}=Ie.useContext(Nt);return z.jsx("div",{className:`${Qg.contactInfo}`,children:z.jsx(jt,{children:r.map((o,d)=>{const{icon:_,title:x,desc:C}=o;return z.jsx(_t,{lg:4,children:z.jsxs("div",{className:`${Qg.singleInfo}`,children:[z.jsx("i",{className:_}),z.jsxs("div",{className:`${Qg.content}`,children:[z.jsx("h3",{children:x}),z.jsx("p",{children:C})]})]})},d)})})})}var Vw={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.0/LICENSE.txt
 */(function(r,o){(function(d,_){r.exports=_()})(s1,function(){var d={},_={};function x(b,c,Z){if(_[b]=Z,b==="index"){var K="var sharedModule = {}; ("+_.shared+")(sharedModule); ("+_.worker+")(sharedModule);",ge={};return _.shared(ge),_.index(d,ge),typeof window<"u"&&d.setWorkerUrl(window.URL.createObjectURL(new Blob([K],{type:"text/javascript"}))),d}}x("shared",["exports"],function(b){function c(s,t,n,a){return new(n||(n=Promise))(function(h,m){function g(P){try{T(a.next(P))}catch(I){m(I)}}function v(P){try{T(a.throw(P))}catch(I){m(I)}}function T(P){var I;P.done?h(P.value):(I=P.value,I instanceof n?I:new n(function(A){A(I)})).then(g,v)}T((a=a.apply(s,t||[])).next())})}function Z(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var K,ge;function be(){if(ge)return K;function s(t,n){this.x=t,this.y=n}return ge=1,K=s,s.prototype={clone:function(){return new s(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,a=t.y-this.y;return n*n+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),a=Math.sin(t),h=a*this.x+n*this.y;return this.x=n*this.x-a*this.y,this.y=h,this},_rotateAround:function(t,n){var a=Math.cos(t),h=Math.sin(t),m=n.y+h*(this.x-n.x)+a*(this.y-n.y);return this.x=n.x+a*(this.x-n.x)-h*(this.y-n.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(t){return t instanceof s?t:Array.isArray(t)?new s(t[0],t[1]):t},K}typeof SuppressedError=="function"&&SuppressedError;var O,H,ue=Z(be()),Pe=function(){if(H)return O;function s(t,n,a,h){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=a,this.p2y=h}return H=1,O=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,h=0;h<8;h++){var m=this.sampleCurveX(a)-t;if(Math.abs(m)<n)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=m/g}var v=0,T=1;for(a=t,h=0;h<20&&(m=this.sampleCurveX(a),!(Math.abs(m-t)<n));h++)t>m?v=a:T=a,a=.5*(T-v)+v;return a},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},O}(),pe=Z(Pe);let E,R;function N(){return E==null&&(E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),E}function re(){if(R==null&&(R=!1,N())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let a=0;a<5*5;a++){const h=4*a;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(a%5,Math.floor(a/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&n[a]!==a){R=!0;break}}}return R||!1}var Te=1e-6,Ce=typeof Float32Array<"u"?Float32Array:Array;function Ne(){var s=new Ce(9);return Ce!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Ge(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function ht(){var s=new Ce(3);return Ce!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function dt(s){return Math.hypot(s[0],s[1],s[2])}function Gt(s,t,n){var a=new Ce(3);return a[0]=s,a[1]=t,a[2]=n,a}function yr(s,t,n){return s[0]=t[0]+n[0],s[1]=t[1]+n[1],s[2]=t[2]+n[2],s}function Lr(s,t,n){return s[0]=t[0]*n,s[1]=t[1]*n,s[2]=t[2]*n,s}function vn(s,t,n){var a=t[0],h=t[1],m=t[2],g=n[0],v=n[1],T=n[2];return s[0]=h*T-m*v,s[1]=m*g-a*T,s[2]=a*v-h*g,s}Math.hypot||(Math.hypot=function(){for(var s=0,t=arguments.length;t--;)s+=arguments[t]*arguments[t];return Math.sqrt(s)});var Ui,xn=dt;function rn(s,t,n){var a=t[0],h=t[1],m=t[2],g=t[3];return s[0]=n[0]*a+n[4]*h+n[8]*m+n[12]*g,s[1]=n[1]*a+n[5]*h+n[9]*m+n[13]*g,s[2]=n[2]*a+n[6]*h+n[10]*m+n[14]*g,s[3]=n[3]*a+n[7]*h+n[11]*m+n[15]*g,s}function st(){var s=new Ce(4);return Ce!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function xt(s,t,n,a){var h=.5*Math.PI/180;t*=h,n*=h,a*=h;var m=Math.sin(t),g=Math.cos(t),v=Math.sin(n),T=Math.cos(n),P=Math.sin(a),I=Math.cos(a);return s[0]=m*T*I-g*v*P,s[1]=g*v*I+m*T*P,s[2]=g*T*P-m*v*I,s[3]=g*T*I+m*v*P,s}function wt(){var s=new Ce(2);return Ce!=Float32Array&&(s[0]=0,s[1]=0),s}function Ft(s,t){var n=new Ce(2);return n[0]=s,n[1]=t,n}ht(),Ui=new Ce(4),Ce!=Float32Array&&(Ui[0]=0,Ui[1]=0,Ui[2]=0,Ui[3]=0),ht(),Gt(1,0,0),Gt(0,1,0),st(),st(),Ne(),wt();const vt=8192;function ii(s,t,n){return t*(vt/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}function Er(s,t){return(s%t+t)%t}function Zi(s,t,n){return s*(1-n)+t*n}function ui(s){if(s<=0)return 0;if(s>=1)return 1;const t=s*s,n=t*s;return 4*(s<.5?n:3*(s-t)+n-.75)}function nn(s,t,n,a){const h=new pe(s,t,n,a);return m=>h.solve(m)}const Il=nn(.25,.1,.25,1);function kr(s,t,n){return Math.min(n,Math.max(t,s))}function ua(s,t,n){const a=n-t,h=((s-t)%a+a)%a+t;return h===t?n:h}function ki(s,...t){for(const n of t)for(const a in n)s[a]=n[a];return s}let ha=1;function cr(s,t,n){const a={};for(const h in s)a[h]=t.call(this,s[h],h,s);return a}function bn(s,t,n){const a={};for(const h in s)t.call(this,s[h],h,s)&&(a[h]=s[h]);return a}function Gi(s){return Array.isArray(s)?s.map(Gi):typeof s=="object"&&s?cr(s,Gi):s}const uo={};function qr(s){uo[s]||(typeof console<"u"&&console.warn(s),uo[s]=!0)}function zi(s,t,n){return(n.y-s.y)*(t.x-s.x)>(t.y-s.y)*(n.x-s.x)}function xi(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let ks=null;function as(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const da="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function zs(s,t,n,a,h){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(s,{timestamp:0});try{const g=m==null?void 0:m.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const v=g.startsWith("BGR"),T=new Uint8ClampedArray(a*h*4);if(yield m.copyTo(T,function(P,I,A,j,$){const V=4*Math.max(1,0),G=(Math.max(0,A)-A)*j*4+V,Y=4*j,ie=Math.max(0,I),ye=Math.max(0,A);return{rect:{x:ie,y:ye,width:Math.min(P.width,I+j)-ie,height:Math.min(P.height,A+$)-ye},layout:[{offset:G,stride:Y}]}}(s,t,n,a,h)),v)for(let P=0;P<T.length;P+=4){const I=T[P];T[P]=T[P+2],T[P+2]=I}return T}finally{m.close()}})}let jn,As;function Fn(s,t,n,a){return s.addEventListener(t,n,a),{unsubscribe:()=>{s.removeEventListener(t,n,a)}}}function Ai(s){return s*Math.PI/180}function wn(s){return s/Math.PI*180}const pa={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},El={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Bn="AbortError";function Se(){return new Error(Bn)}const q={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function W(s){return q.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const J="global-dispatcher";class le extends Error{constructor(t,n,a,h){super(`AJAXError: ${n} (${t}): ${a}`),this.status=t,this.statusText=n,this.url=a,this.body=h}}const _e=()=>xi(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,we=function(s,t){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const a=W(s.url);if(a)return a(s,t);if(xi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:J},t)}if(!(/^file:/.test(n=s.url)||/^file:/.test(_e())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(a,h){return c(this,void 0,void 0,function*(){const m=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:_e(),signal:h.signal});let g,v;a.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");try{g=yield fetch(m)}catch(P){throw new le(0,P.message,a.url,new Blob)}if(!g.ok){const P=yield g.blob();throw new le(g.status,g.statusText,a.url,P)}v=a.type==="arrayBuffer"||a.type==="image"?g.arrayBuffer():a.type==="json"?g.json():g.text();const T=yield v;if(h.signal.aborted)throw Se();return{data:T,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}})}(s,t);if(xi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:J},t)}var n;return function(a,h){return new Promise((m,g)=>{var v;const T=new XMLHttpRequest;T.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(T.responseType="arraybuffer");for(const P in a.headers)T.setRequestHeader(P,a.headers[P]);a.type==="json"&&(T.responseType="text",!((v=a.headers)===null||v===void 0)&&v.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=a.credentials==="include",T.onerror=()=>{g(new Error(T.statusText))},T.onload=()=>{if(!h.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let P=T.response;if(a.type==="json")try{P=JSON.parse(T.response)}catch(I){return void g(I)}m({data:P,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const P=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});g(new le(T.status,T.statusText,a.url,P))}},h.signal.addEventListener("abort",()=>{T.abort(),g(Se())}),T.send(a.body)})}(s,t)};function Ae(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const t=new URL(s),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function xe(s,t,n){n[s]&&n[s].indexOf(t)!==-1||(n[s]=n[s]||[],n[s].push(t))}function Be(s,t,n){if(n&&n[s]){const a=n[s].indexOf(t);a!==-1&&n[s].splice(a,1)}}class je{constructor(t,n={}){ki(this,n),this.type=t}}class Me extends je{constructor(t,n={}){super("error",ki({error:t},n))}}class $e{on(t,n){return this._listeners=this._listeners||{},xe(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return Be(t,n,this._listeners),Be(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},xe(t,n,this._oneTimeListeners),this):new Promise(a=>this.once(t,a))}fire(t,n){typeof t=="string"&&(t=new je(t,n||{}));const a=t.type;if(this.listens(a)){t.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of h)v.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of m)Be(a,v,this._oneTimeListeners),v.call(this,t);const g=this._eventedParent;g&&(ki(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof Me&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Je=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ft(s,t){const n={};for(const a in s)a!=="ref"&&(n[a]=s[a]);return Je.forEach(a=>{a in t&&(n[a]=t[a])}),n}function tt(s,t){if(Array.isArray(s)){if(!Array.isArray(t)||s.length!==t.length)return!1;for(let n=0;n<s.length;n++)if(!tt(s[n],t[n]))return!1;return!0}if(typeof s=="object"&&s!==null&&t!==null){if(typeof t!="object"||Object.keys(s).length!==Object.keys(t).length)return!1;for(const n in s)if(!tt(s[n],t[n]))return!1;return!0}return s===t}function lt(s,t){s.push(t)}function yt(s,t,n){lt(n,{command:"addSource",args:[s,t[s]]})}function Yt(s,t,n){lt(t,{command:"removeSource",args:[s]}),n[s]=!0}function Ut(s,t,n,a){Yt(s,n,a),yt(s,t,n)}function Ot(s,t,n){let a;for(a in s[n])if(Object.prototype.hasOwnProperty.call(s[n],a)&&a!=="data"&&!tt(s[n][a],t[n][a]))return!1;for(a in t[n])if(Object.prototype.hasOwnProperty.call(t[n],a)&&a!=="data"&&!tt(s[n][a],t[n][a]))return!1;return!0}function gt(s,t,n,a,h,m){s=s||{},t=t||{};for(const g in s)Object.prototype.hasOwnProperty.call(s,g)&&(tt(s[g],t[g])||n.push({command:m,args:[a,g,t[g],h]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(s,g)&&(tt(s[g],t[g])||n.push({command:m,args:[a,g,t[g],h]}))}function Rt(s){return s.id}function jr(s,t){return s[t.id]=t,s}class He{constructor(t,n,a,h){this.message=(t?`${t}: `:"")+a,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function Wr(s,...t){for(const n of t)for(const a in n)s[a]=n[a];return s}class tr extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class ls{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[a,h]of n)this.bindings[a]=h}concat(t){return new ls(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Rs={kind:"null"},Ke={kind:"number"},Ct={kind:"string"},Pt={kind:"boolean"},Ri={kind:"color"},kl={kind:"projectionDefinition"},Tn={kind:"object"},Mt={kind:"value"},On={kind:"collator"},Ds={kind:"formatted"},vr={kind:"padding"},fa={kind:"colorArray"},ma={kind:"numberArray"},Nn={kind:"resolvedImage"},ga={kind:"variableAnchorOffsetCollection"};function Di(s,t){return{kind:"array",itemType:s,N:t}}function rr(s){if(s.kind==="array"){const t=rr(s.itemType);return typeof s.N=="number"?`array<${t}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${t}>`}return s.kind}const gd=[Rs,Ke,Ct,Pt,Ri,kl,Ds,Tn,Di(Mt),vr,ma,fa,Nn,ga];function _a(s,t){if(t.kind==="error")return null;if(s.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!_a(s.itemType,t.itemType))&&(typeof s.N!="number"||s.N===t.N))return null}else{if(s.kind===t.kind)return null;if(s.kind==="value"){for(const n of gd)if(!_a(n,t))return null}}return`Expected ${rr(s)} but found ${rr(t)} instead.`}function zl(s,t){return t.some(n=>n.kind===s.kind)}function Ls(s,t){return t.some(n=>n==="null"?s===null:n==="array"?Array.isArray(s):n==="object"?s&&!Array.isArray(s)&&typeof s=="object":n===typeof s)}function cs(s,t){return s.kind==="array"&&t.kind==="array"?s.itemType.kind===t.itemType.kind&&typeof s.N=="number":s.kind===t.kind}const _d=.96422,yd=.82521,vd=4/29,ho=6/29,xd=3*ho*ho,bd=ho*ho*ho,ya=Math.PI/180,am=180/Math.PI;function wd(s){return(s%=360)<0&&(s+=360),s}function po([s,t,n,a]){let h,m;const g=cu((.2225045*(s=lu(s))+.7168786*(t=lu(t))+.0606169*(n=lu(n)))/1);s===t&&t===n?h=m=g:(h=cu((.4360747*s+.3850649*t+.1430804*n)/_d),m=cu((.0139322*s+.0971045*t+.7141733*n)/yd));const v=116*g-16;return[v<0?0:v,500*(h-g),200*(g-m),a]}function lu(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function cu(s){return s>bd?Math.pow(s,1/3):s/xd+vd}function Td([s,t,n,a]){let h=(s+16)/116,m=isNaN(t)?h:h+t/500,g=isNaN(n)?h:h-n/200;return h=1*Rl(h),m=_d*Rl(m),g=yd*Rl(g),[Al(3.1338561*m-1.6168667*h-.4906146*g),Al(-.9787684*m+1.9161415*h+.033454*g),Al(.0719453*m-.2289914*h+1.4052427*g),a]}function Al(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Rl(s){return s>ho?s*s*s:xd*(s-vd)}const Sn=Object.hasOwn||function(s,t){return Object.prototype.hasOwnProperty.call(s,t)};function It(s,t){return Sn(s,t)?s[t]:void 0}function $n(s){return parseInt(s.padEnd(2,s),16)/255}function Vn(s,t){return js(t?s/100:s,0,1)}function js(s,t,n){return Math.min(Math.max(t,s),n)}function uu(s){return!s.some(Number.isNaN)}const hu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function qi(s,t,n){return s+n*(t-s)}function Un(s,t,n){return s.map((a,h)=>qi(a,t[h],n))}class Et{constructor(t,n,a,h=1,m=!0){this.r=t,this.g=n,this.b=a,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,n,a,h]))}static parse(t){if(t instanceof Et)return t;if(typeof t!="string")return;const n=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=It(hu,a);if(h){const[g,v,T]=h;return[g/255,v/255,T/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const g=a.length<6?1:2;let v=1;return[$n(a.slice(v,v+=g)),$n(a.slice(v,v+=g)),$n(a.slice(v,v+=g)),$n(a.slice(v,v+g)||"ff")]}if(a.startsWith("rgb")){const g=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[v,T,P,I,A,j,$,V,G,Y,ie,ye]=g,ae=[I||" ",$||" ",Y].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const B=[P,j,G].join(""),X=B==="%%%"?100:B===""?255:0;if(X){const he=[js(+T/X,0,1),js(+A/X,0,1),js(+V/X,0,1),ie?Vn(+ie,ye):1];if(uu(he))return he}}return}}const m=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[g,v,T,P,I,A,j,$,V]=m,G=[T||" ",I||" ",j].join("");if(G==="  "||G==="  /"||G===",,"||G===",,,"){const Y=[+v,js(+P,0,100),js(+A,0,100),$?Vn(+$,V):1];if(uu(Y))return function([ie,ye,ae,B]){function X(he){const ze=(he+ie/30)%12,Ve=ye*Math.min(ae,1-ae);return ae-Ve*Math.max(-1,Math.min(ze-3,9-ze,1))}return ie=wd(ie),ye/=100,ae/=100,[X(0),X(8),X(4),B]}(Y)}}}(t);return n?new Et(...n,!1):void 0}get rgb(){const{r:t,g:n,b:a,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,n/m,a/m,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,a,h,m]=po(t),g=Math.sqrt(a*a+h*h);return[Math.round(1e4*g)?wd(Math.atan2(h,a)*am):NaN,g,n,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",po(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,a,h]=this.rgb;return`rgba(${[t,n,a].map(m=>Math.round(255*m)).join(",")},${h})`}static interpolate(t,n,a,h="rgb"){switch(h){case"rgb":{const[m,g,v,T]=Un(t.rgb,n.rgb,a);return new Et(m,g,v,T,!1)}case"hcl":{const[m,g,v,T]=t.hcl,[P,I,A,j]=n.hcl;let $,V;if(isNaN(m)||isNaN(P))isNaN(m)?isNaN(P)?$=NaN:($=P,v!==1&&v!==0||(V=I)):($=m,A!==1&&A!==0||(V=g));else{let ae=P-m;P>m&&ae>180?ae-=360:P<m&&m-P>180&&(ae+=360),$=m+a*ae}const[G,Y,ie,ye]=function([ae,B,X,he]){return ae=isNaN(ae)?0:ae*ya,Td([X,Math.cos(ae)*B,Math.sin(ae)*B,he])}([$,V??qi(g,I,a),qi(v,A,a),qi(T,j,a)]);return new Et(G,Y,ie,ye,!1)}case"lab":{const[m,g,v,T]=Td(Un(t.lab,n.lab,a));return new Et(m,g,v,T,!1)}}}}Et.black=new Et(0,0,0,1),Et.white=new Et(1,1,1,1),Et.transparent=new Et(0,0,0,0),Et.red=new Et(1,0,0,1);class va{constructor(t,n,a){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Dl=["bottom","center","top"];class du{constructor(t,n,a,h,m,g){this.text=t,this.image=n,this.scale=a,this.fontStack=h,this.textColor=m,this.verticalAlign=g}}class ni{constructor(t){this.sections=t}static fromString(t){return new ni([new du(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof ni?t:ni.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Cr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Cr)return t;if(typeof t=="number")return new Cr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Cr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,a){return new Cr(Un(t.values,n.values,a))}}class si{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof si)return t;if(typeof t=="number")return new si([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new si(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,a){return new si(Un(t.values,n.values,a))}}class Fr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Fr)return t;if(typeof t=="string"){const a=Et.parse(t);return a?new Fr([a]):void 0}if(!Array.isArray(t))return;const n=[];for(const a of t){if(typeof a!="string")return;const h=Et.parse(a);if(!h)return;n.push(h)}return new Fr(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,a,h="rgb"){const m=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let g=0;g<t.values.length;g++)m.push(Et.interpolate(t.values[g],n.values[g],a,h));return new Fr(m)}}class ir extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Ll=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Dt{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Dt)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const a=t[n],h=t[n+1];if(typeof a!="string"||!Ll.has(a)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new Dt(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,a){const h=t.values,m=n.values;if(h.length!==m.length)throw new ir(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const g=[];for(let v=0;v<h.length;v+=2){if(h[v]!==m[v])throw new ir(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${m[v]}`);g.push(h[v]);const[T,P]=h[v+1],[I,A]=m[v+1];g.push([qi(T,I,a),qi(P,A,a)])}return new Dt(g)}}class bi{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new bi({name:t,available:!1}):null}}class bt{constructor(t,n,a){this.from=t,this.to=n,this.transition=a}static interpolate(t,n,a){return new bt(t,n,a)}static parse(t){return t instanceof bt?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new bt(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new bt(t.from,t.to,t.transition):typeof t=="string"?new bt(t,t,1):void 0}}function Tt(s,t,n,a){return typeof s=="number"&&s>=0&&s<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[s,t,n,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[s,t,n,a]:[s,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fs(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof bt||s instanceof Et||s instanceof va||s instanceof ni||s instanceof Cr||s instanceof si||s instanceof Fr||s instanceof Dt||s instanceof bi)return!0;if(Array.isArray(s)){for(const t of s)if(!Fs(t))return!1;return!0}if(typeof s=="object"){for(const t in s)if(!Fs(s[t]))return!1;return!0}return!1}function mt(s){if(s===null)return Rs;if(typeof s=="string")return Ct;if(typeof s=="boolean")return Pt;if(typeof s=="number")return Ke;if(s instanceof Et)return Ri;if(s instanceof bt)return kl;if(s instanceof va)return On;if(s instanceof ni)return Ds;if(s instanceof Cr)return vr;if(s instanceof si)return ma;if(s instanceof Fr)return fa;if(s instanceof Dt)return ga;if(s instanceof bi)return Nn;if(Array.isArray(s)){const t=s.length;let n;for(const a of s){const h=mt(a);if(n){if(n===h)continue;n=Mt;break}n=h}return Di(n||Mt,t)}return Tn}function Bs(s){const t=typeof s;return s===null?"":t==="string"||t==="number"||t==="boolean"?String(s):s instanceof Et||s instanceof bt||s instanceof ni||s instanceof Cr||s instanceof si||s instanceof Fr||s instanceof Dt||s instanceof bi?s.toString():JSON.stringify(s)}class hi{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Fs(t[1]))return n.error("invalid value");const a=t[1];let h=mt(a);const m=n.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new hi(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const fo={string:Ct,number:Ke,boolean:Pt,object:Tn};class Wi{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let a,h=1;const m=t[0];if(m==="array"){let v,T;if(t.length>2){const P=t[1];if(typeof P!="string"||!(P in fo)||P==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=fo[P],h++}else v=Mt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);T=t[2],h++}a=Di(v,T)}else{if(!fo[m])throw new Error(`Types doesn't contain name = ${m}`);a=fo[m]}const g=[];for(;h<t.length;h++){const v=n.parse(t[h],h,Mt);if(!v)return null;g.push(v)}return new Wi(a,g)}evaluate(t){for(let n=0;n<this.args.length;n++){const a=this.args[n].evaluate(t);if(!_a(this.type,mt(a)))return a;if(n===this.args.length-1)throw new ir(`Expected value to be of type ${rr(this.type)}, but found ${rr(mt(a))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const pu={"to-boolean":Pt,"to-color":Ri,"to-number":Ke,"to-string":Ct};class Cn{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const a=t[0];if(!pu[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&t.length!==2)return n.error("Expected one argument.");const h=pu[a],m=[];for(let g=1;g<t.length;g++){const v=n.parse(t[g],g,Mt);if(!v)return null;m.push(v)}return new Cn(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,a;for(const h of this.args){if(n=h.evaluate(t),a=null,n instanceof Et)return n;if(typeof n=="string"){const m=t.parseColor(n);if(m)return m}else if(Array.isArray(n)&&(a=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Tt(n[0],n[1],n[2],n[3]),!a))return new Et(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new ir(a||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const a of this.args){n=a.evaluate(t);const h=Cr.parse(n);if(h)return h}throw new ir(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const a of this.args){n=a.evaluate(t);const h=si.parse(n);if(h)return h}throw new ir(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const a of this.args){n=a.evaluate(t);const h=Fr.parse(n);if(h)return h}throw new ir(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const a of this.args){n=a.evaluate(t);const h=Dt.parse(n);if(h)return h}throw new ir(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const a of this.args){if(n=a.evaluate(t),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new ir(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return ni.fromString(Bs(this.args[0].evaluate(t)));case"resolvedImage":return bi.fromString(Bs(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Bs(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Sd=["Unknown","Point","LineString","Polygon"];class Cd{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Sd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=Et.parse(t),this._parseColorCache.set(t,n)),n}}class xa{constructor(t,n,a=[],h,m=new ls,g=[]){this.registry=t,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=m,this.errors=g,this.expectedType=h,this._isConstant=n}parse(t,n,a,h,m={}){return n?this.concat(n,a,h)._parse(t,m):this._parse(t,m)}_parse(t,n){function a(h,m,g){return g==="assert"?new Wi(m,[h]):g==="coerce"?new Cn(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let g=m.parse(t,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,T=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value"){if(v.kind==="projectionDefinition"&&["string","array"].includes(T.kind)||["color","formatted","resolvedImage"].includes(v.kind)&&["value","string"].includes(T.kind)||["padding","numberArray"].includes(v.kind)&&["value","number","array"].includes(T.kind)||v.kind==="colorArray"&&["value","string","array"].includes(T.kind)||v.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(T.kind))g=a(g,v,n.typeAnnotation||"coerce");else if(this.checkSubtype(v,T))return null}else g=a(g,v,n.typeAnnotation||"assert")}if(!(g instanceof hi)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const v=new Cd;try{g=new hi(g.type,g.evaluate(v))}catch(T){return this.error(T.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,a){const h=typeof t=="number"?this.path.concat(t):this.path,m=a?this.scope.concat(a):this.scope;return new xa(this.registry,this._isConstant,h,n||null,m,this.errors)}error(t,...n){const a=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new tr(a,t))}checkSubtype(t,n){const a=_a(t,n);return a&&this.error(a),a}}class ba{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const a=[];for(let m=1;m<t.length-1;m+=2){const g=t[m];if(typeof g!="string")return n.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return n.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=n.parse(t[m+1],m+1);if(!v)return null;a.push([g,v])}const h=n.parse(t[t.length-1],t.length-1,n.expectedType,a);return h?new ba(a,h):null}outputDefined(){return this.result.outputDefined()}}class sn{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const a=t[1];return n.scope.has(a)?new sn(a,n.scope.get(a)):n.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Br{constructor(t,n,a){this.type=t,this.index=n,this.input=a}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Ke),h=n.parse(t[2],2,Di(n.expectedType||Mt));return a&&h?new Br(h.type.itemType,a,h):null}evaluate(t){const n=this.index.evaluate(t),a=this.input.evaluate(t);if(n<0)throw new ir(`Array index out of bounds: ${n} < 0.`);if(n>=a.length)throw new ir(`Array index out of bounds: ${n} > ${a.length-1}.`);if(n!==Math.floor(n))throw new ir(`Array index must be an integer, but found ${n} instead.`);return a[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class mo{constructor(t,n){this.type=Pt,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Mt),h=n.parse(t[2],2,Mt);return a&&h?zl(a.type,[Pt,Ct,Ke,Rs,Mt])?new mo(a,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${rr(a.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!a)return!1;if(!Ls(n,["boolean","string","number","null"]))throw new ir(`Expected first argument to be of type boolean, string, number or null, but found ${rr(mt(n))} instead.`);if(!Ls(a,["string","array"]))throw new ir(`Expected second argument to be of type array or string, but found ${rr(mt(a))} instead.`);return a.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class wa{constructor(t,n,a){this.type=Ke,this.needle=t,this.haystack=n,this.fromIndex=a}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Mt),h=n.parse(t[2],2,Mt);if(!a||!h)return null;if(!zl(a.type,[Pt,Ct,Ke,Rs,Mt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${rr(a.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,Ke);return m?new wa(a,h,m):null}return new wa(a,h)}evaluate(t){const n=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!Ls(n,["boolean","string","number","null"]))throw new ir(`Expected first argument to be of type boolean, string, number or null, but found ${rr(mt(n))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),Ls(a,["string"])){const m=a.indexOf(n,h);return m===-1?-1:[...a.slice(0,m)].length}if(Ls(a,["array"]))return a.indexOf(n,h);throw new ir(`Expected second argument to be of type array or string, but found ${rr(mt(a))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class go{constructor(t,n,a,h,m,g){this.inputType=t,this.type=n,this.input=a,this.cases=h,this.outputs=m,this.otherwise=g}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let a,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m={},g=[];for(let P=2;P<t.length-1;P+=2){let I=t[P];const A=t[P+1];Array.isArray(I)||(I=[I]);const j=n.concat(P);if(I.length===0)return j.error("Expected at least one branch label.");for(const V of I){if(typeof V!="number"&&typeof V!="string")return j.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return j.error("Numeric branch labels must be integer values.");if(a){if(j.checkSubtype(a,mt(V)))return null}else a=mt(V);if(m[String(V)]!==void 0)return j.error("Branch labels must be unique.");m[String(V)]=g.length}const $=n.parse(A,P,h);if(!$)return null;h=h||$.type,g.push($)}const v=n.parse(t[1],1,Mt);if(!v)return null;const T=n.parse(t[t.length-1],t.length-1,h);return T?v.type.kind!=="value"&&n.concat(1).checkSubtype(a,v.type)?null:new go(a,h,v,m,g,T):null}evaluate(t){const n=this.input.evaluate(t);return(mt(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Pr{constructor(t,n,a){this.type=t,this.branches=n,this.otherwise=a}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const h=[];for(let g=1;g<t.length-1;g+=2){const v=n.parse(t[g],g,Pt);if(!v)return null;const T=n.parse(t[g+1],g+1,a);if(!T)return null;h.push([v,T]),a=a||T.type}const m=n.parse(t[t.length-1],t.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new Pr(a,h,m)}evaluate(t){for(const[n,a]of this.branches)if(n.evaluate(t))return a.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,a]of this.branches)t(n),t(a);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Ta{constructor(t,n,a,h){this.type=t,this.input=n,this.beginIndex=a,this.endIndex=h}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Mt),h=n.parse(t[2],2,Ke);if(!a||!h)return null;if(!zl(a.type,[Di(Mt),Ct,Mt]))return n.error(`Expected first argument to be of type array or string, but found ${rr(a.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,Ke);return m?new Ta(a.type,a,h,m):null}return new Ta(a.type,a,h)}evaluate(t){const n=this.input.evaluate(t),a=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),Ls(n,["string"]))return[...n].slice(a,h).join("");if(Ls(n,["array"]))return n.slice(a,h);throw new ir(`Expected first argument to be of type array or string, but found ${rr(mt(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function _o(s,t){const n=s.length-1;let a,h,m=0,g=n,v=0;for(;m<=g;)if(v=Math.floor((m+g)/2),a=s[v],h=s[v+1],a<=t){if(v===n||t<h)return v;m=v+1}else{if(!(a>t))throw new ir("Input is not a number.");g=v-1}return 0}class yo{constructor(t,n,a){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const a=n.parse(t[1],1,Ke);if(!a)return null;const h=[];let m=null;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);for(let g=1;g<t.length;g+=2){const v=g===1?-1/0:t[g],T=t[g+1],P=g,I=g+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(h.length&&h[h.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const A=n.parse(T,I,m);if(!A)return null;m=m||A.type,h.push([v,A])}return new yo(m,a,h)}evaluate(t){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return a[0].evaluate(t);const m=n.length;return h>=n[m-1]?a[m-1].evaluate(t):a[_o(n,h)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function lm(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var us,Sa,fu=function(){if(Sa)return us;function s(t,n,a,h){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=a,this.p2y=h}return Sa=1,us=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,h=0;h<8;h++){var m=this.sampleCurveX(a)-t;if(Math.abs(m)<n)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=m/g}var v=0,T=1;for(a=t,h=0;h<20&&(m=this.sampleCurveX(a),!(Math.abs(m-t)<n));h++)t>m?v=a:T=a,a=.5*(T-v)+v;return a},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},us}(),cm=lm(fu);class di{constructor(t,n,a,h,m){this.type=t,this.operator=n,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[g,v]of m)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(t,n,a,h){let m=0;if(t.name==="exponential")m=vo(n,t.base,a,h);else if(t.name==="linear")m=vo(n,1,a,h);else if(t.name==="cubic-bezier"){const g=t.controlPoints;m=new cm(g[0],g[1],g[2],g[3]).solve(vo(n,1,a,h))}return m}static parse(t,n){let[a,h,m,...g]=t;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const P=h[1];if(typeof P!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:P}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const P=h.slice(1);if(P.length!==4||P.some(I=>typeof I!="number"||I<0||I>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:P}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(m=n.parse(m,2,Ke),!m)return null;const v=[];let T=null;a!=="interpolate-hcl"&&a!=="interpolate-lab"||n.expectedType==fa?n.expectedType&&n.expectedType.kind!=="value"&&(T=n.expectedType):T=Ri;for(let P=0;P<g.length;P+=2){const I=g[P],A=g[P+1],j=P+3,$=P+4;if(typeof I!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(v.length&&v[v.length-1][0]>=I)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const V=n.parse(A,$,T);if(!V)return null;T=T||V.type,v.push([I,V])}return cs(T,Ke)||cs(T,kl)||cs(T,Ri)||cs(T,vr)||cs(T,ma)||cs(T,fa)||cs(T,ga)||cs(T,Di(Ke))?new di(T,a,h,m,v):n.error(`Type ${rr(T)} is not interpolatable.`)}evaluate(t){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return a[0].evaluate(t);const m=n.length;if(h>=n[m-1])return a[m-1].evaluate(t);const g=_o(n,h),v=di.interpolationFactor(this.interpolation,h,n[g],n[g+1]),T=a[g].evaluate(t),P=a[g+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return qi(T,P,v);case"color":return Et.interpolate(T,P,v);case"padding":return Cr.interpolate(T,P,v);case"colorArray":return Fr.interpolate(T,P,v);case"numberArray":return si.interpolate(T,P,v);case"variableAnchorOffsetCollection":return Dt.interpolate(T,P,v);case"array":return Un(T,P,v);case"projectionDefinition":return bt.interpolate(T,P,v)}case"interpolate-hcl":switch(this.type.kind){case"color":return Et.interpolate(T,P,v,"hcl");case"colorArray":return Fr.interpolate(T,P,v,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Et.interpolate(T,P,v,"lab");case"colorArray":return Fr.interpolate(T,P,v,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function vo(s,t,n,a){const h=a-n,m=s-n;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}const Li={color:Et.interpolate,number:qi,padding:Cr.interpolate,numberArray:si.interpolate,colorArray:Fr.interpolate,variableAnchorOffsetCollection:Dt.interpolate,array:Un};class wi{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let a=null;const h=n.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const v of t.slice(1)){const T=n.parse(v,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!T)return null;a=a||T.type,m.push(T)}if(!a)throw new Error("No output type");const g=h&&m.some(v=>_a(h,v.type));return new wi(g?Mt:a,m)}evaluate(t){let n,a=null,h=0;for(const m of this.args)if(h++,a=m.evaluate(t),a&&a instanceof bi&&!a.available&&(n||(n=a.name),a=null,h===this.args.length&&(a=n)),a!==null)break;return a}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function mu(s,t){return s==="=="||s==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ca(s,t,n,a){return a.compare(t,n)===0}function xo(s,t,n){const a=s!=="=="&&s!=="!=";return class Uw{constructor(m,g,v){this.type=Pt,this.lhs=m,this.rhs=g,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const v=m[0];let T=g.parse(m[1],1,Mt);if(!T)return null;if(!mu(v,T.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${rr(T.type)}'.`);let P=g.parse(m[2],2,Mt);if(!P)return null;if(!mu(v,P.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${rr(P.type)}'.`);if(T.type.kind!==P.type.kind&&T.type.kind!=="value"&&P.type.kind!=="value")return g.error(`Cannot compare types '${rr(T.type)}' and '${rr(P.type)}'.`);a&&(T.type.kind==="value"&&P.type.kind!=="value"?T=new Wi(P.type,[T]):T.type.kind!=="value"&&P.type.kind==="value"&&(P=new Wi(T.type,[P])));let I=null;if(m.length===4){if(T.type.kind!=="string"&&P.type.kind!=="string"&&T.type.kind!=="value"&&P.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(I=g.parse(m[3],3,On),!I)return null}return new Uw(T,P,I)}evaluate(m){const g=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const T=mt(g),P=mt(v);if(T.kind!==P.kind||T.kind!=="string"&&T.kind!=="number")throw new ir(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${T.kind}, ${P.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const T=mt(g),P=mt(v);if(T.kind!=="string"||P.kind!=="string")return t(m,g,v)}return this.collator?n(m,g,v,this.collator.evaluate(m)):t(m,g,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const gu=xo("==",function(s,t,n){return t===n},Ca),um=xo("!=",function(s,t,n){return t!==n},function(s,t,n,a){return!Ca(0,t,n,a)}),hm=xo("<",function(s,t,n){return t<n},function(s,t,n,a){return a.compare(t,n)<0}),dm=xo(">",function(s,t,n){return t>n},function(s,t,n,a){return a.compare(t,n)>0}),pm=xo("<=",function(s,t,n){return t<=n},function(s,t,n,a){return a.compare(t,n)<=0}),jl=xo(">=",function(s,t,n){return t>=n},function(s,t,n,a){return a.compare(t,n)>=0});class Fl{constructor(t,n,a){this.type=On,this.locale=a,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const a=t[1];if(typeof a!="object"||Array.isArray(a))return n.error("Collator options argument must be an object.");const h=n.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,Pt);if(!h)return null;const m=n.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,Pt);if(!m)return null;let g=null;return a.locale&&(g=n.parse(a.locale,1,Ct),!g)?null:new Fl(h,m,g)}evaluate(t){return new va(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Bl{constructor(t,n,a,h,m){this.type=Ct,this.number=t,this.locale=n,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const a=n.parse(t[1],1,Ke);if(!a)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=n.parse(h.locale,1,Ct),!m))return null;let g=null;if(h.currency&&(g=n.parse(h.currency,1,Ct),!g))return null;let v=null;if(h["min-fraction-digits"]&&(v=n.parse(h["min-fraction-digits"],1,Ke),!v))return null;let T=null;return h["max-fraction-digits"]&&(T=n.parse(h["max-fraction-digits"],1,Ke),!T)?null:new Bl(a,m,g,v,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Pa{constructor(t){this.type=Ds,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const a=t[1];if(!Array.isArray(a)&&typeof a=="object")return n.error("First argument must be an image or text section.");const h=[];let m=!1;for(let g=1;g<=t.length-1;++g){const v=t[g];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let T=null;if(v["font-scale"]&&(T=n.parse(v["font-scale"],1,Ke),!T))return null;let P=null;if(v["text-font"]&&(P=n.parse(v["text-font"],1,Di(Ct)),!P))return null;let I=null;if(v["text-color"]&&(I=n.parse(v["text-color"],1,Ri),!I))return null;let A=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!Dl.includes(v["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(A=n.parse(v["vertical-align"],1,Ct),!A)return null}const j=h[h.length-1];j.scale=T,j.font=P,j.textColor=I,j.verticalAlign=A}else{const T=n.parse(t[g],1,Mt);if(!T)return null;const P=T.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Pa(h)}evaluate(t){return new ni(this.sections.map(n=>{const a=n.content.evaluate(t);return mt(a)===Nn?new du("",a,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new du(Bs(a),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class _u{constructor(t){this.type=Nn,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const a=n.parse(t[1],1,Ct);return a?new _u(a):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),a=bi.fromString(n);return a&&t.availableImages&&(a.available=t.availableImages.indexOf(n)>-1),a}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ol{constructor(t){this.type=Ke,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const a=n.parse(t[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${rr(a.type)} instead.`):new Ol(a):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new ir(`Expected value to be of type string or array, but found ${rr(mt(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Pn=8192;function fm(s,t){const n=(180+s[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(n*h*Pn),Math.round(a*h*Pn)]}function yu(s,t){const n=Math.pow(2,t.z);return[(h=(s[0]/Pn+t.x)/n,360*h-180),(a=(s[1]/Pn+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90)];var a,h}function Ma(s,t){s[0]=Math.min(s[0],t[0]),s[1]=Math.min(s[1],t[1]),s[2]=Math.max(s[2],t[0]),s[3]=Math.max(s[3],t[1])}function Ia(s,t){return!(s[0]<=t[0]||s[2]>=t[2]||s[1]<=t[1]||s[3]>=t[3])}function Pd(s,t,n){const a=s[0]-t[0],h=s[1]-t[1],m=s[0]-n[0],g=s[1]-n[1];return a*g-m*h==0&&a*m<=0&&h*g<=0}function Ea(s,t,n,a){return(h=[a[0]-n[0],a[1]-n[1]])[0]*(m=[t[0]-s[0],t[1]-s[1]])[1]-h[1]*m[0]!=0&&!(!Nl(s,t,n,a)||!Nl(n,a,s,t));var h,m}function Md(s,t,n){for(const a of n)for(let h=0;h<a.length-1;++h)if(Ea(s,t,a[h],a[h+1]))return!0;return!1}function bo(s,t,n=!1){let a=!1;for(const v of t)for(let T=0;T<v.length-1;T++){if(Pd(s,v[T],v[T+1]))return n;(m=v[T])[1]>(h=s)[1]!=(g=v[T+1])[1]>h[1]&&h[0]<(g[0]-m[0])*(h[1]-m[1])/(g[1]-m[1])+m[0]&&(a=!a)}var h,m,g;return a}function mm(s,t){for(const n of t)if(bo(s,n))return!0;return!1}function Id(s,t){for(const n of s)if(!bo(n,t))return!1;for(let n=0;n<s.length-1;++n)if(Md(s[n],s[n+1],t))return!1;return!0}function gm(s,t){for(const n of t)if(Id(s,n))return!0;return!1}function Nl(s,t,n,a){const h=a[0]-n[0],m=a[1]-n[1],g=(s[0]-n[0])*m-h*(s[1]-n[1]),v=(t[0]-n[0])*m-h*(t[1]-n[1]);return g>0&&v<0||g<0&&v>0}function vu(s,t,n){const a=[];for(let h=0;h<s.length;h++){const m=[];for(let g=0;g<s[h].length;g++){const v=fm(s[h][g],n);Ma(t,v),m.push(v)}a.push(m)}return a}function Ed(s,t,n){const a=[];for(let h=0;h<s.length;h++){const m=vu(s[h],t,n);a.push(m)}return a}function kd(s,t,n,a){if(s[0]<n[0]||s[0]>n[2]){const h=.5*a;let m=s[0]-n[0]>h?-a:n[0]-s[0]>h?a:0;m===0&&(m=s[0]-n[2]>h?-a:n[2]-s[0]>h?a:0),s[0]+=m}Ma(t,s)}function xu(s,t,n,a){const h=Math.pow(2,a.z)*Pn,m=[a.x*Pn,a.y*Pn],g=[];for(const v of s)for(const T of v){const P=[T.x+m[0],T.y+m[1]];kd(P,t,n,h),g.push(P)}return g}function bu(s,t,n,a){const h=Math.pow(2,a.z)*Pn,m=[a.x*Pn,a.y*Pn],g=[];for(const T of s){const P=[];for(const I of T){const A=[I.x+m[0],I.y+m[1]];Ma(t,A),P.push(A)}g.push(P)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const T of g)for(const P of T)kd(P,t,n,h)}var v;return g}class Os{constructor(t,n){this.type=Pt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Fs(t[1])){const a=t[1];if(a.type==="FeatureCollection"){const h=[];for(const m of a.features){const{type:g,coordinates:v}=m.geometry;g==="Polygon"&&h.push(v),g==="MultiPolygon"&&h.push(...v)}if(h.length)return new Os(a,{type:"MultiPolygon",coordinates:h})}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Os(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Os(a,a)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=n.canonicalID();if(a.type==="Polygon"){const v=vu(a.coordinates,m,g),T=xu(n.geometry(),h,m,g);if(!Ia(h,m))return!1;for(const P of T)if(!bo(P,v))return!1}if(a.type==="MultiPolygon"){const v=Ed(a.coordinates,m,g),T=xu(n.geometry(),h,m,g);if(!Ia(h,m))return!1;for(const P of T)if(!mm(P,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=n.canonicalID();if(a.type==="Polygon"){const v=vu(a.coordinates,m,g),T=bu(n.geometry(),h,m,g);if(!Ia(h,m))return!1;for(const P of T)if(!Id(P,v))return!1}if(a.type==="MultiPolygon"){const v=Ed(a.coordinates,m,g),T=bu(n.geometry(),h,m,g);if(!Ia(h,m))return!1;for(const P of T)if(!gm(P,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let zd=class{constructor(s=[],t=(n,a)=>n<a?-1:n>a?1:0){if(this.data=s,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:t,compare:n}=this,a=t[s];for(;s>0;){const h=s-1>>1,m=t[h];if(n(a,m)>=0)break;t[s]=m,s=h}t[s]=a}_down(s){const{data:t,compare:n}=this,a=this.length>>1,h=t[s];for(;s<a;){let m=1+(s<<1);const g=m+1;if(g<this.length&&n(t[g],t[m])<0&&(m=g),n(t[m],h)>=0)break;t[s]=t[m],s=m}t[s]=h}};function wu(s,t,n=0,a=s.length-1,h=_m){for(;a>n;){if(a-n>600){const T=a-n+1,P=t-n+1,I=Math.log(T),A=.5*Math.exp(2*I/3),j=.5*Math.sqrt(I*A*(T-A)/T)*(P-T/2<0?-1:1);wu(s,t,Math.max(n,Math.floor(t-P*A/T+j)),Math.min(a,Math.floor(t+(T-P)*A/T+j)),h)}const m=s[t];let g=n,v=a;for(wo(s,n,t),h(s[a],m)>0&&wo(s,n,a);g<v;){for(wo(s,g,v),g++,v--;h(s[g],m)<0;)g++;for(;h(s[v],m)>0;)v--}h(s[n],m)===0?wo(s,n,v):(v++,wo(s,v,a)),v<=t&&(n=v+1),t<=v&&(a=v-1)}}function wo(s,t,n){const a=s[t];s[t]=s[n],s[n]=a}function _m(s,t){return s<t?-1:s>t?1:0}function $l(s,t){if(s.length<=1)return[s];const n=[];let a,h;for(const m of s){const g=Ad(m);g!==0&&(m.area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(a&&n.push(a),a=[m]):a.push(m))}if(a&&n.push(a),t>1)for(let m=0;m<n.length;m++)n[m].length<=t||(wu(n[m],t,1,n[m].length-1,ym),n[m]=n[m].slice(0,t));return n}function ym(s,t){return t.area-s.area}function Ad(s){let t=0;for(let n,a,h=0,m=s.length,g=m-1;h<m;g=h++)n=s[h],a=s[g],t+=(a.x-n.x)*(n.y+a.y);return t}const Rd=1/298.257223563,Dd=Rd*(2-Rd),Ld=Math.PI/180;class Tu{constructor(t){const n=6378.137*Ld*1e3,a=Math.cos(t*Ld),h=1/(1-Dd*(1-a*a)),m=Math.sqrt(h);this.kx=n*m*a,this.ky=n*m*h*(1-Dd)}distance(t,n){const a=this.wrap(t[0]-n[0])*this.kx,h=(t[1]-n[1])*this.ky;return Math.sqrt(a*a+h*h)}pointOnLine(t,n){let a,h,m,g,v=1/0;for(let T=0;T<t.length-1;T++){let P=t[T][0],I=t[T][1],A=this.wrap(t[T+1][0]-P)*this.kx,j=(t[T+1][1]-I)*this.ky,$=0;A===0&&j===0||($=(this.wrap(n[0]-P)*this.kx*A+(n[1]-I)*this.ky*j)/(A*A+j*j),$>1?(P=t[T+1][0],I=t[T+1][1]):$>0&&(P+=A/this.kx*$,I+=j/this.ky*$)),A=this.wrap(n[0]-P)*this.kx,j=(n[1]-I)*this.ky;const V=A*A+j*j;V<v&&(v=V,a=P,h=I,m=T,g=$)}return{point:[a,h],index:m,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function $t(s,t){return t[0]-s[0]}function Vl(s){return s[1]-s[0]+1}function Zn(s,t){return s[1]>=s[0]&&s[1]<t}function Su(s,t){if(s[0]>s[1])return[null,null];const n=Vl(s);if(t){if(n===2)return[s,null];const h=Math.floor(n/2);return[[s[0],s[0]+h],[s[0]+h,s[1]]]}if(n===1)return[s,null];const a=Math.floor(n/2)-1;return[[s[0],s[0]+a],[s[0]+a+1,s[1]]]}function Cu(s,t){if(!Zn(t,s.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let a=t[0];a<=t[1];++a)Ma(n,s[a]);return n}function Pu(s){const t=[1/0,1/0,-1/0,-1/0];for(const n of s)for(const a of n)Ma(t,a);return t}function jd(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Mu(s,t,n){if(!jd(s)||!jd(t))return NaN;let a=0,h=0;return s[2]<t[0]&&(a=t[0]-s[2]),s[0]>t[2]&&(a=s[0]-t[2]),s[1]>t[3]&&(h=s[1]-t[3]),s[3]<t[1]&&(h=t[1]-s[3]),n.distance([0,0],[a,h])}function Ns(s,t,n){const a=n.pointOnLine(t,s);return n.distance(s,a.point)}function Iu(s,t,n,a,h){const m=Math.min(Ns(s,[n,a],h),Ns(t,[n,a],h)),g=Math.min(Ns(n,[s,t],h),Ns(a,[s,t],h));return Math.min(m,g)}function vm(s,t,n,a,h){if(!Zn(t,s.length)||!Zn(a,n.length))return 1/0;let m=1/0;for(let g=t[0];g<t[1];++g){const v=s[g],T=s[g+1];for(let P=a[0];P<a[1];++P){const I=n[P],A=n[P+1];if(Ea(v,T,I,A))return 0;m=Math.min(m,Iu(v,T,I,A,h))}}return m}function xm(s,t,n,a,h){if(!Zn(t,s.length)||!Zn(a,n.length))return NaN;let m=1/0;for(let g=t[0];g<=t[1];++g)for(let v=a[0];v<=a[1];++v)if(m=Math.min(m,h.distance(s[g],n[v])),m===0)return m;return m}function bm(s,t,n){if(bo(s,t,!0))return 0;let a=1/0;for(const h of t){const m=h[0],g=h[h.length-1];if(m!==g&&(a=Math.min(a,Ns(s,[g,m],n)),a===0))return a;const v=n.pointOnLine(h,s);if(a=Math.min(a,n.distance(s,v.point)),a===0)return a}return a}function wm(s,t,n,a){if(!Zn(t,s.length))return NaN;for(let m=t[0];m<=t[1];++m)if(bo(s[m],n,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const g=s[m],v=s[m+1];for(const T of n)for(let P=0,I=T.length,A=I-1;P<I;A=P++){const j=T[A],$=T[P];if(Ea(g,v,j,$))return 0;h=Math.min(h,Iu(g,v,j,$,a))}}return h}function Fd(s,t){for(const n of s)for(const a of n)if(bo(a,t,!0))return!0;return!1}function Tm(s,t,n,a=1/0){const h=Pu(s),m=Pu(t);if(a!==1/0&&Mu(h,m,n)>=a)return a;if(Ia(h,m)){if(Fd(s,t))return 0}else if(Fd(t,s))return 0;let g=1/0;for(const v of s)for(let T=0,P=v.length,I=P-1;T<P;I=T++){const A=v[I],j=v[T];for(const $ of t)for(let V=0,G=$.length,Y=G-1;V<G;Y=V++){const ie=$[Y],ye=$[V];if(Ea(A,j,ie,ye))return 0;g=Math.min(g,Iu(A,j,ie,ye,n))}}return g}function Bd(s,t,n,a,h,m){if(!m)return;const g=Mu(Cu(a,m),h,n);g<t&&s.push([g,m,[0,0]])}function Ul(s,t,n,a,h,m,g){if(!m||!g)return;const v=Mu(Cu(a,m),Cu(h,g),n);v<t&&s.push([v,m,g])}function Zl(s,t,n,a,h=1/0){let m=Math.min(a.distance(s[0],n[0][0]),h);if(m===0)return m;const g=new zd([[0,[0,s.length-1],[0,0]]],$t),v=Pu(n);for(;g.length>0;){const T=g.pop();if(T[0]>=m)continue;const P=T[1],I=t?50:100;if(Vl(P)<=I){if(!Zn(P,s.length))return NaN;if(t){const A=wm(s,P,n,a);if(isNaN(A)||A===0)return A;m=Math.min(m,A)}else for(let A=P[0];A<=P[1];++A){const j=bm(s[A],n,a);if(m=Math.min(m,j),m===0)return 0}}else{const A=Su(P,t);Bd(g,m,a,s,v,A[0]),Bd(g,m,a,s,v,A[1])}}return m}function Gl(s,t,n,a,h,m=1/0){let g=Math.min(m,h.distance(s[0],n[0]));if(g===0)return g;const v=new zd([[0,[0,s.length-1],[0,n.length-1]]],$t);for(;v.length>0;){const T=v.pop();if(T[0]>=g)continue;const P=T[1],I=T[2],A=t?50:100,j=a?50:100;if(Vl(P)<=A&&Vl(I)<=j){if(!Zn(P,s.length)&&Zn(I,n.length))return NaN;let $;if(t&&a)$=vm(s,P,n,I,h),g=Math.min(g,$);else if(t&&!a){const V=s.slice(P[0],P[1]+1);for(let G=I[0];G<=I[1];++G)if($=Ns(n[G],V,h),g=Math.min(g,$),g===0)return g}else if(!t&&a){const V=n.slice(I[0],I[1]+1);for(let G=P[0];G<=P[1];++G)if($=Ns(s[G],V,h),g=Math.min(g,$),g===0)return g}else $=xm(s,P,n,I,h),g=Math.min(g,$)}else{const $=Su(P,t),V=Su(I,a);Ul(v,g,h,s,n,$[0],V[0]),Ul(v,g,h,s,n,$[0],V[1]),Ul(v,g,h,s,n,$[1],V[0]),Ul(v,g,h,s,n,$[1],V[1])}}return g}function Eu(s){return s.type==="MultiPolygon"?s.coordinates.map(t=>({type:"Polygon",coordinates:t})):s.type==="MultiLineString"?s.coordinates.map(t=>({type:"LineString",coordinates:t})):s.type==="MultiPoint"?s.coordinates.map(t=>({type:"Point",coordinates:t})):[s]}class $s{constructor(t,n){this.type=Ke,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Fs(t[1])){const a=t[1];if(a.type==="FeatureCollection")return new $s(a,a.features.map(h=>Eu(h.geometry)).flat());if(a.type==="Feature")return new $s(a,Eu(a.geometry));if("type"in a&&"coordinates"in a)return new $s(a,Eu(a))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,a){const h=n.geometry(),m=h.flat().map(T=>yu([T.x,T.y],n.canonical));if(h.length===0)return NaN;const g=new Tu(m[0][1]);let v=1/0;for(const T of a){switch(T.type){case"Point":v=Math.min(v,Gl(m,!1,[T.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Gl(m,!1,T.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,Zl(m,!1,T.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,a){const h=n.geometry(),m=h.flat().map(T=>yu([T.x,T.y],n.canonical));if(h.length===0)return NaN;const g=new Tu(m[0][1]);let v=1/0;for(const T of a){switch(T.type){case"Point":v=Math.min(v,Gl(m,!0,[T.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Gl(m,!0,T.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,Zl(m,!0,T.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,a){const h=n.geometry();if(h.length===0||h[0].length===0)return NaN;const m=$l(h,0).map(T=>T.map(P=>P.map(I=>yu([I.x,I.y],n.canonical)))),g=new Tu(m[0][0][0][1]);let v=1/0;for(const T of a)for(const P of m){switch(T.type){case"Point":v=Math.min(v,Zl([T.coordinates],!1,P,g,v));break;case"LineString":v=Math.min(v,Zl(T.coordinates,!0,P,g,v));break;case"Polygon":v=Math.min(v,Tm(P,T.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class ka{constructor(t){this.type=Mt,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const a=t[1];return a==null?n.error("Global state property must be defined."):typeof a!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new ka(a)}evaluate(t){var n;const a=(n=t.globals)===null||n===void 0?void 0:n.globalState;return a&&Object.keys(a).length!==0?It(a,this.key):null}eachChild(){}outputDefined(){return!1}}const To={"==":gu,"!=":um,">":dm,"<":hm,">=":jl,"<=":pm,array:Wi,at:Br,boolean:Wi,case:Pr,coalesce:wi,collator:Fl,format:Pa,image:_u,in:mo,"index-of":wa,interpolate:di,"interpolate-hcl":di,"interpolate-lab":di,length:Ol,let:ba,literal:hi,match:go,number:Wi,"number-format":Bl,object:Wi,slice:Ta,step:yo,string:Wi,"to-boolean":Cn,"to-color":Cn,"to-number":Cn,"to-string":Cn,var:sn,within:Os,distance:$s,"global-state":ka};class Hi{constructor(t,n,a,h){this.name=t,this.type=n,this._evaluate=a,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const a=t[0],h=Hi.definitions[a];if(!h)return n.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=g.filter(([P])=>!Array.isArray(P)||P.length===t.length-1);let T=null;for(const[P,I]of v){T=new xa(n.registry,ql,n.path,null,n.scope);const A=[];let j=!1;for(let $=1;$<t.length;$++){const V=t[$],G=Array.isArray(P)?P[$-1]:P.type,Y=T.parse(V,1+A.length,G);if(!Y){j=!0;break}A.push(Y)}if(!j)if(Array.isArray(P)&&P.length!==A.length)T.error(`Expected ${P.length} arguments, but found ${A.length} instead.`);else{for(let $=0;$<A.length;$++){const V=Array.isArray(P)?P[$]:P.type,G=A[$];T.concat($+1).checkSubtype(V,G.type)}if(T.errors.length===0)return new Hi(a,m,I,A)}}if(v.length===1)n.errors.push(...T.errors);else{const P=(v.length?v:g).map(([A])=>{return j=A,Array.isArray(j)?`(${j.map(rr).join(", ")})`:`(${rr(j.type)}...)`;var j}).join(" | "),I=[];for(let A=1;A<t.length;A++){const j=n.parse(t[A],1+I.length);if(!j)return null;I.push(rr(j.type))}n.error(`Expected arguments of type ${P}, but found (${I.join(", ")}) instead.`)}return null}static register(t,n){Hi.definitions=n;for(const a in n)t[a]=Hi}}function Od(s,[t,n,a,h]){t=t.evaluate(s),n=n.evaluate(s),a=a.evaluate(s);const m=h?h.evaluate(s):1,g=Tt(t,n,a,m);if(g)throw new ir(g);return new Et(t/255,n/255,a/255,m,!1)}function Nd(s,t){return s in t}function ku(s,t){const n=t[s];return n===void 0?null:n}function Vs(s){return{type:s}}function ql(s){if(s instanceof sn)return ql(s.boundExpression);if(s instanceof Hi&&s.name==="error"||s instanceof Fl||s instanceof Os||s instanceof $s||s instanceof ka)return!1;const t=s instanceof Cn||s instanceof Wi;let n=!0;return s.eachChild(a=>{n=t?n&&ql(a):n&&a instanceof hi}),!!n&&Wl(s)&&So(s,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Wl(s){if(s instanceof Hi&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Os||s instanceof $s)return!1;let t=!0;return s.eachChild(n=>{t&&!Wl(n)&&(t=!1)}),t}function za(s){if(s instanceof Hi&&s.name==="feature-state")return!1;let t=!0;return s.eachChild(n=>{t&&!za(n)&&(t=!1)}),t}function So(s,t){if(s instanceof Hi&&t.indexOf(s.name)>=0)return!1;let n=!0;return s.eachChild(a=>{n&&!So(a,t)&&(n=!1)}),n}function $d(s){return{result:"success",value:s}}function Co(s){return{result:"error",value:s}}function Po(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function zu(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Au(s){return!!s.expression&&s.expression.interpolated}function kt(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Us(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&mt(s)===Tn}function Vd(s){return s}function Ud(s,t){const n=s.stops&&typeof s.stops[0][0]=="object",a=n||!(n||s.property!==void 0),h=s.type||(Au(t)?"exponential":"interval"),m=function(I){switch(I.type){case"color":return Et.parse;case"padding":return Cr.parse;case"numberArray":return si.parse;case"colorArray":return Fr.parse;default:return null}}(t);if(m&&((s=Wr({},s)).stops&&(s.stops=s.stops.map(I=>[I[0],m(I[1])])),s.default=m(s.default?s.default:t.default)),s.colorSpace&&(g=s.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var g;const v=function(I){switch(I){case"exponential":return Zd;case"interval":return Cm;case"categorical":return Sm;case"identity":return Gd;default:throw new Error(`Unknown function type "${I}"`)}}(h);let T,P;if(h==="categorical"){T=Object.create(null);for(const I of s.stops)T[I[0]]=I[1];P=typeof s.stops[0][0]}if(n){const I={},A=[];for(let V=0;V<s.stops.length;V++){const G=s.stops[V],Y=G[0].zoom;I[Y]===void 0&&(I[Y]={zoom:Y,type:s.type,property:s.property,default:s.default,stops:[]},A.push(Y)),I[Y].stops.push([G[0].value,G[1]])}const j=[];for(const V of A)j.push([I[V].zoom,Ud(I[V],t)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:di.interpolationFactor.bind(void 0,$),zoomStops:j.map(V=>V[0]),evaluate:({zoom:V},G)=>Zd({stops:j,base:s.base},t,V).evaluate(V,G)}}if(a){const I=h==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:di.interpolationFactor.bind(void 0,I),zoomStops:s.stops.map(A=>A[0]),evaluate:({zoom:A})=>v(s,t,A,T,P)}}return{kind:"source",evaluate(I,A){const j=A&&A.properties?A.properties[s.property]:void 0;return j===void 0?Aa(s.default,t.default):v(s,t,j,T,P)}}}function Aa(s,t,n){return s!==void 0?s:t!==void 0?t:n!==void 0?n:void 0}function Sm(s,t,n,a,h){return Aa(typeof n===h?a[n]:void 0,s.default,t.default)}function Cm(s,t,n){if(kt(n)!=="number")return Aa(s.default,t.default);const a=s.stops.length;if(a===1||n<=s.stops[0][0])return s.stops[0][1];if(n>=s.stops[a-1][0])return s.stops[a-1][1];const h=_o(s.stops.map(m=>m[0]),n);return s.stops[h][1]}function Zd(s,t,n){const a=s.base!==void 0?s.base:1;if(kt(n)!=="number")return Aa(s.default,t.default);const h=s.stops.length;if(h===1||n<=s.stops[0][0])return s.stops[0][1];if(n>=s.stops[h-1][0])return s.stops[h-1][1];const m=_o(s.stops.map(I=>I[0]),n),g=function(I,A,j,$){const V=$-j,G=I-j;return V===0?0:A===1?G/V:(Math.pow(A,G)-1)/(Math.pow(A,V)-1)}(n,a,s.stops[m][0],s.stops[m+1][0]),v=s.stops[m][1],T=s.stops[m+1][1],P=Li[t.type]||Vd;return typeof v.evaluate=="function"?{evaluate(...I){const A=v.evaluate.apply(void 0,I),j=T.evaluate.apply(void 0,I);if(A!==void 0&&j!==void 0)return P(A,j,g,s.colorSpace)}}:P(v,T,g,s.colorSpace)}function Gd(s,t,n){switch(t.type){case"color":n=Et.parse(n);break;case"formatted":n=ni.fromString(n.toString());break;case"resolvedImage":n=bi.fromString(n.toString());break;case"padding":n=Cr.parse(n);break;case"colorArray":n=Fr.parse(n);break;case"numberArray":n=si.parse(n);break;default:kt(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return Aa(n,s.default,t.default)}Hi.register(To,{error:[{kind:"error"},[Ct],(s,[t])=>{throw new ir(t.evaluate(s))}],typeof:[Ct,[Mt],(s,[t])=>rr(mt(t.evaluate(s)))],"to-rgba":[Di(Ke,4),[Ri],(s,[t])=>{const[n,a,h,m]=t.evaluate(s).rgb;return[255*n,255*a,255*h,m]}],rgb:[Ri,[Ke,Ke,Ke],Od],rgba:[Ri,[Ke,Ke,Ke,Ke],Od],has:{type:Pt,overloads:[[[Ct],(s,[t])=>Nd(t.evaluate(s),s.properties())],[[Ct,Tn],(s,[t,n])=>Nd(t.evaluate(s),n.evaluate(s))]]},get:{type:Mt,overloads:[[[Ct],(s,[t])=>ku(t.evaluate(s),s.properties())],[[Ct,Tn],(s,[t,n])=>ku(t.evaluate(s),n.evaluate(s))]]},"feature-state":[Mt,[Ct],(s,[t])=>ku(t.evaluate(s),s.featureState||{})],properties:[Tn,[],s=>s.properties()],"geometry-type":[Ct,[],s=>s.geometryType()],id:[Mt,[],s=>s.id()],zoom:[Ke,[],s=>s.globals.zoom],"heatmap-density":[Ke,[],s=>s.globals.heatmapDensity||0],elevation:[Ke,[],s=>s.globals.elevation||0],"line-progress":[Ke,[],s=>s.globals.lineProgress||0],accumulated:[Mt,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[Ke,Vs(Ke),(s,t)=>{let n=0;for(const a of t)n+=a.evaluate(s);return n}],"*":[Ke,Vs(Ke),(s,t)=>{let n=1;for(const a of t)n*=a.evaluate(s);return n}],"-":{type:Ke,overloads:[[[Ke,Ke],(s,[t,n])=>t.evaluate(s)-n.evaluate(s)],[[Ke],(s,[t])=>-t.evaluate(s)]]},"/":[Ke,[Ke,Ke],(s,[t,n])=>t.evaluate(s)/n.evaluate(s)],"%":[Ke,[Ke,Ke],(s,[t,n])=>t.evaluate(s)%n.evaluate(s)],ln2:[Ke,[],()=>Math.LN2],pi:[Ke,[],()=>Math.PI],e:[Ke,[],()=>Math.E],"^":[Ke,[Ke,Ke],(s,[t,n])=>Math.pow(t.evaluate(s),n.evaluate(s))],sqrt:[Ke,[Ke],(s,[t])=>Math.sqrt(t.evaluate(s))],log10:[Ke,[Ke],(s,[t])=>Math.log(t.evaluate(s))/Math.LN10],ln:[Ke,[Ke],(s,[t])=>Math.log(t.evaluate(s))],log2:[Ke,[Ke],(s,[t])=>Math.log(t.evaluate(s))/Math.LN2],sin:[Ke,[Ke],(s,[t])=>Math.sin(t.evaluate(s))],cos:[Ke,[Ke],(s,[t])=>Math.cos(t.evaluate(s))],tan:[Ke,[Ke],(s,[t])=>Math.tan(t.evaluate(s))],asin:[Ke,[Ke],(s,[t])=>Math.asin(t.evaluate(s))],acos:[Ke,[Ke],(s,[t])=>Math.acos(t.evaluate(s))],atan:[Ke,[Ke],(s,[t])=>Math.atan(t.evaluate(s))],min:[Ke,Vs(Ke),(s,t)=>Math.min(...t.map(n=>n.evaluate(s)))],max:[Ke,Vs(Ke),(s,t)=>Math.max(...t.map(n=>n.evaluate(s)))],abs:[Ke,[Ke],(s,[t])=>Math.abs(t.evaluate(s))],round:[Ke,[Ke],(s,[t])=>{const n=t.evaluate(s);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ke,[Ke],(s,[t])=>Math.floor(t.evaluate(s))],ceil:[Ke,[Ke],(s,[t])=>Math.ceil(t.evaluate(s))],"filter-==":[Pt,[Ct,Mt],(s,[t,n])=>s.properties()[t.value]===n.value],"filter-id-==":[Pt,[Mt],(s,[t])=>s.id()===t.value],"filter-type-==":[Pt,[Ct],(s,[t])=>s.geometryType()===t.value],"filter-<":[Pt,[Ct,Mt],(s,[t,n])=>{const a=s.properties()[t.value],h=n.value;return typeof a==typeof h&&a<h}],"filter-id-<":[Pt,[Mt],(s,[t])=>{const n=s.id(),a=t.value;return typeof n==typeof a&&n<a}],"filter->":[Pt,[Ct,Mt],(s,[t,n])=>{const a=s.properties()[t.value],h=n.value;return typeof a==typeof h&&a>h}],"filter-id->":[Pt,[Mt],(s,[t])=>{const n=s.id(),a=t.value;return typeof n==typeof a&&n>a}],"filter-<=":[Pt,[Ct,Mt],(s,[t,n])=>{const a=s.properties()[t.value],h=n.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[Pt,[Mt],(s,[t])=>{const n=s.id(),a=t.value;return typeof n==typeof a&&n<=a}],"filter->=":[Pt,[Ct,Mt],(s,[t,n])=>{const a=s.properties()[t.value],h=n.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[Pt,[Mt],(s,[t])=>{const n=s.id(),a=t.value;return typeof n==typeof a&&n>=a}],"filter-has":[Pt,[Mt],(s,[t])=>t.value in s.properties()],"filter-has-id":[Pt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Pt,[Di(Ct)],(s,[t])=>t.value.indexOf(s.geometryType())>=0],"filter-id-in":[Pt,[Di(Mt)],(s,[t])=>t.value.indexOf(s.id())>=0],"filter-in-small":[Pt,[Ct,Di(Mt)],(s,[t,n])=>n.value.indexOf(s.properties()[t.value])>=0],"filter-in-large":[Pt,[Ct,Di(Mt)],(s,[t,n])=>function(a,h,m,g){for(;m<=g;){const v=m+g>>1;if(h[v]===a)return!0;h[v]>a?g=v-1:m=v+1}return!1}(s.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Pt,overloads:[[[Pt,Pt],(s,[t,n])=>t.evaluate(s)&&n.evaluate(s)],[Vs(Pt),(s,t)=>{for(const n of t)if(!n.evaluate(s))return!1;return!0}]]},any:{type:Pt,overloads:[[[Pt,Pt],(s,[t,n])=>t.evaluate(s)||n.evaluate(s)],[Vs(Pt),(s,t)=>{for(const n of t)if(n.evaluate(s))return!0;return!1}]]},"!":[Pt,[Pt],(s,[t])=>!t.evaluate(s)],"is-supported-script":[Pt,[Ct],(s,[t])=>{const n=s.globals&&s.globals.isSupportedScript;return!n||n(t.evaluate(s))}],upcase:[Ct,[Ct],(s,[t])=>t.evaluate(s).toUpperCase()],downcase:[Ct,[Ct],(s,[t])=>t.evaluate(s).toLowerCase()],concat:[Ct,Vs(Mt),(s,t)=>t.map(n=>Bs(n.evaluate(s))).join("")],"resolved-locale":[Ct,[On],(s,[t])=>t.evaluate(s).resolvedLocale()]});class Hl{constructor(t,n){this.expression=t,this._warningHistory={},this._evaluator=new Cd,this._defaultValue=n?function(a){if(a.type==="color"&&Us(a.default))return new Et(0,0,0,0);switch(a.type){case"color":return Et.parse(a.default)||null;case"padding":return Cr.parse(a.default)||null;case"numberArray":return si.parse(a.default)||null;case"colorArray":return Fr.parse(a.default)||null;case"variableAnchorOffsetCollection":return Dt.parse(a.default)||null;case"projectionDefinition":return bt.parse(a.default)||null;default:return a.default===void 0?null:a.default}}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,a,h,m,g){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,n,a,h,m,g){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new ir(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Xl(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in To}function Yl(s,t){const n=new xa(To,ql,[],t?function(h){const m={color:Ri,string:Ct,number:Ke,enum:Ct,boolean:Pt,formatted:Ds,padding:vr,numberArray:ma,colorArray:fa,projectionDefinition:kl,resolvedImage:Nn,variableAnchorOffsetCollection:ga};return h.type==="array"?Di(m[h.value]||Mt,h.length):m[h.type]}(t):void 0),a=n.parse(s,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?$d(new Hl(a,t)):Co(n.errors)}class Ra{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!za(n.expression),this.globalStateRefs=Io(n.expression)}evaluateWithoutErrorHandling(t,n,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,n,a,h,m,g)}evaluate(t,n,a,h,m,g){return this._styleExpression.evaluate(t,n,a,h,m,g)}}class Kl{constructor(t,n,a,h){this.kind=t,this.zoomStops=a,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!za(n.expression),this.globalStateRefs=Io(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,n,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,n,a,h,m,g)}evaluate(t,n,a,h,m,g){return this._styleExpression.evaluate(t,n,a,h,m,g)}interpolationFactor(t,n,a){return this.interpolationType?di.interpolationFactor(this.interpolationType,t,n,a):0}}function Ru(s,t){const n=Yl(s,t);if(n.result==="error")return n;const a=n.value.expression,h=Wl(a);if(!h&&!Po(t))return Co([new tr("","data expressions not supported")]);const m=So(a,["zoom"]);if(!m&&!zu(t))return Co([new tr("","zoom expressions not supported")]);const g=Mo(a);return g||m?g instanceof tr?Co([g]):g instanceof di&&!Au(t)?Co([new tr("",'"interpolate" expressions cannot be used with this property')]):$d(g?new Kl(h?"camera":"composite",n.value,g.labels,g instanceof di?g.interpolation:void 0):new Ra(h?"constant":"source",n.value)):Co([new tr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Da{constructor(t,n){this._parameters=t,this._specification=n,Wr(this,Ud(this._parameters,this._specification))}static deserialize(t){return new Da(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Mo(s){let t=null;if(s instanceof ba)t=Mo(s.result);else if(s instanceof wi){for(const n of s.args)if(t=Mo(n),t)break}else(s instanceof yo||s instanceof di)&&s.input instanceof Hi&&s.input.name==="zoom"&&(t=s);return t instanceof tr||s.eachChild(n=>{const a=Mo(n);a instanceof tr?t=a:!t&&a?t=new tr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&a&&t!==a&&(t=new tr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Io(s,t=new Set){return s instanceof ka&&t.add(s.key),s.eachChild(n=>{Io(n,t)}),t}function La(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const t of s.slice(1))if(!La(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Du={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hs(s){if(s==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};La(s)||(s=Ql(s));const t=Yl(s,Du);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,a,h)=>t.value.evaluate(n,a,{},h),needGeometry:qd(s),getGlobalStateRefs:()=>Io(t.value.expression)}}function Pm(s,t){return s<t?-1:s>t?1:0}function qd(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let t=1;t<s.length;t++)if(qd(s[t]))return!0;return!1}function Ql(s){if(!s)return!0;const t=s[0];return s.length<=1?t!=="any":t==="=="?Lu(s[1],s[2],"=="):t==="!="?ja(Lu(s[1],s[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Lu(s[1],s[2],t):t==="any"?(n=s.slice(1),["any"].concat(n.map(Ql))):t==="all"?["all"].concat(s.slice(1).map(Ql)):t==="none"?["all"].concat(s.slice(1).map(Ql).map(ja)):t==="in"?Wd(s[1],s.slice(2)):t==="!in"?ja(Wd(s[1],s.slice(2))):t==="has"?Hd(s[1]):t!=="!has"||ja(Hd(s[1]));var n}function Lu(s,t,n){switch(s){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,s,t]}}function Wd(s,t){if(t.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",s,["literal",t.sort(Pm)]]:["filter-in-small",s,["literal",t]]}}function Hd(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function ja(s){return["!",s]}function Jl(s){const t=typeof s;if(t==="number"||t==="boolean"||t==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let h="[";for(const m of s)h+=`${Jl(m)},`;return`${h}]`}const n=Object.keys(s).sort();let a="{";for(let h=0;h<n.length;h++)a+=`${JSON.stringify(n[h])}:${Jl(s[n[h]])},`;return`${a}}`}function ec(s){let t="";for(const n of Je)t+=`/${Jl(s[n])}`;return t}function Xd(s){const t=s.value;return t?[new He(s.key,t,"constants have been deprecated as of v8")]:[]}function ur(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ds(s){if(Array.isArray(s))return s.map(ds);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const t={};for(const n in s)t[n]=ds(s[n]);return t}return ur(s)}function Xi(s){const t=s.key,n=s.value,a=s.valueSpec||{},h=s.objectElementValidators||{},m=s.style,g=s.styleSpec,v=s.validateSpec;let T=[];const P=kt(n);if(P!=="object")return[new He(t,n,`object expected, ${P} found`)];for(const I in n){const A=I.split(".")[0],j=It(a,A)||a["*"];let $;if(It(h,A))$=h[A];else if(It(a,A))$=v;else if(h["*"])$=h["*"];else{if(!a["*"]){T.push(new He(t,n[I],`unknown property "${I}"`));continue}$=v}T=T.concat($({key:(t&&`${t}.`)+I,value:n[I],valueSpec:j,style:m,styleSpec:g,object:n,objectKey:I,validateSpec:v},n))}for(const I in a)h[I]||a[I].required&&a[I].default===void 0&&n[I]===void 0&&T.push(new He(t,n,`missing required property "${I}"`));return T}function tc(s){const t=s.value,n=s.valueSpec,a=s.style,h=s.styleSpec,m=s.key,g=s.arrayElementValidator||s.validateSpec;if(kt(t)!=="array")return[new He(m,t,`array expected, ${kt(t)} found`)];if(n.length&&t.length!==n.length)return[new He(m,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new He(m,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let v={type:n.value,values:n.values};h.$version<7&&(v.function=n.function),kt(n.value)==="object"&&(v=n.value);let T=[];for(let P=0;P<t.length;P++)T=T.concat(g({array:t,arrayIndex:P,value:t[P],valueSpec:v,validateSpec:s.validateSpec,style:a,styleSpec:h,key:`${m}[${P}]`}));return T}function Fa(s){const t=s.key,n=s.value,a=s.valueSpec;let h=kt(n);return h==="number"&&n!=n&&(h="NaN"),h!=="number"?[new He(t,n,`number expected, ${h} found`)]:"minimum"in a&&n<a.minimum?[new He(t,n,`${n} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&n>a.maximum?[new He(t,n,`${n} is greater than the maximum value ${a.maximum}`)]:[]}function Eo(s){const t=s.valueSpec,n=ur(s.value.type);let a,h,m,g={};const v=n!=="categorical"&&s.value.property===void 0,T=!v,P=kt(s.value.stops)==="array"&&kt(s.value.stops[0])==="array"&&kt(s.value.stops[0][0])==="object",I=Xi({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function($){if(n==="identity")return[new He($.key,$.value,'identity function may not have a "stops" property')];let V=[];const G=$.value;return V=V.concat(tc({key:$.key,value:G,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:A})),kt(G)==="array"&&G.length===0&&V.push(new He($.key,G,"array must have at least one stop")),V},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return n==="identity"&&v&&I.push(new He(s.key,s.value,'missing required property "property"')),n==="identity"||s.value.stops||I.push(new He(s.key,s.value,'missing required property "stops"')),n==="exponential"&&s.valueSpec.expression&&!Au(s.valueSpec)&&I.push(new He(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(T&&!Po(s.valueSpec)?I.push(new He(s.key,s.value,"property functions not supported")):v&&!zu(s.valueSpec)&&I.push(new He(s.key,s.value,"zoom functions not supported"))),n!=="categorical"&&!P||s.value.property!==void 0||I.push(new He(s.key,s.value,'"property" property is required')),I;function A($){let V=[];const G=$.value,Y=$.key;if(kt(G)!=="array")return[new He(Y,G,`array expected, ${kt(G)} found`)];if(G.length!==2)return[new He(Y,G,`array length 2 expected, length ${G.length} found`)];if(P){if(kt(G[0])!=="object")return[new He(Y,G,`object expected, ${kt(G[0])} found`)];if(G[0].zoom===void 0)return[new He(Y,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new He(Y,G,"object stop key must have value")];if(m&&m>ur(G[0].zoom))return[new He(Y,G[0].zoom,"stop zoom values must appear in ascending order")];ur(G[0].zoom)!==m&&(m=ur(G[0].zoom),h=void 0,g={}),V=V.concat(Xi({key:`${Y}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Fa,value:j}}))}else V=V.concat(j({key:`${Y}[0]`,value:G[0],validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},G));return Xl(ds(G[1]))?V.concat([new He(`${Y}[1]`,G[1],"expressions are not allowed in function stops.")]):V.concat($.validateSpec({key:`${Y}[1]`,value:G[1],valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function j($,V){const G=kt($.value),Y=ur($.value),ie=$.value!==null?$.value:V;if(a){if(G!==a)return[new He($.key,ie,`${G} stop domain type must match previous stop domain type ${a}`)]}else a=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new He($.key,ie,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&n!=="categorical"){let ye=`number expected, ${G} found`;return Po(t)&&n===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new He($.key,ie,ye)]}return n!=="categorical"||G!=="number"||isFinite(Y)&&Math.floor(Y)===Y?n!=="categorical"&&G==="number"&&h!==void 0&&Y<h?[new He($.key,ie,"stop domain values must appear in ascending order")]:(h=Y,n==="categorical"&&Y in g?[new He($.key,ie,"stop domain values must be unique")]:(g[Y]=!0,[])):[new He($.key,ie,`integer expected, found ${Y}`)]}}function ko(s){const t=(s.expressionContext==="property"?Ru:Yl)(ds(s.value),s.valueSpec);if(t.result==="error")return t.value.map(a=>new He(`${s.key}${a.key}`,s.value,a.message));const n=t.value.expression||t.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!n.outputDefined())return[new He(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!za(n))return[new He(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!za(n))return[new He(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!So(n,["zoom","feature-state"]))return[new He(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Wl(n))return[new He(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ju(s){const t=s.key,n=s.value,a=kt(n);return a!=="string"?[new He(t,n,`color expected, ${a} found`)]:Et.parse(String(n))?[]:[new He(t,n,`color expected, "${n}" found`)]}function Ba(s){const t=s.key,n=s.value,a=s.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(ur(n))===-1&&h.push(new He(t,n,`expected one of [${a.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(a.values).indexOf(ur(n))===-1&&h.push(new He(t,n,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function Fu(s){return La(ds(s.value))?ko(Wr({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Yd(s)}function Yd(s){const t=s.value,n=s.key;if(kt(t)!=="array")return[new He(n,t,`array expected, ${kt(t)} found`)];const a=s.styleSpec;let h,m=[];if(t.length<1)return[new He(n,t,"filter array must have at least 1 element")];switch(m=m.concat(Ba({key:`${n}[0]`,value:t[0],valueSpec:a.filter_operator,style:s.style,styleSpec:s.styleSpec})),ur(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ur(t[1])==="$type"&&m.push(new He(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new He(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=kt(t[1]),h!=="string"&&m.push(new He(`${n}[1]`,t[1],`string expected, ${h} found`)));for(let g=2;g<t.length;g++)h=kt(t[g]),ur(t[1])==="$type"?m=m.concat(Ba({key:`${n}[${g}]`,value:t[g],valueSpec:a.geometry_type,style:s.style,styleSpec:s.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new He(`${n}[${g}]`,t[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)m=m.concat(Yd({key:`${n}[${g}]`,value:t[g],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":h=kt(t[1]),t.length!==2?m.push(new He(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new He(`${n}[1]`,t[1],`string expected, ${h} found`))}return m}function Kd(s,t){const n=s.key,a=s.validateSpec,h=s.style,m=s.styleSpec,g=s.value,v=s.objectKey,T=m[`${t}_${s.layerType}`];if(!T)return[];const P=v.match(/^(.*)-transition$/);if(t==="paint"&&P&&T[P[1]]&&T[P[1]].transition)return a({key:n,value:g,valueSpec:m.transition,style:h,styleSpec:m});const I=s.valueSpec||T[v];if(!I)return[new He(n,g,`unknown property "${v}"`)];let A;if(kt(g)==="string"&&Po(I)&&!I.tokens&&(A=/^{([^}]+)}$/.exec(g)))return[new He(n,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const j=[];return s.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&j.push(new He(n,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Us(ds(g))&&ur(g.type)==="identity"&&j.push(new He(n,g,'"text-font" does not support identity functions'))),j.concat(a({key:s.key,value:g,valueSpec:I,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:v}))}function zo(s){return Kd(s,"paint")}function Ao(s){return Kd(s,"layout")}function Ti(s){let t=[];const n=s.value,a=s.key,h=s.style,m=s.styleSpec;if(kt(n)!=="object")return[new He(a,n,`object expected, ${kt(n)} found`)];n.type||n.ref||t.push(new He(a,n,'either "type" or "ref" is required'));let g=ur(n.type);const v=ur(n.ref);if(n.id){const T=ur(n.id);for(let P=0;P<s.arrayIndex;P++){const I=h.layers[P];ur(I.id)===T&&t.push(new He(a,n.id,`duplicate layer id "${n.id}", previously used at line ${I.id.__line__}`))}}if("ref"in n){let T;["type","source","source-layer","filter","layout"].forEach(P=>{P in n&&t.push(new He(a,n[P],`"${P}" is prohibited for ref layers`))}),h.layers.forEach(P=>{ur(P.id)===v&&(T=P)}),T?T.ref?t.push(new He(a,n.ref,"ref cannot reference another ref layer")):g=ur(T.type):t.push(new He(a,n.ref,`ref layer "${v}" not found`))}else if(g!=="background")if(n.source){const T=h.sources&&h.sources[n.source],P=T&&ur(T.type);T?P==="vector"&&g==="raster"?t.push(new He(a,n.source,`layer "${n.id}" requires a raster source`)):P!=="raster-dem"&&g==="hillshade"||P!=="raster-dem"&&g==="color-relief"?t.push(new He(a,n.source,`layer "${n.id}" requires a raster-dem source`)):P==="raster"&&g!=="raster"?t.push(new He(a,n.source,`layer "${n.id}" requires a vector source`)):P!=="vector"||n["source-layer"]?P==="raster-dem"&&g!=="hillshade"&&g!=="color-relief"?t.push(new He(a,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):g!=="line"||!n.paint||!n.paint["line-gradient"]||P==="geojson"&&T.lineMetrics||t.push(new He(a,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new He(a,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new He(a,n.source,`source "${n.source}" not found`))}else t.push(new He(a,n,'missing required property "source"'));return t=t.concat(Xi({key:a,value:n,valueSpec:m.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${a}.type`,value:n.type,valueSpec:m.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:n,objectKey:"type"}),filter:Fu,layout:T=>Xi({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":P=>Ao(Wr({layerType:g},P))}}),paint:T=>Xi({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":P=>zo(Wr({layerType:g},P))}})}})),t}function on(s){const t=s.value,n=s.key,a=kt(t);return a!=="string"?[new He(n,t,`string expected, ${a} found`)]:[]}const Bu={promoteId:function({key:s,value:t}){if(kt(t)==="string")return on({key:s,value:t});{const n=[];for(const a in t)n.push(...on({key:`${s}.${a}`,value:t[a]}));return n}}};function Qd(s){const t=s.value,n=s.key,a=s.styleSpec,h=s.style,m=s.validateSpec;if(!t.type)return[new He(n,t,'"type" is required')];const g=ur(t.type);let v;switch(g){case"vector":case"raster":return v=Xi({key:n,value:t,valueSpec:a[`source_${g.replace("-","_")}`],style:s.style,styleSpec:a,objectElementValidators:Bu,validateSpec:m}),v;case"raster-dem":return v=function(T){var P;const I=(P=T.sourceName)!==null&&P!==void 0?P:"",A=T.value,j=T.styleSpec,$=j.source_raster_dem,V=T.style;let G=[];const Y=kt(A);if(A===void 0)return G;if(Y!=="object")return G.push(new He("source_raster_dem",A,`object expected, ${Y} found`)),G;const ie=ur(A.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],ae=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const B in A)!ie&&ye.includes(B)?G.push(new He(B,A[B],`In "${I}": "${B}" is only valid when "encoding" is set to "custom". ${ae} encoding found`)):$[B]?G=G.concat(T.validateSpec({key:B,value:A[B],valueSpec:$[B],validateSpec:T.validateSpec,style:V,styleSpec:j})):G.push(new He(B,A[B],`unknown property "${B}"`));return G}({sourceName:n,value:t,style:s.style,styleSpec:a,validateSpec:m}),v;case"geojson":if(v=Xi({key:n,value:t,valueSpec:a.source_geojson,style:h,styleSpec:a,validateSpec:m,objectElementValidators:Bu}),t.cluster)for(const T in t.clusterProperties){const[P,I]=t.clusterProperties[T],A=typeof P=="string"?[P,["accumulated"],["get",T]]:P;v.push(...ko({key:`${n}.${T}.map`,value:I,expressionContext:"cluster-map"})),v.push(...ko({key:`${n}.${T}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return v;case"video":return Xi({key:n,value:t,valueSpec:a.source_video,style:h,validateSpec:m,styleSpec:a});case"image":return Xi({key:n,value:t,valueSpec:a.source_image,style:h,validateSpec:m,styleSpec:a});case"canvas":return[new He(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ba({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Jd(s){const t=s.value,n=s.styleSpec,a=n.light,h=s.style;let m=[];const g=kt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new He("light",t,`object expected, ${g} found`)]),m;for(const v in t){const T=v.match(/^(.*)-transition$/);m=m.concat(T&&a[T[1]]&&a[T[1]].transition?s.validateSpec({key:v,value:t[v],valueSpec:n.transition,validateSpec:s.validateSpec,style:h,styleSpec:n}):a[v]?s.validateSpec({key:v,value:t[v],valueSpec:a[v],validateSpec:s.validateSpec,style:h,styleSpec:n}):[new He(v,t[v],`unknown property "${v}"`)])}return m}function Ro(s){const t=s.value,n=s.styleSpec,a=n.sky,h=s.style,m=kt(t);if(t===void 0)return[];if(m!=="object")return[new He("sky",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(a[v]?s.validateSpec({key:v,value:t[v],valueSpec:a[v],style:h,styleSpec:n}):[new He(v,t[v],`unknown property "${v}"`)]);return g}function Ou(s){const t=s.value,n=s.styleSpec,a=n.terrain,h=s.style;let m=[];const g=kt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new He("terrain",t,`object expected, ${g} found`)]),m;for(const v in t)m=m.concat(a[v]?s.validateSpec({key:v,value:t[v],valueSpec:a[v],validateSpec:s.validateSpec,style:h,styleSpec:n}):[new He(v,t[v],`unknown property "${v}"`)]);return m}function rc(s){let t=[];const n=s.value,a=s.key;if(Array.isArray(n)){const h=[],m=[];for(const g in n)n[g].id&&h.includes(n[g].id)&&t.push(new He(a,n,`all the sprites' ids must be unique, but ${n[g].id} is duplicated`)),h.push(n[g].id),n[g].url&&m.includes(n[g].url)&&t.push(new He(a,n,`all the sprites' URLs must be unique, but ${n[g].url} is duplicated`)),m.push(n[g].url),t=t.concat(Xi({key:`${a}[${g}]`,value:n[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return t}return on({key:a,value:n})}function ep(s){return t=s.value,t&&t.constructor===Object?[]:[new He(s.key,s.value,`object expected, ${kt(s.value)} found`)];var t}const ic={"*":()=>[],array:tc,boolean:function(s){const t=s.value,n=s.key,a=kt(t);return a!=="boolean"?[new He(n,t,`boolean expected, ${a} found`)]:[]},number:Fa,color:ju,constants:Xd,enum:Ba,filter:Fu,function:Eo,layer:Ti,object:Xi,source:Qd,light:Jd,sky:Ro,terrain:Ou,projection:function(s){const t=s.value,n=s.styleSpec,a=n.projection,h=s.style,m=kt(t);if(t===void 0)return[];if(m!=="object")return[new He("projection",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(a[v]?s.validateSpec({key:v,value:t[v],valueSpec:a[v],style:h,styleSpec:n}):[new He(v,t[v],`unknown property "${v}"`)]);return g},projectionDefinition:function(s){const t=s.key;let n=s.value;n=n instanceof String?n.valueOf():n;const a=kt(n);return a!=="array"||function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"}(n)||function(h){return!!["interpolate","step","literal"].includes(h[0])}(n)?["array","string"].includes(a)?[]:[new He(t,n,`projection expected, invalid type "${a}" found`)]:[new He(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:on,formatted:function(s){return on(s).length===0?[]:ko(s)},resolvedImage:function(s){return on(s).length===0?[]:ko(s)},padding:function(s){const t=s.key,n=s.value;if(kt(n)==="array"){if(n.length<1||n.length>4)return[new He(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const a={type:"number"};let h=[];for(let m=0;m<n.length;m++)h=h.concat(s.validateSpec({key:`${t}[${m}]`,value:n[m],validateSpec:s.validateSpec,valueSpec:a}));return h}return Fa({key:t,value:n,valueSpec:{}})},numberArray:function(s){const t=s.key,n=s.value;if(kt(n)==="array"){const a={type:"number"};if(n.length<1)return[new He(t,n,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<n.length;m++)h=h.concat(s.validateSpec({key:`${t}[${m}]`,value:n[m],validateSpec:s.validateSpec,valueSpec:a}));return h}return Fa({key:t,value:n,valueSpec:{}})},colorArray:function(s){const t=s.key,n=s.value;if(kt(n)==="array"){if(n.length<1)return[new He(t,n,"array length at least 1 expected, length 0 found")];let a=[];for(let h=0;h<n.length;h++)a=a.concat(ju({key:`${t}[${h}]`,value:n[h]}));return a}return ju({key:t,value:n})},variableAnchorOffsetCollection:function(s){const t=s.key,n=s.value,a=kt(n),h=s.styleSpec;if(a!=="array"||n.length<1||n.length%2!=0)return[new He(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let g=0;g<n.length;g+=2)m=m.concat(Ba({key:`${t}[${g}]`,value:n[g],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(tc({key:`${t}[${g+1}]`,value:n[g+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:h}));return m},sprite:rc,state:ep};function nc(s){const t=s.value,n=s.valueSpec,a=s.styleSpec;return s.validateSpec=nc,n.expression&&Us(ur(t))?Eo(s):n.expression&&Xl(ds(t))?ko(s):n.type&&ic[n.type]?ic[n.type](s):Xi(Wr({},s,{valueSpec:n.type?a[n.type]:n}))}function Do(s){const t=s.value,n=s.key,a=on(s);return a.length||(t.indexOf("{fontstack}")===-1&&a.push(new He(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&a.push(new He(n,t,'"glyphs" url must include a "{range}" token'))),a}function Yi(s,t=me){let n=[];return n=n.concat(nc({key:"",value:s,valueSpec:t.$root,styleSpec:t,style:s,validateSpec:nc,objectElementValidators:{glyphs:Do,"*":()=>[]}})),s.constants&&(n=n.concat(Xd({key:"constants",value:s.constants}))),tp(n)}function an(s){return function(t){return s({...t,validateSpec:nc})}}function tp(s){return[].concat(s).sort((t,n)=>t.line-n.line)}function pi(s){return function(...t){return tp(s.apply(this,t))}}Yi.source=pi(an(Qd)),Yi.sprite=pi(an(rc)),Yi.glyphs=pi(an(Do)),Yi.light=pi(an(Jd)),Yi.sky=pi(an(Ro)),Yi.terrain=pi(an(Ou)),Yi.state=pi(an(ep)),Yi.layer=pi(an(Ti)),Yi.filter=pi(an(Fu)),Yi.paintProperty=pi(an(zo)),Yi.layoutProperty=pi(an(Ao));const Lo=Yi,Mm=Lo.light,sc=Lo.sky,Im=Lo.paintProperty,Nu=Lo.layoutProperty;function Oa(s,t){let n=!1;if(t&&t.length)for(const a of t)s.fire(new Me(new Error(a.message))),n=!0;return n}class jo{constructor(t,n,a){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(n=g[1])+2*(a=g[2]);for(let T=0;T<this.d*this.d;T++){const P=g[3+T],I=g[3+T+1];h.push(P===I?null:g.subarray(P,I))}const v=g[3+h.length+1];this.keys=g.subarray(g[3+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=n+2*a;for(let g=0;g<this.d*this.d;g++)h.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=a,this.scale=n/t,this.uid=0;const m=a/n*t;this.min=-m,this.max=t+m}insert(t,n,a,h,m){this._forEachCell(n,a,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,a,h,m,g){this.cells[m].push(g)}query(t,n,a,h,m){const g=this.min,v=this.max;if(t<=g&&n<=g&&v<=a&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(t,n,a,h,this._queryCell,T,{},m),T}}_queryCell(t,n,a,h,m,g,v,T){const P=this.cells[m];if(P!==null){const I=this.keys,A=this.bboxes;for(let j=0;j<P.length;j++){const $=P[j];if(v[$]===void 0){const V=4*$;(T?T(A[V+0],A[V+1],A[V+2],A[V+3]):t<=A[V+2]&&n<=A[V+3]&&a>=A[V+0]&&h>=A[V+1])?(v[$]=!0,g.push(I[$])):v[$]=!1}}}}_forEachCell(t,n,a,h,m,g,v,T){const P=this._convertToCellCoord(t),I=this._convertToCellCoord(n),A=this._convertToCellCoord(a),j=this._convertToCellCoord(h);for(let $=P;$<=A;$++)for(let V=I;V<=j;V++){const G=this.d*V+$;if((!T||T(this._convertFromCellCoord($),this._convertFromCellCoord(V),this._convertFromCellCoord($+1),this._convertFromCellCoord(V+1)))&&m.call(this,t,n,a,h,G,g,v,T))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let a=0;for(let g=0;g<this.cells.length;g++)a+=this.cells[g].length;const h=new Int32Array(n+a+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=n;for(let g=0;g<t.length;g++){const v=t[g];h[3+g]=m,h.set(v,m),m+=v.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,n){const a=t.toArrayBuffer();return n&&n.push(a),{buffer:a}}static deserialize(t){return new jo(t.buffer)}}const Mn={};function et(s,t,n={}){if(Mn[s])throw new Error(`${s} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:s,writeable:!1}),Mn[s]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}et("Object",Object),et("Set",Set),et("TransferableGridIndex",jo),et("Color",Et),et("Error",Error),et("AJAXError",le),et("ResolvedImage",bi),et("StylePropertyFunction",Da),et("StyleExpression",Hl,{omit:["_evaluator"]}),et("ZoomDependentExpression",Kl),et("ZoomConstantExpression",Ra),et("CompoundExpression",Hi,{omit:["_evaluate"]});for(const s in To)To[s]._classRegistryKey||et(`Expression_${s}`,To[s]);function $u(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Na(s){return s.$name||s.constructor._classRegistryKey}function Vu(s){return!function(t){if(t===null||typeof t!="object")return!1;const n=Na(t);return!(!n||n==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||$u(s)||as(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function $a(s,t){if(Vu(s))return($u(s)||as(s))&&t&&t.push(s),ArrayBuffer.isView(s)&&t&&t.push(s.buffer),s instanceof ImageData&&t&&t.push(s.data.buffer),s;if(Array.isArray(s)){const m=[];for(const g of s)m.push($a(g,t));return m}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const n=Na(s);if(!n)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!Mn[n])throw new Error(`${n} is not registered.`);const{klass:a}=Mn[n],h=a.serialize?a.serialize(s,t):{};if(a.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in s){if(!s.hasOwnProperty(m)||Mn[n].omit.indexOf(m)>=0)continue;const g=s[m];h[m]=Mn[n].shallow.indexOf(m)>=0?g:$a(g,t)}s instanceof Error&&(h.message=s.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(h.$name=n),h}function Fo(s){if(Vu(s))return s;if(Array.isArray(s))return s.map(Fo);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const t=Na(s)||"Object";if(!Mn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=Mn[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(s);const a=Object.create(n.prototype);for(const h of Object.keys(s)){if(h==="$name")continue;const m=s[h];a[h]=Mn[t].shallow.indexOf(h)>=0?m:Fo(m)}return a}class Uu{constructor(){this.first=!0}update(t,n){const a=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=a,!0))}}const zt={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Hangul Syllables":s=>s>=44032&&s<=55215,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Zu(s){for(const t of s)if(ac(t.charCodeAt(0)))return!0;return!1}function rp(s){for(const t of s)if(!km(t.charCodeAt(0)))return!1;return!0}function oc(s){const t=s.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const Em=oc(["Arab","Dupl","Mong","Ougr","Syrc"]);function km(s){return!Em.test(String.fromCodePoint(s))}const Gu=oc(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ac(s){return!(s!==746&&s!==747&&(s<4352||!(zt["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||zt["CJK Compatibility"](s)||zt["CJK Strokes"](s)||!(!zt["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||zt["Enclosed CJK Letters and Months"](s)||zt["Ideographic Description Characters"](s)||zt.Kanbun(s)||zt.Katakana(s)&&s!==12540||!(!zt["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!zt["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||zt["Vertical Forms"](s)||zt["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||Gu.test(String.fromCodePoint(s)))))}function qu(s){return!(ac(s)||function(t){return!!(zt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||zt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||zt["Letterlike Symbols"](t)||zt["Number Forms"](t)||zt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||zt["Control Pictures"](t)&&t!==9251||zt["Optical Character Recognition"](t)||zt["Enclosed Alphanumerics"](t)||zt["Geometric Shapes"](t)||zt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||zt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||zt["CJK Symbols and Punctuation"](t)||zt.Katakana(t)||zt["Private Use Area"](t)||zt["CJK Compatibility Forms"](t)||zt["Small Form Variants"](t)||zt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(s))}const ip=oc(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Va(s){return ip.test(String.fromCodePoint(s))}function zm(s,t){return!(!t&&Va(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||zt.Khmer(s))}function Wu(s){for(const t of s)if(Va(t.charCodeAt(0)))return!0;return!1}const ps=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(ps.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const n=s.pluginURL,a=new Promise(m=>{this.loadScriptResolve=m});t(n);const h=new Promise(m=>setTimeout(()=>m(),this.TIMEOUT));if(yield Promise.race([a,h]),this.isParsed()){const m={pluginStatus:"loaded",pluginURL:n};return this.setState(m),m}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)})}};class er{constructor(t,n){this.zoom=t,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new Uu,this.transition=n.transition||{},this.globalState=n.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Uu,this.transition={},this.globalState={})}isSupportedScript(t){return function(n,a){for(const h of n)if(!zm(h.charCodeAt(0),a))return!1;return!0}(t,ps.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),a=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*n}}}class Ua{constructor(t,n){this.property=t,this.value=n,this.expression=function(a,h){if(Us(a))return new Da(a,h);if(Xl(a)){const m=Ru(a,h);if(m.result==="error")throw new Error(m.value.map(g=>`${g.key}: ${g.message}`).join(", "));return m.value}{let m=a;return h.type==="color"&&typeof a=="string"?m=Et.parse(a):h.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?h.type!=="numberArray"||typeof a!="number"&&!Array.isArray(a)?h.type!=="colorArray"||typeof a!="string"&&!Array.isArray(a)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(a)?m=Dt.parse(a):h.type==="projectionDefinition"&&typeof a=="string"&&(m=bt.parse(a)):m=Fr.parse(a):m=si.parse(a):m=Cr.parse(a),{globalStateRefs:new Set,kind:"constant",evaluate:()=>m}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,n,a){return this.property.possiblyEvaluate(this,t,n,a)}}class lc{constructor(t){this.property=t,this.value=new Ua(t,void 0)}transitioned(t,n){return new np(this.property,this.value,n,ki({},t.transition,this.transition),t.now)}untransitioned(){return new np(this.property,this.value,null,{},0)}}class Hu{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Gi(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new lc(this._values[t].property)),this._values[t].value=new Ua(this._values[t].property,n===null?void 0:Gi(n))}getTransition(t){return Gi(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new lc(this._values[t].property)),this._values[t].transition=Gi(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(t[n]=a);const h=this.getTransition(n);h!==void 0&&(t[`${n}-transition`]=h)}return t}transitioned(t,n){const a=new sp(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(t,n._values[h]);return a}untransitioned(){const t=new sp(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class np{constructor(t,n,a,h,m){this.property=t,this.value=n,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(t,n,a){const h=t.now||0,m=this.value.possiblyEvaluate(t,n,a),g=this.prior;if(g){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return g.possiblyEvaluate(t,n,a);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,n,a),m,ui(v))}}return m}}class sp{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,a){const h=new cc(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,a);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Am{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Gi(this._values[t].value)}setValue(t,n){this._values[t]=new Ua(this._values[t].property,n===null?void 0:Gi(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(t[n]=a)}return t}possiblyEvaluate(t,n,a){const h=new cc(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,a);return h}}class In{constructor(t,n,a){this.property=t,this.value=n,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,a,h){return this.property.evaluate(this.value,this.parameters,t,n,a,h)}}class cc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class nt{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,a){const h=Li[this.specification.type];return h?h(t,n,a):t}}class pt{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,a,h){return new In(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},a,h)}:t.expression,n)}interpolate(t,n,a){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new In(this,{kind:"constant",value:void 0},t.parameters);const h=Li[this.specification.type];if(h){const m=h(t.value.value,n.value.value,a);return new In(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,n,a,h,m,g){return t.kind==="constant"?t.value:t.evaluate(n,a,h,m,g)}}class uc extends pt{possiblyEvaluate(t,n,a,h){if(t.value===void 0)return new In(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},a,h),g=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(g,g,g,n);return new In(this,{kind:"constant",value:v},n)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new In(this,{kind:"constant",value:m},n)}return new In(this,t.expression,n)}evaluate(t,n,a,h,m,g){if(t.kind==="source"){const v=t.evaluate(n,a,h,m,g);return this._calculate(v,v,v,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},a,h),t.evaluate({zoom:Math.floor(n.zoom)},a,h),t.evaluate({zoom:Math.floor(n.zoom)+1},a,h),n):t.value}_calculate(t,n,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:a,to:n}}interpolate(t){return t}}class Xu{constructor(t){this.specification=t}possiblyEvaluate(t,n,a,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},a,h);return this._calculate(m,m,m,n)}return this._calculate(t.expression.evaluate(new er(Math.floor(n.zoom-1),n)),t.expression.evaluate(new er(Math.floor(n.zoom),n)),t.expression.evaluate(new er(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:a,to:n}}interpolate(t){return t}}class Za{constructor(t){this.specification=t}possiblyEvaluate(t,n,a,h){return!!t.expression.evaluate(n,null,{},a,h)}interpolate(){return!1}}class fi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const a=t[n];a.specification.overridable&&this.overridableProperties.push(n);const h=this.defaultPropertyValues[n]=new Ua(a,void 0),m=this.defaultTransitionablePropertyValues[n]=new lc(a);this.defaultTransitioningPropertyValues[n]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=h.possiblyEvaluate({})}}}et("DataDrivenProperty",pt),et("DataConstantProperty",nt),et("CrossFadedDataDrivenProperty",uc),et("CrossFadedProperty",Xu),et("ColorRampProperty",Za);const op="-transition";class Hr extends $e{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=hs(t.filter)),n.layout&&(this._unevaluatedLayout=new Am(n.layout)),n.paint)){this._transitionablePaint=new Hu(n.paint);for(const a in t.paint)this.setPaintProperty(a,t.paint[a],{validate:!1});for(const a in t.layout)this.setLayoutProperty(a,t.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new cc(n.paint)}}setFilter(t){this.filter=t,this._featureFilter=hs(t)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const a=this._unevaluatedLayout._values[n];for(const h of a.getGlobalStateRefs())t.add(h)}for(const n of this._featureFilter.getGlobalStateRefs())t.add(n);return t}setLayoutProperty(t,n,a={}){n!=null&&this._validate(Nu,`layers.${this.id}.layout.${t}`,t,n,a)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(op)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,a={}){if(n!=null&&this._validate(Im,`layers.${this.id}.paint.${t}`,t,n,a))return!1;if(t.endsWith(op))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",g=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||g||m||this._handleOverridablePaintPropertyUpdate(t,v,T)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,a){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),bn(t,(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}_validate(t,n,a,h,m={}){return(!m||m.validate!==!1)&&Oa(this,t.call(Lo,{key:n,layerType:this.type,objectKey:a,value:h,styleSpec:me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof In&&Po(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const ap={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Zs{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class nr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function hr(s,t=1){let n=0,a=0;return{members:s.map(h=>{const m=ap[h.type].BYTES_PER_ELEMENT,g=n=lp(n,Math.max(t,m)),v=h.components||1;return a=Math.max(a,m),n+=m*v,{name:h.name,type:h.type,components:v,offset:g}}),size:lp(n,Math.max(a,t)),alignment:t}}function lp(s,t){return Math.ceil(s/t)*t}class fs extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,n)}emplace(t,n,a){const h=2*t;return this.int16[h+0]=n,this.int16[h+1]=a,t}}fs.prototype.bytesPerElement=4,et("StructArrayLayout2i4",fs);class ms extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,a)}emplace(t,n,a,h){const m=3*t;return this.int16[m+0]=n,this.int16[m+1]=a,this.int16[m+2]=h,t}}ms.prototype.bytesPerElement=6,et("StructArrayLayout3i6",ms);class Yu extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,a,h)}emplace(t,n,a,h,m){const g=4*t;return this.int16[g+0]=n,this.int16[g+1]=a,this.int16[g+2]=h,this.int16[g+3]=m,t}}Yu.prototype.bytesPerElement=8,et("StructArrayLayout4i8",Yu);class hc extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,a,h,m,g)}emplace(t,n,a,h,m,g,v){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=a,this.int16[T+2]=h,this.int16[T+3]=m,this.int16[T+4]=g,this.int16[T+5]=v,t}}hc.prototype.bytesPerElement=12,et("StructArrayLayout2i4i12",hc);class Gs extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,a,h,m,g)}emplace(t,n,a,h,m,g,v){const T=4*t,P=8*t;return this.int16[T+0]=n,this.int16[T+1]=a,this.uint8[P+4]=h,this.uint8[P+5]=m,this.uint8[P+6]=g,this.uint8[P+7]=v,t}}Gs.prototype.bytesPerElement=8,et("StructArrayLayout2i4ub8",Gs);class Ga extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,n)}emplace(t,n,a){const h=2*t;return this.float32[h+0]=n,this.float32[h+1]=a,t}}Ga.prototype.bytesPerElement=8,et("StructArrayLayout2f8",Ga);class Ku extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g,v,T,P,I){const A=this.length;return this.resize(A+1),this.emplace(A,t,n,a,h,m,g,v,T,P,I)}emplace(t,n,a,h,m,g,v,T,P,I,A){const j=10*t;return this.uint16[j+0]=n,this.uint16[j+1]=a,this.uint16[j+2]=h,this.uint16[j+3]=m,this.uint16[j+4]=g,this.uint16[j+5]=v,this.uint16[j+6]=T,this.uint16[j+7]=P,this.uint16[j+8]=I,this.uint16[j+9]=A,t}}Ku.prototype.bytesPerElement=20,et("StructArrayLayout10ui20",Ku);class dc extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g,v,T,P,I,A,j){const $=this.length;return this.resize($+1),this.emplace($,t,n,a,h,m,g,v,T,P,I,A,j)}emplace(t,n,a,h,m,g,v,T,P,I,A,j,$){const V=12*t;return this.int16[V+0]=n,this.int16[V+1]=a,this.int16[V+2]=h,this.int16[V+3]=m,this.uint16[V+4]=g,this.uint16[V+5]=v,this.uint16[V+6]=T,this.uint16[V+7]=P,this.int16[V+8]=I,this.int16[V+9]=A,this.int16[V+10]=j,this.int16[V+11]=$,t}}dc.prototype.bytesPerElement=24,et("StructArrayLayout4i4ui4i24",dc);class Qu extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,a)}emplace(t,n,a,h){const m=3*t;return this.float32[m+0]=n,this.float32[m+1]=a,this.float32[m+2]=h,t}}Qu.prototype.bytesPerElement=12,et("StructArrayLayout3f12",Qu);class p extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}p.prototype.bytesPerElement=4,et("StructArrayLayout1ul4",p);class e extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g,v,T,P){const I=this.length;return this.resize(I+1),this.emplace(I,t,n,a,h,m,g,v,T,P)}emplace(t,n,a,h,m,g,v,T,P,I){const A=10*t,j=5*t;return this.int16[A+0]=n,this.int16[A+1]=a,this.int16[A+2]=h,this.int16[A+3]=m,this.int16[A+4]=g,this.int16[A+5]=v,this.uint32[j+3]=T,this.uint16[A+8]=P,this.uint16[A+9]=I,t}}e.prototype.bytesPerElement=20,et("StructArrayLayout6i1ul2ui20",e);class i extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,a,h,m,g)}emplace(t,n,a,h,m,g,v){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=a,this.int16[T+2]=h,this.int16[T+3]=m,this.int16[T+4]=g,this.int16[T+5]=v,t}}i.prototype.bytesPerElement=12,et("StructArrayLayout2i2i2i12",i);class l extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,n,a,h,m)}emplace(t,n,a,h,m,g){const v=4*t,T=8*t;return this.float32[v+0]=n,this.float32[v+1]=a,this.float32[v+2]=h,this.int16[T+6]=m,this.int16[T+7]=g,t}}l.prototype.bytesPerElement=16,et("StructArrayLayout2f1f2i16",l);class u extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,a,h,m,g)}emplace(t,n,a,h,m,g,v){const T=16*t,P=4*t,I=8*t;return this.uint8[T+0]=n,this.uint8[T+1]=a,this.float32[P+1]=h,this.float32[P+2]=m,this.int16[I+6]=g,this.int16[I+7]=v,t}}u.prototype.bytesPerElement=16,et("StructArrayLayout2ub2f2i16",u);class f extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,a)}emplace(t,n,a,h){const m=3*t;return this.uint16[m+0]=n,this.uint16[m+1]=a,this.uint16[m+2]=h,t}}f.prototype.bytesPerElement=6,et("StructArrayLayout3ui6",f);class y extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g,v,T,P,I,A,j,$,V,G,Y,ie){const ye=this.length;return this.resize(ye+1),this.emplace(ye,t,n,a,h,m,g,v,T,P,I,A,j,$,V,G,Y,ie)}emplace(t,n,a,h,m,g,v,T,P,I,A,j,$,V,G,Y,ie,ye){const ae=24*t,B=12*t,X=48*t;return this.int16[ae+0]=n,this.int16[ae+1]=a,this.uint16[ae+2]=h,this.uint16[ae+3]=m,this.uint32[B+2]=g,this.uint32[B+3]=v,this.uint32[B+4]=T,this.uint16[ae+10]=P,this.uint16[ae+11]=I,this.uint16[ae+12]=A,this.float32[B+7]=j,this.float32[B+8]=$,this.uint8[X+36]=V,this.uint8[X+37]=G,this.uint8[X+38]=Y,this.uint32[B+10]=ie,this.int16[ae+22]=ye,t}}y.prototype.bytesPerElement=48,et("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",y);class w extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a,h,m,g,v,T,P,I,A,j,$,V,G,Y,ie,ye,ae,B,X,he,ze,Ve,Le,Fe,qe,Ze){const We=this.length;return this.resize(We+1),this.emplace(We,t,n,a,h,m,g,v,T,P,I,A,j,$,V,G,Y,ie,ye,ae,B,X,he,ze,Ve,Le,Fe,qe,Ze)}emplace(t,n,a,h,m,g,v,T,P,I,A,j,$,V,G,Y,ie,ye,ae,B,X,he,ze,Ve,Le,Fe,qe,Ze,We){const Oe=32*t,it=16*t;return this.int16[Oe+0]=n,this.int16[Oe+1]=a,this.int16[Oe+2]=h,this.int16[Oe+3]=m,this.int16[Oe+4]=g,this.int16[Oe+5]=v,this.int16[Oe+6]=T,this.int16[Oe+7]=P,this.uint16[Oe+8]=I,this.uint16[Oe+9]=A,this.uint16[Oe+10]=j,this.uint16[Oe+11]=$,this.uint16[Oe+12]=V,this.uint16[Oe+13]=G,this.uint16[Oe+14]=Y,this.uint16[Oe+15]=ie,this.uint16[Oe+16]=ye,this.uint16[Oe+17]=ae,this.uint16[Oe+18]=B,this.uint16[Oe+19]=X,this.uint16[Oe+20]=he,this.uint16[Oe+21]=ze,this.uint16[Oe+22]=Ve,this.uint32[it+12]=Le,this.float32[it+13]=Fe,this.float32[it+14]=qe,this.uint16[Oe+30]=Ze,this.uint16[Oe+31]=We,t}}w.prototype.bytesPerElement=64,et("StructArrayLayout8i15ui1ul2f2ui64",w);class S extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}S.prototype.bytesPerElement=4,et("StructArrayLayout1f4",S);class M extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,a)}emplace(t,n,a,h){const m=3*t;return this.uint16[6*t+0]=n,this.float32[m+1]=a,this.float32[m+2]=h,t}}M.prototype.bytesPerElement=12,et("StructArrayLayout1ui2f12",M);class k extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,a)}emplace(t,n,a,h){const m=4*t;return this.uint32[2*t+0]=n,this.uint16[m+2]=a,this.uint16[m+3]=h,t}}k.prototype.bytesPerElement=8,et("StructArrayLayout1ul2ui8",k);class L extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,n)}emplace(t,n,a){const h=2*t;return this.uint16[h+0]=n,this.uint16[h+1]=a,t}}L.prototype.bytesPerElement=4,et("StructArrayLayout2ui4",L);class D extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}D.prototype.bytesPerElement=2,et("StructArrayLayout1ui2",D);class F extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,a,h)}emplace(t,n,a,h,m){const g=4*t;return this.float32[g+0]=n,this.float32[g+1]=a,this.float32[g+2]=h,this.float32[g+3]=m,t}}F.prototype.bytesPerElement=16,et("StructArrayLayout4f16",F);class U extends Zs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ue(this.anchorPointX,this.anchorPointY)}}U.prototype.size=20;class ee extends e{get(t){return new U(this,t)}}et("CollisionBoxArray",ee);class Q extends Zs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Q.prototype.size=48;class te extends y{get(t){return new Q(this,t)}}et("PlacedSymbolArray",te);class ne extends Zs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ne.prototype.size=64;class ce extends w{get(t){return new ne(this,t)}}et("SymbolInstanceArray",ce);class se extends S{getoffsetX(t){return this.float32[1*t+0]}}et("GlyphOffsetArray",se);class de extends ms{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}et("SymbolLineVertexArray",de);class fe extends Zs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}fe.prototype.size=12;class oe extends M{get(t){return new fe(this,t)}}et("TextAnchorOffsetArray",oe);class ve extends Zs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ve.prototype.size=8;class Re extends k{get(t){return new ve(this,t)}}et("FeatureIndexArray",Re);class Ee extends fs{}class ke extends fs{}class De extends fs{}class Ye extends hc{}class Xe extends Gs{}class Ue extends Ga{}class rt extends Ku{}class St extends dc{}class Vt extends Qu{}class sr extends p{}class qt extends i{}class or extends u{}class Ht extends f{}class Wt extends L{}const Xt=hr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xr}=Xt;class Lt{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,a,h){const m=this.segments[this.segments.length-1];return t>Lt.MAX_VERTEX_ARRAY_LENGTH&&qr(`Max vertices per segment is ${Lt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Lt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!m||m.vertexLength+t>Lt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h?this.createNewSegment(n,a,h):m}createNewSegment(t,n,a){const h={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return a!==void 0&&(h.sortKey=a),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,n,a){return this.prepareSegment(0,t,n,a)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,a,h){return new Lt([{vertexOffset:t,primitiveOffset:n,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}function Or(s,t){return 256*(s=kr(Math.floor(s),0,255))+kr(Math.floor(t),0,255)}Lt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,et("SegmentVector",Lt);const Yr=hr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var gs,_s,ys,En={exports:{}},qa={exports:{}},Wa={exports:{}},Bo=function(){if(ys)return En.exports;ys=1;var s=(gs||(gs=1,qa.exports=function(n,a){var h,m,g,v,T,P,I,A;for(m=n.length-(h=3&n.length),g=a,T=3432918353,P=461845907,A=0;A<m;)I=255&n.charCodeAt(A)|(255&n.charCodeAt(++A))<<8|(255&n.charCodeAt(++A))<<16|(255&n.charCodeAt(++A))<<24,++A,g=27492+(65535&(v=5*(65535&(g=(g^=I=(65535&(I=(I=(65535&I)*T+(((I>>>16)*T&65535)<<16)&4294967295)<<15|I>>>17))*P+(((I>>>16)*P&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(I=0,h){case 3:I^=(255&n.charCodeAt(A+2))<<16;case 2:I^=(255&n.charCodeAt(A+1))<<8;case 1:g^=I=(65535&(I=(I=(65535&(I^=255&n.charCodeAt(A)))*T+(((I>>>16)*T&65535)<<16)&4294967295)<<15|I>>>17))*P+(((I>>>16)*P&65535)<<16)&4294967295}return g^=n.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),qa.exports),t=(_s||(_s=1,Wa.exports=function(n,a){for(var h,m=n.length,g=a^m,v=0;m>=4;)h=1540483477*(65535&(h=255&n.charCodeAt(v)|(255&n.charCodeAt(++v))<<8|(255&n.charCodeAt(++v))<<16|(255&n.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++v;switch(m){case 3:g^=(255&n.charCodeAt(v+2))<<16;case 2:g^=(255&n.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&n.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),Wa.exports);return En.exports=s,En.exports.murmur3=s,En.exports.murmur2=t,En.exports}(),Si=Z(Bo);class ln{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,a,h){this.ids.push(vs(t)),this.positions.push(n,a,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=vs(t);let a=0,h=this.ids.length-1;for(;a<h;){const g=a+h>>1;this.ids[g]>=n?h=g:a=g+1}const m=[];for(;this.ids[a]===n;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(t,n){const a=new Float64Array(t.ids),h=new Uint32Array(t.positions);return qs(a,h,0,a.length-1),n&&n.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(t){const n=new ln;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function vs(s){const t=+s;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Si(String(s))}function qs(s,t,n,a){for(;n<a;){const h=s[n+a>>1];let m=n-1,g=a+1;for(;;){do m++;while(s[m]<h);do g--;while(s[g]>h);if(m>=g)break;mr(s,m,g),mr(t,3*m,3*g),mr(t,3*m+1,3*g+1),mr(t,3*m+2,3*g+2)}g-n<a-g?(qs(s,t,n,g),n=g+1):(qs(s,t,g+1,a),a=g)}}function mr(s,t,n){const a=s[t];s[t]=s[n],s[n]=a}et("FeaturePositionMap",ln);class Qt{constructor(t,n){this.gl=t.gl,this.location=n}}class mi extends Qt{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class zr extends Qt{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class cp extends Qt{constructor(t,n){super(t,n),this.current=Et.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Rm=new Float32Array(16);function Ju(s){return[Or(255*s.r,255*s.g),Or(255*s.b,255*s.a)]}class Ha{constructor(t,n,a){this.value=t,this.uniformNames=n.map(h=>`u_${h}`),this.type=a}setUniform(t,n,a){t.set(a.constantOr(this.value))}getBinding(t,n,a){return this.type==="color"?new cp(t,n):new mi(t,n)}}class Oo{constructor(t,n){this.uniformNames=n.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,a,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,n,a){return a.substr(0,9)==="u_pattern"?new zr(t,n):new mi(t,n)}}class Gn{constructor(t,n,a,h){this.expression=t,this.type=a,this.maxValue=0,this.paintVertexAttributes=n.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,n,a,h,m){const g=this.paintVertexArray.length,v=this.expression.evaluate(new er(0),n,{},h,[],m);this.paintVertexArray.resize(t),this._setPaintValue(g,t,v)}updatePaintArray(t,n,a,h){const m=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(t,n,m)}_setPaintValue(t,n,a){if(this.type==="color"){const h=Ju(a);for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<n;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Kr{constructor(t,n,a,h,m,g){this.expression=t,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,n,a,h,m){const g=this.expression.evaluate(new er(this.zoom),n,{},h,[],m),v=this.expression.evaluate(new er(this.zoom+1),n,{},h,[],m),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,g,v)}updatePaintArray(t,n,a,h){const m=this.expression.evaluate({zoom:this.zoom},a,h),g=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(t,n,m,g)}_setPaintValue(t,n,a,h){if(this.type==="color"){const m=Ju(a),g=Ju(h);for(let v=t;v<n;v++)this.paintVertexArray.emplace(v,m[0],m[1],g[0],g[1])}else{for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const a=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,h=kr(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,n,a){return new mi(t,n)}}class qn{constructor(t,n,a,h,m,g){this.expression=t,this.type=n,this.useIntegerZoom=a,this.zoom=h,this.layerId=g,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,n,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,n.patterns&&n.patterns[this.layerId],a)}updatePaintArray(t,n,a,h,m){this._setPaintValues(t,n,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(t,n,a,h){if(!h||!a)return;const{min:m,mid:g,max:v}=a,T=h[m],P=h[g],I=h[v];if(T&&P&&I)for(let A=t;A<n;A++)this.zoomInPaintVertexArray.emplace(A,P.tl[0],P.tl[1],P.br[0],P.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],P.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,P.tl[0],P.tl[1],P.br[0],P.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],P.pixelRatio,I.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Yr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Yr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class eh{constructor(t,n,a){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!a(m))continue;const g=t.paint.get(m);if(!(g instanceof In&&Po(g.property.specification)))continue;const v=th(m,t.type),T=g.value,P=g.property.specification.type,I=g.property.useIntegerZoom,A=g.property.specification["property-type"],j=A==="cross-faded"||A==="cross-faded-data-driven";if(T.kind==="constant")this.binders[m]=j?new Oo(T.value,v):new Ha(T.value,v,P),h.push(`/u_${m}`);else if(T.kind==="source"||j){const $=rh(m,P,"source");this.binders[m]=j?new qn(T,P,I,n,$,t.id):new Gn(T,v,P,$),h.push(`/a_${m}`)}else{const $=rh(m,P,"composite");this.binders[m]=new Kr(T,v,P,I,n,$),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof Gn||n instanceof Kr?n.maxValue:0}populatePaintArrays(t,n,a,h,m){for(const g in this.binders){const v=this.binders[g];(v instanceof Gn||v instanceof Kr||v instanceof qn)&&v.populatePaintArray(t,n,a,h,m)}}setConstantPatternPositions(t,n){for(const a in this.binders){const h=this.binders[a];h instanceof Oo&&h.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,a,h,m){let g=!1;for(const v in t){const T=n.getPositions(v);for(const P of T){const I=a.feature(P.index);for(const A in this.binders){const j=this.binders[A];if((j instanceof Gn||j instanceof Kr||j instanceof qn)&&j.expression.isStateDependent===!0){const $=h.paint.get(A);j.expression=$.value,j.updatePaintArray(P.start,P.end,I,t[v],m),g=!0}}}}return g}defines(){const t=[];for(const n in this.binders){const a=this.binders[n];(a instanceof Ha||a instanceof Oo)&&t.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof Gn||a instanceof Kr)for(let h=0;h<a.paintVertexAttributes.length;h++)t.push(a.paintVertexAttributes[h].name);else if(a instanceof qn)for(let h=0;h<Yr.members.length;h++)t.push(Yr.members[h].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof Ha||a instanceof Oo||a instanceof Kr)for(const h of a.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Ha||m instanceof Oo||m instanceof Kr){for(const g of m.uniformNames)if(n[g]){const v=m.getBinding(t,n[g],g);a.push({name:g,property:h,binding:v})}}}return a}setUniforms(t,n,a,h){for(const{name:m,property:g,binding:v}of n)this.binders[g].setUniform(v,h,a.get(g),m)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const a=this.binders[n];if(t&&a instanceof qn){const h=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof Gn||a instanceof Kr)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(t){for(const n in this.binders){const a=this.binders[n];(a instanceof Gn||a instanceof Kr||a instanceof qn)&&a.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof Gn||n instanceof Kr||n instanceof qn)&&n.destroy()}}}class xs{constructor(t,n,a=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new eh(h,n,a);this.needsUpload=!1,this._featureMap=new ln,this._bufferOffset=0}populatePaintArrays(t,n,a,h,m,g){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,n,h,m,g);n.id!==void 0&&this._featureMap.add(n.id,a,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,a,h){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,n,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function th(s,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${t}-`,"").replace(/-/g,"_")]}function rh(s,t,n){const a={color:{source:Ga,composite:F},number:{source:S,composite:Ga}},h=function(m){return{"line-pattern":{source:rt,composite:rt},"fill-pattern":{source:rt,composite:rt},"fill-extrusion-pattern":{source:rt,composite:rt}}[m]}(s);return h&&h[n]||a[t][n]}et("ConstantBinder",Ha),et("CrossFadedConstantBinder",Oo),et("SourceExpressionBinder",Gn),et("CrossFadedCompositeBinder",qn),et("CompositeExpressionBinder",Kr),et("ProgramConfiguration",eh,{omit:["_buffers"]}),et("ProgramConfigurationSet",xs);const Xa=Math.pow(2,14)-1,Qy=-Xa-1;function Ya(s){const t=vt/s.extent,n=s.loadGeometry();for(let a=0;a<n.length;a++){const h=n[a];for(let m=0;m<h.length;m++){const g=h[m],v=Math.round(g.x*t),T=Math.round(g.y*t);g.x=kr(v,Qy,Xa),g.y=kr(T,Qy,Xa),(v<g.x||v>g.x+1||T<g.y||T>g.y+1)&&qr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Ka(s,t){return{type:s.type,id:s.id,properties:s.properties,geometry:t?Ya(s):[]}}const Jy=-32768;function Zw(s,t,n,a,h){s.emplaceBack(Jy+8*t+a,Jy+8*n+h)}class Dm{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ke,this.indexArray=new Ht,this.segments=new Lt,this.programConfigurations=new xs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){const h=this.layers[0],m=[];let g=null,v=!1,T=h.type==="heatmap";if(h.type==="circle"){const I=h;g=I.layout.get("circle-sort-key"),v=!g.isConstant(),T=T||I.paint.get("circle-pitch-alignment")==="map"}const P=T?n.subdivisionGranularity.circle:1;for(const{feature:I,id:A,index:j,sourceLayerIndex:$}of t){const V=this.layers[0]._featureFilter.needGeometry,G=Ka(I,V);if(!this.layers[0]._featureFilter.filter(new er(this.zoom,{globalState:this.globalState}),G,a))continue;const Y=v?g.evaluate(G,{},a):void 0,ie={id:A,properties:I.properties,type:I.type,sourceLayerIndex:$,index:j,geometry:V?G.geometry:Ya(I),patterns:{},sortKey:Y};m.push(ie)}v&&m.sort((I,A)=>I.sortKey-A.sortKey);for(const I of m){const{geometry:A,index:j,sourceLayerIndex:$}=I,V=t[j].feature;this.addFeature(I,A,j,a,P),n.featureIndex.insert(V,A,j,$,this.index)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xr),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,a,h,m=1){let g;switch(m){case 1:g=[0,7];break;case 3:g=[0,2,5,7];break;case 5:g=[0,1,3,4,6,7];break;case 7:g=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${m}; valid values are 1, 3, 5, 7.`)}const v=g.length;for(const T of n)for(const P of T){const I=P.x,A=P.y;if(I<0||I>=vt||A<0||A>=vt)continue;const j=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),$=j.vertexLength;for(let V=0;V<v;V++)for(let G=0;G<v;G++)Zw(this.layoutVertexArray,I,A,g[G],g[V]);for(let V=0;V<v-1;V++)for(let G=0;G<v-1;G++){const Y=$+V*v+G,ie=$+(V+1)*v+G;this.indexArray.emplaceBack(Y,ie+1,Y+1),this.indexArray.emplaceBack(Y,ie,ie+1)}j.vertexLength+=v*v,j.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,{},h)}}function ev(s,t){for(let n=0;n<s.length;n++)if(pc(t,s[n]))return!0;for(let n=0;n<t.length;n++)if(pc(s,t[n]))return!0;return!!Lm(s,t)}function Gw(s,t,n){return!!pc(s,t)||!!jm(t,s,n)}function tv(s,t){if(s.length===1)return iv(t,s[0]);for(let n=0;n<t.length;n++){const a=t[n];for(let h=0;h<a.length;h++)if(pc(s,a[h]))return!0}for(let n=0;n<s.length;n++)if(iv(t,s[n]))return!0;for(let n=0;n<t.length;n++)if(Lm(s,t[n]))return!0;return!1}function qw(s,t,n){if(s.length>1){if(Lm(s,t))return!0;for(let a=0;a<t.length;a++)if(jm(t[a],s,n))return!0}for(let a=0;a<s.length;a++)if(jm(s[a],t,n))return!0;return!1}function Lm(s,t){if(s.length===0||t.length===0)return!1;for(let n=0;n<s.length-1;n++){const a=s[n],h=s[n+1];for(let m=0;m<t.length-1;m++)if(Ww(a,h,t[m],t[m+1]))return!0}return!1}function Ww(s,t,n,a){return zi(s,n,a)!==zi(t,n,a)&&zi(s,t,n)!==zi(s,t,a)}function jm(s,t,n){const a=n*n;if(t.length===1)return s.distSqr(t[0])<a;for(let h=1;h<t.length;h++)if(rv(s,t[h-1],t[h])<a)return!0;return!1}function rv(s,t,n){const a=t.distSqr(n);if(a===0)return s.distSqr(t);const h=((s.x-t.x)*(n.x-t.x)+(s.y-t.y)*(n.y-t.y))/a;return s.distSqr(h<0?t:h>1?n:n.sub(t)._mult(h)._add(t))}function iv(s,t){let n,a,h,m=!1;for(let g=0;g<s.length;g++){n=s[g];for(let v=0,T=n.length-1;v<n.length;T=v++)a=n[v],h=n[T],a.y>t.y!=h.y>t.y&&t.x<(h.x-a.x)*(t.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function pc(s,t){let n=!1;for(let a=0,h=s.length-1;a<s.length;h=a++){const m=s[a],g=s[h];m.y>t.y!=g.y>t.y&&t.x<(g.x-m.x)*(t.y-m.y)/(g.y-m.y)+m.x&&(n=!n)}return n}function Hw(s,t,n){const a=n[0],h=n[2];if(s.x<a.x&&t.x<a.x||s.x>h.x&&t.x>h.x||s.y<a.y&&t.y<a.y||s.y>h.y&&t.y>h.y)return!1;const m=zi(s,t,n[0]);return m!==zi(s,t,n[1])||m!==zi(s,t,n[2])||m!==zi(s,t,n[3])}function ih(s,t,n){const a=t.paint.get(s).value;return a.kind==="constant"?a.value:n.programConfigurations.get(t.id).getMaxValue(s)}function up(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function hp(s,t,n,a,h){if(!t[0]&&!t[1])return s;const m=ue.convert(t)._mult(h);n==="viewport"&&m._rotate(-a);const g=[];for(let v=0;v<s.length;v++)g.push(s[v].sub(m));return g}let nv,sv;et("CircleBucket",Dm,{omit:["layers"]});var Xw={get paint(){return sv=sv||new fi({"circle-radius":new pt(me.paint_circle["circle-radius"]),"circle-color":new pt(me.paint_circle["circle-color"]),"circle-blur":new pt(me.paint_circle["circle-blur"]),"circle-opacity":new pt(me.paint_circle["circle-opacity"]),"circle-translate":new nt(me.paint_circle["circle-translate"]),"circle-translate-anchor":new nt(me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new nt(me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new nt(me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pt(me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pt(me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pt(me.paint_circle["circle-stroke-opacity"])})},get layout(){return nv=nv||new fi({"circle-sort-key":new pt(me.layout_circle["circle-sort-key"])})}};class Yw extends Hr{constructor(t){super(t,Xw)}createBucket(t){return new Dm(t)}queryRadius(t){const n=t;return ih("circle-radius",this,n)+ih("circle-stroke-width",this,n)+up(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g,unwrappedTileID:v,getElevation:T}){const P=hp(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-m.bearingInRadians,g),I=this.paint.get("circle-radius").evaluate(n,a)+this.paint.get("circle-stroke-width").evaluate(n,a),A=this.paint.get("circle-pitch-alignment")==="map",j=A?P:function(V,G,Y,ie){return V.map(ye=>ov(ye,G,Y,ie))}(P,m,v,T),$=A?I*g:I;for(const V of h)for(const G of V){const Y=A?G:ov(G,m,v,T);let ie=$;const ye=m.projectTileCoordinates(G.x,G.y,v,T).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ie*=ye/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ie*=m.cameraToCenterDistance/ye),Gw(j,Y,ie))return!0}return!1}}function ov(s,t,n,a){const h=t.projectTileCoordinates(s.x,s.y,n,a).point;return new ue((.5*h.x+.5)*t.width,(.5*-h.y+.5)*t.height)}class av extends Dm{}let lv;et("HeatmapBucket",av,{omit:["layers"]});var Kw={get paint(){return lv=lv||new fi({"heatmap-radius":new pt(me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pt(me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new nt(me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Za(me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new nt(me.paint_heatmap["heatmap-opacity"])})}};function Fm(s,{width:t,height:n},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*n*a)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*n*a}`)}else h=new Uint8Array(t*n*a);return s.width=t,s.height=n,s.data=h,s}function cv(s,{width:t,height:n},a){if(t===s.width&&n===s.height)return;const h=Fm({},{width:t,height:n},a);Bm(s,h,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,t),height:Math.min(s.height,n)},a),s.width=t,s.height=n,s.data=h.data}function Bm(s,t,n,a,h,m){if(h.width===0||h.height===0)return t;if(h.width>s.width||h.height>s.height||n.x>s.width-h.width||n.y>s.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||a.x>t.width-h.width||a.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=s.data,v=t.data;if(g===v)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<h.height;T++){const P=((n.y+T)*s.width+n.x)*m,I=((a.y+T)*t.width+a.x)*m;for(let A=0;A<h.width*m;A++)v[I+A]=g[P+A]}return t}class nh{constructor(t,n){Fm(this,t,1,n)}resize(t){cv(this,t,1)}clone(){return new nh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,a,h,m){Bm(t,n,a,h,m,1)}}class ji{constructor(t,n){Fm(this,t,4,n)}resize(t){cv(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ji({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,a,h,m){Bm(t,n,a,h,m,4)}setPixel(t,n,a){const h=4*(t*this.width+n);this.data[h+0]=Math.round(255*a.r/a.a),this.data[h+1]=Math.round(255*a.g/a.a),this.data[h+2]=Math.round(255*a.b/a.a),this.data[h+3]=Math.round(255*a.a)}}function uv(s){const t={},n=s.resolution||256,a=s.clips?s.clips.length:1,h=s.image||new ji({width:n,height:a});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const m=(g,v,T)=>{t[s.evaluationKey]=T;const P=s.expression.evaluate(t);h.setPixel(g/4/n,v/4,P)};if(s.clips)for(let g=0,v=0;g<a;++g,v+=4*n)for(let T=0,P=0;T<n;T++,P+=4){const I=T/(n-1),{start:A,end:j}=s.clips[g];m(v,P,A*(1-I)+j*I)}else for(let g=0,v=0;g<n;g++,v+=4)m(0,v,g/(n-1));return h}et("AlphaImage",nh),et("RGBAImage",ji);const Om="big-fb";class Qw extends Hr{createBucket(t){return new av(t)}constructor(t){super(t,Kw),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=uv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Om)&&this.heatmapFbos.delete(Om)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let hv;var Jw={get paint(){return hv=hv||new fi({"hillshade-illumination-direction":new nt(me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new nt(me.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new nt(me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new nt(me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new nt(me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new nt(me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new nt(me.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new nt(me.paint_hillshade["hillshade-method"])})}};class e2 extends Hr{constructor(t){super(t,Jw),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,a=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const m=Math.max(t.length,n.length,a.length,h.length);t=t.concat(Array(m-t.length).fill(t.at(-1))),n=n.concat(Array(m-n.length).fill(n.at(-1))),a=a.concat(Array(m-a.length).fill(a.at(-1))),h=h.concat(Array(m-h.length).fill(h.at(-1)));const g=n.map(Ai);return{directionRadians:t.map(Ai),altitudeRadians:g,shadowColor:h,highlightColor:a}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let dv;var t2={get paint(){return dv=dv||new fi({"color-relief-opacity":new nt(me["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Za(me["paint_color-relief"]["color-relief-color"])})}};class Nm{constructor(t,n,a,h){this.context=t,this.format=a,this.texture=t.gl.createTexture(),this.update(n,h)}update(t,n,a){const{width:h,height:m}=t,g=!(this.size&&this.size[0]===h&&this.size[1]===m||a),{context:v}=this,{gl:T}=v;if(this.useMipmap=!!(n&&n.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!n||n.premultiply!==!1)),g)this.size=[h,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||as(t)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,t):T.texImage2D(T.TEXTURE_2D,0,this.format,h,m,0,this.format,T.UNSIGNED_BYTE,t.data);else{const{x:P,y:I}=a||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||as(t)?T.texSubImage2D(T.TEXTURE_2D,0,P,I,T.RGBA,T.UNSIGNED_BYTE,t):T.texSubImage2D(T.TEXTURE_2D,0,P,I,h,m,T.RGBA,T.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D),v.pixelStoreUnpackFlipY.setDefault(),v.pixelStoreUnpack.setDefault(),v.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,n,a){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),a!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(a=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,a||t),this.filter=t),n!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class pv{constructor(t,n,a,h=1,m=1,g=1,v=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void qr(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const T=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=g,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<T;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(T,P)]=this.data[this._idx(T-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,T)]=this.data[this._idx(P,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<T;P++)for(let I=0;I<T;I++){const A=this.get(P,I);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(t,n){const a=new Uint8Array(this.data.buffer),h=4*this._idx(t,n);return this.unpack(a[h],a[h+1],a[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,a){return t*this.redFactor+n*this.greenFactor+a*this.blueFactor-this.baseShift}pack(t){return fv(t,this.getUnpackVector())}getPixels(){return new ji({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,a){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,m=n*this.dim+this.dim,g=a*this.dim,v=a*this.dim+this.dim;switch(n){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:g=v-1;break;case 1:v=g+1}const T=-n*this.dim,P=-a*this.dim;for(let I=g;I<v;I++)for(let A=h;A<m;A++)this.data[this._idx(A,I)]=t.data[this._idx(A+T,I+P)]}}function fv(s,t){const n=t[0],a=t[1],h=t[2],m=t[3],g=Math.min(n,a,h),v=Math.round((s+m)/g);return{r:Math.floor(v*g/n)%256,g:Math.floor(v*g/a)%256,b:Math.floor(v*g/h)%256}}et("DEMData",pv);class r2 extends Hr{constructor(t){super(t,t2)}_createColorRamp(t){const n={elevationStops:[],colorStops:[]},a=this._transitionablePaint._values["color-relief-color"].value.expression;if(a instanceof Ra&&a._styleExpression.expression instanceof di){this.colorRampExpression=a;const g=a._styleExpression.expression;n.elevationStops=g.labels,n.colorStops=[];for(const v of n.elevationStops)n.colorStops.push(g.evaluate({globals:{elevation:v}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[Et.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=t)return n;const h={elevationStops:[],colorStops:[]},m=(n.elevationStops.length-1)/(t-1);for(let g=0;g<n.elevationStops.length-.5;g+=m)h.elevationStops.push(n.elevationStops[Math.round(g)]),h.colorStops.push(n.colorStops[Math.round(g)]);return qr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),h}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,n,a){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const h=this._createColorRamp(n),m=new ji({width:h.colorStops.length,height:1}),g=new ji({width:h.colorStops.length,height:1});for(let v=0;v<h.elevationStops.length;v++){const T=fv(h.elevationStops[v],a);g.setPixel(0,v,new Et(T.r/255,T.g/255,T.b/255,1)),m.setPixel(0,v,h.colorStops[v])}return this.colorRampTextures={elevationTexture:new Nm(t,g,t.gl.RGBA),colorTexture:new Nm(t,m,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const i2=hr([{name:"a_pos",components:2,type:"Int16"}],4),{members:n2}=i2;function $m(s,t,n){const a=n.patternDependencies;let h=!1;for(const m of t){const g=m.paint.get(`${s}-pattern`);g.isConstant()||(h=!0);const v=g.constantOr(null);v&&(h=!0,a[v.to]=!0,a[v.from]=!0)}return h}function Vm(s,t,n,a,h){const m=h.patternDependencies;for(const g of t){const v=g.paint.get(`${s}-pattern`).value;if(v.kind!=="constant"){let T=v.evaluate({zoom:a-1},n,{},h.availableImages),P=v.evaluate({zoom:a},n,{},h.availableImages),I=v.evaluate({zoom:a+1},n,{},h.availableImages);T=T&&T.name?T.name:T,P=P&&P.name?P.name:P,I=I&&I.name?I.name:I,m[T]=!0,m[P]=!0,m[I]=!0,n.patterns[g.id]={min:T,mid:P,max:I}}}return n}function mv(s,t,n,a,h){let m;if(h===function(g,v,T,P){let I=0;for(let A=v,j=T-P;A<T;A+=P)I+=(g[j]-g[A])*(g[A+1]+g[j+1]),j=A;return I}(s,t,n,a)>0)for(let g=t;g<n;g+=a)m=vv(g/a|0,s[g],s[g+1],m);else for(let g=n-a;g>=t;g-=a)m=vv(g/a|0,s[g],s[g+1],m);return m&&fc(m,m.next)&&(lh(m),m=m.next),m}function Qa(s,t){if(!s)return s;t||(t=s);let n,a=s;do if(n=!1,a.steiner||!fc(a,a.next)&&xr(a.prev,a,a.next)!==0)a=a.next;else{if(lh(a),a=t=a.prev,a===a.next)break;n=!0}while(n||a!==t);return t}function sh(s,t,n,a,h,m,g){if(!s)return;!g&&m&&function(T,P,I,A){let j=T;do j.z===0&&(j.z=Um(j.x,j.y,P,I,A)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==T);j.prevZ.nextZ=null,j.prevZ=null,function($){let V,G=1;do{let Y,ie=$;$=null;let ye=null;for(V=0;ie;){V++;let ae=ie,B=0;for(let he=0;he<G&&(B++,ae=ae.nextZ,ae);he++);let X=G;for(;B>0||X>0&&ae;)B!==0&&(X===0||!ae||ie.z<=ae.z)?(Y=ie,ie=ie.nextZ,B--):(Y=ae,ae=ae.nextZ,X--),ye?ye.nextZ=Y:$=Y,Y.prevZ=ye,ye=Y;ie=ae}ye.nextZ=null,G*=2}while(V>1)}(j)}(s,a,h,m);let v=s;for(;s.prev!==s.next;){const T=s.prev,P=s.next;if(m?o2(s,a,h,m):s2(s))t.push(T.i,s.i,P.i),lh(s),s=P.next,v=P.next;else if((s=P)===v){g?g===1?sh(s=a2(Qa(s),t),t,n,a,h,m,2):g===2&&l2(s,t,n,a,h,m):sh(Qa(s),t,n,a,h,m,1);break}}}function s2(s){const t=s.prev,n=s,a=s.next;if(xr(t,n,a)>=0)return!1;const h=t.x,m=n.x,g=a.x,v=t.y,T=n.y,P=a.y,I=Math.min(h,m,g),A=Math.min(v,T,P),j=Math.max(h,m,g),$=Math.max(v,T,P);let V=a.next;for(;V!==t;){if(V.x>=I&&V.x<=j&&V.y>=A&&V.y<=$&&oh(h,v,m,T,g,P,V.x,V.y)&&xr(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function o2(s,t,n,a){const h=s.prev,m=s,g=s.next;if(xr(h,m,g)>=0)return!1;const v=h.x,T=m.x,P=g.x,I=h.y,A=m.y,j=g.y,$=Math.min(v,T,P),V=Math.min(I,A,j),G=Math.max(v,T,P),Y=Math.max(I,A,j),ie=Um($,V,t,n,a),ye=Um(G,Y,t,n,a);let ae=s.prevZ,B=s.nextZ;for(;ae&&ae.z>=ie&&B&&B.z<=ye;){if(ae.x>=$&&ae.x<=G&&ae.y>=V&&ae.y<=Y&&ae!==h&&ae!==g&&oh(v,I,T,A,P,j,ae.x,ae.y)&&xr(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,B.x>=$&&B.x<=G&&B.y>=V&&B.y<=Y&&B!==h&&B!==g&&oh(v,I,T,A,P,j,B.x,B.y)&&xr(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;ae&&ae.z>=ie;){if(ae.x>=$&&ae.x<=G&&ae.y>=V&&ae.y<=Y&&ae!==h&&ae!==g&&oh(v,I,T,A,P,j,ae.x,ae.y)&&xr(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;B&&B.z<=ye;){if(B.x>=$&&B.x<=G&&B.y>=V&&B.y<=Y&&B!==h&&B!==g&&oh(v,I,T,A,P,j,B.x,B.y)&&xr(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function a2(s,t){let n=s;do{const a=n.prev,h=n.next.next;!fc(a,h)&&_v(a,n,n.next,h)&&ah(a,h)&&ah(h,a)&&(t.push(a.i,n.i,h.i),lh(n),lh(n.next),n=s=h),n=n.next}while(n!==s);return Qa(n)}function l2(s,t,n,a,h,m){let g=s;do{let v=g.next.next;for(;v!==g.prev;){if(g.i!==v.i&&p2(g,v)){let T=yv(g,v);return g=Qa(g,g.next),T=Qa(T,T.next),sh(g,t,n,a,h,m,0),void sh(T,t,n,a,h,m,0)}v=v.next}g=g.next}while(g!==s)}function c2(s,t){let n=s.x-t.x;return n===0&&(n=s.y-t.y,n===0)&&(n=(s.next.y-s.y)/(s.next.x-s.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function u2(s,t){const n=function(h,m){let g=m;const v=h.x,T=h.y;let P,I=-1/0;if(fc(h,g))return g;do{if(fc(h,g.next))return g.next;if(T<=g.y&&T>=g.next.y&&g.next.y!==g.y){const G=g.x+(T-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(G<=v&&G>I&&(I=G,P=g.x<g.next.x?g:g.next,G===v))return P}g=g.next}while(g!==m);if(!P)return null;const A=P,j=P.x,$=P.y;let V=1/0;g=P;do{if(v>=g.x&&g.x>=j&&v!==g.x&&gv(T<$?v:I,T,j,$,T<$?I:v,T,g.x,g.y)){const G=Math.abs(T-g.y)/(v-g.x);ah(g,h)&&(G<V||G===V&&(g.x>P.x||g.x===P.x&&h2(P,g)))&&(P=g,V=G)}g=g.next}while(g!==A);return P}(s,t);if(!n)return t;const a=yv(n,s);return Qa(a,a.next),Qa(n,n.next)}function h2(s,t){return xr(s.prev,s,t.prev)<0&&xr(t.next,s,s.next)<0}function Um(s,t,n,a,h){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-n)*h|0)|s<<8))|s<<4))|s<<2))|s<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-a)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d2(s){let t=s,n=s;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==s);return n}function gv(s,t,n,a,h,m,g,v){return(h-g)*(t-v)>=(s-g)*(m-v)&&(s-g)*(a-v)>=(n-g)*(t-v)&&(n-g)*(m-v)>=(h-g)*(a-v)}function oh(s,t,n,a,h,m,g,v){return!(s===g&&t===v)&&gv(s,t,n,a,h,m,g,v)}function p2(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!function(n,a){let h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==a.i&&h.next.i!==a.i&&_v(h,h.next,n,a))return!0;h=h.next}while(h!==n);return!1}(s,t)&&(ah(s,t)&&ah(t,s)&&function(n,a){let h=n,m=!1;const g=(n.x+a.x)/2,v=(n.y+a.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&g<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==n);return m}(s,t)&&(xr(s.prev,s,t.prev)||xr(s,t.prev,t))||fc(s,t)&&xr(s.prev,s,s.next)>0&&xr(t.prev,t,t.next)>0)}function xr(s,t,n){return(t.y-s.y)*(n.x-t.x)-(t.x-s.x)*(n.y-t.y)}function fc(s,t){return s.x===t.x&&s.y===t.y}function _v(s,t,n,a){const h=pp(xr(s,t,n)),m=pp(xr(s,t,a)),g=pp(xr(n,a,s)),v=pp(xr(n,a,t));return h!==m&&g!==v||!(h!==0||!dp(s,n,t))||!(m!==0||!dp(s,a,t))||!(g!==0||!dp(n,s,a))||!(v!==0||!dp(n,t,a))}function dp(s,t,n){return t.x<=Math.max(s.x,n.x)&&t.x>=Math.min(s.x,n.x)&&t.y<=Math.max(s.y,n.y)&&t.y>=Math.min(s.y,n.y)}function pp(s){return s>0?1:s<0?-1:0}function ah(s,t){return xr(s.prev,s,s.next)<0?xr(s,t,s.next)>=0&&xr(s,s.prev,t)>=0:xr(s,t,s.prev)<0||xr(s,s.next,t)<0}function yv(s,t){const n=Zm(s.i,s.x,s.y),a=Zm(t.i,t.x,t.y),h=s.next,m=t.prev;return s.next=t,t.prev=s,n.next=h,h.prev=n,a.next=n,n.prev=a,m.next=a,a.prev=m,a}function vv(s,t,n,a){const h=Zm(s,t,n);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function lh(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Zm(s,t,n){return{i:s,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class mc{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class fp{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}fp.noSubdivision=new fp({fill:new mc(0,0),line:new mc(0,0),tile:new mc(0,0),stencil:new mc(0,0),circle:1}),et("SubdivisionGranularityExpression",mc),et("SubdivisionGranularitySetting",fp);const gc=-32768,ch=32767;class f2{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=vt/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|n+32768}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const a=0|Math.round(t),h=0|Math.round(n),m=this._getKey(a,h);if(this._vertexDictionary.has(m))return this._vertexDictionary.get(m);const g=this._vertexBuffer.length/2;return this._vertexDictionary.set(m,g),this._vertexBuffer.push(a,h),g}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(h,m){const g=[];for(let v=0;v<m.length;v+=3){const T=m[v],P=m[v+1],I=m[v+2],A=h[2*T],j=h[2*T+1];(h[2*P]-A)*(h[2*I+1]-j)-(h[2*P+1]-j)*(h[2*I]-A)>0?(g.push(T),g.push(I),g.push(P)):(g.push(T),g.push(P),g.push(I))}return g}(this._vertexBuffer,t);const n=[],a=t.length;for(let h=0;h<a;h+=3){const m=[t[h+0],t[h+1],t[h+2]],g=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let v=1/0,T=1/0,P=-1/0,I=-1/0;for(let G=0;G<3;G++){const Y=g[2*G],ie=g[2*G+1];v=Math.min(v,Y),P=Math.max(P,Y),T=Math.min(T,ie),I=Math.max(I,ie)}if(v===P||T===I)continue;const A=Math.floor(v/this._granularityCellSize),j=Math.ceil(P/this._granularityCellSize),$=Math.floor(T/this._granularityCellSize),V=Math.ceil(I/this._granularityCellSize);if(A!==j||$!==V)for(let G=$;G<V;G++){const Y=this._scanlineGenerateVertexRingForCellRow(G,g,m);m2(this._vertexBuffer,Y,n)}else n.push(...m)}return n}_scanlineGenerateVertexRingForCellRow(t,n,a){const h=t*this._granularityCellSize,m=h+this._granularityCellSize,g=[];for(let v=0;v<3;v++){const T=n[2*v],P=n[2*v+1],I=n[2*(v+1)%6],A=n[(2*(v+1)+1)%6],j=n[2*(v+2)%6],$=n[(2*(v+2)+1)%6],V=I-T,G=A-P,Y=V===0,ie=G===0,ye=(h-P)/G,ae=(m-P)/G,B=Math.min(ye,ae),X=Math.max(ye,ae);if(!ie&&(B>=1||X<=0)||ie&&(P<h||P>m)){A>=h&&A<=m&&g.push(a[(v+1)%3]);continue}!ie&&B>0&&g.push(this._vertexToIndex(T+V*B,P+G*B));const he=T+V*Math.max(B,0),ze=T+V*Math.min(X,1);Y||this._generateIntraEdgeVertices(g,T,P,I,A,he,ze),!ie&&X<1&&g.push(this._vertexToIndex(T+V*X,P+G*X)),(ie||A>=h&&A<=m)&&g.push(a[(v+1)%3]),!ie&&(A<=h||A>=m)&&this._generateInterEdgeVertices(g,T,P,I,A,j,$,ze,h,m)}return g}_generateIntraEdgeVertices(t,n,a,h,m,g,v){const T=h-n,P=m-a,I=P===0,A=I?Math.min(n,h):Math.min(g,v),j=I?Math.max(n,h):Math.max(g,v),$=Math.floor(A/this._granularityCellSize)+1,V=Math.ceil(j/this._granularityCellSize)-1;if(I?n<h:g<v)for(let G=$;G<=V;G++){const Y=G*this._granularityCellSize;t.push(this._vertexToIndex(Y,a+P*(Y-n)/T))}else for(let G=V;G>=$;G--){const Y=G*this._granularityCellSize;t.push(this._vertexToIndex(Y,a+P*(Y-n)/T))}}_generateInterEdgeVertices(t,n,a,h,m,g,v,T,P,I){const A=m-a,j=g-h,$=v-m,V=(P-m)/$,G=(I-m)/$,Y=Math.min(V,G),ie=Math.max(V,G),ye=h+j*Y;let ae=Math.floor(Math.min(ye,T)/this._granularityCellSize)+1,B=Math.ceil(Math.max(ye,T)/this._granularityCellSize)-1,X=T<ye;const he=$===0;if(he&&(v===P||v===I))return;if(he||Y>=1||ie<=0){const Ve=a-v,Le=g+(n-g)*Math.min((P-v)/Ve,(I-v)/Ve);ae=Math.floor(Math.min(Le,T)/this._granularityCellSize)+1,B=Math.ceil(Math.max(Le,T)/this._granularityCellSize)-1,X=T<Le}const ze=A>0?I:P;if(X)for(let Ve=ae;Ve<=B;Ve++)t.push(this._vertexToIndex(Ve*this._granularityCellSize,ze));else for(let Ve=B;Ve>=ae;Ve--)t.push(this._vertexToIndex(Ve*this._granularityCellSize,ze))}_generateOutline(t){const n=[];for(const a of t){const h=Ja(a,this._granularity,!0),m=this._pointArrayToIndices(h),g=[];for(let v=1;v<m.length;v++)g.push(m[v-1]),g.push(m[v]);n.push(g)}return n}_handlePoles(t){let n=!1,a=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(a=!0)),(n||a)&&this._fillPoles(t,n,a)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const a=t[n+1];a===gc&&(t[n+1]=-32767),a===ch&&(t[n+1]=32766)}}_generatePoleQuad(t,n,a,h,m,g){h>m!=(g===gc)?(t.push(n),t.push(a),t.push(this._vertexToIndex(h,g)),t.push(a),t.push(this._vertexToIndex(m,g)),t.push(this._vertexToIndex(h,g))):(t.push(a),t.push(n),t.push(this._vertexToIndex(h,g)),t.push(this._vertexToIndex(m,g)),t.push(a),t.push(this._vertexToIndex(h,g)))}_fillPoles(t,n,a){const h=this._vertexBuffer,m=vt,g=t.length;for(let v=2;v<g;v+=3){const T=t[v-2],P=t[v-1],I=t[v],A=h[2*T],j=h[2*T+1],$=h[2*P],V=h[2*P+1],G=h[2*I],Y=h[2*I+1];n&&(j===0&&V===0&&this._generatePoleQuad(t,T,P,A,$,gc),V===0&&Y===0&&this._generatePoleQuad(t,P,I,$,G,gc),Y===0&&j===0&&this._generatePoleQuad(t,I,T,G,A,gc)),a&&(j===m&&V===m&&this._generatePoleQuad(t,T,P,A,$,ch),V===m&&Y===m&&this._generatePoleQuad(t,P,I,$,G,ch),Y===m&&j===m&&this._generatePoleQuad(t,I,T,G,A,ch))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:a,holeIndices:h}=function(v){const T=[],P=[];for(const I of v)if(I.length!==0){I!==v[0]&&T.push(P.length/2);for(let A=0;A<I.length;A++)P.push(I[A].x),P.push(I[A].y)}return{flattened:P,holeIndices:T}}(t);let m;this._initializeVertices(a);try{const v=function(P,I,A=2){const j=I&&I.length,$=j?I[0]*A:P.length;let V=mv(P,0,$,A,!0);const G=[];if(!V||V.next===V.prev)return G;let Y,ie,ye;if(j&&(V=function(ae,B,X,he){const ze=[];for(let Ve=0,Le=B.length;Ve<Le;Ve++){const Fe=mv(ae,B[Ve]*he,Ve<Le-1?B[Ve+1]*he:ae.length,he,!1);Fe===Fe.next&&(Fe.steiner=!0),ze.push(d2(Fe))}ze.sort(c2);for(let Ve=0;Ve<ze.length;Ve++)X=u2(ze[Ve],X);return X}(P,I,V,A)),P.length>80*A){Y=1/0,ie=1/0;let ae=-1/0,B=-1/0;for(let X=A;X<$;X+=A){const he=P[X],ze=P[X+1];he<Y&&(Y=he),ze<ie&&(ie=ze),he>ae&&(ae=he),ze>B&&(B=ze)}ye=Math.max(ae-Y,B-ie),ye=ye!==0?32767/ye:0}return sh(V,G,A,Y,ie,ye,0),G}(a,h),T=this._convertIndices(a,v);m=this._subdivideTrianglesScanline(T)}catch(v){console.error(v)}let g=[];return n&&(g=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(m),{verticesFlattened:this._vertexBuffer,indicesTriangles:m,indicesLineList:g}}_convertIndices(t,n){const a=[];for(let h=0;h<n.length;h++)a.push(this._vertexToIndex(t[2*n[h]],t[2*n[h]+1]));return a}_pointArrayToIndices(t){const n=[];for(let a=0;a<t.length;a++){const h=t[a];n.push(this._vertexToIndex(h.x,h.y))}return n}}function xv(s,t,n,a=!0){return new f2(n,t).subdividePolygonInternal(s,a)}function Ja(s,t,n=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const a=s[0],h=s[s.length-1],m=n&&(a.x!==h.x||a.y!==h.y);if(t<2)return m?[...s,s[0]]:[...s];const g=Math.floor(vt/t),v=[];v.push(new ue(s[0].x,s[0].y));const T=s.length,P=m?T:T-1;for(let I=0;I<P;I++){const A=s[I],j=I<T-1?s[I+1]:s[0],$=A.x,V=A.y,G=j.x,Y=j.y,ie=$!==G,ye=V!==Y;if(!ie&&!ye)continue;const ae=G-$,B=Y-V,X=Math.abs(ae),he=Math.abs(B);let ze=$,Ve=V;for(;;){const Fe=ae>0?(Math.floor(ze/g)+1)*g:(Math.ceil(ze/g)-1)*g,qe=B>0?(Math.floor(Ve/g)+1)*g:(Math.ceil(Ve/g)-1)*g,Ze=Math.abs(ze-Fe),We=Math.abs(Ve-qe),Oe=Math.abs(ze-G),it=Math.abs(Ve-Y),ut=ie?Ze/X:Number.POSITIVE_INFINITY,ct=ye?We/he:Number.POSITIVE_INFINITY;if((Oe<=Ze||!ie)&&(it<=We||!ye))break;if(ut<ct&&ie||!ye){ze=Fe,Ve+=B*ut;const ot=new ue(ze,Math.round(Ve));v[v.length-1].x===ot.x&&v[v.length-1].y===ot.y||v.push(ot)}else{ze+=ae*ct,Ve=qe;const ot=new ue(Math.round(ze),Ve);v[v.length-1].x===ot.x&&v[v.length-1].y===ot.y||v.push(ot)}}const Le=new ue(G,Y);v[v.length-1].x===Le.x&&v[v.length-1].y===Le.y||v.push(Le)}return v}function m2(s,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let a=0,h=s[2*t[0]];for(let T=1;T<t.length;T++){const P=s[2*t[T]];P<h&&(h=P,a=T)}const m=t.length;let g=a,v=(g+1)%m;for(;;){const T=g-1>=0?g-1:m-1,P=(v+1)%m,I=s[2*t[T]],A=s[2*t[P]],j=s[2*t[g]],$=s[2*t[g]+1],V=s[2*t[v]+1];let G=!1;if(I<A)G=!0;else if(I>A)G=!1;else{const Y=V-$,ie=-(s[2*t[v]]-j),ye=$<V?1:-1;((I-j)*Y+(s[2*t[T]+1]-$)*ie)*ye>((A-j)*Y+(s[2*t[P]+1]-$)*ie)*ye&&(G=!0)}if(G){const Y=t[T],ie=t[g],ye=t[v];Y!==ie&&Y!==ye&&ie!==ye&&n.push(ye,ie,Y),g--,g<0&&(g=m-1)}else{const Y=t[P],ie=t[g],ye=t[v];Y!==ie&&Y!==ye&&ie!==ye&&n.push(ye,ie,Y),v++,v>=m&&(v=0)}if(T===P)break}}function bv(s,t,n,a,h,m,g,v,T){const P=h.length/2,I=g&&v&&T;if(P<Lt.MAX_VERTEX_ARRAY_LENGTH){const A=t.prepareSegment(P,n,a),j=A.vertexLength;for(let G=0;G<m.length;G+=3)a.emplaceBack(j+m[G],j+m[G+1],j+m[G+2]);let $,V;A.vertexLength+=P,A.primitiveLength+=m.length/3,I&&(V=g.prepareSegment(P,n,v),$=V.vertexLength,V.vertexLength+=P);for(let G=0;G<h.length;G+=2)s(h[G],h[G+1]);if(I)for(let G=0;G<T.length;G++){const Y=T[G];for(let ie=1;ie<Y.length;ie+=2)v.emplaceBack($+Y[ie-1],$+Y[ie]);V.primitiveLength+=Y.length/2}}else(function(A,j,$,V,G,Y){const ie=[];for(let he=0;he<V.length/2;he++)ie.push(-1);const ye={count:0};let ae=0,B=A.getOrCreateLatestSegment(j,$),X=B.vertexLength;for(let he=2;he<G.length;he+=3){const ze=G[he-2],Ve=G[he-1],Le=G[he];let Fe=ie[ze]<ae,qe=ie[Ve]<ae,Ze=ie[Le]<ae;B.vertexLength+((Fe?1:0)+(qe?1:0)+(Ze?1:0))>Lt.MAX_VERTEX_ARRAY_LENGTH&&(B=A.createNewSegment(j,$),ae=ye.count,Fe=!0,qe=!0,Ze=!0,X=0);const We=uh(ie,V,Y,ye,ze,Fe,B),Oe=uh(ie,V,Y,ye,Ve,qe,B),it=uh(ie,V,Y,ye,Le,Ze,B);$.emplaceBack(X+We-ae,X+Oe-ae,X+it-ae),B.primitiveLength++}})(t,n,a,h,m,s),I&&function(A,j,$,V,G,Y){const ie=[];for(let he=0;he<V.length/2;he++)ie.push(-1);const ye={count:0};let ae=0,B=A.getOrCreateLatestSegment(j,$),X=B.vertexLength;for(let he=0;he<G.length;he++){const ze=G[he];for(let Ve=1;Ve<G[he].length;Ve+=2){const Le=ze[Ve-1],Fe=ze[Ve];let qe=ie[Le]<ae,Ze=ie[Fe]<ae;B.vertexLength+((qe?1:0)+(Ze?1:0))>Lt.MAX_VERTEX_ARRAY_LENGTH&&(B=A.createNewSegment(j,$),ae=ye.count,qe=!0,Ze=!0,X=0);const We=uh(ie,V,Y,ye,Le,qe,B),Oe=uh(ie,V,Y,ye,Fe,Ze,B);$.emplaceBack(X+We-ae,X+Oe-ae),B.primitiveLength++}}}(g,n,v,h,T,s),t.forceNewSegmentOnNextPrepare(),g==null||g.forceNewSegmentOnNextPrepare()}function uh(s,t,n,a,h,m,g){if(m){const v=a.count;return n(t[2*h],t[2*h+1]),s[h]=a.count,a.count++,g.vertexLength++,v}return s[h]}class Gm{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new De,this.indexArray=new Ht,this.indexArray2=new Wt,this.programConfigurations=new xs(t.layers,t.zoom),this.segments=new Lt,this.segments2=new Lt,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){this.hasPattern=$m("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:T,index:P,sourceLayerIndex:I}of t){const A=this.layers[0]._featureFilter.needGeometry,j=Ka(v,A);if(!this.layers[0]._featureFilter.filter(new er(this.zoom,{globalState:this.globalState}),j,a))continue;const $=m?h.evaluate(j,{},a,n.availableImages):void 0,V={id:T,properties:v.properties,type:v.type,sourceLayerIndex:I,index:P,geometry:A?j.geometry:Ya(v),patterns:{},sortKey:$};g.push(V)}m&&g.sort((v,T)=>v.sortKey-T.sortKey);for(const v of g){const{geometry:T,index:P,sourceLayerIndex:I}=v;if(this.hasPattern){const A=Vm("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(A)}else this.addFeature(v,T,P,a,{},n.subdivisionGranularity);n.featureIndex.insert(t[P].feature,T,P,I,this.index)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}addFeatures(t,n,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,n2),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,a,h,m,g){for(const v of $l(n,500)){const T=xv(v,h,g.fill.getGranularityForZoomLevel(h.z)),P=this.layoutVertexArray;bv((I,A)=>{P.emplaceBack(I,A)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}}let wv,Tv;et("FillBucket",Gm,{omit:["layers","patternFeatures"]});var g2={get paint(){return Tv=Tv||new fi({"fill-antialias":new nt(me.paint_fill["fill-antialias"]),"fill-opacity":new pt(me.paint_fill["fill-opacity"]),"fill-color":new pt(me.paint_fill["fill-color"]),"fill-outline-color":new pt(me.paint_fill["fill-outline-color"]),"fill-translate":new nt(me.paint_fill["fill-translate"]),"fill-translate-anchor":new nt(me.paint_fill["fill-translate-anchor"]),"fill-pattern":new uc(me.paint_fill["fill-pattern"])})},get layout(){return wv=wv||new fi({"fill-sort-key":new pt(me.layout_fill["fill-sort-key"])})}};class _2 extends Hr{constructor(t){super(t,g2)}recalculate(t,n){super.recalculate(t,n);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Gm(t)}queryRadius(){return up(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:a,pixelsToTileUnits:h}){return tv(hp(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-a.bearingInRadians,h),n)}isTileClipped(){return!0}}const y2=hr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),v2=hr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:x2}=y2;var qm,Sv,Wm,Cv,Hm,Pv,Mv,mp={};function Iv(){if(Sv)return qm;Sv=1;var s=be();function t(h,m,g,v,T){this.properties={},this.extent=g,this.type=0,this._pbf=h,this._geometry=-1,this._keys=v,this._values=T,h.readFields(n,this,m)}function n(h,m,g){h==1?m.id=g.readVarint():h==2?function(v,T){for(var P=v.readVarint()+v.pos;v.pos<P;){var I=T._keys[v.readVarint()],A=T._values[v.readVarint()];T.properties[I]=A}}(g,m):h==3?m.type=g.readVarint():h==4&&(m._geometry=g.pos)}function a(h){for(var m,g,v=0,T=0,P=h.length,I=P-1;T<P;I=T++)v+=((g=h[I]).x-(m=h[T]).x)*(m.y+g.y);return v}return qm=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var m,g=h.readVarint()+h.pos,v=1,T=0,P=0,I=0,A=[];h.pos<g;){if(T<=0){var j=h.readVarint();v=7&j,T=j>>3}if(T--,v===1||v===2)P+=h.readSVarint(),I+=h.readSVarint(),v===1&&(m&&A.push(m),m=[]),m.push(new s(P,I));else{if(v!==7)throw new Error("unknown command "+v);m&&m.push(m[0].clone())}}return m&&A.push(m),A},t.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var m=h.readVarint()+h.pos,g=1,v=0,T=0,P=0,I=1/0,A=-1/0,j=1/0,$=-1/0;h.pos<m;){if(v<=0){var V=h.readVarint();g=7&V,v=V>>3}if(v--,g===1||g===2)(T+=h.readSVarint())<I&&(I=T),T>A&&(A=T),(P+=h.readSVarint())<j&&(j=P),P>$&&($=P);else if(g!==7)throw new Error("unknown command "+g)}return[I,j,A,$]},t.prototype.toGeoJSON=function(h,m,g){var v,T,P=this.extent*Math.pow(2,g),I=this.extent*h,A=this.extent*m,j=this.loadGeometry(),$=t.types[this.type];function V(ie){for(var ye=0;ye<ie.length;ye++){var ae=ie[ye];ie[ye]=[360*(ae.x+I)/P-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+A)/P)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(v=0;v<j.length;v++)G[v]=j[v][0];V(j=G);break;case 2:for(v=0;v<j.length;v++)V(j[v]);break;case 3:for(j=function(ie){var ye=ie.length;if(ye<=1)return[ie];for(var ae,B,X=[],he=0;he<ye;he++){var ze=a(ie[he]);ze!==0&&(B===void 0&&(B=ze<0),B===ze<0?(ae&&X.push(ae),ae=[ie[he]]):ae.push(ie[he]))}return ae&&X.push(ae),X}(j),v=0;v<j.length;v++)for(T=0;T<j[v].length;T++)V(j[v][T])}j.length===1?j=j[0]:$="Multi"+$;var Y={type:"Feature",geometry:{type:$,coordinates:j},properties:this.properties};return"id"in this&&(Y.id=this.id),Y},qm}function Ev(){if(Cv)return Wm;Cv=1;var s=Iv();function t(a,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(n,this,h),this.length=this._features.length}function n(a,h,m){a===15?h.version=m.readVarint():a===1?h.name=m.readString():a===5?h.extent=m.readVarint():a===2?h._features.push(m.pos):a===3?h._keys.push(m.readString()):a===4&&h._values.push(function(g){for(var v=null,T=g.readVarint()+g.pos;g.pos<T;){var P=g.readVarint()>>3;v=P===1?g.readString():P===2?g.readFloat():P===3?g.readDouble():P===4?g.readVarint64():P===5?g.readVarint():P===6?g.readSVarint():P===7?g.readBoolean():null}return v}(m))}return Wm=t,t.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var h=this._pbf.readVarint()+this._pbf.pos;return new s(this._pbf,h,this.extent,this._keys,this._values)},Wm}function kv(){return Mv||(Mv=1,mp.VectorTile=function(){if(Pv)return Hm;Pv=1;var s=Ev();function t(n,a,h){if(n===3){var m=new s(h,h.readVarint()+h.pos);m.length&&(a[m.name]=m)}}return Hm=function(n,a){this.layers=n.readFields(t,{},a)},Hm}(),mp.VectorTileFeature=Iv(),mp.VectorTileLayer=Ev()),mp}var hh=Z(kv());const b2=hh.VectorTileFeature.types,Xm=Math.pow(2,13);function dh(s,t,n,a,h,m,g,v){s.emplaceBack(t,n,2*Math.floor(a*Xm)+g,h*Xm*2,m*Xm*2,Math.round(v))}class Ym{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ye,this.centroidVertexArray=new Ee,this.indexArray=new Ht,this.programConfigurations=new xs(t.layers,t.zoom),this.segments=new Lt,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){this.features=[],this.hasPattern=$m("fill-extrusion",this.layers,n);for(const{feature:h,id:m,index:g,sourceLayerIndex:v}of t){const T=this.layers[0]._featureFilter.needGeometry,P=Ka(h,T);if(!this.layers[0]._featureFilter.filter(new er(this.zoom,{globalState:this.globalState}),P,a))continue;const I={id:m,sourceLayerIndex:v,index:g,geometry:T?P.geometry:Ya(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Vm("fill-extrusion",this.layers,I,this.zoom,n)):this.addFeature(I,I.geometry,g,a,{},n.subdivisionGranularity),n.featureIndex.insert(h,I.geometry,g,v,this.index,!0)}}addFeatures(t,n,a){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,n,a,t.subdivisionGranularity)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,x2),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,v2.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,a,h,m,g){for(const v of $l(n,500)){const T={x:0,y:0,sampleCount:0},P=this.layoutVertexArray.length;this.processPolygon(T,h,t,v,g);const I=this.layoutVertexArray.length-P,A=Math.floor(T.x/T.sampleCount),j=Math.floor(T.y/T.sampleCount);for(let $=0;$<I;$++)this.centroidVertexArray.emplaceBack(A,j)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}processPolygon(t,n,a,h,m){if(h.length<1||zv(h[0]))return;for(const A of h)A.length!==0&&w2(t,A);const g={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=m.fill.getGranularityForZoomLevel(n.z),T=b2[a.type]==="Polygon";for(const A of h){if(A.length===0||zv(A))continue;const j=Ja(A,v,T);this._generateSideFaces(j,g)}if(!T)return;const P=xv(h,n,v,!1),I=this.layoutVertexArray;bv((A,j)=>{dh(I,A,j,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles)}_generateSideFaces(t,n){let a=0;for(let h=1;h<t.length;h++){const m=t[h],g=t[h-1];if(T2(m,g))continue;n.segment.vertexLength+4>Lt.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=m.sub(g)._perp()._unit(),T=g.dist(m);a+T>32768&&(a=0),dh(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,a),dh(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,a),a+=T,dh(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,a),dh(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,a);const P=n.segment.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function w2(s,t){for(let n=0;n<t.length;n++){const a=t[n];n===t.length-1&&t[0].x===a.x&&t[0].y===a.y||(s.x+=a.x,s.y+=a.y,s.sampleCount++)}}function T2(s,t){return s.x===t.x&&(s.x<0||s.x>vt)||s.y===t.y&&(s.y<0||s.y>vt)}function zv(s){return s.every(t=>t.x<0)||s.every(t=>t.x>vt)||s.every(t=>t.y<0)||s.every(t=>t.y>vt)}let Av;et("FillExtrusionBucket",Ym,{omit:["layers","features"]});var S2={get paint(){return Av=Av||new fi({"fill-extrusion-opacity":new nt(me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pt(me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new nt(me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new nt(me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new uc(me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pt(me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pt(me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new nt(me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class C2 extends Hr{constructor(t){super(t,S2)}createBucket(t){return new Ym(t)}queryRadius(){return up(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g,pixelPosMatrix:v}){const T=hp(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-m.bearingInRadians,g),P=this.paint.get("fill-extrusion-height").evaluate(n,a),I=this.paint.get("fill-extrusion-base").evaluate(n,a),A=function($,V){const G=[];for(const Y of $){const ie=[Y.x,Y.y,0,1];rn(ie,ie,V),G.push(new ue(ie[0]/ie[3],ie[1]/ie[3]))}return G}(T,v),j=function($,V,G,Y){const ie=[],ye=[],ae=Y[8]*V,B=Y[9]*V,X=Y[10]*V,he=Y[11]*V,ze=Y[8]*G,Ve=Y[9]*G,Le=Y[10]*G,Fe=Y[11]*G;for(const qe of $){const Ze=[],We=[];for(const Oe of qe){const it=Oe.x,ut=Oe.y,ct=Y[0]*it+Y[4]*ut+Y[12],ot=Y[1]*it+Y[5]*ut+Y[13],At=Y[2]*it+Y[6]*ut+Y[14],dr=Y[3]*it+Y[7]*ut+Y[15],Ar=At+X,ai=dr+he,un=ct+ze,Fi=ot+Ve,Qr=At+Le,ar=dr+Fe,$r=new ue((ct+ae)/ai,(ot+B)/ai);$r.z=Ar/ai,Ze.push($r);const Jr=new ue(un/ar,Fi/ar);Jr.z=Qr/ar,We.push(Jr)}ie.push(Ze),ye.push(We)}return[ie,ye]}(h,I,P,v);return function($,V,G){let Y=1/0;tv(G,V)&&(Y=Rv(G,V[0]));for(let ie=0;ie<V.length;ie++){const ye=V[ie],ae=$[ie];for(let B=0;B<ye.length-1;B++){const X=ye[B],he=[X,ye[B+1],ae[B+1],ae[B],X];ev(G,he)&&(Y=Math.min(Y,Rv(G,he)))}}return Y!==1/0&&Y}(j[0],j[1],A)}}function ph(s,t){return s.x*t.x+s.y*t.y}function Rv(s,t){if(s.length===1){let n=0;const a=t[n++];let h;for(;!h||a.equals(h);)if(h=t[n++],!h)return 1/0;for(;n<t.length;n++){const m=t[n],g=s[0],v=h.sub(a),T=m.sub(a),P=g.sub(a),I=ph(v,v),A=ph(v,T),j=ph(T,T),$=ph(P,v),V=ph(P,T),G=I*j-A*A,Y=(j*$-A*V)/G,ie=(I*V-A*$)/G,ye=a.z*(1-Y-ie)+h.z*Y+m.z*ie;if(isFinite(ye))return ye}return 1/0}{let n=1/0;for(const a of t)n=Math.min(n,a.z);return n}}const P2=hr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:M2}=P2,I2=hr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:E2}=I2,k2=hh.VectorTileFeature.types,z2=Math.cos(Math.PI/180*37.5),Dv=Math.pow(2,14)/.5;class Km{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Xe,this.layoutVertexArray2=new Ue,this.indexArray=new Ht,this.programConfigurations=new xs(t.layers,t.zoom),this.segments=new Lt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){this.hasPattern=$m("line",this.layers,n);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:T,index:P,sourceLayerIndex:I}of t){const A=this.layers[0]._featureFilter.needGeometry,j=Ka(v,A);if(!this.layers[0]._featureFilter.filter(new er(this.zoom,{globalState:this.globalState}),j,a))continue;const $=m?h.evaluate(j,{},a):void 0,V={id:T,properties:v.properties,type:v.type,sourceLayerIndex:I,index:P,geometry:A?j.geometry:Ya(v),patterns:{},sortKey:$};g.push(V)}m&&g.sort((v,T)=>v.sortKey-T.sortKey);for(const v of g){const{geometry:T,index:P,sourceLayerIndex:I}=v;if(this.hasPattern){const A=Vm("line",this.layers,v,this.zoom,n);this.patternFeatures.push(A)}else this.addFeature(v,T,P,a,{},n.subdivisionGranularity);n.featureIndex.insert(t[P].feature,T,P,I,this.index)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}addFeatures(t,n,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,E2)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,M2),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,a,h,m,g){const v=this.layers[0].layout,T=v.get("line-join").evaluate(t,{}),P=v.get("line-cap"),I=v.get("line-miter-limit"),A=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const j of n)this.addLine(j,t,T,P,I,A,h,g);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}addLine(t,n,a,h,m,g,v,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Ja(t,v?T.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<t.length-1;ae++)this.totalDistance+=t[ae].dist(t[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=k2[n.type]==="Polygon";let I=t.length;for(;I>=2&&t[I-1].equals(t[I-2]);)I--;let A=0;for(;A<I-1&&t[A].equals(t[A+1]);)A++;if(I<(P?3:2))return;a==="bevel"&&(m=1.05);const j=this.overscaling<=16?122880/(512*this.overscaling):0,$=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let V,G,Y,ie,ye;this.e1=this.e2=-1,P&&(V=t[I-2],ye=t[A].sub(V)._unit()._perp());for(let ae=A;ae<I;ae++){if(Y=ae===I-1?P?t[A+1]:void 0:t[ae+1],Y&&t[ae].equals(Y))continue;ye&&(ie=ye),V&&(G=V),V=t[ae],ye=Y?Y.sub(V)._unit()._perp():ie,ie=ie||ye;let B=ie.add(ye);B.x===0&&B.y===0||B._unit();const X=ie.x*ye.x+ie.y*ye.y,he=B.x*ye.x+B.y*ye.y,ze=he!==0?1/he:1/0,Ve=2*Math.sqrt(2-2*he),Le=he<z2&&G&&Y,Fe=ie.x*ye.y-ie.y*ye.x>0;if(Le&&ae>A){const We=V.dist(G);if(We>2*j){const Oe=V.sub(V.sub(G)._mult(j/We)._round());this.updateDistance(G,Oe),this.addCurrentVertex(Oe,ie,0,0,$),G=Oe}}const qe=G&&Y;let Ze=qe?a:P?"butt":h;if(qe&&Ze==="round"&&(ze<g?Ze="miter":ze<=2&&(Ze="fakeround")),Ze==="miter"&&ze>m&&(Ze="bevel"),Ze==="bevel"&&(ze>2&&(Ze="flipbevel"),ze<m&&(Ze="miter")),G&&this.updateDistance(G,V),Ze==="miter")B._mult(ze),this.addCurrentVertex(V,B,0,0,$);else if(Ze==="flipbevel"){if(ze>100)B=ye.mult(-1);else{const We=ze*ie.add(ye).mag()/ie.sub(ye).mag();B._perp()._mult(We*(Fe?-1:1))}this.addCurrentVertex(V,B,0,0,$),this.addCurrentVertex(V,B.mult(-1),0,0,$)}else if(Ze==="bevel"||Ze==="fakeround"){const We=-Math.sqrt(ze*ze-1),Oe=Fe?We:0,it=Fe?0:We;if(G&&this.addCurrentVertex(V,ie,Oe,it,$),Ze==="fakeround"){const ut=Math.round(180*Ve/Math.PI/20);for(let ct=1;ct<ut;ct++){let ot=ct/ut;if(ot!==.5){const dr=ot-.5;ot+=ot*dr*(ot-1)*((1.0904+X*(X*(3.55645-1.43519*X)-3.2452))*dr*dr+(.848013+X*(.215638*X-1.06021)))}const At=ye.sub(ie)._mult(ot)._add(ie)._unit()._mult(Fe?-1:1);this.addHalfVertex(V,At.x,At.y,!1,Fe,0,$)}}Y&&this.addCurrentVertex(V,ye,-Oe,-it,$)}else if(Ze==="butt")this.addCurrentVertex(V,B,0,0,$);else if(Ze==="square"){const We=G?1:-1;this.addCurrentVertex(V,B,We,We,$)}else Ze==="round"&&(G&&(this.addCurrentVertex(V,ie,0,0,$),this.addCurrentVertex(V,ie,1,1,$,!0)),Y&&(this.addCurrentVertex(V,ye,-1,-1,$,!0),this.addCurrentVertex(V,ye,0,0,$)));if(Le&&ae<I-1){const We=V.dist(Y);if(We>2*j){const Oe=V.add(Y.sub(V)._mult(j/We)._round());this.updateDistance(V,Oe),this.addCurrentVertex(Oe,ye,0,0,$),V=Oe}}}}addCurrentVertex(t,n,a,h,m,g=!1){const v=n.y*h-n.x,T=-n.y-n.x*h;this.addHalfVertex(t,n.x+n.y*a,n.y-n.x*a,g,!1,a,m),this.addHalfVertex(t,v,T,g,!0,-h,m),this.distance>Dv/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,a,h,m,g))}addHalfVertex({x:t,y:n},a,h,m,g,v,T){const P=.5*(this.lineClips?this.scaledDistance*(Dv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(n<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,I,this.e2),T.primitiveLength++),g?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let Lv,jv;et("LineBucket",Km,{omit:["layers","patternFeatures"]});var Fv={get paint(){return jv=jv||new fi({"line-opacity":new pt(me.paint_line["line-opacity"]),"line-color":new pt(me.paint_line["line-color"]),"line-translate":new nt(me.paint_line["line-translate"]),"line-translate-anchor":new nt(me.paint_line["line-translate-anchor"]),"line-width":new pt(me.paint_line["line-width"]),"line-gap-width":new pt(me.paint_line["line-gap-width"]),"line-offset":new pt(me.paint_line["line-offset"]),"line-blur":new pt(me.paint_line["line-blur"]),"line-dasharray":new Xu(me.paint_line["line-dasharray"]),"line-pattern":new uc(me.paint_line["line-pattern"]),"line-gradient":new Za(me.paint_line["line-gradient"])})},get layout(){return Lv=Lv||new fi({"line-cap":new nt(me.layout_line["line-cap"]),"line-join":new pt(me.layout_line["line-join"]),"line-miter-limit":new nt(me.layout_line["line-miter-limit"]),"line-round-limit":new nt(me.layout_line["line-round-limit"]),"line-sort-key":new pt(me.layout_line["line-sort-key"])})}};class A2 extends pt{possiblyEvaluate(t,n){return n=new er(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,a,h){return n=ki({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,a,h)}}let gp;class R2 extends Hr{constructor(t){super(t,Fv),this.gradientVersion=0,gp||(gp=new A2(Fv.paint.properties["line-width"].specification),gp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof yo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=gp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Km(t)}queryRadius(t){const n=t,a=Bv(ih("line-width",this,n),ih("line-gap-width",this,n)),h=ih("line-offset",this,n);return a/2+Math.abs(h)+up(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g}){const v=hp(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-m.bearingInRadians,g),T=g/2*Bv(this.paint.get("line-width").evaluate(n,a),this.paint.get("line-gap-width").evaluate(n,a)),P=this.paint.get("line-offset").evaluate(n,a);return P&&(h=function(I,A){const j=[];for(let $=0;$<I.length;$++){const V=I[$],G=[];for(let Y=0;Y<V.length;Y++){const ie=V[Y-1],ye=V[Y],ae=V[Y+1],B=Y===0?new ue(0,0):ye.sub(ie)._unit()._perp(),X=Y===V.length-1?new ue(0,0):ae.sub(ye)._unit()._perp(),he=B._add(X)._unit(),ze=he.x*X.x+he.y*X.y;ze!==0&&he._mult(1/ze),G.push(he._mult(A)._add(ye))}j.push(G)}return j}(h,P*g)),function(I,A,j){for(let $=0;$<A.length;$++){const V=A[$];if(I.length>=3){for(let G=0;G<V.length;G++)if(pc(I,V[G]))return!0}if(qw(I,V,j))return!0}return!1}(v,h,T)}isTileClipped(){return!0}}function Bv(s,t){return t>0?t+2*s:s}const D2=hr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),L2=hr([{name:"a_projected_pos",components:3,type:"Float32"}],4);hr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const j2=hr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);hr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ov=hr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),F2=hr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function B2(s,t,n){return s.sections.forEach(a=>{a.text=function(h,m,g){const v=m.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),ps.applyArabicShaping&&(h=ps.applyArabicShaping(h)),h}(a.text,t,n)}),s}hr([{name:"triangle",components:3,type:"Uint16"}]),hr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),hr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),hr([{type:"Float32",name:"offsetX"}]),hr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),hr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const fh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Nv,Qm,$v,Nr=24,Jm={};function O2(){return Nv||(Nv=1,Jm.read=function(s,t,n,a,h){var m,g,v=8*h-a-1,T=(1<<v)-1,P=T>>1,I=-7,A=n?h-1:0,j=n?-1:1,$=s[t+A];for(A+=j,m=$&(1<<-I)-1,$>>=-I,I+=v;I>0;m=256*m+s[t+A],A+=j,I-=8);for(g=m&(1<<-I)-1,m>>=-I,I+=a;I>0;g=256*g+s[t+A],A+=j,I-=8);if(m===0)m=1-P;else{if(m===T)return g?NaN:1/0*($?-1:1);g+=Math.pow(2,a),m-=P}return($?-1:1)*g*Math.pow(2,m-a)},Jm.write=function(s,t,n,a,h,m){var g,v,T,P=8*m-h-1,I=(1<<P)-1,A=I>>1,j=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=a?0:m-1,V=a?1:-1,G=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,g=I):(g=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-g))<1&&(g--,T*=2),(t+=g+A>=1?j/T:j*Math.pow(2,1-A))*T>=2&&(g++,T/=2),g+A>=I?(v=0,g=I):g+A>=1?(v=(t*T-1)*Math.pow(2,h),g+=A):(v=t*Math.pow(2,A-1)*Math.pow(2,h),g=0));h>=8;s[n+$]=255&v,$+=V,v/=256,h-=8);for(g=g<<h|v,P+=h;P>0;s[n+$]=255&g,$+=V,g/=256,P-=8);s[n+$-V]|=128*G}),Jm}function Vv(){if($v)return Qm;$v=1,Qm=t;var s=O2();function t(B){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(B)?B:new Uint8Array(B||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var n=4294967296,a=1/n,h=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function m(B){return B.type===t.Bytes?B.readVarint()+B.pos:B.pos+1}function g(B,X,he){return he?4294967296*X+(B>>>0):4294967296*(X>>>0)+(B>>>0)}function v(B,X,he){var ze=X<=16383?1:X<=2097151?2:X<=268435455?3:Math.floor(Math.log(X)/(7*Math.LN2));he.realloc(ze);for(var Ve=he.pos-1;Ve>=B;Ve--)he.buf[Ve+ze]=he.buf[Ve]}function T(B,X){for(var he=0;he<B.length;he++)X.writeVarint(B[he])}function P(B,X){for(var he=0;he<B.length;he++)X.writeSVarint(B[he])}function I(B,X){for(var he=0;he<B.length;he++)X.writeFloat(B[he])}function A(B,X){for(var he=0;he<B.length;he++)X.writeDouble(B[he])}function j(B,X){for(var he=0;he<B.length;he++)X.writeBoolean(B[he])}function $(B,X){for(var he=0;he<B.length;he++)X.writeFixed32(B[he])}function V(B,X){for(var he=0;he<B.length;he++)X.writeSFixed32(B[he])}function G(B,X){for(var he=0;he<B.length;he++)X.writeFixed64(B[he])}function Y(B,X){for(var he=0;he<B.length;he++)X.writeSFixed64(B[he])}function ie(B,X){return(B[X]|B[X+1]<<8|B[X+2]<<16)+16777216*B[X+3]}function ye(B,X,he){B[he]=X,B[he+1]=X>>>8,B[he+2]=X>>>16,B[he+3]=X>>>24}function ae(B,X){return(B[X]|B[X+1]<<8|B[X+2]<<16)+(B[X+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(B,X,he){for(he=he||this.length;this.pos<he;){var ze=this.readVarint(),Ve=ze>>3,Le=this.pos;this.type=7&ze,B(Ve,X,this),this.pos===Le&&this.skip(ze)}return X},readMessage:function(B,X){return this.readFields(B,X,this.readVarint()+this.pos)},readFixed32:function(){var B=ie(this.buf,this.pos);return this.pos+=4,B},readSFixed32:function(){var B=ae(this.buf,this.pos);return this.pos+=4,B},readFixed64:function(){var B=ie(this.buf,this.pos)+ie(this.buf,this.pos+4)*n;return this.pos+=8,B},readSFixed64:function(){var B=ie(this.buf,this.pos)+ae(this.buf,this.pos+4)*n;return this.pos+=8,B},readFloat:function(){var B=s.read(this.buf,this.pos,!0,23,4);return this.pos+=4,B},readDouble:function(){var B=s.read(this.buf,this.pos,!0,52,8);return this.pos+=8,B},readVarint:function(B){var X,he,ze=this.buf;return X=127&(he=ze[this.pos++]),he<128?X:(X|=(127&(he=ze[this.pos++]))<<7,he<128?X:(X|=(127&(he=ze[this.pos++]))<<14,he<128?X:(X|=(127&(he=ze[this.pos++]))<<21,he<128?X:function(Ve,Le,Fe){var qe,Ze,We=Fe.buf;if(qe=(112&(Ze=We[Fe.pos++]))>>4,Ze<128||(qe|=(127&(Ze=We[Fe.pos++]))<<3,Ze<128)||(qe|=(127&(Ze=We[Fe.pos++]))<<10,Ze<128)||(qe|=(127&(Ze=We[Fe.pos++]))<<17,Ze<128)||(qe|=(127&(Ze=We[Fe.pos++]))<<24,Ze<128)||(qe|=(1&(Ze=We[Fe.pos++]))<<31,Ze<128))return g(Ve,qe,Le);throw new Error("Expected varint not more than 10 bytes")}(X|=(15&(he=ze[this.pos]))<<28,B,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var B=this.readVarint();return B%2==1?(B+1)/-2:B/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var B=this.readVarint()+this.pos,X=this.pos;return this.pos=B,B-X>=12&&h?function(he,ze,Ve){return h.decode(he.subarray(ze,Ve))}(this.buf,X,B):function(he,ze,Ve){for(var Le="",Fe=ze;Fe<Ve;){var qe,Ze,We,Oe=he[Fe],it=null,ut=Oe>239?4:Oe>223?3:Oe>191?2:1;if(Fe+ut>Ve)break;ut===1?Oe<128&&(it=Oe):ut===2?(192&(qe=he[Fe+1]))==128&&(it=(31&Oe)<<6|63&qe)<=127&&(it=null):ut===3?(Ze=he[Fe+2],(192&(qe=he[Fe+1]))==128&&(192&Ze)==128&&((it=(15&Oe)<<12|(63&qe)<<6|63&Ze)<=2047||it>=55296&&it<=57343)&&(it=null)):ut===4&&(Ze=he[Fe+2],We=he[Fe+3],(192&(qe=he[Fe+1]))==128&&(192&Ze)==128&&(192&We)==128&&((it=(15&Oe)<<18|(63&qe)<<12|(63&Ze)<<6|63&We)<=65535||it>=1114112)&&(it=null)),it===null?(it=65533,ut=1):it>65535&&(it-=65536,Le+=String.fromCharCode(it>>>10&1023|55296),it=56320|1023&it),Le+=String.fromCharCode(it),Fe+=ut}return Le}(this.buf,X,B)},readBytes:function(){var B=this.readVarint()+this.pos,X=this.buf.subarray(this.pos,B);return this.pos=B,X},readPackedVarint:function(B,X){if(this.type!==t.Bytes)return B.push(this.readVarint(X));var he=m(this);for(B=B||[];this.pos<he;)B.push(this.readVarint(X));return B},readPackedSVarint:function(B){if(this.type!==t.Bytes)return B.push(this.readSVarint());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readSVarint());return B},readPackedBoolean:function(B){if(this.type!==t.Bytes)return B.push(this.readBoolean());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readBoolean());return B},readPackedFloat:function(B){if(this.type!==t.Bytes)return B.push(this.readFloat());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readFloat());return B},readPackedDouble:function(B){if(this.type!==t.Bytes)return B.push(this.readDouble());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readDouble());return B},readPackedFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed32());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readFixed32());return B},readPackedSFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed32());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readSFixed32());return B},readPackedFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed64());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readFixed64());return B},readPackedSFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed64());var X=m(this);for(B=B||[];this.pos<X;)B.push(this.readSFixed64());return B},skip:function(B){var X=7&B;if(X===t.Varint)for(;this.buf[this.pos++]>127;);else if(X===t.Bytes)this.pos=this.readVarint()+this.pos;else if(X===t.Fixed32)this.pos+=4;else{if(X!==t.Fixed64)throw new Error("Unimplemented type: "+X);this.pos+=8}},writeTag:function(B,X){this.writeVarint(B<<3|X)},realloc:function(B){for(var X=this.length||16;X<this.pos+B;)X*=2;if(X!==this.length){var he=new Uint8Array(X);he.set(this.buf),this.buf=he,this.length=X}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(B){this.realloc(4),ye(this.buf,B,this.pos),this.pos+=4},writeSFixed32:function(B){this.realloc(4),ye(this.buf,B,this.pos),this.pos+=4},writeFixed64:function(B){this.realloc(8),ye(this.buf,-1&B,this.pos),ye(this.buf,Math.floor(B*a),this.pos+4),this.pos+=8},writeSFixed64:function(B){this.realloc(8),ye(this.buf,-1&B,this.pos),ye(this.buf,Math.floor(B*a),this.pos+4),this.pos+=8},writeVarint:function(B){(B=+B||0)>268435455||B<0?function(X,he){var ze,Ve;if(X>=0?(ze=X%4294967296|0,Ve=X/4294967296|0):(Ve=~(-X/4294967296),4294967295^(ze=~(-X%4294967296))?ze=ze+1|0:(ze=0,Ve=Ve+1|0)),X>=18446744073709552e3||X<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");he.realloc(10),function(Le,Fe,qe){qe.buf[qe.pos++]=127&Le|128,Le>>>=7,qe.buf[qe.pos++]=127&Le|128,Le>>>=7,qe.buf[qe.pos++]=127&Le|128,Le>>>=7,qe.buf[qe.pos++]=127&Le|128,qe.buf[qe.pos]=127&(Le>>>=7)}(ze,0,he),function(Le,Fe){var qe=(7&Le)<<4;Fe.buf[Fe.pos++]|=qe|((Le>>>=3)?128:0),Le&&(Fe.buf[Fe.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(Fe.buf[Fe.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(Fe.buf[Fe.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(Fe.buf[Fe.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(Fe.buf[Fe.pos++]=127&Le)))))}(Ve,he)}(B,this):(this.realloc(4),this.buf[this.pos++]=127&B|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=B>>>7&127))))},writeSVarint:function(B){this.writeVarint(B<0?2*-B-1:2*B)},writeBoolean:function(B){this.writeVarint(!!B)},writeString:function(B){B=String(B),this.realloc(4*B.length),this.pos++;var X=this.pos;this.pos=function(ze,Ve,Le){for(var Fe,qe,Ze=0;Ze<Ve.length;Ze++){if((Fe=Ve.charCodeAt(Ze))>55295&&Fe<57344){if(!qe){Fe>56319||Ze+1===Ve.length?(ze[Le++]=239,ze[Le++]=191,ze[Le++]=189):qe=Fe;continue}if(Fe<56320){ze[Le++]=239,ze[Le++]=191,ze[Le++]=189,qe=Fe;continue}Fe=qe-55296<<10|Fe-56320|65536,qe=null}else qe&&(ze[Le++]=239,ze[Le++]=191,ze[Le++]=189,qe=null);Fe<128?ze[Le++]=Fe:(Fe<2048?ze[Le++]=Fe>>6|192:(Fe<65536?ze[Le++]=Fe>>12|224:(ze[Le++]=Fe>>18|240,ze[Le++]=Fe>>12&63|128),ze[Le++]=Fe>>6&63|128),ze[Le++]=63&Fe|128)}return Le}(this.buf,B,this.pos);var he=this.pos-X;he>=128&&v(X,he,this),this.pos=X-1,this.writeVarint(he),this.pos+=he},writeFloat:function(B){this.realloc(4),s.write(this.buf,B,this.pos,!0,23,4),this.pos+=4},writeDouble:function(B){this.realloc(8),s.write(this.buf,B,this.pos,!0,52,8),this.pos+=8},writeBytes:function(B){var X=B.length;this.writeVarint(X),this.realloc(X);for(var he=0;he<X;he++)this.buf[this.pos++]=B[he]},writeRawMessage:function(B,X){this.pos++;var he=this.pos;B(X,this);var ze=this.pos-he;ze>=128&&v(he,ze,this),this.pos=he-1,this.writeVarint(ze),this.pos+=ze},writeMessage:function(B,X,he){this.writeTag(B,t.Bytes),this.writeRawMessage(X,he)},writePackedVarint:function(B,X){X.length&&this.writeMessage(B,T,X)},writePackedSVarint:function(B,X){X.length&&this.writeMessage(B,P,X)},writePackedBoolean:function(B,X){X.length&&this.writeMessage(B,j,X)},writePackedFloat:function(B,X){X.length&&this.writeMessage(B,I,X)},writePackedDouble:function(B,X){X.length&&this.writeMessage(B,A,X)},writePackedFixed32:function(B,X){X.length&&this.writeMessage(B,$,X)},writePackedSFixed32:function(B,X){X.length&&this.writeMessage(B,V,X)},writePackedFixed64:function(B,X){X.length&&this.writeMessage(B,G,X)},writePackedSFixed64:function(B,X){X.length&&this.writeMessage(B,Y,X)},writeBytesField:function(B,X){this.writeTag(B,t.Bytes),this.writeBytes(X)},writeFixed32Field:function(B,X){this.writeTag(B,t.Fixed32),this.writeFixed32(X)},writeSFixed32Field:function(B,X){this.writeTag(B,t.Fixed32),this.writeSFixed32(X)},writeFixed64Field:function(B,X){this.writeTag(B,t.Fixed64),this.writeFixed64(X)},writeSFixed64Field:function(B,X){this.writeTag(B,t.Fixed64),this.writeSFixed64(X)},writeVarintField:function(B,X){this.writeTag(B,t.Varint),this.writeVarint(X)},writeSVarintField:function(B,X){this.writeTag(B,t.Varint),this.writeSVarint(X)},writeStringField:function(B,X){this.writeTag(B,t.Bytes),this.writeString(X)},writeFloatField:function(B,X){this.writeTag(B,t.Fixed32),this.writeFloat(X)},writeDoubleField:function(B,X){this.writeTag(B,t.Fixed64),this.writeDouble(X)},writeBooleanField:function(B,X){this.writeVarintField(B,!!X)}},Qm}var No,eg=Z(Vv());function N2(s,t,n){s===1&&n.readMessage($2,t)}function $2(s,t,n){if(s===3){const{id:a,bitmap:h,width:m,height:g,left:v,top:T,advance:P}=n.readMessage(V2,{});t.push({id:a,bitmap:new nh({width:m+6,height:g+6},h),metrics:{width:m,height:g,left:v,top:T,advance:P}})}}function V2(s,t,n){s===1?t.id=n.readVarint():s===2?t.bitmap=n.readBytes():s===3?t.width=n.readVarint():s===4?t.height=n.readVarint():s===5?t.left=n.readSVarint():s===6?t.top=n.readSVarint():s===7&&(t.advance=n.readVarint())}function Uv(s){let t=0,n=0;for(const g of s)t+=g.w*g.h,n=Math.max(n,g.w);s.sort((g,v)=>v.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let h=0,m=0;for(const g of s)for(let v=a.length-1;v>=0;v--){const T=a[v];if(!(g.w>T.w||g.h>T.h)){if(g.x=T.x,g.y=T.y,m=Math.max(m,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===T.w&&g.h===T.h){const P=a.pop();v<a.length&&(a[v]=P)}else g.h===T.h?(T.x+=g.w,T.w-=g.w):g.w===T.w?(T.y+=g.h,T.h-=g.h):(a.push({x:T.x+g.w,y:T.y,w:T.w-g.w,h:g.h}),T.y+=g.h,T.h-=g.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}class tg{constructor(t,{pixelRatio:n,version:a,stretchX:h,stretchY:m,content:g,textFitWidth:v,textFitHeight:T}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=h,this.stretchY=m,this.content=g,this.version=a,this.textFitWidth=v,this.textFitHeight=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Zv{constructor(t,n){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,a,m),this.addImages(n,h,m);const{w:g,h:v}=Uv(m),T=new ji({width:g||1,height:v||1});for(const P in t){const I=t[P],A=a[P].paddedRect;ji.copy(I.data,T,{x:0,y:0},{x:A.x+1,y:A.y+1},I.data)}for(const P in n){const I=n[P],A=h[P].paddedRect,j=A.x+1,$=A.y+1,V=I.data.width,G=I.data.height;ji.copy(I.data,T,{x:0,y:0},{x:j,y:$},I.data),ji.copy(I.data,T,{x:0,y:G-1},{x:j,y:$-1},{width:V,height:1}),ji.copy(I.data,T,{x:0,y:0},{x:j,y:$+G},{width:V,height:1}),ji.copy(I.data,T,{x:V-1,y:0},{x:j-1,y:$},{width:1,height:G}),ji.copy(I.data,T,{x:0,y:0},{x:j+V,y:$},{width:1,height:G})}this.image=T,this.iconPositions=a,this.patternPositions=h}addImages(t,n,a){for(const h in t){const m=t[h],g={x:0,y:0,w:m.data.width+2,h:m.data.height+2};a.push(g),n[h]=new tg(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in t.updatedImages)this.patchUpdatedImage(this.iconPositions[a],t.getImage(a),n),this.patchUpdatedImage(this.patternPositions[a],t.getImage(a),n)}patchUpdatedImage(t,n,a){if(!t||!n||t.version===n.version)return;t.version=n.version;const[h,m]=t.tl;a.update(n.data,void 0,{x:h,y:m})}}et("ImagePosition",tg),et("ImageAtlas",Zv),b.an=void 0,(No=b.an||(b.an={}))[No.none=0]="none",No[No.horizontal=1]="horizontal",No[No.vertical=2]="vertical",No[No.horizontalOnly=3]="horizontalOnly";class mh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,a){const h=new mh;return h.scale=t||1,h.fontStack=n,h.verticalAlign=a||"bottom",h}static forImage(t,n){const a=new mh;return a.imageName=t,a.verticalAlign=n||"bottom",a}}class _c{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const a=new _c;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,n)}return a}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let a=0;a<t.length;a++){const h=t.charCodeAt(a+1)||null,m=t.charCodeAt(a-1)||null;n+=h&&qu(h)&&!fh[t[a+1]]||m&&qu(m)&&!fh[t[a-1]]||!fh[t[a]]?t[a]:fh[t[a]]}return n}(this.text)}trim(){let t=0;for(let a=0;a<this.text.length&&yp[this.text.charCodeAt(a)];a++)t++;let n=this.text.length;for(let a=this.text.length-1;a>=0&&a>=t&&yp[this.text.charCodeAt(a)];a--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const a=new _c;return a.text=this.text.substring(t,n),a.sectionIndex=this.sectionIndex.slice(t,n),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}getMaxImageSize(t){let n=0,a=0;for(let h=0;h<this.length();h++){const m=this.getSection(h);if(m.imageName){const g=t[m.imageName];if(!g)continue;const v=g.displaySize;n=Math.max(n,v[0]),a=Math.max(a,v[1])}}return{maxImageWidth:n,maxImageHeight:a}}addTextSection(t,n){this.text+=t.text,this.sections.push(mh.forText(t.scale,t.fontStack||n,t.verticalAlign));const a=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(a)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void qr("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(mh.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):qr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _p(s,t,n,a,h,m,g,v,T,P,I,A,j,$,V){const G=_c.fromFeature(s,h);let Y;A===b.an.vertical&&G.verticalizePunctuation();const{processBidirectionalText:ie,processStyledBidirectionalText:ye}=ps;if(ie&&G.sections.length===1){Y=[];const X=ie(G.toString(),rg(G,P,m,t,a,$));for(const he of X){const ze=new _c;ze.text=he,ze.sections=G.sections;for(let Ve=0;Ve<he.length;Ve++)ze.sectionIndex.push(0);Y.push(ze)}}else if(ye){Y=[];const X=ye(G.text,G.sectionIndex,rg(G,P,m,t,a,$));for(const he of X){const ze=new _c;ze.text=he[0],ze.sectionIndex=he[1],ze.sections=G.sections,Y.push(ze)}}else Y=function(X,he){const ze=[],Ve=X.text;let Le=0;for(const Fe of he)ze.push(X.substring(Le,Fe)),Le=Fe;return Le<Ve.length&&ze.push(X.substring(Le,Ve.length)),ze}(G,rg(G,P,m,t,a,$));const ae=[],B={positionedLines:ae,text:G.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(X,he,ze,Ve,Le,Fe,qe,Ze,We,Oe,it,ut){let ct=0,ot=0,At=0,dr=0;const Ar=Ze==="right"?1:Ze==="left"?0:.5,ai=Nr/ut;let un=0;for(const ar of Le){ar.trim();const $r=ar.getMaxScale(),Jr={positionedGlyphs:[],lineOffset:0};X.positionedLines[un]=Jr;const ei=Jr.positionedGlyphs;let Ci=0;if(!ar.length()){ot+=Fe,++un;continue}const hn=q2(Ve,ar,ai);for(let Bi=0;Bi<ar.length();Bi++){const Rr=ar.getSection(Bi),Ur=ar.getSectionIndex(Bi),Zr=ar.getCharCode(Bi),Mr=W2(We,it,Zr);let Jt;if(Rr.imageName){if(X.iconsInText=!0,Rr.scale=Rr.scale*ai,Jt=X2(Rr,Mr,$r,hn,Ve),!Jt)continue;Ci=Math.max(Ci,Jt.imageOffset)}else if(Jt=H2(Rr,Zr,Mr,hn,he,ze),!Jt)continue;const{rect:Wn,metrics:bc,baselineOffset:Hn}=Jt;ei.push({glyph:Zr,imageName:Rr.imageName,x:ct,y:ot+Hn+-17,vertical:Mr,scale:Rr.scale,fontStack:Rr.fontStack,sectionIndex:Ur,metrics:bc,rect:Wn}),Mr?(X.verticalizable=!0,ct+=(Rr.imageName?bc.advance:Nr)*Rr.scale+Oe):ct+=bc.advance*Rr.scale+Oe}ei.length!==0&&(At=Math.max(ct-Oe,At),Y2(ei,0,ei.length-1,Ar)),ct=0,Jr.lineOffset=Math.max(Ci,($r-1)*Nr);const Vr=Fe*$r+Ci;ot+=Vr,dr=Math.max(Vr,dr),++un}const{horizontalAlign:Fi,verticalAlign:Qr}=ig(qe);(function(ar,$r,Jr,ei,Ci,hn,Vr,Bi,Rr){const Ur=($r-Jr)*Ci;let Zr=0;Zr=hn!==Vr?-Bi*ei- -17:-ei*Rr*Vr+.5*Vr;for(const Mr of ar)for(const Jt of Mr.positionedGlyphs)Jt.x+=Ur,Jt.y+=Zr})(X.positionedLines,Ar,Fi,Qr,At,dr,Fe,ot,Le.length),X.top+=-Qr*ot,X.bottom=X.top+ot,X.left+=-Fi*At,X.right=X.left+At}(B,t,n,a,Y,g,v,T,A,P,j,V),!function(X){for(const he of X)if(he.positionedGlyphs.length!==0)return!1;return!0}(ae)&&B}const yp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},U2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Z2={40:!0};function Gv(s,t,n,a,h,m){if(t.imageName){const g=a[t.imageName];return g?g.displaySize[0]*t.scale*Nr/m+h:0}{const g=n[t.fontStack],v=g&&g[s];return v?v.metrics.advance*t.scale+h:0}}function qv(s,t,n,a){const h=Math.pow(s-t,2);return a?s<t?h/2:2*h:h+Math.abs(n)*n}function G2(s,t,n){let a=0;return s===10&&(a-=1e4),n&&(a+=150),s!==40&&s!==65288||(a+=50),t!==41&&t!==65289||(a+=50),a}function Wv(s,t,n,a,h,m){let g=null,v=qv(t,n,h,m);for(const T of a){const P=qv(t-T.x,n,h,m)+T.badness;P<=v&&(g=T,v=P)}return{index:s,x:t,priorBreak:g,badness:v}}function Hv(s){return s?Hv(s.priorBreak).concat(s.index):[]}function rg(s,t,n,a,h,m){if(!s)return[];const g=[],v=function(A,j,$,V,G,Y){let ie=0;for(let ye=0;ye<A.length();ye++){const ae=A.getSection(ye);ie+=Gv(A.getCharCode(ye),ae,V,G,j,Y)}return ie/Math.max(1,Math.ceil(ie/$))}(s,t,n,a,h,m),T=s.text.indexOf("​")>=0;let P=0;for(let A=0;A<s.length();A++){const j=s.getSection(A),$=s.getCharCode(A);if(yp[$]||(P+=Gv($,j,a,h,t,m)),A<s.length()-1){const V=!((I=$)<11904)&&(!!zt["CJK Compatibility Forms"](I)||!!zt["CJK Compatibility"](I)||!!zt["CJK Strokes"](I)||!!zt["CJK Symbols and Punctuation"](I)||!!zt["Enclosed CJK Letters and Months"](I)||!!zt["Halfwidth and Fullwidth Forms"](I)||!!zt["Ideographic Description Characters"](I)||!!zt["Vertical Forms"](I)||Gu.test(String.fromCodePoint(I)));(U2[$]||V||j.imageName||A!==s.length()-2&&Z2[s.getCharCode(A+1)])&&g.push(Wv(A+1,P,v,g,G2($,s.getCharCode(A+1),V&&T),!1))}}var I;return Hv(Wv(s.length(),P,v,g,0,!0))}function ig(s){let t=.5,n=.5;switch(s){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function q2(s,t,n){const a=t.getMaxScale()*Nr,{maxImageWidth:h,maxImageHeight:m}=t.getMaxImageSize(s),g=Math.max(a,m*n);return{verticalLineContentWidth:Math.max(a,h*n),horizontalLineContentHeight:g}}function Xv(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function W2(s,t,n){return!(s===b.an.horizontal||!t&&!ac(n)||t&&(yp[n]||(a=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(a)))));var a}function H2(s,t,n,a,h,m){const g=m[s.fontStack],v=function(P,I,A,j){if(P&&P.rect)return P;const $=I[A.fontStack],V=$&&$[j];return V?{rect:null,metrics:V.metrics}:null}(g&&g[t],h,s,t);if(v===null)return null;let T;if(n)T=a.verticalLineContentWidth-s.scale*Nr;else{const P=Xv(s.verticalAlign);T=(a.horizontalLineContentHeight-s.scale*Nr)*P}return{rect:v.rect,metrics:v.metrics,baselineOffset:T}}function X2(s,t,n,a,h){const m=h[s.imageName];if(!m)return null;const g=m.paddedRect,v=m.displaySize,T={width:v[0],height:v[1],left:1,top:-3,advance:t?v[1]:v[0]};let P;if(t)P=a.verticalLineContentWidth-v[1]*s.scale;else{const I=Xv(s.verticalAlign);P=(a.horizontalLineContentHeight-v[1]*s.scale)*I}return{rect:g,metrics:T,baselineOffset:P,imageOffset:(t?v[0]:v[1])*s.scale-Nr*n}}function Y2(s,t,n,a){if(a===0)return;const h=s[n],m=(s[n].x+h.metrics.advance*h.scale)*a;for(let g=t;g<=n;g++)s[g].x-=m}function K2(s,t,n){const{horizontalAlign:a,verticalAlign:h}=ig(n),m=t[0]-s.displaySize[0]*a,g=t[1]-s.displaySize[1]*h;return{image:s,top:g,bottom:g+s.displaySize[1],left:m,right:m+s.displaySize[0]}}function Yv(s){var t,n;let a=s.left,h=s.top,m=s.right-a,g=s.bottom-h;const v=(t=s.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",T=(n=s.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",P=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(T==="proportional"){if(v==="stretchOnly"&&m/g<P||v==="proportional"){const I=Math.ceil(g*P);a*=I/m,m=I}}else if(v==="proportional"&&T==="stretchOnly"&&P!==0&&m/g>P){const I=Math.ceil(m/P);h*=I/g,g=I}return{x1:a,y1:h,x2:a+m,y2:h+g}}function Kv(s,t,n,a,h,m){const g=s.image;let v;if(g.content){const Y=g.content,ie=g.pixelRatio||1;v=[Y[0]/ie,Y[1]/ie,g.displaySize[0]-Y[2]/ie,g.displaySize[1]-Y[3]/ie]}const T=t.left*m,P=t.right*m;let I,A,j,$;n==="width"||n==="both"?($=h[0]+T-a[3],A=h[0]+P+a[1]):($=h[0]+(T+P-g.displaySize[0])/2,A=$+g.displaySize[0]);const V=t.top*m,G=t.bottom*m;return n==="height"||n==="both"?(I=h[1]+V-a[0],j=h[1]+G+a[2]):(I=h[1]+(V+G-g.displaySize[1])/2,j=I+g.displaySize[1]),{image:g,top:I,right:A,bottom:j,left:$,collisionPadding:v}}const Ws=128,$o=32640;function Qv(s,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new er(s+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=n;let m=0;for(;m<a.length&&a[m]<=s;)m++;m=Math.max(0,m-1);let g=m;for(;g<a.length&&a[g]<s+1;)g++;g=Math.min(a.length-1,g);const v=a[m],T=a[g];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:T,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:T,minSize:n.evaluate(new er(v)),maxSize:n.evaluate(new er(T)),interpolationType:h}}}function ng(s,t,n){let a="never";const h=s.get(t);return h?a=h:s.get(n)&&(a="always"),a}const Q2=hh.VectorTileFeature.types,J2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vp(s,t,n,a,h,m,g,v,T,P,I,A,j){const $=v?Math.min($o,Math.round(v[0])):0,V=v?Math.min($o,Math.round(v[1])):0;s.emplaceBack(t,n,Math.round(32*a),Math.round(32*h),m,g,($<<1)+(T?1:0),V,16*P,16*I,256*A,256*j)}function sg(s,t,n){s.emplaceBack(t.x,t.y,n),s.emplaceBack(t.x,t.y,n),s.emplaceBack(t.x,t.y,n),s.emplaceBack(t.x,t.y,n)}function eT(s){for(const t of s.sections)if(Wu(t.text))return!0;return!1}class og{constructor(t){this.layoutVertexArray=new St,this.indexArray=new Ht,this.programConfigurations=t,this.segments=new Lt,this.dynamicLayoutVertexArray=new Vt,this.opacityVertexArray=new sr,this.hasVisibleVertices=!1,this.placedSymbolArray=new te}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,D2.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,L2.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,J2,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}et("SymbolBuffers",og);class ag{constructor(t,n,a){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new a,this.segments=new Lt,this.collisionVertexArray=new or}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,j2.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}et("CollisionBuffers",ag);class yc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Qv(this.zoom,n["text-size"]),this.iconSizeData=Qv(this.zoom,n["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=ng(a,"text-overlap","text-allow-overlap")!=="never"||ng(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(g=>b.an[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID}createArrays(){this.text=new og(new xs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new og(new xs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new se,this.lineVertexArray=new de,this.symbolInstances=new ce,this.textAnchorOffsets=new oe}calculateGlyphDependencies(t,n,a,h,m){for(let g=0;g<t.length;g++)if(n[t.charCodeAt(g)]=!0,(a||h)&&m){const v=fh[t.charAt(g)];v&&(n[v.charCodeAt(0)]=!0)}}populate(t,n,a){const h=this.layers[0],m=h.layout,g=m.get("text-font"),v=m.get("text-field"),T=m.get("icon-image"),P=(v.value.kind!=="constant"||v.value.value instanceof ni&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),I=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,A=m.get("symbol-sort-key");if(this.features=[],!P&&!I)return;const j=n.iconDependencies,$=n.glyphDependencies,V=n.availableImages,G=new er(this.zoom,{globalState:this.globalState});for(const{feature:Y,id:ie,index:ye,sourceLayerIndex:ae}of t){const B=h._featureFilter.needGeometry,X=Ka(Y,B);if(!h._featureFilter.filter(G,X,a))continue;let he,ze;if(B||(X.geometry=Ya(Y)),P){const Le=h.getValueAndResolveTokens("text-field",X,a,V),Fe=ni.factory(Le),qe=this.hasRTLText=this.hasRTLText||eT(Fe);(!qe||ps.getRTLTextPluginStatus()==="unavailable"||qe&&ps.isParsed())&&(he=B2(Fe,h,X))}if(I){const Le=h.getValueAndResolveTokens("icon-image",X,a,V);ze=Le instanceof bi?Le:bi.fromString(Le)}if(!he&&!ze)continue;const Ve=this.sortFeaturesByKey?A.evaluate(X,{},a):void 0;if(this.features.push({id:ie,text:he,icon:ze,index:ye,sourceLayerIndex:ae,geometry:X.geometry,properties:Y.properties,type:Q2[Y.type],sortKey:Ve}),ze&&(j[ze.name]=!0),he){const Le=g.evaluate(X,{},a).join(","),Fe=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(b.an.vertical)>=0;for(const qe of he.sections)if(qe.image)j[qe.image.name]=!0;else{const Ze=Zu(he.toString()),We=qe.fontStack||Le,Oe=$[We]=$[We]||{};this.calculateGlyphDependencies(qe.text,Oe,Fe,this.allowVerticalPlacement,Ze)}}}m.get("symbol-placement")==="line"&&(this.features=function(Y){const ie={},ye={},ae=[];let B=0;function X(Le){ae.push(Y[Le]),B++}function he(Le,Fe,qe){const Ze=ye[Le];return delete ye[Le],ye[Fe]=Ze,ae[Ze].geometry[0].pop(),ae[Ze].geometry[0]=ae[Ze].geometry[0].concat(qe[0]),Ze}function ze(Le,Fe,qe){const Ze=ie[Fe];return delete ie[Fe],ie[Le]=Ze,ae[Ze].geometry[0].shift(),ae[Ze].geometry[0]=qe[0].concat(ae[Ze].geometry[0]),Ze}function Ve(Le,Fe,qe){const Ze=qe?Fe[0][Fe[0].length-1]:Fe[0][0];return`${Le}:${Ze.x}:${Ze.y}`}for(let Le=0;Le<Y.length;Le++){const Fe=Y[Le],qe=Fe.geometry,Ze=Fe.text?Fe.text.toString():null;if(!Ze){X(Le);continue}const We=Ve(Ze,qe),Oe=Ve(Ze,qe,!0);if(We in ye&&Oe in ie&&ye[We]!==ie[Oe]){const it=ze(We,Oe,qe),ut=he(We,Oe,ae[it].geometry);delete ie[We],delete ye[Oe],ye[Ve(Ze,ae[ut].geometry,!0)]=ut,ae[it].geometry=null}else We in ye?he(We,Oe,qe):Oe in ie?ze(We,Oe,qe):(X(Le),ie[We]=B-1,ye[Oe]=B-1)}return ae.filter(Le=>Le.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Y,ie)=>Y.sortKey-ie.sortKey)}update(t,n,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,a),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const a=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(n[t.segment+1]),m=t.dist(n[t.segment]);const g={};for(let v=t.segment+1;v<n.length;v++)g[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:h},v<n.length-1&&(h+=n[v+1].dist(n[v]));for(let v=t.segment||0;v>=0;v--)g[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=n[v-1].dist(n[v]));for(let v=0;v<n.length;v++){const T=g[v];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(t,n,a,h,m,g,v,T,P,I,A,j){const $=t.indexArray,V=t.layoutVertexArray,G=t.segments.prepareSegment(4*n.length,V,$,this.canOverlap?g.sortKey:void 0),Y=this.glyphOffsetArray.length,ie=G.vertexLength,ye=this.allowVerticalPlacement&&v===b.an.vertical?Math.PI/2:0,ae=g.text&&g.text.sections;for(let B=0;B<n.length;B++){const{tl:X,tr:he,bl:ze,br:Ve,tex:Le,pixelOffsetTL:Fe,pixelOffsetBR:qe,minFontScaleX:Ze,minFontScaleY:We,glyphOffset:Oe,isSDF:it,sectionIndex:ut}=n[B],ct=G.vertexLength,ot=Oe[1];vp(V,T.x,T.y,X.x,ot+X.y,Le.x,Le.y,a,it,Fe.x,Fe.y,Ze,We),vp(V,T.x,T.y,he.x,ot+he.y,Le.x+Le.w,Le.y,a,it,qe.x,Fe.y,Ze,We),vp(V,T.x,T.y,ze.x,ot+ze.y,Le.x,Le.y+Le.h,a,it,Fe.x,qe.y,Ze,We),vp(V,T.x,T.y,Ve.x,ot+Ve.y,Le.x+Le.w,Le.y+Le.h,a,it,qe.x,qe.y,Ze,We),sg(t.dynamicLayoutVertexArray,T,ye),$.emplaceBack(ct,ct+2,ct+1),$.emplaceBack(ct+1,ct+2,ct+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Oe[0]),B!==n.length-1&&ut===n[B+1].sectionIndex||t.programConfigurations.populatePaintArrays(V.length,g,g.index,{},j,ae&&ae[ut])}t.placedSymbolArray.emplaceBack(T.x,T.y,Y,this.glyphOffsetArray.length-Y,ie,P,I,T.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],v,0,!1,0,A)}_addCollisionDebugVertex(t,n,a,h,m,g){return n.emplaceBack(0,0),t.emplaceBack(a.x,a.y,h,m,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,n,a,h,m,g,v){const T=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),P=T.vertexLength,I=m.layoutVertexArray,A=m.collisionVertexArray,j=v.anchorX,$=v.anchorY;this._addCollisionDebugVertex(I,A,g,j,$,new ue(t,n)),this._addCollisionDebugVertex(I,A,g,j,$,new ue(a,n)),this._addCollisionDebugVertex(I,A,g,j,$,new ue(a,h)),this._addCollisionDebugVertex(I,A,g,j,$,new ue(t,h)),T.vertexLength+=4;const V=m.indexArray;V.emplaceBack(P,P+1),V.emplaceBack(P+1,P+2),V.emplaceBack(P+2,P+3),V.emplaceBack(P+3,P),T.primitiveLength+=4}addDebugCollisionBoxes(t,n,a,h){for(let m=t;m<n;m++){const g=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,h?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ag(qt,Ov.members,Wt),this.iconCollisionBox=new ag(qt,Ov.members,Wt);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,a,h,m,g,v,T,P){const I={};for(let A=n;A<a;A++){const j=t.get(A);I.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.textFeatureIndex=j.featureIndex;break}for(let A=h;A<m;A++){const j=t.get(A);I.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.verticalTextFeatureIndex=j.featureIndex;break}for(let A=g;A<v;A++){const j=t.get(A);I.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.iconFeatureIndex=j.featureIndex;break}for(let A=T;A<P;A++){const j=t.get(A);I.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.verticalIconFeatureIndex=j.featureIndex;break}return I}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const a=t.placedSymbolArray.get(n),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+2,m+1),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),a=Math.cos(t),h=[],m=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const T=this.symbolInstances.get(v);h.push(0|Math.round(n*T.anchorX+a*T.anchorY)),m.push(T.featureIndex)}return g.sort((v,T)=>h[v]-h[T]||m[T]-m[v]),g}addToSortKeyRanges(t,n){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===n?a.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const a=this.symbolInstances.get(n);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,m,g)=>{h>=0&&g.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Jv,ex;et("SymbolBucket",yc,{omit:["layers","collisionBoxArray","features","compareText"]}),yc.MAX_GLYPHS=65535,yc.addDynamicAttributes=sg;var lg={get paint(){return ex=ex||new fi({"icon-opacity":new pt(me.paint_symbol["icon-opacity"]),"icon-color":new pt(me.paint_symbol["icon-color"]),"icon-halo-color":new pt(me.paint_symbol["icon-halo-color"]),"icon-halo-width":new pt(me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pt(me.paint_symbol["icon-halo-blur"]),"icon-translate":new nt(me.paint_symbol["icon-translate"]),"icon-translate-anchor":new nt(me.paint_symbol["icon-translate-anchor"]),"text-opacity":new pt(me.paint_symbol["text-opacity"]),"text-color":new pt(me.paint_symbol["text-color"],{runtimeType:Ri,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new pt(me.paint_symbol["text-halo-color"]),"text-halo-width":new pt(me.paint_symbol["text-halo-width"]),"text-halo-blur":new pt(me.paint_symbol["text-halo-blur"]),"text-translate":new nt(me.paint_symbol["text-translate"]),"text-translate-anchor":new nt(me.paint_symbol["text-translate-anchor"])})},get layout(){return Jv=Jv||new fi({"symbol-placement":new nt(me.layout_symbol["symbol-placement"]),"symbol-spacing":new nt(me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new nt(me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pt(me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new nt(me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new nt(me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new nt(me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new nt(me.layout_symbol["icon-ignore-placement"]),"icon-optional":new nt(me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new nt(me.layout_symbol["icon-rotation-alignment"]),"icon-size":new pt(me.layout_symbol["icon-size"]),"icon-text-fit":new nt(me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nt(me.layout_symbol["icon-text-fit-padding"]),"icon-image":new pt(me.layout_symbol["icon-image"]),"icon-rotate":new pt(me.layout_symbol["icon-rotate"]),"icon-padding":new pt(me.layout_symbol["icon-padding"]),"icon-keep-upright":new nt(me.layout_symbol["icon-keep-upright"]),"icon-offset":new pt(me.layout_symbol["icon-offset"]),"icon-anchor":new pt(me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new nt(me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new nt(me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new nt(me.layout_symbol["text-rotation-alignment"]),"text-field":new pt(me.layout_symbol["text-field"]),"text-font":new pt(me.layout_symbol["text-font"]),"text-size":new pt(me.layout_symbol["text-size"]),"text-max-width":new pt(me.layout_symbol["text-max-width"]),"text-line-height":new nt(me.layout_symbol["text-line-height"]),"text-letter-spacing":new pt(me.layout_symbol["text-letter-spacing"]),"text-justify":new pt(me.layout_symbol["text-justify"]),"text-radial-offset":new pt(me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new nt(me.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new pt(me.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new pt(me.layout_symbol["text-anchor"]),"text-max-angle":new nt(me.layout_symbol["text-max-angle"]),"text-writing-mode":new nt(me.layout_symbol["text-writing-mode"]),"text-rotate":new pt(me.layout_symbol["text-rotate"]),"text-padding":new nt(me.layout_symbol["text-padding"]),"text-keep-upright":new nt(me.layout_symbol["text-keep-upright"]),"text-transform":new pt(me.layout_symbol["text-transform"]),"text-offset":new pt(me.layout_symbol["text-offset"]),"text-allow-overlap":new nt(me.layout_symbol["text-allow-overlap"]),"text-overlap":new nt(me.layout_symbol["text-overlap"]),"text-ignore-placement":new nt(me.layout_symbol["text-ignore-placement"]),"text-optional":new nt(me.layout_symbol["text-optional"])})}};class tx{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Rs,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}et("FormatSectionOverride",tx,{omit:["defaultValue"]});class xp extends Hr{constructor(t){super(t,lg)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,a,h){const m=this.layout.get(t).evaluate(n,{},a,h),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||Xl(g.value)||!m?m:function(v,T){return T.replace(/{([^{}]+)}/g,(P,I)=>v&&I in v?String(v[I]):"")}(n.properties,m)}createBucket(t){return new yc(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of lg.paint.overridableProperties){if(!xp.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),a=new tx(n),h=new Hl(a,n.property.specification);let m=null;m=n.value.kind==="constant"||n.value.kind==="source"?new Ra("source",h):new Kl("composite",h,n.value.zoomStops),this.paint._values[t]=new In(n.property,m,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven())&&xp.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const a=t.get("text-field"),h=lg.paint.properties[n];let m=!1;const g=v=>{for(const T of v)if(h.overrides&&h.overrides.hasOverride(T))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof ni)g(a.value.value.sections);else if(a.value.kind==="source"){const v=P=>{m||(P instanceof hi&&mt(P.value)===Ds?g(P.value.sections):P instanceof Pa?g(P.sections):P.eachChild(v))},T=a.value;T._styleExpression&&v(T._styleExpression.expression)}return m}}let rx;var tT={get paint(){return rx=rx||new fi({"background-color":new nt(me.paint_background["background-color"]),"background-pattern":new Xu(me.paint_background["background-pattern"]),"background-opacity":new nt(me.paint_background["background-opacity"])})}};class rT extends Hr{constructor(t){super(t,tT)}}let ix;var iT={get paint(){return ix=ix||new fi({"raster-opacity":new nt(me.paint_raster["raster-opacity"]),"raster-hue-rotate":new nt(me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new nt(me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new nt(me.paint_raster["raster-brightness-max"]),"raster-saturation":new nt(me.paint_raster["raster-saturation"]),"raster-contrast":new nt(me.paint_raster["raster-contrast"]),"raster-resampling":new nt(me.paint_raster["raster-resampling"]),"raster-fade-duration":new nt(me.paint_raster["raster-fade-duration"])})}};class nT extends Hr{constructor(t){super(t,iT)}}class sT extends Hr{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class oT{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const aT={once:!0},cg=63710088e-1;class Vo{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Vo(ua(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,a=this.lat*n,h=t.lat*n,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((t.lng-this.lng)*n);return cg*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof Vo)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Vo(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Vo(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const nx=2*Math.PI*cg;function sx(s){return nx*Math.cos(s*Math.PI/180)}function ox(s){return(180+s)/360}function ax(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function lx(s,t){return s/sx(t)}function ug(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function cx(s,t){return s*sx(ug(t))}class gh{constructor(t,n,a=0){this.x=+t,this.y=+n,this.z=+a}static fromLngLat(t,n=0){const a=Vo.convert(t);return new gh(ox(a.lng),ax(a.lat),lx(n,a.lat))}toLngLat(){return new Vo(360*this.x-180,ug(this.y))}toAltitude(){return cx(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/nx*(t=ug(this.y),1/Math.cos(t*Math.PI/180));var t}}function ux(s,t,n){var a=2*Math.PI*6378137/256/Math.pow(2,n);return[s*a-2*Math.PI*6378137/2,t*a-2*Math.PI*6378137/2]}class hg{constructor(t,n,a){if(!function(h,m,g){return!(h<0||h>25||g<0||g>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))}(t,n,a))throw new Error(`x=${n}, y=${a}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=a,this.key=vc(0,t,t,n,a)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,a){const h=(g=this.y,v=this.z,T=ux(256*(m=this.x),256*(g=Math.pow(2,v)-g-1),v),P=ux(256*(m+1),256*(g+1),v),T[0]+","+T[1]+","+P[0]+","+P[1]);var m,g,v,T,P;const I=function(A,j,$){let V,G="";for(let Y=A;Y>0;Y--)V=1<<Y-1,G+=(j&V?1:0)+($&V?2:0);return G}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new ue((t.x*n-this.x)*vt,(t.y*n-this.y)*vt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class hx{constructor(t,n){this.wrap=t,this.canonical=n,this.key=vc(t,n.z,n.z,n.x,n.y)}}class cn{constructor(t,n,a,h,m){if(this.terrainRttPosMatrix32f=null,t<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${a}`);this.overscaledZ=t,this.wrap=n,this.canonical=new hg(a,+h,+m),this.key=vc(n,t,a,h,m)}clone(){return new cn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new cn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new cn(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?vc(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):vc(this.wrap*+n,t,t,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new cn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new cn(n,this.wrap,n,a,h),new cn(n,this.wrap,n,a+1,h),new cn(n,this.wrap,n,a,h+1),new cn(n,this.wrap,n,a+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new cn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new cn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new hx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new gh(t.x-this.wrap,t.y))}}function vc(s,t,n,a,h){(s*=2)<0&&(s=-1*s-1);const m=1<<n;return(m*m*s+m*h+a).toString(36)+n.toString(36)+t.toString(36)}et("CanonicalTileID",hg),et("OverscaledTileID",cn,{omit:["terrainRttPosMatrix32f"]});class el{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const n=new el;return n.extend(t(new ue(this.minX,this.minY))),n.extend(t(new ue(this.maxX,this.minY))),n.extend(t(new ue(this.minX,this.maxY))),n.extend(t(new ue(this.maxX,this.maxY))),n}static fromPoints(t){const n=new el;for(const a of t)n.extend(a);return n}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class dx{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const a=t[n];this._stringToNumber[a]=n,this._numberToString[n]=a}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class px{constructor(t,n,a,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=a,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class fx{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new jo(vt,16,0),this.grid3D=new jo(vt,16,0),this.featureIndexArray=new Re,this.promoteId=n}insert(t,n,a,h,m,g){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m);const T=g?this.grid3D:this.grid;for(let P=0;P<n.length;P++){const I=n[P],A=[1/0,1/0,-1/0,-1/0];for(let j=0;j<I.length;j++){const $=I[j];A[0]=Math.min(A[0],$.x),A[1]=Math.min(A[1],$.y),A[2]=Math.max(A[2],$.x),A[3]=Math.max(A[3],$.y)}A[0]<vt&&A[1]<vt&&A[2]>=0&&A[3]>=0&&T.insert(v,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new hh.VectorTile(new eg(this.rawTileData)).layers,this.sourceLayerCoder=new dx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,a,h){this.loadVTLayers();const m=t.params,g=vt/t.tileSize/t.scale,v=hs(m.filter),T=t.queryGeometry,P=t.queryPadding*g,I=el.fromPoints(T),A=this.grid.query(I.minX-P,I.minY-P,I.maxX+P,I.maxY+P),j=el.fromPoints(t.cameraQueryGeometry).expandBy(P),$=this.grid3D.query(j.minX,j.minY,j.maxX,j.maxY,(Y,ie,ye,ae)=>function(B,X,he,ze,Ve){for(const Fe of B)if(X<=Fe.x&&he<=Fe.y&&ze>=Fe.x&&Ve>=Fe.y)return!0;const Le=[new ue(X,he),new ue(X,Ve),new ue(ze,Ve),new ue(ze,he)];if(B.length>2){for(const Fe of Le)if(pc(B,Fe))return!0}for(let Fe=0;Fe<B.length-1;Fe++)if(Hw(B[Fe],B[Fe+1],Le))return!0;return!1}(t.cameraQueryGeometry,Y-P,ie-P,ye+P,ae+P));for(const Y of $)A.push(Y);A.sort(lT);const V={};let G;for(let Y=0;Y<A.length;Y++){const ie=A[Y];if(ie===G)continue;G=ie;const ye=this.featureIndexArray.get(ie);let ae=null;this.loadMatchingFeature(V,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,v,m.layers,m.availableImages,n,a,h,(B,X,he)=>(ae||(ae=Ya(B)),X.queryIntersectsFeature({queryGeometry:T,feature:B,featureState:he,geometry:ae,zoom:this.z,transform:t.transform,pixelsToTileUnits:g,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return V}loadMatchingFeature(t,n,a,h,m,g,v,T,P,I,A){const j=this.bucketLayerIDs[n];if(g&&!j.some(Y=>g.has(Y)))return;const $=this.sourceLayerCoder.decode(a),V=this.vtLayers[$].feature(h);if(m.needGeometry){const Y=Ka(V,!0);if(!m.filter(new er(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!m.filter(new er(this.tileID.overscaledZ),V))return;const G=this.getId(V,$);for(let Y=0;Y<j.length;Y++){const ie=j[Y];if(g&&!g.has(ie))continue;const ye=T[ie];if(!ye)continue;let ae={};G&&I&&(ae=I.getState(ye.sourceLayer||"_geojsonTileLayer",G));const B=ki({},P[ie]);B.paint=mx(B.paint,ye.paint,V,ae,v),B.layout=mx(B.layout,ye.layout,V,ae,v);const X=!A||A(V,ye,ae);if(!X)continue;const he=new px(V,this.z,this.x,this.y,G);he.layer=B;let ze=t[ie];ze===void 0&&(ze=t[ie]=[]),ze.push({featureIndex:h,feature:he,intersectionZ:X})}}lookupSymbolFeatures(t,n,a,h,m,g,v,T){const P={};this.loadVTLayers();const I=hs(m);for(const A of t)this.loadMatchingFeature(P,a,h,A,I,g,v,T,n);return P}hasLayer(t){for(const n of this.bucketLayerIDs)for(const a of n)if(t===a)return!0;return!1}getId(t,n){var a;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((a=t.properties)===null||a===void 0)&&a.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function mx(s,t,n,a,h){return cr(s,(m,g)=>{const v=t instanceof cc?t.get(g):null;return v&&v.evaluate?v.evaluate(n,a,h):v})}function lT(s,t){return t-s}function gx(s,t,n,a,h){const m=[];for(let g=0;g<s.length;g++){const v=s[g];let T;for(let P=0;P<v.length-1;P++){let I=v[P],A=v[P+1];I.x<t&&A.x<t||(I.x<t?I=new ue(t,I.y+(t-I.x)/(A.x-I.x)*(A.y-I.y))._round():A.x<t&&(A=new ue(t,I.y+(t-I.x)/(A.x-I.x)*(A.y-I.y))._round()),I.y<n&&A.y<n||(I.y<n?I=new ue(I.x+(n-I.y)/(A.y-I.y)*(A.x-I.x),n)._round():A.y<n&&(A=new ue(I.x+(n-I.y)/(A.y-I.y)*(A.x-I.x),n)._round()),I.x>=a&&A.x>=a||(I.x>=a?I=new ue(a,I.y+(a-I.x)/(A.x-I.x)*(A.y-I.y))._round():A.x>=a&&(A=new ue(a,I.y+(a-I.x)/(A.x-I.x)*(A.y-I.y))._round()),I.y>=h&&A.y>=h||(I.y>=h?I=new ue(I.x+(h-I.y)/(A.y-I.y)*(A.x-I.x),h)._round():A.y>=h&&(A=new ue(I.x+(h-I.y)/(A.y-I.y)*(A.x-I.x),h)._round()),T&&I.equals(T[T.length-1])||(T=[I],m.push(T)),T.push(A)))))}}return m}et("FeatureIndex",fx,{omit:["rawTileData","sourceLayerCoder"]});class Uo extends ue{constructor(t,n,a,h){super(t,n),this.angle=a,h!==void 0&&(this.segment=h)}clone(){return new Uo(this.x,this.y,this.angle,this.segment)}}function _x(s,t,n,a,h){if(t.segment===void 0||n===0)return!0;let m=t,g=t.segment+1,v=0;for(;v>-n/2;){if(g--,g<0)return!1;v-=s[g].dist(m),m=s[g]}v+=s[g].dist(s[g+1]),g++;const T=[];let P=0;for(;v<n/2;){const I=s[g],A=s[g+1];if(!A)return!1;let j=s[g-1].angleTo(I)-I.angleTo(A);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:v,angleDelta:j}),P+=j;v-T[0].distance>a;)P-=T.shift().angleDelta;if(P>h)return!1;g++,v+=I.dist(A)}return!0}function yx(s){let t=0;for(let n=0;n<s.length-1;n++)t+=s[n].dist(s[n+1]);return t}function vx(s,t,n){return s?.6*t*n:0}function xx(s,t){return Math.max(s?s.right-s.left:0,t?t.right-t.left:0)}function cT(s,t,n,a,h,m){const g=vx(n,h,m),v=xx(n,a)*m;let T=0;const P=yx(s)/2;for(let I=0;I<s.length-1;I++){const A=s[I],j=s[I+1],$=A.dist(j);if(T+$>P){const V=(P-T)/$,G=Li.number(A.x,j.x,V),Y=Li.number(A.y,j.y,V),ie=new Uo(G,Y,j.angleTo(A),I);return ie._round(),!g||_x(s,ie,v,g,t)?ie:void 0}T+=$}}function uT(s,t,n,a,h,m,g,v,T){const P=vx(a,m,g),I=xx(a,h),A=I*g,j=s[0].x===0||s[0].x===T||s[0].y===0||s[0].y===T;return t-A<t/4&&(t=A+t/4),bx(s,j?t/2*v%t:(I/2+2*m)*g*v%t,t,P,n,A,j,!1,T)}function bx(s,t,n,a,h,m,g,v,T){const P=m/2,I=yx(s);let A=0,j=t-n,$=[];for(let V=0;V<s.length-1;V++){const G=s[V],Y=s[V+1],ie=G.dist(Y),ye=Y.angleTo(G);for(;j+n<A+ie;){j+=n;const ae=(j-A)/ie,B=Li.number(G.x,Y.x,ae),X=Li.number(G.y,Y.y,ae);if(B>=0&&B<T&&X>=0&&X<T&&j-P>=0&&j+P<=I){const he=new Uo(B,X,ye,V);he._round(),a&&!_x(s,he,m,a,h)||$.push(he)}}A+=ie}return v||$.length||g||($=bx(s,A/2,n,a,h,m,g,!0,T)),$}function wx(s,t,n,a){const h=[],m=s.image,g=m.pixelRatio,v=m.paddedRect.w-2,T=m.paddedRect.h-2;let P={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const I=m.stretchX||[[0,v]],A=m.stretchY||[[0,T]],j=(Oe,it)=>Oe+it[1]-it[0],$=I.reduce(j,0),V=A.reduce(j,0),G=v-$,Y=T-V;let ie=0,ye=$,ae=0,B=V,X=0,he=G,ze=0,Ve=Y;if(m.content&&a){const Oe=m.content,it=Oe[2]-Oe[0],ut=Oe[3]-Oe[1];(m.textFitWidth||m.textFitHeight)&&(P=Yv(s)),ie=bp(I,0,Oe[0]),ae=bp(A,0,Oe[1]),ye=bp(I,Oe[0],Oe[2]),B=bp(A,Oe[1],Oe[3]),X=Oe[0]-ie,ze=Oe[1]-ae,he=it-ye,Ve=ut-B}const Le=P.x1,Fe=P.y1,qe=P.x2-Le,Ze=P.y2-Fe,We=(Oe,it,ut,ct)=>{const ot=wp(Oe.stretch-ie,ye,qe,Le),At=Tp(Oe.fixed-X,he,Oe.stretch,$),dr=wp(it.stretch-ae,B,Ze,Fe),Ar=Tp(it.fixed-ze,Ve,it.stretch,V),ai=wp(ut.stretch-ie,ye,qe,Le),un=Tp(ut.fixed-X,he,ut.stretch,$),Fi=wp(ct.stretch-ae,B,Ze,Fe),Qr=Tp(ct.fixed-ze,Ve,ct.stretch,V),ar=new ue(ot,dr),$r=new ue(ai,dr),Jr=new ue(ai,Fi),ei=new ue(ot,Fi),Ci=new ue(At/g,Ar/g),hn=new ue(un/g,Qr/g),Vr=t*Math.PI/180;if(Vr){const Ur=Math.sin(Vr),Zr=Math.cos(Vr),Mr=[Zr,-Ur,Ur,Zr];ar._matMult(Mr),$r._matMult(Mr),ei._matMult(Mr),Jr._matMult(Mr)}const Bi=Oe.stretch+Oe.fixed,Rr=it.stretch+it.fixed;return{tl:ar,tr:$r,bl:ei,br:Jr,tex:{x:m.paddedRect.x+1+Bi,y:m.paddedRect.y+1+Rr,w:ut.stretch+ut.fixed-Bi,h:ct.stretch+ct.fixed-Rr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ci,pixelOffsetBR:hn,minFontScaleX:he/g/qe,minFontScaleY:Ve/g/Ze,isSDF:n}};if(a&&(m.stretchX||m.stretchY)){const Oe=Tx(I,G,$),it=Tx(A,Y,V);for(let ut=0;ut<Oe.length-1;ut++){const ct=Oe[ut],ot=Oe[ut+1];for(let At=0;At<it.length-1;At++)h.push(We(ct,it[At],ot,it[At+1]))}}else h.push(We({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:T+1}));return h}function bp(s,t,n){let a=0;for(const h of s)a+=Math.max(t,Math.min(n,h[1]))-Math.max(t,Math.min(n,h[0]));return a}function Tx(s,t,n){const a=[{fixed:-1,stretch:0}];for(const[h,m]of s){const g=a[a.length-1];a.push({fixed:h-g.stretch,stretch:g.stretch}),a.push({fixed:h-g.stretch,stretch:g.stretch+(m-h)})}return a.push({fixed:t+1,stretch:n}),a}function wp(s,t,n,a){return s/t*n+a}function Tp(s,t,n,a){return s-t*n/a}et("Anchor",Uo);class Sp{constructor(t,n,a,h,m,g,v,T,P,I){var A;if(this.boxStartIndex=t.length,P){let j=g.top,$=g.bottom;const V=g.collisionPadding;V&&(j-=V[1],$+=V[3]);let G=$-j;G>0&&(G=Math.max(10,G),this.circleDiameter=G)}else{const j=!((A=g.image)===null||A===void 0)&&A.content&&(g.image.textFitWidth||g.image.textFitHeight)?Yv(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};j.y1=j.y1*v-T[0],j.y2=j.y2*v+T[2],j.x1=j.x1*v-T[3],j.x2=j.x2*v+T[1];const $=g.collisionPadding;if($&&(j.x1-=$[0]*v,j.y1-=$[1]*v,j.x2+=$[2]*v,j.y2+=$[3]*v),I){const V=new ue(j.x1,j.y1),G=new ue(j.x2,j.y1),Y=new ue(j.x1,j.y2),ie=new ue(j.x2,j.y2),ye=I*Math.PI/180;V._rotate(ye),G._rotate(ye),Y._rotate(ye),ie._rotate(ye),j.x1=Math.min(V.x,G.x,Y.x,ie.x),j.x2=Math.max(V.x,G.x,Y.x,ie.x),j.y1=Math.min(V.y,G.y,Y.y,ie.y),j.y2=Math.max(V.y,G.y,Y.y,ie.y)}t.emplaceBack(n.x,n.y,j.x1,j.y1,j.x2,j.y2,a,h,m)}this.boxEndIndex=t.length}}class hT{constructor(t=[],n=(a,h)=>a<h?-1:a>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:a}=this,h=n[t];for(;t>0;){const m=t-1>>1,g=n[m];if(a(h,g)>=0)break;n[t]=g,t=m}n[t]=h}_down(t){const{data:n,compare:a}=this,h=this.length>>1,m=n[t];for(;t<h;){let g=1+(t<<1);const v=g+1;if(v<this.length&&a(n[v],n[g])<0&&(g=v),a(n[g],m)>=0)break;n[t]=n[g],t=g}n[t]=m}}function dT(s,t=1,n=!1){const a=el.fromPoints(s[0]),h=Math.min(a.width(),a.height());let m=h/2;const g=new hT([],pT),{minX:v,minY:T,maxX:P,maxY:I}=a;if(h===0)return new ue(v,T);for(let $=v;$<P;$+=h)for(let V=T;V<I;V+=h)g.push(new xc($+m,V+m,m,s));let A=function($){let V=0,G=0,Y=0;const ie=$[0];for(let ye=0,ae=ie.length,B=ae-1;ye<ae;B=ye++){const X=ie[ye],he=ie[B],ze=X.x*he.y-he.x*X.y;G+=(X.x+he.x)*ze,Y+=(X.y+he.y)*ze,V+=3*ze}return new xc(G/V,Y/V,0,$)}(s),j=g.length;for(;g.length;){const $=g.pop();($.d>A.d||!A.d)&&(A=$,n&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,j)),$.max-A.d<=t||(m=$.h/2,g.push(new xc($.p.x-m,$.p.y-m,m,s)),g.push(new xc($.p.x+m,$.p.y-m,m,s)),g.push(new xc($.p.x-m,$.p.y+m,m,s)),g.push(new xc($.p.x+m,$.p.y+m,m,s)),j+=4)}return n&&(console.log(`num probes: ${j}`),console.log(`best distance: ${A.d}`)),A.p}function pT(s,t){return t.max-s.max}function xc(s,t,n,a){this.p=new ue(s,t),this.h=n,this.d=function(h,m){let g=!1,v=1/0;for(let T=0;T<m.length;T++){const P=m[T];for(let I=0,A=P.length,j=A-1;I<A;j=I++){const $=P[I],V=P[j];$.y>h.y!=V.y>h.y&&h.x<(V.x-$.x)*(h.y-$.y)/(V.y-$.y)+$.x&&(g=!g),v=Math.min(v,rv(h,$,V))}}return(g?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var oi;b.aD=void 0,(oi=b.aD||(b.aD={}))[oi.center=1]="center",oi[oi.left=2]="left",oi[oi.right=3]="right",oi[oi.top=4]="top",oi[oi.bottom=5]="bottom",oi[oi["top-left"]=6]="top-left",oi[oi["top-right"]=7]="top-right",oi[oi["bottom-left"]=8]="bottom-left",oi[oi["bottom-right"]=9]="bottom-right";const dg=Number.POSITIVE_INFINITY;function Sx(s,t){return t[1]!==dg?function(n,a,h){let m=0,g=0;switch(a=Math.abs(a),h=Math.abs(h),n){case"top-right":case"top-left":case"top":g=h-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-h}switch(n){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,g]}(s,t[0],t[1]):function(n,a){let h=0,m=0;a<0&&(a=0);const g=a/Math.SQRT2;switch(n){case"top-right":case"top-left":m=g-7;break;case"bottom-right":case"bottom-left":m=7-g;break;case"bottom":m=7-a;break;case"top":m=a-7}switch(n){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=a;break;case"right":h=-a}return[h,m]}(s,t[0])}function Cx(s,t,n){var a;const h=s.layout,m=(a=h.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(t,{},n);if(m){const v=m.values,T=[];for(let P=0;P<v.length;P+=2){const I=T[P]=v[P],A=v[P+1].map(j=>j*Nr);I.startsWith("top")?A[1]-=7:I.startsWith("bottom")&&(A[1]+=7),T[P+1]=A}return new Dt(T)}const g=h.get("text-variable-anchor");if(g){let v;v=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},n)*Nr,dg]:h.get("text-offset").evaluate(t,{},n).map(P=>P*Nr);const T=[];for(const P of g)T.push(P,Sx(P,v));return new Dt(T)}return null}function pg(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function fT(s,t,n,a,h,m,g,v,T,P,I,A){let j=m.textMaxSize.evaluate(t,{});j===void 0&&(j=g);const $=s.layers[0].layout,V=$.get("icon-offset").evaluate(t,{},I),G=Mx(n.horizontal),Y=g/24,ie=s.tilePixelRatio*Y,ye=s.tilePixelRatio*j/24,ae=s.tilePixelRatio*v,B=s.tilePixelRatio*$.get("symbol-spacing"),X=$.get("text-padding")*s.tilePixelRatio,he=function(ut,ct,ot,At=1){const dr=ut.get("icon-padding").evaluate(ct,{},ot),Ar=dr&&dr.values;return[Ar[0]*At,Ar[1]*At,Ar[2]*At,Ar[3]*At]}($,t,I,s.tilePixelRatio),ze=$.get("text-max-angle")/180*Math.PI,Ve=$.get("text-rotation-alignment")!=="viewport"&&$.get("symbol-placement")!=="point",Le=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",Fe=$.get("symbol-placement"),qe=B/2,Ze=$.get("icon-text-fit");let We;a&&Ze!=="none"&&(s.allowVerticalPlacement&&n.vertical&&(We=Kv(a,n.vertical,Ze,$.get("icon-text-fit-padding"),V,Y)),G&&(a=Kv(a,G,Ze,$.get("icon-text-fit-padding"),V,Y)));const Oe=I?A.line.getGranularityForZoomLevel(I.z):1,it=(ut,ct)=>{ct.x<0||ct.x>=vt||ct.y<0||ct.y>=vt||function(ot,At,dr,Ar,ai,un,Fi,Qr,ar,$r,Jr,ei,Ci,hn,Vr,Bi,Rr,Ur,Zr,Mr,Jt,Wn,bc,Hn,_T){const wc=ot.addToLineVertexArray(At,dr);let tl,Tc,Sc,Cc,zx=0,Ax=0,Rx=0,Dx=0,bg=-1,wg=-1;const Hs={};let Lx=Si("");if(ot.allowVerticalPlacement&&Ar.vertical){const gi=Qr.layout.get("text-rotate").evaluate(Jt,{},Hn)+90;Sc=new Sp(ar,At,$r,Jr,ei,Ar.vertical,Ci,hn,Vr,gi),Fi&&(Cc=new Sp(ar,At,$r,Jr,ei,Fi,Rr,Ur,Vr,gi))}if(ai){const gi=Qr.layout.get("icon-rotate").evaluate(Jt,{}),dn=Qr.layout.get("icon-text-fit")!=="none",rl=wx(ai,gi,bc,dn),Yn=Fi?wx(Fi,gi,bc,dn):void 0;Tc=new Sp(ar,At,$r,Jr,ei,ai,Rr,Ur,!1,gi),zx=4*rl.length;const il=ot.iconSizeData;let bs=null;il.kind==="source"?(bs=[Ws*Qr.layout.get("icon-size").evaluate(Jt,{})],bs[0]>$o&&qr(`${ot.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):il.kind==="composite"&&(bs=[Ws*Wn.compositeIconSizes[0].evaluate(Jt,{},Hn),Ws*Wn.compositeIconSizes[1].evaluate(Jt,{},Hn)],(bs[0]>$o||bs[1]>$o)&&qr(`${ot.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ot.addSymbols(ot.icon,rl,bs,Mr,Zr,Jt,b.an.none,At,wc.lineStartIndex,wc.lineLength,-1,Hn),bg=ot.icon.placedSymbolArray.length-1,Yn&&(Ax=4*Yn.length,ot.addSymbols(ot.icon,Yn,bs,Mr,Zr,Jt,b.an.vertical,At,wc.lineStartIndex,wc.lineLength,-1,Hn),wg=ot.icon.placedSymbolArray.length-1)}const jx=Object.keys(Ar.horizontal);for(const gi of jx){const dn=Ar.horizontal[gi];if(!tl){Lx=Si(dn.text);const Yn=Qr.layout.get("text-rotate").evaluate(Jt,{},Hn);tl=new Sp(ar,At,$r,Jr,ei,dn,Ci,hn,Vr,Yn)}const rl=dn.positionedLines.length===1;if(Rx+=Px(ot,At,dn,un,Qr,Vr,Jt,Bi,wc,Ar.vertical?b.an.horizontal:b.an.horizontalOnly,rl?jx:[gi],Hs,bg,Wn,Hn),rl)break}Ar.vertical&&(Dx+=Px(ot,At,Ar.vertical,un,Qr,Vr,Jt,Bi,wc,b.an.vertical,["vertical"],Hs,wg,Wn,Hn));const yT=tl?tl.boxStartIndex:ot.collisionBoxArray.length,vT=tl?tl.boxEndIndex:ot.collisionBoxArray.length,xT=Sc?Sc.boxStartIndex:ot.collisionBoxArray.length,bT=Sc?Sc.boxEndIndex:ot.collisionBoxArray.length,wT=Tc?Tc.boxStartIndex:ot.collisionBoxArray.length,TT=Tc?Tc.boxEndIndex:ot.collisionBoxArray.length,ST=Cc?Cc.boxStartIndex:ot.collisionBoxArray.length,CT=Cc?Cc.boxEndIndex:ot.collisionBoxArray.length;let Xn=-1;const Pp=(gi,dn)=>gi&&gi.circleDiameter?Math.max(gi.circleDiameter,dn):dn;Xn=Pp(tl,Xn),Xn=Pp(Sc,Xn),Xn=Pp(Tc,Xn),Xn=Pp(Cc,Xn);const Fx=Xn>-1?1:0;Fx&&(Xn*=_T/Nr),ot.glyphOffsetArray.length>=yc.MAX_GLYPHS&&qr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jt.sortKey!==void 0&&ot.addToSortKeyRanges(ot.symbolInstances.length,Jt.sortKey);const PT=Cx(Qr,Jt,Hn),[MT,IT]=function(gi,dn){const rl=gi.length,Yn=dn==null?void 0:dn.values;if((Yn==null?void 0:Yn.length)>0)for(let il=0;il<Yn.length;il+=2){const bs=Yn[il+1];gi.emplaceBack(b.aD[Yn[il]],bs[0],bs[1])}return[rl,gi.length]}(ot.textAnchorOffsets,PT);ot.symbolInstances.emplaceBack(At.x,At.y,Hs.right>=0?Hs.right:-1,Hs.center>=0?Hs.center:-1,Hs.left>=0?Hs.left:-1,Hs.vertical||-1,bg,wg,Lx,yT,vT,xT,bT,wT,TT,ST,CT,$r,Rx,Dx,zx,Ax,Fx,0,Ci,Xn,MT,IT)}(s,ct,ut,n,a,h,We,s.layers[0],s.collisionBoxArray,t.index,t.sourceLayerIndex,s.index,ie,[X,X,X,X],Ve,T,ae,he,Le,V,t,m,P,I,g)};if(Fe==="line")for(const ut of gx(t.geometry,0,0,vt,vt)){const ct=Ja(ut,Oe),ot=uT(ct,B,ze,n.vertical||G,a,24,ye,s.overscaling,vt);for(const At of ot)G&&mT(s,G.text,qe,At)||it(ct,At)}else if(Fe==="line-center"){for(const ut of t.geometry)if(ut.length>1){const ct=Ja(ut,Oe),ot=cT(ct,ze,n.vertical||G,a,24,ye);ot&&it(ct,ot)}}else if(t.type==="Polygon")for(const ut of $l(t.geometry,0)){const ct=dT(ut,16);it(Ja(ut[0],Oe,!0),new Uo(ct.x,ct.y,0))}else if(t.type==="LineString")for(const ut of t.geometry){const ct=Ja(ut,Oe);it(ct,new Uo(ct[0].x,ct[0].y,0))}else if(t.type==="Point")for(const ut of t.geometry)for(const ct of ut)it([ct],new Uo(ct.x,ct.y,0))}function Px(s,t,n,a,h,m,g,v,T,P,I,A,j,$,V){const G=function(ye,ae,B,X,he,ze,Ve,Le){const Fe=X.layout.get("text-rotate").evaluate(ze,{})*Math.PI/180,qe=[];for(const Ze of ae.positionedLines)for(const We of Ze.positionedGlyphs){if(!We.rect)continue;const Oe=We.rect||{};let it=4,ut=!0,ct=1,ot=0;const At=(he||Le)&&We.vertical,dr=We.metrics.advance*We.scale/2;if(Le&&ae.verticalizable&&(ot=Ze.lineOffset/2-(We.imageName?-(Nr-We.metrics.width*We.scale)/2:(We.scale-1)*Nr)),We.imageName){const Ur=Ve[We.imageName];ut=Ur.sdf,ct=Ur.pixelRatio,it=1/ct}const Ar=he?[We.x+dr,We.y]:[0,0];let ai=he?[0,0]:[We.x+dr+B[0],We.y+B[1]-ot],un=[0,0];At&&(un=ai,ai=[0,0]);const Fi=We.metrics.isDoubleResolution?2:1,Qr=(We.metrics.left-it)*We.scale-dr+ai[0],ar=(-We.metrics.top-it)*We.scale+ai[1],$r=Qr+Oe.w/Fi*We.scale/ct,Jr=ar+Oe.h/Fi*We.scale/ct,ei=new ue(Qr,ar),Ci=new ue($r,ar),hn=new ue(Qr,Jr),Vr=new ue($r,Jr);if(At){const Ur=new ue(-dr,dr- -17),Zr=-Math.PI/2,Mr=12-dr,Jt=new ue(22-Mr,-(We.imageName?Mr:0)),Wn=new ue(...un);ei._rotateAround(Zr,Ur)._add(Jt)._add(Wn),Ci._rotateAround(Zr,Ur)._add(Jt)._add(Wn),hn._rotateAround(Zr,Ur)._add(Jt)._add(Wn),Vr._rotateAround(Zr,Ur)._add(Jt)._add(Wn)}if(Fe){const Ur=Math.sin(Fe),Zr=Math.cos(Fe),Mr=[Zr,-Ur,Ur,Zr];ei._matMult(Mr),Ci._matMult(Mr),hn._matMult(Mr),Vr._matMult(Mr)}const Bi=new ue(0,0),Rr=new ue(0,0);qe.push({tl:ei,tr:Ci,bl:hn,br:Vr,tex:Oe,writingMode:ae.writingMode,glyphOffset:Ar,sectionIndex:We.sectionIndex,isSDF:ut,pixelOffsetTL:Bi,pixelOffsetBR:Rr,minFontScaleX:0,minFontScaleY:0})}return qe}(0,n,v,h,m,g,a,s.allowVerticalPlacement),Y=s.textSizeData;let ie=null;Y.kind==="source"?(ie=[Ws*h.layout.get("text-size").evaluate(g,{})],ie[0]>$o&&qr(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Y.kind==="composite"&&(ie=[Ws*$.compositeTextSizes[0].evaluate(g,{},V),Ws*$.compositeTextSizes[1].evaluate(g,{},V)],(ie[0]>$o||ie[1]>$o)&&qr(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,G,ie,v,m,g,P,t,T.lineStartIndex,T.lineLength,j,V);for(const ye of I)A[ye]=s.text.placedSymbolArray.length-1;return 4*G.length}function Mx(s){for(const t in s)return s[t];return null}function mT(s,t,n,a){const h=s.compareText;if(t in h){const m=h[t];for(let g=m.length-1;g>=0;g--)if(a.dist(m[g])<n)return!0}else h[t]=[];return h[t].push(a),!1}const Ix=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class fg{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,a]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=Ix[15&a];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new fg(v,g,m,t)}constructor(t,n=64,a=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=a,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=Ix.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+T,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+T),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+T,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=t,this.coords[this._pos++]=n,a}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return mg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:v}=this,T=[0,m.length-1,0],P=[];for(;T.length;){const I=T.pop()||0,A=T.pop()||0,j=T.pop()||0;if(A-j<=v){for(let Y=j;Y<=A;Y++){const ie=g[2*Y],ye=g[2*Y+1];ie>=t&&ie<=a&&ye>=n&&ye<=h&&P.push(m[Y])}continue}const $=j+A>>1,V=g[2*$],G=g[2*$+1];V>=t&&V<=a&&G>=n&&G<=h&&P.push(m[$]),(I===0?t<=V:n<=G)&&(T.push(j),T.push($-1),T.push(1-I)),(I===0?a>=V:h>=G)&&(T.push($+1),T.push(A),T.push(1-I))}return P}within(t,n,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:g}=this,v=[0,h.length-1,0],T=[],P=a*a;for(;v.length;){const I=v.pop()||0,A=v.pop()||0,j=v.pop()||0;if(A-j<=g){for(let Y=j;Y<=A;Y++)kx(m[2*Y],m[2*Y+1],t,n)<=P&&T.push(h[Y]);continue}const $=j+A>>1,V=m[2*$],G=m[2*$+1];kx(V,G,t,n)<=P&&T.push(h[$]),(I===0?t-a<=V:n-a<=G)&&(v.push(j),v.push($-1),v.push(1-I)),(I===0?t+a>=V:n+a>=G)&&(v.push($+1),v.push(A),v.push(1-I))}return T}}function mg(s,t,n,a,h,m){if(h-a<=n)return;const g=a+h>>1;Ex(s,t,g,a,h,m),mg(s,t,n,a,g-1,1-m),mg(s,t,n,g+1,h,1-m)}function Ex(s,t,n,a,h,m){for(;h>a;){if(h-a>600){const P=h-a+1,I=n-a+1,A=Math.log(P),j=.5*Math.exp(2*A/3),$=.5*Math.sqrt(A*j*(P-j)/P)*(I-P/2<0?-1:1);Ex(s,t,n,Math.max(a,Math.floor(n-I*j/P+$)),Math.min(h,Math.floor(n+(P-I)*j/P+$)),m)}const g=t[2*n+m];let v=a,T=h;for(_h(s,t,a,n),t[2*h+m]>g&&_h(s,t,a,h);v<T;){for(_h(s,t,v,T),v++,T--;t[2*v+m]<g;)v++;for(;t[2*T+m]>g;)T--}t[2*a+m]===g?_h(s,t,a,T):(T++,_h(s,t,T,h)),T<=n&&(a=T+1),n<=T&&(h=T-1)}}function _h(s,t,n,a){gg(s,n,a),gg(t,2*n,2*a),gg(t,2*n+1,2*a+1)}function gg(s,t,n){const a=s[t];s[t]=s[n],s[n]=a}function kx(s,t,n,a){const h=s-n,m=t-a;return h*h+m*m}var _g;b.cw=void 0,(_g=b.cw||(b.cw={})).create="create",_g.load="load",_g.fullLoad="fullLoad";let Cp=null,yh=[];const yg=1e3/60,vg="loadTime",xg="fullLoadTime",gT={mark(s){performance.mark(s)},frame(s){const t=s;Cp!=null&&yh.push(t-Cp),Cp=t},clearMetrics(){Cp=null,yh=[],performance.clearMeasures(vg),performance.clearMeasures(xg);for(const s in b.cw)performance.clearMarks(b.cw[s])},getPerformanceMetrics(){performance.measure(vg,b.cw.create,b.cw.load),performance.measure(xg,b.cw.create,b.cw.fullLoad);const s=performance.getEntriesByName(vg)[0].duration,t=performance.getEntriesByName(xg)[0].duration,n=yh.length,a=1/(yh.reduce((m,g)=>m+g,0)/n/1e3),h=yh.filter(m=>m>yg).reduce((m,g)=>m+(g-yg)/yg,0);return{loadTime:s,fullLoadTime:t,fps:a,percentDroppedFrames:h/(n+h)*100,totalFrames:n}}};b.$=vt,b.A=Ce,b.B=function([s,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:s*Math.cos(t)*Math.sin(n),y:s*Math.sin(t)*Math.sin(n),z:s*Math.cos(n)}},b.C=Li,b.D=nt,b.E=$e,b.F=er,b.G=sc,b.H=function(s){if(ks==null){const t=s.navigator?s.navigator.userAgent:null;ks=!!s.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ks},b.I=tg,b.J=class{constructor(s,t){this.target=s,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new oT(()=>this.process()),this.subscription=Fn(this.target,"message",n=>this.receive(n),!1),this.globalScope=xi(self)?s:window}registerMessageHandler(s,t){this.messageHandlers[s]=t}sendAsync(s,t){return new Promise((n,a)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),m=t?Fn(t.signal,"abort",()=>{m==null||m.unsubscribe(),delete this.resolveRejects[h];const T={id:h,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)},aT):null;this.resolveRejects[h]={resolve:T=>{m==null||m.unsubscribe(),n(T)},reject:T=>{m==null||m.unsubscribe(),a(T)}};const g=[],v=Object.assign(Object.assign({},s),{id:h,sourceMapId:this.mapId,origin:location.origin,data:$a(s.data,g)});this.target.postMessage(v,{transfer:g})})}receive(s){const t=s.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const a=this.abortControllers[n];return delete this.abortControllers[n],void(a&&a.abort())}if(xi(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),t=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(s,t)}processTask(s,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[s];return delete this.resolveRejects[s],h?void(t.error?h.reject(Fo(t.error)):h.resolve(Fo(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Fo(t.data),a=new AbortController;this.abortControllers[s]=a;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,n,a);this.completeTask(s,null,h)}catch(h){this.completeTask(s,h)}})}completeTask(s,t,n){const a=[];delete this.abortControllers[s];const h={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?$a(t):null,data:$a(n,a)};this.target.postMessage(h,{transfer:a})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},b.K=J,b.L=function(){var s=new Ce(16);return Ce!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},b.M=function(s,t,n){var a,h,m,g,v,T,P,I,A,j,$,V,G=n[0],Y=n[1],ie=n[2];return t===s?(s[12]=t[0]*G+t[4]*Y+t[8]*ie+t[12],s[13]=t[1]*G+t[5]*Y+t[9]*ie+t[13],s[14]=t[2]*G+t[6]*Y+t[10]*ie+t[14],s[15]=t[3]*G+t[7]*Y+t[11]*ie+t[15]):(h=t[1],m=t[2],g=t[3],v=t[4],T=t[5],P=t[6],I=t[7],A=t[8],j=t[9],$=t[10],V=t[11],s[0]=a=t[0],s[1]=h,s[2]=m,s[3]=g,s[4]=v,s[5]=T,s[6]=P,s[7]=I,s[8]=A,s[9]=j,s[10]=$,s[11]=V,s[12]=a*G+v*Y+A*ie+t[12],s[13]=h*G+T*Y+j*ie+t[13],s[14]=m*G+P*Y+$*ie+t[14],s[15]=g*G+I*Y+V*ie+t[15]),s},b.N=function(s,t,n){var a=n[0],h=n[1],m=n[2];return s[0]=t[0]*a,s[1]=t[1]*a,s[2]=t[2]*a,s[3]=t[3]*a,s[4]=t[4]*h,s[5]=t[5]*h,s[6]=t[6]*h,s[7]=t[7]*h,s[8]=t[8]*m,s[9]=t[9]*m,s[10]=t[10]*m,s[11]=t[11]*m,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},b.O=function(s,t,n){var a=t[0],h=t[1],m=t[2],g=t[3],v=t[4],T=t[5],P=t[6],I=t[7],A=t[8],j=t[9],$=t[10],V=t[11],G=t[12],Y=t[13],ie=t[14],ye=t[15],ae=n[0],B=n[1],X=n[2],he=n[3];return s[0]=ae*a+B*v+X*A+he*G,s[1]=ae*h+B*T+X*j+he*Y,s[2]=ae*m+B*P+X*$+he*ie,s[3]=ae*g+B*I+X*V+he*ye,s[4]=(ae=n[4])*a+(B=n[5])*v+(X=n[6])*A+(he=n[7])*G,s[5]=ae*h+B*T+X*j+he*Y,s[6]=ae*m+B*P+X*$+he*ie,s[7]=ae*g+B*I+X*V+he*ye,s[8]=(ae=n[8])*a+(B=n[9])*v+(X=n[10])*A+(he=n[11])*G,s[9]=ae*h+B*T+X*j+he*Y,s[10]=ae*m+B*P+X*$+he*ie,s[11]=ae*g+B*I+X*V+he*ye,s[12]=(ae=n[12])*a+(B=n[13])*v+(X=n[14])*A+(he=n[15])*G,s[13]=ae*h+B*T+X*j+he*Y,s[14]=ae*m+B*P+X*$+he*ie,s[15]=ae*g+B*I+X*V+he*ye,s},b.P=ue,b.Q=function(s,t){const n={};for(let a=0;a<t.length;a++){const h=t[a];h in s&&(n[h]=s[h])}return n},b.R=ji,b.S=Vo,b.T=Nm,b.U=ax,b.V=ox,b.W=N,b.X=re,b.Y=zs,b.Z=cn,b._=c,b.a=q,b.a$=function(s,t,n){return s[0]=t[0]*n,s[1]=t[1]*n,s[2]=t[2]*n,s[3]=t[3]*n,s},b.a0=gh,b.a1=el,b.a2=25,b.a3=hg,b.a4=s=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const a of s){const h=window.document.createElement("source");Ae(a)||(t.crossOrigin="Anonymous"),h.src=a,t.appendChild(h)}})},b.a5=He,b.a6=function(){return ha++},b.a7=ee,b.a8=yc,b.a9=hs,b.aA=Nr,b.aB=ii,b.aC=function(s,t,n,a,h=!1){if(!n[0]&&!n[1])return[0,0];const m=h?a==="map"?-s.bearingInRadians:0:a==="viewport"?s.bearingInRadians:0;if(m){const g=Math.sin(m),v=Math.cos(m);n=[n[0]*v-n[1]*g,n[0]*g+n[1]*v]}return[h?n[0]:ii(t,n[0],s.zoom),h?n[1]:ii(t,n[1],s.zoom)]},b.aE=ng,b.aF=pg,b.aG=ig,b.aH=fg,b.aI=hr,b.aJ=fp,b.aK=Ee,b.aL=Lt,b.aM=Ht,b.aN=ua,b.aO=wn,b.aP=cx,b.aQ=Lr,b.aR=yr,b.aS=function(s){var t=new Ce(3);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t},b.aT=function(s,t,n){return s[0]=t[0]-n[0],s[1]=t[1]-n[1],s[2]=t[2]-n[2],s},b.aU=function(s,t){var n=t[0],a=t[1],h=t[2],m=n*n+a*a+h*h;return m>0&&(m=1/Math.sqrt(m)),s[0]=t[0]*m,s[1]=t[1]*m,s[2]=t[2]*m,s},b.aV=vn,b.aW=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]},b.aX=function(s,t,n){return s[0]=t[0]*n[0],s[1]=t[1]*n[1],s[2]=t[2]*n[2],s[3]=t[3]*n[3],s},b.aY=dt,b.aZ=function(s,t,n){const a=t[0]*n[0]+t[1]*n[1]+t[2]*n[2];return a===0?null:(-(s[0]*n[0]+s[1]*n[1]+s[2]*n[2])-n[3])/a},b.a_=xn,b.aa=Ka,b.ab=px,b.ac=function(s){const t={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,a,h,m)=>{const g=h||m;return t[a]=!g||g.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},b.ad=Ai,b.ae=function(s){return Math.pow(2,s)},b.af=Ge,b.ag=kr,b.ah=85.051129,b.ai=lx,b.aj=function(s){return Math.log(s)/Math.LN2},b.ak=function(s){var t=s[0],n=s[1];return t*t+n*n},b.al=function(s,t){const n=[];for(const a in s)a in t||n.push(a);return n},b.am=function(s,t){let n=0,a=0;if(s.kind==="constant")a=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:g}=s,v=h?kr(di.interpolationFactor(h,t,m,g),0,1):0;s.kind==="camera"?a=Li.number(s.minSize,s.maxSize,v):n=v}return{uSizeT:n,uSize:a}},b.ao=function(s,{uSize:t,uSizeT:n},{lowerSize:a,upperSize:h}){return s.kind==="source"?a/Ws:s.kind==="composite"?Li.number(a/Ws,h/Ws,n):t},b.ap=function(s,t){var n=t[0],a=t[1],h=t[2],m=t[3],g=t[4],v=t[5],T=t[6],P=t[7],I=t[8],A=t[9],j=t[10],$=t[11],V=t[12],G=t[13],Y=t[14],ie=t[15],ye=n*v-a*g,ae=n*T-h*g,B=n*P-m*g,X=a*T-h*v,he=a*P-m*v,ze=h*P-m*T,Ve=I*G-A*V,Le=I*Y-j*V,Fe=I*ie-$*V,qe=A*Y-j*G,Ze=A*ie-$*G,We=j*ie-$*Y,Oe=ye*We-ae*Ze+B*qe+X*Fe-he*Le+ze*Ve;return Oe?(s[0]=(v*We-T*Ze+P*qe)*(Oe=1/Oe),s[1]=(h*Ze-a*We-m*qe)*Oe,s[2]=(G*ze-Y*he+ie*X)*Oe,s[3]=(j*he-A*ze-$*X)*Oe,s[4]=(T*Fe-g*We-P*Le)*Oe,s[5]=(n*We-h*Fe+m*Le)*Oe,s[6]=(Y*B-V*ze-ie*ae)*Oe,s[7]=(I*ze-j*B+$*ae)*Oe,s[8]=(g*Ze-v*Fe+P*Ve)*Oe,s[9]=(a*Fe-n*Ze-m*Ve)*Oe,s[10]=(V*he-G*B+ie*ye)*Oe,s[11]=(A*B-I*he-$*ye)*Oe,s[12]=(v*Le-g*qe-T*Ve)*Oe,s[13]=(n*qe-a*Le+h*Ve)*Oe,s[14]=(G*ae-V*X-Y*ye)*Oe,s[15]=(I*X-A*ae+j*ye)*Oe,s):null},b.aq=wt,b.ar=function(s){return Math.hypot(s[0],s[1])},b.as=function(s){return s[0]=0,s[1]=0,s},b.at=function(s,t,n){return s[0]=t[0]*n,s[1]=t[1]*n,s},b.au=sg,b.av=rn,b.aw=function(s,t,n,a){const h=t.y-s.y,m=t.x-s.x,g=a.y-n.y,v=a.x-n.x,T=g*m-v*h;if(T===0)return null;const P=(v*(s.y-n.y)-g*(s.x-n.x))/T;return new ue(s.x+P*m,s.y+P*h)},b.ax=gx,b.ay=ev,b.az=function(s){let t=1/0,n=1/0,a=-1/0,h=-1/0;for(const m of s)t=Math.min(t,m.x),n=Math.min(n,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return[t,n,a,h]},b.b=as,b.b$=F2,b.b0=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]+s[3]},b.b1=hx,b.b2=vc,b.b3=function(s,t,n,a,h){var m,g=1/Math.tan(t/2);return s[0]=g/n,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=g,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,h!=null&&h!==1/0?(s[10]=(h+a)*(m=1/(a-h)),s[14]=2*h*a*m):(s[10]=-1,s[14]=-2*a),s},b.b4=function(s){var t=new Ce(16);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],t},b.b5=function(s,t,n){var a=Math.sin(n),h=Math.cos(n),m=t[0],g=t[1],v=t[2],T=t[3],P=t[4],I=t[5],A=t[6],j=t[7];return t!==s&&(s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=m*h+P*a,s[1]=g*h+I*a,s[2]=v*h+A*a,s[3]=T*h+j*a,s[4]=P*h-m*a,s[5]=I*h-g*a,s[6]=A*h-v*a,s[7]=j*h-T*a,s},b.b6=function(s,t,n){var a=Math.sin(n),h=Math.cos(n),m=t[4],g=t[5],v=t[6],T=t[7],P=t[8],I=t[9],A=t[10],j=t[11];return t!==s&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[4]=m*h+P*a,s[5]=g*h+I*a,s[6]=v*h+A*a,s[7]=T*h+j*a,s[8]=P*h-m*a,s[9]=I*h-g*a,s[10]=A*h-v*a,s[11]=j*h-T*a,s},b.b7=function(){const s=new Float32Array(16);return Ge(s),s},b.b8=function(){const s=new Float64Array(16);return Ge(s),s},b.b9=function(){return new Float64Array(16)},b.bA=function(s){return s[0]=0,s[1]=0,s[2]=0,s},b.bB=function(s,t,n,a){const h=Math.sqrt(s*s+t*t),m=Math.sqrt(n*n+a*a);s/=h,t/=h,n/=m,a/=m;const g=Math.acos(s*n+t*a);return-t*n+s*a>0?g:-g},b.bC=function(s,t){const n=Er(s,2*Math.PI),a=Er(t,2*Math.PI);return Math.min(Math.abs(n-a),Math.abs(n-a+2*Math.PI),Math.abs(n-a-2*Math.PI))},b.bD=function(){const s={},t=me.$version;for(const n in me.$root){const a=me.$root[n];if(a.required){let h=null;h=n==="version"?t:a.type==="array"?[]:{},h!=null&&(s[n]=h)}}return s},b.bE=Uu,b.bF=_e,b.bG=function s(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(!s(t[a],n[a]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(!s(t[a],n[a]))return!1;return!0}return t===n},b.bH=function(s){s=s.slice();const t=Object.create(null);for(let n=0;n<s.length;n++)t[s[n].id]=s[n];for(let n=0;n<s.length;n++)"ref"in s[n]&&(s[n]=ft(s[n],t[s[n].ref]));return s},b.bI=function(s){if(s.type==="custom")return new sT(s);switch(s.type){case"background":return new rT(s);case"circle":return new Yw(s);case"color-relief":return new r2(s);case"fill":return new _2(s);case"fill-extrusion":return new C2(s);case"heatmap":return new Qw(s);case"hillshade":return new e2(s);case"line":return new R2(s);case"raster":return new nT(s);case"symbol":return new xp(s)}},b.bJ=Gi,b.bK=function(s,t){if(!s)return[{command:"setStyle",args:[t]}];let n=[];try{if(!tt(s.version,t.version))return[{command:"setStyle",args:[t]}];tt(s.center,t.center)||n.push({command:"setCenter",args:[t.center]}),tt(s.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),tt(s.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),tt(s.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),tt(s.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),tt(s.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),tt(s.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),tt(s.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),tt(s.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),tt(s.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),tt(s.light,t.light)||n.push({command:"setLight",args:[t.light]}),tt(s.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),tt(s.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),tt(s.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const a={},h=[];(function(g,v,T,P){let I;for(I in v=v||{},g=g||{})Object.prototype.hasOwnProperty.call(g,I)&&(Object.prototype.hasOwnProperty.call(v,I)||Yt(I,T,P));for(I in v)Object.prototype.hasOwnProperty.call(v,I)&&(Object.prototype.hasOwnProperty.call(g,I)?tt(g[I],v[I])||(g[I].type==="geojson"&&v[I].type==="geojson"&&Ot(g,v,I)?lt(T,{command:"setGeoJSONSourceData",args:[I,v[I].data]}):Ut(I,v,T,P)):yt(I,v,T))})(s.sources,t.sources,h,a);const m=[];s.layers&&s.layers.forEach(g=>{"source"in g&&a[g.source]?n.push({command:"removeLayer",args:[g.id]}):m.push(g)}),n=n.concat(h),function(g,v,T){v=v||[];const P=(g=g||[]).map(Rt),I=v.map(Rt),A=g.reduce(jr,{}),j=v.reduce(jr,{}),$=P.slice(),V=Object.create(null);let G,Y,ie,ye,ae;for(let B=0,X=0;B<P.length;B++)G=P[B],Object.prototype.hasOwnProperty.call(j,G)?X++:(lt(T,{command:"removeLayer",args:[G]}),$.splice($.indexOf(G,X),1));for(let B=0,X=0;B<I.length;B++)G=I[I.length-1-B],$[$.length-1-B]!==G&&(Object.prototype.hasOwnProperty.call(A,G)?(lt(T,{command:"removeLayer",args:[G]}),$.splice($.lastIndexOf(G,$.length-X),1)):X++,ye=$[$.length-B],lt(T,{command:"addLayer",args:[j[G],ye]}),$.splice($.length-B,0,G),V[G]=!0);for(let B=0;B<I.length;B++)if(G=I[B],Y=A[G],ie=j[G],!V[G]&&!tt(Y,ie))if(tt(Y.source,ie.source)&&tt(Y["source-layer"],ie["source-layer"])&&tt(Y.type,ie.type)){for(ae in gt(Y.layout,ie.layout,T,G,null,"setLayoutProperty"),gt(Y.paint,ie.paint,T,G,null,"setPaintProperty"),tt(Y.filter,ie.filter)||lt(T,{command:"setFilter",args:[G,ie.filter]}),tt(Y.minzoom,ie.minzoom)&&tt(Y.maxzoom,ie.maxzoom)||lt(T,{command:"setLayerZoomRange",args:[G,ie.minzoom,ie.maxzoom]}),Y)Object.prototype.hasOwnProperty.call(Y,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?gt(Y[ae],ie[ae],T,G,ae.slice(6),"setPaintProperty"):tt(Y[ae],ie[ae])||lt(T,{command:"setLayerProperty",args:[G,ae,ie[ae]]}));for(ae in ie)Object.prototype.hasOwnProperty.call(ie,ae)&&!Object.prototype.hasOwnProperty.call(Y,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?gt(Y[ae],ie[ae],T,G,ae.slice(6),"setPaintProperty"):tt(Y[ae],ie[ae])||lt(T,{command:"setLayerProperty",args:[G,ae,ie[ae]]}))}else lt(T,{command:"removeLayer",args:[G]}),ye=$[$.lastIndexOf(G)+1],lt(T,{command:"addLayer",args:[ie,ye]})}(m,t.layers,n)}catch(a){console.warn("Unable to compute style diff:",a),n=[{command:"setStyle",args:[t]}]}return n},b.bL=function(s){const t=[],n=s.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),s.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},b.bM=cr,b.bN=bn,b.bO=class extends Qt{constructor(s,t){super(s,t),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},b.bP=cp,b.bQ=class extends Qt{constructor(s,t){super(s,t),this.current=Rm}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let t=1;t<16;t++)if(s[t]!==this.current[t]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},b.bR=zr,b.bS=class extends Qt{constructor(s,t){super(s,t),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},b.bT=class extends Qt{constructor(s,t){super(s,t),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},b.bU=Ne,b.bV=function(s,t){var n=Math.sin(t),a=Math.cos(t);return s[0]=a,s[1]=n,s[2]=0,s[3]=-n,s[4]=a,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},b.bW=function(s,t,n){var a=t[0],h=t[1],m=t[2];return s[0]=a*n[0]+h*n[3]+m*n[6],s[1]=a*n[1]+h*n[4]+m*n[7],s[2]=a*n[2]+h*n[5]+m*n[8],s},b.bX=function(s,t,n,a,h,m,g){var v=1/(t-n),T=1/(a-h),P=1/(m-g);return s[0]=-2*v,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*T,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(t+n)*v,s[13]=(h+a)*T,s[14]=(g+m)*P,s[15]=1,s},b.bY=class extends Qt{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(4*s.length);for(let n=0;n<s.length;n++)t[4*n]=s[n].r,t[4*n+1]=s[n].g,t[4*n+2]=s[n].b,t[4*n+3]=s[n].a;this.gl.uniform4fv(this.location,t)}}},b.bZ=class extends Qt{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(s);this.gl.uniform1fv(this.location,t)}}},b.b_=class extends l{},b.ba=function(s,t,n){const a=new Float64Array(4);return xt(a,s,t-90,n),a},b.bb=function(s,t,n,a){var h,m,g,v,T,P=t[0],I=t[1],A=t[2],j=t[3],$=n[0],V=n[1],G=n[2],Y=n[3];return(m=P*$+I*V+A*G+j*Y)<0&&(m=-m,$=-$,V=-V,G=-G,Y=-Y),1-m>Te?(h=Math.acos(m),g=Math.sin(h),v=Math.sin((1-a)*h)/g,T=Math.sin(a*h)/g):(v=1-a,T=a),s[0]=v*P+T*$,s[1]=v*I+T*V,s[2]=v*A+T*G,s[3]=v*j+T*Y,s},b.bc=function(s){const t=new Float64Array(9);var n,a,h,m,g,v,T,P,I,A,j,$,V,G,Y,ie,ye,ae;A=(h=(a=s)[0])*(T=h+h),j=(m=a[1])*T,V=(g=a[2])*T,G=g*(P=m+m),ie=(v=a[3])*T,ye=v*P,ae=v*(I=g+g),(n=t)[0]=1-($=m*P)-(Y=g*I),n[3]=j-ae,n[6]=V+ye,n[1]=j+ae,n[4]=1-A-Y,n[7]=G-ie,n[2]=V-ye,n[5]=G+ie,n[8]=1-A-$;const B=wn(-Math.asin(kr(t[2],-1,1)));let X,he;return Math.hypot(t[5],t[8])<.001?(X=0,he=-wn(Math.atan2(t[3],t[4]))):(X=wn(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),he=wn(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:X,pitch:B+90,bearing:he}},b.bd=function(s,t){return s.roll==t.roll&&s.pitch==t.pitch&&s.bearing==t.bearing},b.be=Et,b.bf=mi,b.bg=gc,b.bh=ch,b.bi=mc,b.bj=Zi,b.bk=ui,b.bl=bt,b.bm=function(s,t,n,a,h){return Zi(a,h,kr((s-t)/(n-t),0,1))},b.bn=Er,b.bo=function(){return new Float64Array(3)},b.bp=function(s,t,n,a){return s[0]=t[0]+n[0]*a,s[1]=t[1]+n[1]*a,s[2]=t[2]+n[2]*a,s},b.bq=xt,b.br=function(s,t,n){var a=n[0],h=n[1],m=n[2],g=t[0],v=t[1],T=t[2],P=h*T-m*v,I=m*g-a*T,A=a*v-h*g,j=h*A-m*I,$=m*P-a*A,V=a*I-h*P,G=2*n[3];return I*=G,A*=G,$*=2,V*=2,s[0]=g+(P*=G)+(j*=2),s[1]=v+I+$,s[2]=T+A+V,s},b.bs=function(s,t,n){const a=(h=[s[0],s[1],s[2],t[0],t[1],t[2],n[0],n[1],n[2]])[0]*((I=h[8])*(g=h[4])-(v=h[5])*(P=h[7]))+h[1]*(-I*(m=h[3])+v*(T=h[6]))+h[2]*(P*m-g*T);var h,m,g,v,T,P,I;if(a===0)return null;const A=vn([],[t[0],t[1],t[2]],[n[0],n[1],n[2]]),j=vn([],[n[0],n[1],n[2]],[s[0],s[1],s[2]]),$=vn([],[s[0],s[1],s[2]],[t[0],t[1],t[2]]),V=Lr([],A,-s[3]);return yr(V,V,Lr([],j,-t[3])),yr(V,V,Lr([],$,-n[3])),Lr(V,V,1/a),V},b.bt=cg,b.bu=function(){return new Float64Array(4)},b.bv=function(s,t,n,a){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[0]*Math.cos(a)-h[1]*Math.sin(a),m[1]=h[0]*Math.sin(a)+h[1]*Math.cos(a),m[2]=h[2],s[0]=m[0]+n[0],s[1]=m[1]+n[1],s[2]=m[2]+n[2],s},b.bw=function(s,t,n,a){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[0],m[1]=h[1]*Math.cos(a)-h[2]*Math.sin(a),m[2]=h[1]*Math.sin(a)+h[2]*Math.cos(a),s[0]=m[0]+n[0],s[1]=m[1]+n[1],s[2]=m[2]+n[2],s},b.bx=function(s,t,n,a){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[2]*Math.sin(a)+h[0]*Math.cos(a),m[1]=h[1],m[2]=h[2]*Math.cos(a)-h[0]*Math.sin(a),s[0]=m[0]+n[0],s[1]=m[1]+n[1],s[2]=m[2]+n[2],s},b.by=function(s,t,n){var a=Math.sin(n),h=Math.cos(n),m=t[0],g=t[1],v=t[2],T=t[3],P=t[8],I=t[9],A=t[10],j=t[11];return t!==s&&(s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=m*h-P*a,s[1]=g*h-I*a,s[2]=v*h-A*a,s[3]=T*h-j*a,s[8]=m*a+P*h,s[9]=g*a+I*h,s[10]=v*a+A*h,s[11]=T*a+j*h,s},b.bz=function(s,t){const n=Er(s,360),a=Er(t,360),h=a-n,m=a>n?h-360:h+360;return Math.abs(h)<Math.abs(m)?h:m},b.c=Se,b.c0=class extends f{},b.c1=Om,b.c2=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},b.c3=uv,b.c4=function(s,t,n){var a=t[0],h=t[1],m=t[2],g=n[3]*a+n[7]*h+n[11]*m+n[15];return s[0]=(n[0]*a+n[4]*h+n[8]*m+n[12])/(g=g||1),s[1]=(n[1]*a+n[5]*h+n[9]*m+n[13])/g,s[2]=(n[2]*a+n[6]*h+n[10]*m+n[14])/g,s},b.c5=class extends Yu{},b.c6=class extends D{},b.c7=function(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]&&s[3]===t[3]&&s[4]===t[4]&&s[5]===t[5]&&s[6]===t[6]&&s[7]===t[7]&&s[8]===t[8]&&s[9]===t[9]&&s[10]===t[10]&&s[11]===t[11]&&s[12]===t[12]&&s[13]===t[13]&&s[14]===t[14]&&s[15]===t[15]},b.c8=function(s,t){var n=s[0],a=s[1],h=s[2],m=s[3],g=s[4],v=s[5],T=s[6],P=s[7],I=s[8],A=s[9],j=s[10],$=s[11],V=s[12],G=s[13],Y=s[14],ie=s[15],ye=t[0],ae=t[1],B=t[2],X=t[3],he=t[4],ze=t[5],Ve=t[6],Le=t[7],Fe=t[8],qe=t[9],Ze=t[10],We=t[11],Oe=t[12],it=t[13],ut=t[14],ct=t[15];return Math.abs(n-ye)<=Te*Math.max(1,Math.abs(n),Math.abs(ye))&&Math.abs(a-ae)<=Te*Math.max(1,Math.abs(a),Math.abs(ae))&&Math.abs(h-B)<=Te*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(m-X)<=Te*Math.max(1,Math.abs(m),Math.abs(X))&&Math.abs(g-he)<=Te*Math.max(1,Math.abs(g),Math.abs(he))&&Math.abs(v-ze)<=Te*Math.max(1,Math.abs(v),Math.abs(ze))&&Math.abs(T-Ve)<=Te*Math.max(1,Math.abs(T),Math.abs(Ve))&&Math.abs(P-Le)<=Te*Math.max(1,Math.abs(P),Math.abs(Le))&&Math.abs(I-Fe)<=Te*Math.max(1,Math.abs(I),Math.abs(Fe))&&Math.abs(A-qe)<=Te*Math.max(1,Math.abs(A),Math.abs(qe))&&Math.abs(j-Ze)<=Te*Math.max(1,Math.abs(j),Math.abs(Ze))&&Math.abs($-We)<=Te*Math.max(1,Math.abs($),Math.abs(We))&&Math.abs(V-Oe)<=Te*Math.max(1,Math.abs(V),Math.abs(Oe))&&Math.abs(G-it)<=Te*Math.max(1,Math.abs(G),Math.abs(it))&&Math.abs(Y-ut)<=Te*Math.max(1,Math.abs(Y),Math.abs(ut))&&Math.abs(ie-ct)<=Te*Math.max(1,Math.abs(ie),Math.abs(ct))},b.c9=function(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},b.cA=function(s){delete q.REGISTERED_PROTOCOLS[s]},b.cB=function(s,t){const n={};for(let h=0;h<s.length;h++){const m=t&&t[s[h].id]||ec(s[h]);t&&(t[s[h].id]=m);let g=n[m];g||(g=n[m]=[]),g.push(s[h])}const a=[];for(const h in n)a.push(n[h]);return a},b.cC=et,b.cD=dx,b.cE=fx,b.cF=Zv,b.cG=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=vt/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const t=s.bucket.layers[0],n=t.layout,a=t._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new er(s.bucket.zoom+1),s.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new er(s.bucket.zoom+1),s.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new er(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:I}=s.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new er(P),s.canonical),a["text-size"].possiblyEvaluate(new er(I),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:I}=s.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new er(P),s.canonical),a["icon-size"].possiblyEvaluate(new er(I),s.canonical)]}const m=n.get("text-line-height")*Nr,g=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",v=n.get("text-keep-upright"),T=n.get("text-size");for(const P of s.bucket.features){const I=n.get("text-font").evaluate(P,{},s.canonical).join(","),A=T.evaluate(P,{},s.canonical),j=h.layoutTextSize.evaluate(P,{},s.canonical),$=h.layoutIconSize.evaluate(P,{},s.canonical),V={horizontal:{},vertical:void 0},G=P.text;let Y,ie=[0,0];if(G){const B=G.toString(),X=n.get("text-letter-spacing").evaluate(P,{},s.canonical)*Nr,he=rp(B)?X:0,ze=n.get("text-anchor").evaluate(P,{},s.canonical),Ve=Cx(t,P,s.canonical);if(!Ve){const Ze=n.get("text-radial-offset").evaluate(P,{},s.canonical);ie=Ze?Sx(ze,[Ze*Nr,dg]):n.get("text-offset").evaluate(P,{},s.canonical).map(We=>We*Nr)}let Le=g?"center":n.get("text-justify").evaluate(P,{},s.canonical);const Fe=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(P,{},s.canonical)*Nr:1/0,qe=()=>{s.bucket.allowVerticalPlacement&&Zu(B)&&(V.vertical=_p(G,s.glyphMap,s.glyphPositions,s.imagePositions,I,Fe,m,ze,"left",he,ie,b.an.vertical,!0,j,A))};if(!g&&Ve){const Ze=new Set;if(Le==="auto")for(let Oe=0;Oe<Ve.values.length;Oe+=2)Ze.add(pg(Ve.values[Oe]));else Ze.add(Le);let We=!1;for(const Oe of Ze)if(!V.horizontal[Oe])if(We)V.horizontal[Oe]=V.horizontal[0];else{const it=_p(G,s.glyphMap,s.glyphPositions,s.imagePositions,I,Fe,m,"center",Oe,he,ie,b.an.horizontal,!1,j,A);it&&(V.horizontal[Oe]=it,We=it.positionedLines.length===1)}qe()}else{Le==="auto"&&(Le=pg(ze));const Ze=_p(G,s.glyphMap,s.glyphPositions,s.imagePositions,I,Fe,m,ze,Le,he,ie,b.an.horizontal,!1,j,A);Ze&&(V.horizontal[Le]=Ze),qe(),Zu(B)&&g&&v&&(V.vertical=_p(G,s.glyphMap,s.glyphPositions,s.imagePositions,I,Fe,m,ze,Le,he,ie,b.an.vertical,!1,j,A))}}let ye=!1;if(P.icon&&P.icon.name){const B=s.imageMap[P.icon.name];B&&(Y=K2(s.imagePositions[P.icon.name],n.get("icon-offset").evaluate(P,{},s.canonical),n.get("icon-anchor").evaluate(P,{},s.canonical)),ye=!!B.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ye:s.bucket.sdfIcons!==ye&&qr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(B.pixelRatio!==s.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ae=Mx(V.horizontal)||V.vertical;s.bucket.iconsInText=!!ae&&ae.iconsInText,(ae||Y)&&fT(s.bucket,P,V,Y,s.imageMap,h,j,$,ie,ye,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},b.cH=Km,b.cI=Gm,b.cJ=Ym,b.cK=hh,b.cL=eg,b.cM=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},b.cN=function(s,t,n,a,h){return c(this,void 0,void 0,function*(){if(re())try{return yield zs(s,t,n,a,h)}catch{}return function(m,g,v,T,P){const I=m.width,A=m.height;jn&&As||(jn=new OffscreenCanvas(I,A),As=jn.getContext("2d",{willReadFrequently:!0})),jn.width=I,jn.height=A,As.drawImage(m,0,0,I,A);const j=As.getImageData(g,v,T,P);return As.clearRect(0,0,I,A),j.data}(s,t,n,a,h)})},b.cO=pv,b.cP=Z,b.cQ=be,b.cR=kv,b.cS=Vv,b.cT=Yl,b.cU=ps,b.ca=s=>s.type==="symbol",b.cb=s=>s.type==="circle",b.cc=s=>s.type==="heatmap",b.cd=s=>s.type==="line",b.ce=s=>s.type==="fill",b.cf=s=>s.type==="fill-extrusion",b.cg=s=>s.type==="hillshade",b.ch=s=>s.type==="color-relief",b.ci=s=>s.type==="raster",b.cj=s=>s.type==="background",b.ck=s=>s.type==="custom",b.cl=nn,b.cm=function(s,t,n){const a=Ft(t.x-n.x,t.y-n.y),h=Ft(s.x-n.x,s.y-n.y);var m,g;return wn(Math.atan2(a[0]*h[1]-a[1]*h[0],(m=a)[0]*(g=h)[0]+m[1]*g[1]))},b.cn=Il,b.co=function(s,t){return El[t]&&(s instanceof MouseEvent||s instanceof WheelEvent)},b.cp=function(s,t){return pa[t]&&"touches"in s},b.cq=function(s){return pa[s]||El[s]},b.cr=function(s,t,n){var a=t[0],h=t[1];return s[0]=n[0]*a+n[4]*h+n[12],s[1]=n[1]*a+n[5]*h+n[13],s},b.cs=function(s,t){const{x:n,y:a}=gh.fromLngLat(t);return!(s<0||s>25||a<0||a>=1||n<0||n>=1)},b.ct=function(s,t){return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},b.cu=class extends ms{},b.cv=gT,b.cx=function(s){return s.message===Bn},b.cy=le,b.cz=function(s,t){q.REGISTERED_PROTOCOLS[s]=t},b.d=Ae,b.e=ki,b.f=s=>c(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),b.g=W,b.h=s=>new Promise((t,n)=>{const a=new Image;a.onload=()=>{t(a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=da})},a.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(s)],{type:"image/png"});a.src=s.byteLength?URL.createObjectURL(h):da}),b.i=xi,b.j=(s,t)=>we(ki(s,{type:"json"}),t),b.k=Me,b.l=je,b.m=we,b.n=(s,t)=>we(ki(s,{type:"arrayBuffer"}),t),b.o=function(s){return new eg(s).readFields(N2,[])},b.p=Uv,b.q=nh,b.r=fi,b.s=Fn,b.t=Hu,b.u=zt,b.v=me,b.w=qr,b.x=Mm,b.y=Oa,b.z=Lo}),x("worker",["./shared"],function(b){class c{constructor(q){this.keyCache={},q&&this.replace(q)}replace(q){this._layerConfigs={},this._layers={},this.update(q,[])}update(q,W){for(const le of q){this._layerConfigs[le.id]=le;const _e=this._layers[le.id]=b.bI(le);_e._featureFilter=b.a9(_e.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of W)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const J=b.cB(Object.values(this._layerConfigs),this.keyCache);for(const le of J){const _e=le.map(Me=>this._layers[Me.id]),we=_e[0];if(we.visibility==="none")continue;const Ae=we.source||"";let xe=this.familiesBySource[Ae];xe||(xe=this.familiesBySource[Ae]={});const Be=we.sourceLayer||"_geojsonTileLayer";let je=xe[Be];je||(je=xe[Be]=[]),je.push(_e)}}}class Z{constructor(q){const W={},J=[];for(const Ae in q){const xe=q[Ae],Be=W[Ae]={};for(const je in xe){const Me=xe[+je];if(!Me||Me.bitmap.width===0||Me.bitmap.height===0)continue;const $e={x:0,y:0,w:Me.bitmap.width+2,h:Me.bitmap.height+2};J.push($e),Be[je]={rect:$e,metrics:Me.metrics}}}const{w:le,h:_e}=b.p(J),we=new b.q({width:le||1,height:_e||1});for(const Ae in q){const xe=q[Ae];for(const Be in xe){const je=xe[+Be];if(!je||je.bitmap.width===0||je.bitmap.height===0)continue;const Me=W[Ae][Be].rect;b.q.copy(je.bitmap,we,{x:0,y:0},{x:Me.x+1,y:Me.y+1},je.bitmap)}}this.image=we,this.positions=W}}b.cC("GlyphAtlas",Z);class K{constructor(q){this.tileID=new b.Z(q.tileID.overscaledZ,q.tileID.wrap,q.tileID.canonical.z,q.tileID.canonical.x,q.tileID.canonical.y),this.uid=q.uid,this.zoom=q.zoom,this.pixelRatio=q.pixelRatio,this.tileSize=q.tileSize,this.source=q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=q.showCollisionBoxes,this.collectResourceTiming=!!q.collectResourceTiming,this.returnDependencies=!!q.returnDependencies,this.promoteId=q.promoteId,this.inFlightDependencies=[],this.globalState=q.globalState}parse(q,W,J,le,_e){return b._(this,void 0,void 0,function*(){this.status="parsing",this.data=q,this.collisionBoxArray=new b.a7;const we=new b.cD(Object.keys(q.layers).sort()),Ae=new b.cE(this.tileID,this.promoteId);Ae.bucketLayerIDs=[];const xe={},Be={featureIndex:Ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:J,subdivisionGranularity:_e},je=W.familiesBySource[this.source];for(const gt in je){const Rt=q.layers[gt];if(!Rt)continue;Rt.version===1&&b.w(`Vector tile source "${this.source}" layer "${gt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const jr=we.encode(gt),He=[];for(let Wr=0;Wr<Rt.length;Wr++){const tr=Rt.feature(Wr),ls=Ae.getId(tr,gt);He.push({feature:tr,id:ls,index:Wr,sourceLayerIndex:jr})}for(const Wr of je[gt]){const tr=Wr[0];tr.source!==this.source&&b.w(`layer.source = ${tr.source} does not equal this.source = ${this.source}`),tr.minzoom&&this.zoom<Math.floor(tr.minzoom)||tr.maxzoom&&this.zoom>=tr.maxzoom||tr.visibility!=="none"&&(ge(Wr,this.zoom,J),(xe[tr.id]=tr.createBucket({index:Ae.bucketLayerIDs.length,layers:Wr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:jr,sourceID:this.source,globalState:this.globalState})).populate(He,Be,this.tileID.canonical),Ae.bucketLayerIDs.push(Wr.map(ls=>ls.id)))}}const Me=b.bM(Be.glyphDependencies,gt=>Object.keys(gt).map(Number));this.inFlightDependencies.forEach(gt=>gt==null?void 0:gt.abort()),this.inFlightDependencies=[];let $e=Promise.resolve({});if(Object.keys(Me).length){const gt=new AbortController;this.inFlightDependencies.push(gt),$e=le.sendAsync({type:"GG",data:{stacks:Me,source:this.source,tileID:this.tileID,type:"glyphs"}},gt)}const me=Object.keys(Be.iconDependencies);let Je=Promise.resolve({});if(me.length){const gt=new AbortController;this.inFlightDependencies.push(gt),Je=le.sendAsync({type:"GI",data:{icons:me,source:this.source,tileID:this.tileID,type:"icons"}},gt)}const ft=Object.keys(Be.patternDependencies);let tt=Promise.resolve({});if(ft.length){const gt=new AbortController;this.inFlightDependencies.push(gt),tt=le.sendAsync({type:"GI",data:{icons:ft,source:this.source,tileID:this.tileID,type:"patterns"}},gt)}const[lt,yt,Yt]=yield Promise.all([$e,Je,tt]),Ut=new Z(lt),Ot=new b.cF(yt,Yt);for(const gt in xe){const Rt=xe[gt];Rt instanceof b.a8?(ge(Rt.layers,this.zoom,J),b.cG({bucket:Rt,glyphMap:lt,glyphPositions:Ut.positions,imageMap:yt,imagePositions:Ot.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Be.subdivisionGranularity})):Rt.hasPattern&&(Rt instanceof b.cH||Rt instanceof b.cI||Rt instanceof b.cJ)&&(ge(Rt.layers,this.zoom,J),Rt.addFeatures(Be,this.tileID.canonical,Ot.patternPositions))}return this.status="done",{buckets:Object.values(xe).filter(gt=>!gt.isEmpty()),featureIndex:Ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ut.image,imageAtlas:Ot,glyphMap:this.returnDependencies?lt:null,iconMap:this.returnDependencies?yt:null,glyphPositions:this.returnDependencies?Ut.positions:null}})}}function ge(Se,q,W){const J=new b.F(q);for(const le of Se)le.recalculate(J,W)}class be{constructor(q,W,J){this.actor=q,this.layerIndex=W,this.availableImages=J,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(q,W){return b._(this,void 0,void 0,function*(){const J=yield b.n(q.request,W);try{return{vectorTile:new b.cK.VectorTile(new b.cL(J.data)),rawData:J.data,cacheControl:J.cacheControl,expires:J.expires}}catch(le){const _e=new Uint8Array(J.data);let we=`Unable to parse the tile at ${q.request.url}, `;throw we+=_e[0]===31&&_e[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${le.message}`,new Error(we)}})}loadTile(q){return b._(this,void 0,void 0,function*(){const W=q.uid,J=!!(q&&q.request&&q.request.collectResourceTiming)&&new b.cM(q.request),le=new K(q);this.loading[W]=le;const _e=new AbortController;le.abort=_e;try{const we=yield this.loadVectorTile(q,_e);if(delete this.loading[W],!we)return null;const Ae=we.rawData,xe={};we.expires&&(xe.expires=we.expires),we.cacheControl&&(xe.cacheControl=we.cacheControl);const Be={};if(J){const Me=J.finish();Me&&(Be.resourceTiming=JSON.parse(JSON.stringify(Me)))}le.vectorTile=we.vectorTile;const je=le.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,q.subdivisionGranularity);this.loaded[W]=le,this.fetching[W]={rawTileData:Ae,cacheControl:xe,resourceTiming:Be};try{const Me=yield je;return b.e({rawTileData:Ae.slice(0)},Me,xe,Be)}finally{delete this.fetching[W]}}catch(we){throw delete this.loading[W],le.status="done",this.loaded[W]=le,we}})}reloadTile(q){return b._(this,void 0,void 0,function*(){const W=q.uid;if(!this.loaded||!this.loaded[W])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const J=this.loaded[W];if(J.showCollisionBoxes=q.showCollisionBoxes,J.globalState=q.globalState,J.status==="parsing"){const le=yield J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,q.subdivisionGranularity);let _e;if(this.fetching[W]){const{rawTileData:we,cacheControl:Ae,resourceTiming:xe}=this.fetching[W];delete this.fetching[W],_e=b.e({rawTileData:we.slice(0)},le,Ae,xe)}else _e=le;return _e}if(J.status==="done"&&J.vectorTile)return J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,q.subdivisionGranularity)})}abortTile(q){return b._(this,void 0,void 0,function*(){const W=this.loading,J=q.uid;W&&W[J]&&W[J].abort&&(W[J].abort.abort(),delete W[J])})}removeTile(q){return b._(this,void 0,void 0,function*(){this.loaded&&this.loaded[q.uid]&&delete this.loaded[q.uid]})}}class O{constructor(){this.loaded={}}loadTile(q){return b._(this,void 0,void 0,function*(){const{uid:W,encoding:J,rawImageData:le,redFactor:_e,greenFactor:we,blueFactor:Ae,baseShift:xe}=q,Be=le.width+2,je=le.height+2,Me=b.b(le)?new b.R({width:Be,height:je},yield b.cN(le,-1,-1,Be,je)):le,$e=new b.cO(W,Me,J,_e,we,Ae,xe);return this.loaded=this.loaded||{},this.loaded[W]=$e,$e})}removeTile(q){const W=this.loaded,J=q.uid;W&&W[J]&&delete W[J]}}var H,ue,Pe=function(){if(ue)return H;function Se(W,J){if(W.length!==0){q(W[0],J);for(var le=1;le<W.length;le++)q(W[le],!J)}}function q(W,J){for(var le=0,_e=0,we=0,Ae=W.length,xe=Ae-1;we<Ae;xe=we++){var Be=(W[we][0]-W[xe][0])*(W[xe][1]+W[we][1]),je=le+Be;_e+=Math.abs(le)>=Math.abs(Be)?le-je+Be:Be-je+le,le=je}le+_e>=0!=!!J&&W.reverse()}return ue=1,H=function W(J,le){var _e,we=J&&J.type;if(we==="FeatureCollection")for(_e=0;_e<J.features.length;_e++)W(J.features[_e],le);else if(we==="GeometryCollection")for(_e=0;_e<J.geometries.length;_e++)W(J.geometries[_e],le);else if(we==="Feature")W(J.geometry,le);else if(we==="Polygon")Se(J.coordinates,le);else if(we==="MultiPolygon")for(_e=0;_e<J.coordinates.length;_e++)Se(J.coordinates[_e],le);return J}}(),pe=b.cP(Pe);const E=b.cK.VectorTileFeature.prototype.toGeoJSON;class R{constructor(q){this._feature=q,this.extent=b.$,this.type=q.type,this.properties=q.tags,"id"in q&&!isNaN(q.id)&&(this.id=parseInt(q.id,10))}loadGeometry(){if(this._feature.type===1){const q=[];for(const W of this._feature.geometry)q.push([new b.P(W[0],W[1])]);return q}{const q=[];for(const W of this._feature.geometry){const J=[];for(const le of W)J.push(new b.P(le[0],le[1]));q.push(J)}return q}}toGeoJSON(q,W,J){return E.call(this,q,W,J)}}class N{constructor(q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=b.$,this.length=q.length,this._features=q}feature(q){return new R(this._features[q])}}var re,Te,Ce,Ne={exports:{}},Ge=function(){if(Ce)return Ne.exports;Ce=1;var Se=b.cS(),q=function(){if(Te)return re;Te=1;var je=b.cQ(),Me=b.cR().VectorTileFeature;function $e(Je,ft){this.options=ft||{},this.features=Je,this.length=Je.length}function me(Je,ft){this.id=typeof Je.id=="number"?Je.id:void 0,this.type=Je.type,this.rawGeometry=Je.type===1?[Je.geometry]:Je.geometry,this.properties=Je.tags,this.extent=ft||4096}return re=$e,$e.prototype.feature=function(Je){return new me(this.features[Je],this.options.extent)},me.prototype.loadGeometry=function(){var Je=this.rawGeometry;this.geometry=[];for(var ft=0;ft<Je.length;ft++){for(var tt=Je[ft],lt=[],yt=0;yt<tt.length;yt++)lt.push(new je(tt[yt][0],tt[yt][1]));this.geometry.push(lt)}return this.geometry},me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Je=this.geometry,ft=1/0,tt=-1/0,lt=1/0,yt=-1/0,Yt=0;Yt<Je.length;Yt++)for(var Ut=Je[Yt],Ot=0;Ot<Ut.length;Ot++){var gt=Ut[Ot];ft=Math.min(ft,gt.x),tt=Math.max(tt,gt.x),lt=Math.min(lt,gt.y),yt=Math.max(yt,gt.y)}return[ft,lt,tt,yt]},me.prototype.toGeoJSON=Me.prototype.toGeoJSON,re}();function W(je){var Me=new Se;return function($e,me){for(var Je in $e.layers)me.writeMessage(3,J,$e.layers[Je])}(je,Me),Me.finish()}function J(je,Me){var $e;Me.writeVarintField(15,je.version||1),Me.writeStringField(1,je.name||""),Me.writeVarintField(5,je.extent||4096);var me={keys:[],values:[],keycache:{},valuecache:{}};for($e=0;$e<je.length;$e++)me.feature=je.feature($e),Me.writeMessage(2,le,me);var Je=me.keys;for($e=0;$e<Je.length;$e++)Me.writeStringField(3,Je[$e]);var ft=me.values;for($e=0;$e<ft.length;$e++)Me.writeMessage(4,Be,ft[$e])}function le(je,Me){var $e=je.feature;$e.id!==void 0&&Me.writeVarintField(1,$e.id),Me.writeMessage(2,_e,je),Me.writeVarintField(3,$e.type),Me.writeMessage(4,xe,$e)}function _e(je,Me){var $e=je.feature,me=je.keys,Je=je.values,ft=je.keycache,tt=je.valuecache;for(var lt in $e.properties){var yt=$e.properties[lt],Yt=ft[lt];if(yt!==null){Yt===void 0&&(me.push(lt),ft[lt]=Yt=me.length-1),Me.writeVarint(Yt);var Ut=typeof yt;Ut!=="string"&&Ut!=="boolean"&&Ut!=="number"&&(yt=JSON.stringify(yt));var Ot=Ut+":"+yt,gt=tt[Ot];gt===void 0&&(Je.push(yt),tt[Ot]=gt=Je.length-1),Me.writeVarint(gt)}}}function we(je,Me){return(Me<<3)+(7&je)}function Ae(je){return je<<1^je>>31}function xe(je,Me){for(var $e=je.loadGeometry(),me=je.type,Je=0,ft=0,tt=$e.length,lt=0;lt<tt;lt++){var yt=$e[lt],Yt=1;me===1&&(Yt=yt.length),Me.writeVarint(we(1,Yt));for(var Ut=me===3?yt.length-1:yt.length,Ot=0;Ot<Ut;Ot++){Ot===1&&me!==1&&Me.writeVarint(we(2,Ut-1));var gt=yt[Ot].x-Je,Rt=yt[Ot].y-ft;Me.writeVarint(Ae(gt)),Me.writeVarint(Ae(Rt)),Je+=gt,ft+=Rt}me===3&&Me.writeVarint(we(7,1))}}function Be(je,Me){var $e=typeof je;$e==="string"?Me.writeStringField(1,je):$e==="boolean"?Me.writeBooleanField(7,je):$e==="number"&&(je%1!=0?Me.writeDoubleField(3,je):je<0?Me.writeSVarintField(6,je):Me.writeVarintField(5,je))}return Ne.exports=W,Ne.exports.fromVectorTileJs=W,Ne.exports.fromGeojsonVt=function(je,Me){Me=Me||{};var $e={};for(var me in je)$e[me]=new q(je[me].features,Me),$e[me].name=me,$e[me].version=Me.version,$e[me].extent=Me.extent;return W({layers:$e})},Ne.exports.GeoJSONWrapper=q,Ne.exports}(),ht=b.cP(Ge);const dt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Se=>Se},Gt=Math.fround||(yr=new Float32Array(1),Se=>(yr[0]=+Se,yr[0]));var yr;class Lr{constructor(q){this.options=Object.assign(Object.create(dt),q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(q){const{log:W,minZoom:J,maxZoom:le}=this.options;W&&console.time("total time");const _e=`prepare ${q.length} points`;W&&console.time(_e),this.points=q;const we=[];for(let xe=0;xe<q.length;xe++){const Be=q[xe];if(!Be.geometry)continue;const[je,Me]=Be.geometry.coordinates,$e=Gt(xn(je)),me=Gt(rn(Me));we.push($e,me,1/0,xe,-1,1),this.options.reduce&&we.push(0)}let Ae=this.trees[le+1]=this._createTree(we);W&&console.timeEnd(_e);for(let xe=le;xe>=J;xe--){const Be=+Date.now();Ae=this.trees[xe]=this._createTree(this._cluster(Ae,xe)),W&&console.log("z%d: %d clusters in %dms",xe,Ae.numItems,+Date.now()-Be)}return W&&console.timeEnd("total time"),this}getClusters(q,W){let J=((q[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,q[1]));let _e=q[2]===180?180:((q[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,q[3]));if(q[2]-q[0]>=360)J=-180,_e=180;else if(J>_e){const Me=this.getClusters([J,le,180,we],W),$e=this.getClusters([-180,le,_e,we],W);return Me.concat($e)}const Ae=this.trees[this._limitZoom(W)],xe=Ae.range(xn(J),rn(we),xn(_e),rn(le)),Be=Ae.data,je=[];for(const Me of xe){const $e=this.stride*Me;je.push(Be[$e+5]>1?vn(Be,$e,this.clusterProps):this.points[Be[$e+3]])}return je}getChildren(q){const W=this._getOriginId(q),J=this._getOriginZoom(q),le="No cluster with the specified id.",_e=this.trees[J];if(!_e)throw new Error(le);const we=_e.data;if(W*this.stride>=we.length)throw new Error(le);const Ae=this.options.radius/(this.options.extent*Math.pow(2,J-1)),xe=_e.within(we[W*this.stride],we[W*this.stride+1],Ae),Be=[];for(const je of xe){const Me=je*this.stride;we[Me+4]===q&&Be.push(we[Me+5]>1?vn(we,Me,this.clusterProps):this.points[we[Me+3]])}if(Be.length===0)throw new Error(le);return Be}getLeaves(q,W,J){const le=[];return this._appendLeaves(le,q,W=W||10,J=J||0,0),le}getTile(q,W,J){const le=this.trees[this._limitZoom(q)],_e=Math.pow(2,q),{extent:we,radius:Ae}=this.options,xe=Ae/we,Be=(J-xe)/_e,je=(J+1+xe)/_e,Me={features:[]};return this._addTileFeatures(le.range((W-xe)/_e,Be,(W+1+xe)/_e,je),le.data,W,J,_e,Me),W===0&&this._addTileFeatures(le.range(1-xe/_e,Be,1,je),le.data,_e,J,_e,Me),W===_e-1&&this._addTileFeatures(le.range(0,Be,xe/_e,je),le.data,-1,J,_e,Me),Me.features.length?Me:null}getClusterExpansionZoom(q){let W=this._getOriginZoom(q)-1;for(;W<=this.options.maxZoom;){const J=this.getChildren(q);if(W++,J.length!==1)break;q=J[0].properties.cluster_id}return W}_appendLeaves(q,W,J,le,_e){const we=this.getChildren(W);for(const Ae of we){const xe=Ae.properties;if(xe&&xe.cluster?_e+xe.point_count<=le?_e+=xe.point_count:_e=this._appendLeaves(q,xe.cluster_id,J,le,_e):_e<le?_e++:q.push(Ae),q.length===J)break}return _e}_createTree(q){const W=new b.aH(q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let J=0;J<q.length;J+=this.stride)W.add(q[J],q[J+1]);return W.finish(),W.data=q,W}_addTileFeatures(q,W,J,le,_e,we){for(const Ae of q){const xe=Ae*this.stride,Be=W[xe+5]>1;let je,Me,$e;if(Be)je=Ui(W,xe,this.clusterProps),Me=W[xe],$e=W[xe+1];else{const ft=this.points[W[xe+3]];je=ft.properties;const[tt,lt]=ft.geometry.coordinates;Me=xn(tt),$e=rn(lt)}const me={type:1,geometry:[[Math.round(this.options.extent*(Me*_e-J)),Math.round(this.options.extent*($e*_e-le))]],tags:je};let Je;Je=Be||this.options.generateId?W[xe+3]:this.points[W[xe+3]].id,Je!==void 0&&(me.id=Je),we.features.push(me)}}_limitZoom(q){return Math.max(this.options.minZoom,Math.min(Math.floor(+q),this.options.maxZoom+1))}_cluster(q,W){const{radius:J,extent:le,reduce:_e,minPoints:we}=this.options,Ae=J/(le*Math.pow(2,W)),xe=q.data,Be=[],je=this.stride;for(let Me=0;Me<xe.length;Me+=je){if(xe[Me+2]<=W)continue;xe[Me+2]=W;const $e=xe[Me],me=xe[Me+1],Je=q.within(xe[Me],xe[Me+1],Ae),ft=xe[Me+5];let tt=ft;for(const lt of Je){const yt=lt*je;xe[yt+2]>W&&(tt+=xe[yt+5])}if(tt>ft&&tt>=we){let lt,yt=$e*ft,Yt=me*ft,Ut=-1;const Ot=(Me/je<<5)+(W+1)+this.points.length;for(const gt of Je){const Rt=gt*je;if(xe[Rt+2]<=W)continue;xe[Rt+2]=W;const jr=xe[Rt+5];yt+=xe[Rt]*jr,Yt+=xe[Rt+1]*jr,xe[Rt+4]=Ot,_e&&(lt||(lt=this._map(xe,Me,!0),Ut=this.clusterProps.length,this.clusterProps.push(lt)),_e(lt,this._map(xe,Rt)))}xe[Me+4]=Ot,Be.push(yt/tt,Yt/tt,1/0,Ot,-1,tt),_e&&Be.push(Ut)}else{for(let lt=0;lt<je;lt++)Be.push(xe[Me+lt]);if(tt>1)for(const lt of Je){const yt=lt*je;if(!(xe[yt+2]<=W)){xe[yt+2]=W;for(let Yt=0;Yt<je;Yt++)Be.push(xe[yt+Yt])}}}}return Be}_getOriginId(q){return q-this.points.length>>5}_getOriginZoom(q){return(q-this.points.length)%32}_map(q,W,J){if(q[W+5]>1){const we=this.clusterProps[q[W+6]];return J?Object.assign({},we):we}const le=this.points[q[W+3]].properties,_e=this.options.map(le);return J&&_e===le?Object.assign({},_e):_e}}function vn(Se,q,W){return{type:"Feature",id:Se[q+3],properties:Ui(Se,q,W),geometry:{type:"Point",coordinates:[(J=Se[q],360*(J-.5)),st(Se[q+1])]}};var J}function Ui(Se,q,W){const J=Se[q+5],le=J>=1e4?`${Math.round(J/1e3)}k`:J>=1e3?Math.round(J/100)/10+"k":J,_e=Se[q+6],we=_e===-1?{}:Object.assign({},W[_e]);return Object.assign(we,{cluster:!0,cluster_id:Se[q+3],point_count:J,point_count_abbreviated:le})}function xn(Se){return Se/360+.5}function rn(Se){const q=Math.sin(Se*Math.PI/180),W=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return W<0?0:W>1?1:W}function st(Se){const q=(180-360*Se)*Math.PI/180;return 360*Math.atan(Math.exp(q))/Math.PI-90}function xt(Se,q,W,J){let le=J;const _e=q+(W-q>>1);let we,Ae=W-q;const xe=Se[q],Be=Se[q+1],je=Se[W],Me=Se[W+1];for(let $e=q+3;$e<W;$e+=3){const me=wt(Se[$e],Se[$e+1],xe,Be,je,Me);if(me>le)we=$e,le=me;else if(me===le){const Je=Math.abs($e-_e);Je<Ae&&(we=$e,Ae=Je)}}le>J&&(we-q>3&&xt(Se,q,we,J),Se[we+2]=le,W-we>3&&xt(Se,we,W,J))}function wt(Se,q,W,J,le,_e){let we=le-W,Ae=_e-J;if(we!==0||Ae!==0){const xe=((Se-W)*we+(q-J)*Ae)/(we*we+Ae*Ae);xe>1?(W=le,J=_e):xe>0&&(W+=we*xe,J+=Ae*xe)}return we=Se-W,Ae=q-J,we*we+Ae*Ae}function Ft(Se,q,W,J){const le={id:Se??null,type:q,geometry:W,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(q==="Point"||q==="MultiPoint"||q==="LineString")vt(le,W);else if(q==="Polygon")vt(le,W[0]);else if(q==="MultiLineString")for(const _e of W)vt(le,_e);else if(q==="MultiPolygon")for(const _e of W)vt(le,_e[0]);return le}function vt(Se,q){for(let W=0;W<q.length;W+=3)Se.minX=Math.min(Se.minX,q[W]),Se.minY=Math.min(Se.minY,q[W+1]),Se.maxX=Math.max(Se.maxX,q[W]),Se.maxY=Math.max(Se.maxY,q[W+1])}function ii(Se,q,W,J){if(!q.geometry)return;const le=q.geometry.coordinates;if(le&&le.length===0)return;const _e=q.geometry.type,we=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2);let Ae=[],xe=q.id;if(W.promoteId?xe=q.properties[W.promoteId]:W.generateId&&(xe=J||0),_e==="Point")Er(le,Ae);else if(_e==="MultiPoint")for(const Be of le)Er(Be,Ae);else if(_e==="LineString")Zi(le,Ae,we,!1);else if(_e==="MultiLineString"){if(W.lineMetrics){for(const Be of le)Ae=[],Zi(Be,Ae,we,!1),Se.push(Ft(xe,"LineString",Ae,q.properties));return}ui(le,Ae,we,!1)}else if(_e==="Polygon")ui(le,Ae,we,!0);else{if(_e!=="MultiPolygon"){if(_e==="GeometryCollection"){for(const Be of q.geometry.geometries)ii(Se,{id:xe,geometry:Be,properties:q.properties},W,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Be of le){const je=[];ui(Be,je,we,!0),Ae.push(je)}}Se.push(Ft(xe,_e,Ae,q.properties))}function Er(Se,q){q.push(nn(Se[0]),Il(Se[1]),0)}function Zi(Se,q,W,J){let le,_e,we=0;for(let xe=0;xe<Se.length;xe++){const Be=nn(Se[xe][0]),je=Il(Se[xe][1]);q.push(Be,je,0),xe>0&&(we+=J?(le*je-Be*_e)/2:Math.sqrt(Math.pow(Be-le,2)+Math.pow(je-_e,2))),le=Be,_e=je}const Ae=q.length-3;q[2]=1,xt(q,0,Ae,W),q[Ae+2]=1,q.size=Math.abs(we),q.start=0,q.end=q.size}function ui(Se,q,W,J){for(let le=0;le<Se.length;le++){const _e=[];Zi(Se[le],_e,W,J),q.push(_e)}}function nn(Se){return Se/360+.5}function Il(Se){const q=Math.sin(Se*Math.PI/180),W=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return W<0?0:W>1?1:W}function kr(Se,q,W,J,le,_e,we,Ae){if(J/=q,_e>=(W/=q)&&we<J)return Se;if(we<W||_e>=J)return null;const xe=[];for(const Be of Se){const je=Be.geometry;let Me=Be.type;const $e=le===0?Be.minX:Be.minY,me=le===0?Be.maxX:Be.maxY;if($e>=W&&me<J){xe.push(Be);continue}if(me<W||$e>=J)continue;let Je=[];if(Me==="Point"||Me==="MultiPoint")ua(je,Je,W,J,le);else if(Me==="LineString")ki(je,Je,W,J,le,!1,Ae.lineMetrics);else if(Me==="MultiLineString")cr(je,Je,W,J,le,!1);else if(Me==="Polygon")cr(je,Je,W,J,le,!0);else if(Me==="MultiPolygon")for(const ft of je){const tt=[];cr(ft,tt,W,J,le,!0),tt.length&&Je.push(tt)}if(Je.length){if(Ae.lineMetrics&&Me==="LineString"){for(const ft of Je)xe.push(Ft(Be.id,Me,ft,Be.tags));continue}Me!=="LineString"&&Me!=="MultiLineString"||(Je.length===1?(Me="LineString",Je=Je[0]):Me="MultiLineString"),Me!=="Point"&&Me!=="MultiPoint"||(Me=Je.length===3?"Point":"MultiPoint"),xe.push(Ft(Be.id,Me,Je,Be.tags))}}return xe.length?xe:null}function ua(Se,q,W,J,le){for(let _e=0;_e<Se.length;_e+=3){const we=Se[_e+le];we>=W&&we<=J&&bn(q,Se[_e],Se[_e+1],Se[_e+2])}}function ki(Se,q,W,J,le,_e,we){let Ae=ha(Se);const xe=le===0?Gi:uo;let Be,je,Me=Se.start;for(let tt=0;tt<Se.length-3;tt+=3){const lt=Se[tt],yt=Se[tt+1],Yt=Se[tt+2],Ut=Se[tt+3],Ot=Se[tt+4],gt=le===0?lt:yt,Rt=le===0?Ut:Ot;let jr=!1;we&&(Be=Math.sqrt(Math.pow(lt-Ut,2)+Math.pow(yt-Ot,2))),gt<W?Rt>W&&(je=xe(Ae,lt,yt,Ut,Ot,W),we&&(Ae.start=Me+Be*je)):gt>J?Rt<J&&(je=xe(Ae,lt,yt,Ut,Ot,J),we&&(Ae.start=Me+Be*je)):bn(Ae,lt,yt,Yt),Rt<W&&gt>=W&&(je=xe(Ae,lt,yt,Ut,Ot,W),jr=!0),Rt>J&&gt<=J&&(je=xe(Ae,lt,yt,Ut,Ot,J),jr=!0),!_e&&jr&&(we&&(Ae.end=Me+Be*je),q.push(Ae),Ae=ha(Se)),we&&(Me+=Be)}let $e=Se.length-3;const me=Se[$e],Je=Se[$e+1],ft=le===0?me:Je;ft>=W&&ft<=J&&bn(Ae,me,Je,Se[$e+2]),$e=Ae.length-3,_e&&$e>=3&&(Ae[$e]!==Ae[0]||Ae[$e+1]!==Ae[1])&&bn(Ae,Ae[0],Ae[1],Ae[2]),Ae.length&&q.push(Ae)}function ha(Se){const q=[];return q.size=Se.size,q.start=Se.start,q.end=Se.end,q}function cr(Se,q,W,J,le,_e){for(const we of Se)ki(we,q,W,J,le,_e,!1)}function bn(Se,q,W,J){Se.push(q,W,J)}function Gi(Se,q,W,J,le,_e){const we=(_e-q)/(J-q);return bn(Se,_e,W+(le-W)*we,1),we}function uo(Se,q,W,J,le,_e){const we=(_e-W)/(le-W);return bn(Se,q+(J-q)*we,_e,1),we}function qr(Se,q){const W=[];for(let J=0;J<Se.length;J++){const le=Se[J],_e=le.type;let we;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")we=zi(le.geometry,q);else if(_e==="MultiLineString"||_e==="Polygon"){we=[];for(const Ae of le.geometry)we.push(zi(Ae,q))}else if(_e==="MultiPolygon"){we=[];for(const Ae of le.geometry){const xe=[];for(const Be of Ae)xe.push(zi(Be,q));we.push(xe)}}W.push(Ft(le.id,_e,we,le.tags))}return W}function zi(Se,q){const W=[];W.size=Se.size,Se.start!==void 0&&(W.start=Se.start,W.end=Se.end);for(let J=0;J<Se.length;J+=3)W.push(Se[J]+q,Se[J+1],Se[J+2]);return W}function xi(Se,q){if(Se.transformed)return Se;const W=1<<Se.z,J=Se.x,le=Se.y;for(const _e of Se.features){const we=_e.geometry,Ae=_e.type;if(_e.geometry=[],Ae===1)for(let xe=0;xe<we.length;xe+=2)_e.geometry.push(ks(we[xe],we[xe+1],q,W,J,le));else for(let xe=0;xe<we.length;xe++){const Be=[];for(let je=0;je<we[xe].length;je+=2)Be.push(ks(we[xe][je],we[xe][je+1],q,W,J,le));_e.geometry.push(Be)}}return Se.transformed=!0,Se}function ks(Se,q,W,J,le,_e){return[Math.round(W*(Se*J-le)),Math.round(W*(q*J-_e))]}function as(Se,q,W,J,le){const _e=q===le.maxZoom?0:le.tolerance/((1<<q)*le.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:Se.length,source:null,x:W,y:J,z:q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ae of Se)da(we,Ae,_e,le);return we}function da(Se,q,W,J){const le=q.geometry,_e=q.type,we=[];if(Se.minX=Math.min(Se.minX,q.minX),Se.minY=Math.min(Se.minY,q.minY),Se.maxX=Math.max(Se.maxX,q.maxX),Se.maxY=Math.max(Se.maxY,q.maxY),_e==="Point"||_e==="MultiPoint")for(let Ae=0;Ae<le.length;Ae+=3)we.push(le[Ae],le[Ae+1]),Se.numPoints++,Se.numSimplified++;else if(_e==="LineString")zs(we,le,Se,W,!1,!1);else if(_e==="MultiLineString"||_e==="Polygon")for(let Ae=0;Ae<le.length;Ae++)zs(we,le[Ae],Se,W,_e==="Polygon",Ae===0);else if(_e==="MultiPolygon")for(let Ae=0;Ae<le.length;Ae++){const xe=le[Ae];for(let Be=0;Be<xe.length;Be++)zs(we,xe[Be],Se,W,!0,Be===0)}if(we.length){let Ae=q.tags||null;if(_e==="LineString"&&J.lineMetrics){Ae={};for(const Be in q.tags)Ae[Be]=q.tags[Be];Ae.mapbox_clip_start=le.start/le.size,Ae.mapbox_clip_end=le.end/le.size}const xe={geometry:we,type:_e==="Polygon"||_e==="MultiPolygon"?3:_e==="LineString"||_e==="MultiLineString"?2:1,tags:Ae};q.id!==null&&(xe.id=q.id),Se.features.push(xe)}}function zs(Se,q,W,J,le,_e){const we=J*J;if(J>0&&q.size<(le?we:J))return void(W.numPoints+=q.length/3);const Ae=[];for(let xe=0;xe<q.length;xe+=3)(J===0||q[xe+2]>we)&&(W.numSimplified++,Ae.push(q[xe],q[xe+1])),W.numPoints++;le&&function(xe,Be){let je=0;for(let Me=0,$e=xe.length,me=$e-2;Me<$e;me=Me,Me+=2)je+=(xe[Me]-xe[me])*(xe[Me+1]+xe[me+1]);if(je>0===Be)for(let Me=0,$e=xe.length;Me<$e/2;Me+=2){const me=xe[Me],Je=xe[Me+1];xe[Me]=xe[$e-2-Me],xe[Me+1]=xe[$e-1-Me],xe[$e-2-Me]=me,xe[$e-1-Me]=Je}}(Ae,_e),Se.push(Ae)}const jn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class As{constructor(q,W){const J=(W=this.options=function(_e,we){for(const Ae in we)_e[Ae]=we[Ae];return _e}(Object.create(jn),W)).debug;if(J&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");let le=function(_e,we){const Ae=[];if(_e.type==="FeatureCollection")for(let xe=0;xe<_e.features.length;xe++)ii(Ae,_e.features[xe],we,xe);else ii(Ae,_e.type==="Feature"?_e:{geometry:_e},we);return Ae}(q,W);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),le=function(_e,we){const Ae=we.buffer/we.extent;let xe=_e;const Be=kr(_e,1,-1-Ae,Ae,0,-1,2,we),je=kr(_e,1,1-Ae,2+Ae,0,-1,2,we);return(Be||je)&&(xe=kr(_e,1,-Ae,1+Ae,0,-1,2,we)||[],Be&&(xe=qr(Be,1).concat(xe)),je&&(xe=xe.concat(qr(je,-1)))),xe}(le,W),le.length&&this.splitTile(le,0,0,0),J&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(q,W,J,le,_e,we,Ae){const xe=[q,W,J,le],Be=this.options,je=Be.debug;for(;xe.length;){le=xe.pop(),J=xe.pop(),W=xe.pop(),q=xe.pop();const Me=1<<W,$e=Fn(W,J,le);let me=this.tiles[$e];if(!me&&(je>1&&console.time("creation"),me=this.tiles[$e]=as(q,W,J,le,Be),this.tileCoords.push({z:W,x:J,y:le}),je)){je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,J,le,me.numFeatures,me.numPoints,me.numSimplified),console.timeEnd("creation"));const jr=`z${W}`;this.stats[jr]=(this.stats[jr]||0)+1,this.total++}if(me.source=q,_e==null){if(W===Be.indexMaxZoom||me.numPoints<=Be.indexMaxPoints)continue}else{if(W===Be.maxZoom||W===_e)continue;if(_e!=null){const jr=_e-W;if(J!==we>>jr||le!==Ae>>jr)continue}}if(me.source=null,q.length===0)continue;je>1&&console.time("clipping");const Je=.5*Be.buffer/Be.extent,ft=.5-Je,tt=.5+Je,lt=1+Je;let yt=null,Yt=null,Ut=null,Ot=null,gt=kr(q,Me,J-Je,J+tt,0,me.minX,me.maxX,Be),Rt=kr(q,Me,J+ft,J+lt,0,me.minX,me.maxX,Be);q=null,gt&&(yt=kr(gt,Me,le-Je,le+tt,1,me.minY,me.maxY,Be),Yt=kr(gt,Me,le+ft,le+lt,1,me.minY,me.maxY,Be),gt=null),Rt&&(Ut=kr(Rt,Me,le-Je,le+tt,1,me.minY,me.maxY,Be),Ot=kr(Rt,Me,le+ft,le+lt,1,me.minY,me.maxY,Be),Rt=null),je>1&&console.timeEnd("clipping"),xe.push(yt||[],W+1,2*J,2*le),xe.push(Yt||[],W+1,2*J,2*le+1),xe.push(Ut||[],W+1,2*J+1,2*le),xe.push(Ot||[],W+1,2*J+1,2*le+1)}}getTile(q,W,J){q=+q,W=+W,J=+J;const le=this.options,{extent:_e,debug:we}=le;if(q<0||q>24)return null;const Ae=1<<q,xe=Fn(q,W=W+Ae&Ae-1,J);if(this.tiles[xe])return xi(this.tiles[xe],_e);we>1&&console.log("drilling down to z%d-%d-%d",q,W,J);let Be,je=q,Me=W,$e=J;for(;!Be&&je>0;)je--,Me>>=1,$e>>=1,Be=this.tiles[Fn(je,Me,$e)];return Be&&Be.source?(we>1&&(console.log("found parent tile z%d-%d-%d",je,Me,$e),console.time("drilling down")),this.splitTile(Be.source,je,Me,$e,q,W,J),we>1&&console.timeEnd("drilling down"),this.tiles[xe]?xi(this.tiles[xe],_e):null):null}}function Fn(Se,q,W){return 32*((1<<Se)*W+q)+Se}function Ai(Se,q){return q?Se.properties[q]:Se.id}function wn(Se,q){if(Se==null)return!0;if(Se.type==="Feature")return Ai(Se,q)!=null;if(Se.type==="FeatureCollection"){const W=new Set;for(const J of Se.features){const le=Ai(J,q);if(le==null||W.has(le))return!1;W.add(le)}return!0}return!1}function pa(Se,q){const W=new Map;if(Se!=null)if(Se.type==="Feature")W.set(Ai(Se,q),Se);else for(const J of Se.features)W.set(Ai(J,q),J);return W}class El extends be{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(q,W){return b._(this,void 0,void 0,function*(){const J=q.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const le=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!le)return null;const _e=new N(le.features);let we=ht(_e);return we.byteOffset===0&&we.byteLength===we.buffer.byteLength||(we=new Uint8Array(we)),{vectorTile:_e,rawData:we.buffer}})}loadData(q){return b._(this,void 0,void 0,function*(){var W;(W=this._pendingRequest)===null||W===void 0||W.abort();const J=!!(q&&q.request&&q.request.collectResourceTiming)&&new b.cM(q.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(q,this._pendingRequest),this._geoJSONIndex=q.cluster?new Lr(function({superclusterOptions:we,clusterProperties:Ae}){if(!Ae||!we)return we;const xe={},Be={},je={accumulated:null,zoom:0},Me={properties:null},$e=Object.keys(Ae);for(const me of $e){const[Je,ft]=Ae[me],tt=b.cT(ft),lt=b.cT(typeof Je=="string"?[Je,["accumulated"],["get",me]]:Je);xe[me]=tt.value,Be[me]=lt.value}return we.map=me=>{Me.properties=me;const Je={};for(const ft of $e)Je[ft]=xe[ft].evaluate(je,Me);return Je},we.reduce=(me,Je)=>{Me.properties=Je;for(const ft of $e)je.accumulated=me[ft],me[ft]=Be[ft].evaluate(je,Me)},we}(q)).load((yield this._pendingData).features):(le=yield this._pendingData,new As(le,q.geojsonVtOptions)),this.loaded={};const _e={};if(J){const we=J.finish();we&&(_e.resourceTiming={},_e.resourceTiming[q.source]=JSON.parse(JSON.stringify(we)))}return _e}catch(_e){if(delete this._pendingRequest,b.cx(_e))return{abandoned:!0};throw _e}var le})}getData(){return b._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(q){const W=this.loaded;return W&&W[q.uid]?super.reloadTile(q):this.loadTile(q)}loadAndProcessGeoJSON(q,W){return b._(this,void 0,void 0,function*(){let J=yield this.loadGeoJSON(q,W);if(delete this._pendingRequest,typeof J!="object")throw new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`);if(pe(J,!0),q.filter){const le=b.cT(q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map(we=>`${we.key}: ${we.message}`).join(", "));J={type:"FeatureCollection",features:J.features.filter(we=>le.value.evaluate({zoom:0},we))}}return J})}loadGeoJSON(q,W){return b._(this,void 0,void 0,function*(){const{promoteId:J}=q;if(q.request){const le=yield b.j(q.request,W);return this._dataUpdateable=wn(le.data,J)?pa(le.data,J):void 0,le.data}if(typeof q.data=="string")try{const le=JSON.parse(q.data);return this._dataUpdateable=wn(le,J)?pa(le,J):void 0,le}catch{throw new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`)}if(!q.dataDiff)throw new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${q.source}`);return function(le,_e,we){var Ae,xe,Be,je;if(_e.removeAll&&le.clear(),_e.remove)for(const Me of _e.remove)le.delete(Me);if(_e.add)for(const Me of _e.add){const $e=Ai(Me,we);$e!=null&&le.set($e,Me)}if(_e.update)for(const Me of _e.update){let $e=le.get(Me.id);if($e==null)continue;const me=!Me.removeAllProperties&&(((Ae=Me.removeProperties)===null||Ae===void 0?void 0:Ae.length)>0||((xe=Me.addOrUpdateProperties)===null||xe===void 0?void 0:xe.length)>0);if((Me.newGeometry||Me.removeAllProperties||me)&&($e=Object.assign({},$e),le.set(Me.id,$e),me&&($e.properties=Object.assign({},$e.properties))),Me.newGeometry&&($e.geometry=Me.newGeometry),Me.removeAllProperties)$e.properties={};else if(((Be=Me.removeProperties)===null||Be===void 0?void 0:Be.length)>0)for(const Je of Me.removeProperties)Object.prototype.hasOwnProperty.call($e.properties,Je)&&delete $e.properties[Je];if(((je=Me.addOrUpdateProperties)===null||je===void 0?void 0:je.length)>0)for(const{key:Je,value:ft}of Me.addOrUpdateProperties)$e.properties[Je]=ft}}(this._dataUpdateable,q.dataDiff,J),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(q){return b._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(q){return this._geoJSONIndex.getClusterExpansionZoom(q.clusterId)}getClusterChildren(q){return this._geoJSONIndex.getChildren(q.clusterId)}getClusterLeaves(q){return this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset)}}class Bn{constructor(q){this.self=q,this.actor=new b.J(q),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(W,J)=>{if(this.externalWorkerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.externalWorkerSourceTypes[W]=J},this.self.addProtocol=b.cz,this.self.removeProtocol=b.cA,this.self.registerRTLTextPlugin=W=>{b.cU.setMethods(W)},this.actor.registerMessageHandler("LDT",(W,J)=>this._getDEMWorkerSource(W,J.source).loadTile(J)),this.actor.registerMessageHandler("RDT",(W,J)=>b._(this,void 0,void 0,function*(){this._getDEMWorkerSource(W,J.source).removeTile(J)})),this.actor.registerMessageHandler("GCEZ",(W,J)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(W,J.type,J.source).getClusterExpansionZoom(J)})),this.actor.registerMessageHandler("GCC",(W,J)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(W,J.type,J.source).getClusterChildren(J)})),this.actor.registerMessageHandler("GCL",(W,J)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(W,J.type,J.source).getClusterLeaves(J)})),this.actor.registerMessageHandler("LD",(W,J)=>this._getWorkerSource(W,J.type,J.source).loadData(J)),this.actor.registerMessageHandler("GD",(W,J)=>this._getWorkerSource(W,J.type,J.source).getData()),this.actor.registerMessageHandler("LT",(W,J)=>this._getWorkerSource(W,J.type,J.source).loadTile(J)),this.actor.registerMessageHandler("RT",(W,J)=>this._getWorkerSource(W,J.type,J.source).reloadTile(J)),this.actor.registerMessageHandler("AT",(W,J)=>this._getWorkerSource(W,J.type,J.source).abortTile(J)),this.actor.registerMessageHandler("RMT",(W,J)=>this._getWorkerSource(W,J.type,J.source).removeTile(J)),this.actor.registerMessageHandler("RS",(W,J)=>b._(this,void 0,void 0,function*(){if(!this.workerSources[W]||!this.workerSources[W][J.type]||!this.workerSources[W][J.type][J.source])return;const le=this.workerSources[W][J.type][J.source];delete this.workerSources[W][J.type][J.source],le.removeSource!==void 0&&le.removeSource(J)})),this.actor.registerMessageHandler("RM",W=>b._(this,void 0,void 0,function*(){delete this.layerIndexes[W],delete this.availableImages[W],delete this.workerSources[W],delete this.demWorkerSources[W]})),this.actor.registerMessageHandler("SR",(W,J)=>b._(this,void 0,void 0,function*(){this.referrer=J})),this.actor.registerMessageHandler("SRPS",(W,J)=>this._syncRTLPluginState(W,J)),this.actor.registerMessageHandler("IS",(W,J)=>b._(this,void 0,void 0,function*(){this.self.importScripts(J)})),this.actor.registerMessageHandler("SI",(W,J)=>this._setImages(W,J)),this.actor.registerMessageHandler("UL",(W,J)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(W).update(J.layers,J.removedIds)})),this.actor.registerMessageHandler("SL",(W,J)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(W).replace(J)}))}_setImages(q,W){return b._(this,void 0,void 0,function*(){this.availableImages[q]=W;for(const J in this.workerSources[q]){const le=this.workerSources[q][J];for(const _e in le)le[_e].availableImages=W}})}_syncRTLPluginState(q,W){return b._(this,void 0,void 0,function*(){return yield b.cU.syncState(W,this.self.importScripts)})}_getAvailableImages(q){let W=this.availableImages[q];return W||(W=[]),W}_getLayerIndex(q){let W=this.layerIndexes[q];return W||(W=this.layerIndexes[q]=new c),W}_getWorkerSource(q,W,J){if(this.workerSources[q]||(this.workerSources[q]={}),this.workerSources[q][W]||(this.workerSources[q][W]={}),!this.workerSources[q][W][J]){const le={sendAsync:(_e,we)=>(_e.targetMapId=q,this.actor.sendAsync(_e,we))};switch(W){case"vector":this.workerSources[q][W][J]=new be(le,this._getLayerIndex(q),this._getAvailableImages(q));break;case"geojson":this.workerSources[q][W][J]=new El(le,this._getLayerIndex(q),this._getAvailableImages(q));break;default:this.workerSources[q][W][J]=new this.externalWorkerSourceTypes[W](le,this._getLayerIndex(q),this._getAvailableImages(q))}}return this.workerSources[q][W][J]}_getDEMWorkerSource(q,W){return this.demWorkerSources[q]||(this.demWorkerSources[q]={}),this.demWorkerSources[q][W]||(this.demWorkerSources[q][W]=new O),this.demWorkerSources[q][W]}}return b.i(self)&&(self.worker=new Bn(self)),Bn}),x("index",["exports","./shared"],function(b,c){var Z="5.6.0";function K(){var p=new c.A(4);return c.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}let ge,be;const O={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(p,e,i){const l=requestAnimationFrame(f=>{u(),e(f)}),{unsubscribe:u}=c.s(p.signal,"abort",()=>{u(),cancelAnimationFrame(l),i(c.c())},!1)},frameAsync(p){return new Promise((e,i)=>{this.frame(p,e,i)})},getImageData(p,e=0){return this.getImageCanvasContext(p).getImageData(-e,-e,p.width+2*e,p.height+2*e)},getImageCanvasContext(p){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=p.width,e.height=p.height,i.drawImage(p,0,0,p.width,p.height),i},resolveURL:p=>(ge||(ge=document.createElement("a")),ge.href=p,ge.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(be==null&&(be=matchMedia("(prefers-reduced-motion: reduce)")),be.matches)}};class H{static testProp(e){if(!H.docStyle)return e[0];for(let i=0;i<e.length;i++)if(e[i]in H.docStyle)return e[i];return e[0]}static create(e,i,l){const u=window.document.createElement(e);return i!==void 0&&(u.className=i),l&&l.appendChild(u),u}static createNS(e,i){return window.document.createElementNS(e,i)}static disableDrag(){H.docStyle&&H.selectProp&&(H.userSelect=H.docStyle[H.selectProp],H.docStyle[H.selectProp]="none")}static enableDrag(){H.docStyle&&H.selectProp&&(H.docStyle[H.selectProp]=H.userSelect)}static setTransform(e,i){e.style[H.transformProp]=i}static addEventListener(e,i,l,u={}){e.addEventListener(i,l,"passive"in u?u:u.capture)}static removeEventListener(e,i,l,u={}){e.removeEventListener(i,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",H.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",H.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",H.suppressClickInternal,!0)},0)}static getScale(e){const i=e.getBoundingClientRect();return{x:i.width/e.offsetWidth||1,y:i.height/e.offsetHeight||1,boundingClientRect:i}}static getPoint(e,i,l){const u=i.boundingClientRect;return new c.P((l.clientX-u.left)/i.x-e.clientLeft,(l.clientY-u.top)/i.y-e.clientTop)}static mousePos(e,i){const l=H.getScale(e);return H.getPoint(e,l,i)}static touchPos(e,i){const l=[],u=H.getScale(e);for(let f=0;f<i.length;f++)l.push(H.getPoint(e,u,i[f]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const i=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=i.querySelectorAll("script");for(const u of l)u.remove();return H.clean(i),i.innerHTML}static isPossiblyDangerous(e,i){const l=i.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const i=e.children;for(const l of i)H.removeAttributes(l),H.clean(l)}static removeAttributes(e){for(const{name:i,value:l}of e.attributes)H.isPossiblyDangerous(i,l)&&e.removeAttribute(i)}}H.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,H.selectProp=H.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),H.transformProp=H.testProp(["transform","WebkitTransform"]);const ue={supported:!1,testSupport:function(p){!E&&pe&&(R?N(p):Pe=p)}};let Pe,pe,E=!1,R=!1;function N(p){const e=p.createTexture();p.bindTexture(p.TEXTURE_2D,e);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,pe),p.isContextLost())return;ue.supported=!0}catch{}p.deleteTexture(e),E=!0}var re;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{Pe&&N(Pe),Pe=null,R=!0},pe.onerror=()=>{E=!0,Pe=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(p){let e,i,l,u;p.resetRequestQueue=()=>{e=[],i=0,l=0,u={}},p.addThrottleControl=S=>{const M=l++;return u[M]=S,M},p.removeThrottleControl=S=>{delete u[S],y()},p.getImage=(S,M,k=!0)=>new Promise((L,D)=>{ue.supported&&(S.headers||(S.headers={}),S.headers.accept="image/webp,*/*"),c.e(S,{type:"image"}),e.push({abortController:M,requestParameters:S,supportImageRefresh:k,state:"queued",onError:F=>{D(F)},onSuccess:F=>{L(F)}}),y()});const f=S=>c._(this,void 0,void 0,function*(){S.state="running";const{requestParameters:M,supportImageRefresh:k,onError:L,onSuccess:D,abortController:F}=S,U=k===!1&&!c.i(self)&&!c.g(M.url)&&(!M.headers||Object.keys(M.headers).reduce((te,ne)=>te&&ne==="accept",!0));i++;const ee=U?w(M,F):c.m(M,F);try{const te=yield ee;delete S.abortController,S.state="completed",te.data instanceof HTMLImageElement||c.b(te.data)?D(te):te.data&&D({data:yield(Q=te.data,typeof createImageBitmap=="function"?c.f(Q):c.h(Q)),cacheControl:te.cacheControl,expires:te.expires})}catch(te){delete S.abortController,L(te)}finally{i--,y()}var Q}),y=()=>{const S=(()=>{for(const M of Object.keys(u))if(u[M]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=i;M<S&&e.length>0;M++){const k=e.shift();k.abortController.signal.aborted?M--:f(k)}},w=(S,M)=>new Promise((k,L)=>{const D=new Image,F=S.url,U=S.credentials;U&&U==="include"?D.crossOrigin="use-credentials":(U&&U==="same-origin"||!c.d(F))&&(D.crossOrigin="anonymous"),M.signal.addEventListener("abort",()=>{D.src="",L(c.c())}),D.fetchPriority="high",D.onload=()=>{D.onerror=D.onload=null,k({data:D})},D.onerror=()=>{D.onerror=D.onload=null,M.signal.aborted||L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},D.src=F})}(re||(re={})),re.resetRequestQueue();class Te{constructor(e){this._transformRequestFn=e}transformRequest(e,i){return this._transformRequestFn&&this._transformRequestFn(e,i)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ce(p){const e=[];if(typeof p=="string")e.push({id:"default",url:p});else if(p&&p.length>0){const i=[];for(const{id:l,url:u}of p){const f=`${l}${u}`;i.indexOf(f)===-1&&(i.push(f),e.push({id:l,url:u}))}}return e}function Ne(p,e,i){try{const l=new URL(p);return l.pathname+=`${e}${i}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${p}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Ge(p){const{userImage:e}=p;return!!(e&&e.render&&e.render())&&(p.data.replace(new Uint8Array(e.data.buffer)),!0)}class ht extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:i,promiseResolve:l}of this.requestors)l(this._getImagesForIds(i));this.requestors=[]}}getImage(e){const i=this.images[e];if(i&&!i.data&&i.spriteData){const l=i.spriteData;i.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),i.spriteData=null}return i}addImage(e,i){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,i)&&(this.images[e]=i)}_validate(e,i){let l=!0;const u=i.data||i.spriteData;return this._validateStretch(i.stretchX,u&&u.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(i.stretchY,u&&u.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(i.content,i)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,i){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||i<u[1])return!1;l=u[1]}return!0}_validateContent(e,i){if(!e)return!0;if(e.length!==4)return!1;const l=i.spriteData,u=l&&l.width||i.data.width,f=l&&l.height||i.data.height;return!(e[0]<0||u<e[0]||e[1]<0||f<e[1]||e[2]<0||u<e[2]||e[3]<0||f<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,i,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==i.data.width||u.data.height!==i.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=u.version+1,this.images[e]=i,this.updatedImages[e]=!0}removeImage(e){const i=this.images[e];delete this.images[e],delete this.patterns[e],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((i,l)=>{let u=!0;if(!this.isLoaded())for(const f of e)this.images[f]||(u=!1);this.isLoaded()||u?i(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:i})})}_getImagesForIds(e){const i={};for(const l of e){let u=this.getImage(l);u||(this.fire(new c.l("styleimagemissing",{id:l})),u=this.getImage(l)),u?i[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:e,height:i}=this.atlasImage;return{width:e,height:i}}getPattern(e){const i=this.patterns[e],l=this.getImage(e);if(!l)return null;if(i&&i.position.version===l.version)return i.position;if(i)i.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},f=new c.I(u,l);this.patterns[e]={bin:u,position:f}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const i=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const f in this.patterns)e.push(this.patterns[f].bin);const{w:i,h:l}=c.p(e),u=this.atlasImage;u.resize({width:i||1,height:l||1});for(const f in this.patterns){const{bin:y}=this.patterns[f],w=y.x+1,S=y.y+1,M=this.getImage(f).data,k=M.width,L=M.height;c.R.copy(M,u,{x:0,y:0},{x:w,y:S},{width:k,height:L}),c.R.copy(M,u,{x:0,y:L-1},{x:w,y:S-1},{width:k,height:1}),c.R.copy(M,u,{x:0,y:0},{x:w,y:S+L},{width:k,height:1}),c.R.copy(M,u,{x:k-1,y:0},{x:w-1,y:S},{width:1,height:L}),c.R.copy(M,u,{x:0,y:0},{x:w+k,y:S},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const i of e){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const l=this.getImage(i);l||c.w(`Image with ID: "${i}" was not found`),Ge(l)&&this.updateImage(i,l)}}}const dt=1e20;function Gt(p,e,i,l,u,f,y,w,S){for(let M=e;M<e+l;M++)yr(p,i*f+M,f,u,y,w,S);for(let M=i;M<i+u;M++)yr(p,M*f+e,1,l,y,w,S)}function yr(p,e,i,l,u,f,y){f[0]=0,y[0]=-1e20,y[1]=dt,u[0]=p[e];for(let w=1,S=0,M=0;w<l;w++){u[w]=p[e+w*i];const k=w*w;do{const L=f[S];M=(u[w]-u[L]+k-L*L)/(w-L)/2}while(M<=y[S]&&--S>-1);S++,f[S]=w,y[S]=M,y[S+1]=dt}for(let w=0,S=0;w<l;w++){for(;y[S+1]<w;)S++;const M=f[S],k=w-M;p[e+w*i]=u[M]+k*k}}class Lr{constructor(e,i){this.requestManager=e,this.localIdeographFontFamily=i,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const i=[];for(const f in e)for(const y of e[f])i.push(this._getAndCacheGlyphsPromise(f,y));const l=yield Promise.all(i),u={};for(const{stack:f,id:y,glyph:w}of l)u[f]||(u[f]={}),u[f][y]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return u})}_getAndCacheGlyphsPromise(e,i){return c._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[i];if(u!==void 0)return{stack:e,id:i,glyph:u};if(u=this._tinySDF(l,e,i),u)return l.glyphs[i]=u,{stack:e,id:i,glyph:u};const f=Math.floor(i/256);if(256*f>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[f])return{stack:e,id:i,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[f]){const w=Lr.loadGlyphRange(e,f,this.url,this.requestManager);l.requests[f]=w}const y=yield l.requests[f];for(const w in y)this._doesCharSupportLocalGlyph(+w)||(l.glyphs[+w]=y[+w]);return l.ranges[f]=!0,{stack:e,id:i,glyph:y[i]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,i,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let f=e.tinySDF;if(!f){let w="400";/bold/i.test(i)?w="900":/medium/i.test(i)?w="500":/light/i.test(i)&&(w="200"),f=e.tinySDF=new Lr.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:w})}const y=f.draw(String.fromCharCode(l));return{id:l,bitmap:new c.q({width:y.width||60,height:y.height||60},y.data),metrics:{width:y.glyphWidth/2||24,height:y.glyphHeight/2||24,left:y.glyphLeft/2+.5||0,top:y.glyphTop/2-27.5||-8,advance:y.glyphAdvance/2||24,isDoubleResolution:!0}}}}Lr.loadGlyphRange=function(p,e,i,l){return c._(this,void 0,void 0,function*(){const u=256*e,f=u+255,y=l.transformRequest(i.replace("{fontstack}",p).replace("{range}",`${u}-${f}`),"Glyphs"),w=yield c.n(y,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${f}`);const S={};for(const M of c.o(w.data))S[M.id]=M;return S})},Lr.TinySDF=class{constructor({fontSize:p=24,buffer:e=3,radius:i=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=i;const w=this.size=p+4*e,S=this._createCanvas(w),M=this.ctx=S.getContext("2d",{willReadFrequently:!0});M.font=`${y} ${f} ${p}px ${u}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(p){const e=document.createElement("canvas");return e.width=e.height=p,e}draw(p){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(p),y=Math.ceil(i),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-u))),S=Math.min(this.size-this.buffer,y+Math.ceil(l)),M=w+2*this.buffer,k=S+2*this.buffer,L=Math.max(M*k,0),D=new Uint8ClampedArray(L),F={data:D,width:M,height:k,glyphWidth:w,glyphHeight:S,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(w===0||S===0)return F;const{ctx:U,buffer:ee,gridInner:Q,gridOuter:te}=this;U.clearRect(ee,ee,w,S),U.fillText(p,ee,ee+y);const ne=U.getImageData(ee,ee,w,S);te.fill(dt,0,L),Q.fill(0,0,L);for(let ce=0;ce<S;ce++)for(let se=0;se<w;se++){const de=ne.data[4*(ce*w+se)+3]/255;if(de===0)continue;const fe=(ce+ee)*M+se+ee;if(de===1)te[fe]=0,Q[fe]=dt;else{const oe=.5-de;te[fe]=oe>0?oe*oe:0,Q[fe]=oe<0?oe*oe:0}}Gt(te,0,0,M,k,M,this.f,this.v,this.z),Gt(Q,ee,ee,w,S,M,this.f,this.v,this.z);for(let ce=0;ce<L;ce++){const se=Math.sqrt(te[ce])-Math.sqrt(Q[ce]);D[ce]=Math.round(255-255*(se/this.radius+this.cutoff))}return F}};class vn{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,i){return c.B(e.expression.evaluate(i))}interpolate(e,i,l){return{x:c.C.number(e.x,i.x,l),y:c.C.number(e.y,i.y,l),z:c.C.number(e.z,i.z,l)}}}let Ui;class xn extends c.E{constructor(e){super(),Ui=Ui||new c.r({anchor:new c.D(c.v.light.anchor),position:new vn,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(Ui),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,i={}){if(!this._validate(c.x,e,i))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,l){return(!l||l.validate!==!1)&&c.y(this,e.call(c.z,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const rn=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class st extends c.E{constructor(e){super(),this._transitionable=new c.t(rn),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(e,i={}){if(!this._validate(c.G,e,i)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,l={}){return(l==null?void 0:l.validate)!==!1&&c.y(this,e.call(c.z,c.e({value:i,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class xt{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,i){const l=e.join(",")+String(i);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,i)),this.dashEntry[l]}getDashRanges(e,i,l){const u=[];let f=e.length%2==1?-e[e.length-1]*l:0,y=e[0]*l,w=!0;u.push({left:f,right:y,isDash:w,zeroLength:e[0]===0});let S=e[0];for(let M=1;M<e.length;M++){w=!w;const k=e[M];f=S*l,S+=k,y=S*l,u.push({left:f,right:y,isDash:w,zeroLength:k===0})}return u}addRoundDash(e,i,l){const u=i/2;for(let f=-l;f<=l;f++){const y=this.width*(this.nextRow+l+f);let w=0,S=e[w];for(let M=0;M<this.width;M++){M/S.right>1&&(S=e[++w]);const k=Math.abs(M-S.left),L=Math.abs(M-S.right),D=Math.min(k,L);let F;const U=f/l*(u+1);if(S.isDash){const ee=u-Math.abs(U);F=Math.sqrt(D*D+ee*ee)}else F=u-Math.sqrt(D*D+U*U);this.data[y+M]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(e){for(let w=e.length-1;w>=0;--w){const S=e[w],M=e[w+1];S.zeroLength?e.splice(w,1):M&&M.isDash===S.isDash&&(M.left=S.left,e.splice(w,1))}const i=e[0],l=e[e.length-1];i.isDash===l.isDash&&(i.left=l.left-this.width,l.right=i.right+this.width);const u=this.width*this.nextRow;let f=0,y=e[f];for(let w=0;w<this.width;w++){w/y.right>1&&(y=e[++f]);const S=Math.abs(w-y.left),M=Math.abs(w-y.right),k=Math.min(S,M);this.data[u+w]=Math.max(0,Math.min(255,(y.isDash?k:-k)+128))}}addDash(e,i){const l=i?7:0,u=2*l+1;if(this.nextRow+u>this.height)return c.w("LineAtlas out of space"),null;let f=0;for(let w=0;w<e.length;w++)f+=e[w];if(f!==0){const w=this.width/f,S=this.getDashRanges(e,this.width,w);i?this.addRoundDash(S,w,l):this.addRegularDash(S)}const y={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:f};return this.nextRow+=u,this.dirty=!0,y}bind(e){const i=e.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const wt="maplibre_preloaded_worker_pool";class Ft{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ft.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[wt]}numActive(){return Object.keys(this.active).length}}const vt=Math.floor(O.hardwareConcurrency/2);let ii,Er;function Zi(){return ii||(ii=new Ft),ii}Ft.workerCount=c.H(globalThis)?Math.max(Math.min(vt,3),1):1;class ui{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=i;const l=this.workerPool.acquire(i);for(let u=0;u<l.length;u++){const f=new c.J(l[u],i);f.name=`Worker ${u}`,this.actors.push(f)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,i){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:i}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,i){for(const l of this.actors)l.registerMessageHandler(e,i)}}function nn(){return Er||(Er=new ui(Zi(),c.K),Er.registerMessageHandler("GR",(p,e,i)=>c.m(e,i))),Er}function Il(p,e){const i=c.L();return c.M(i,i,[1,1,0]),c.N(i,i,[.5*p.width,.5*p.height,1]),p.calculatePosMatrix?c.O(i,i,p.calculatePosMatrix(e.toUnwrapped())):i}function kr(p,e,i,l,u,f,y){var w;const S=function(D,F,U){if(D)for(const ee of D){const Q=F[ee];if(Q&&Q.source===U&&Q.type==="fill-extrusion")return!0}else for(const ee in F){const Q=F[ee];if(Q.source===U&&Q.type==="fill-extrusion")return!0}return!1}((w=u==null?void 0:u.layers)!==null&&w!==void 0?w:null,e,p.id),M=f.maxPitchScaleFactor(),k=p.tilesIn(l,M,S);k.sort(ua);const L=[];for(const D of k)L.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,i,p._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,u,f,M,Il(p.transform,D.tileID),y?(F,U)=>y(D.tileID,F,U):void 0)});return function(D,F){for(const U in D)for(const ee of D[U])ki(ee,F);return D}(function(D){const F={},U={};for(const ee of D){const Q=ee.queryResults,te=ee.wrappedTileID,ne=U[te]=U[te]||{};for(const ce in Q){const se=Q[ce],de=ne[ce]=ne[ce]||{},fe=F[ce]=F[ce]||[];for(const oe of se)de[oe.featureIndex]||(de[oe.featureIndex]=!0,fe.push(oe))}}return F}(L),p)}function ua(p,e){const i=p.tileID,l=e.tileID;return i.overscaledZ-l.overscaledZ||i.canonical.y-l.canonical.y||i.wrap-l.wrap||i.canonical.x-l.canonical.x}function ki(p,e){const i=p.feature,l=e.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=l}function ha(p,e,i){return c._(this,void 0,void 0,function*(){let l=p;if(p.url?l=(yield c.j(e.transformRequest(p.url,"Source"),i)).data:yield O.frameAsync(i),!l)return null;const u=c.Q(c.e(l,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map(f=>f.id)),u})}class cr{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}extend(e){const i=this._sw,l=this._ne;let u,f;if(e instanceof c.S)u=e,f=e;else{if(!(e instanceof cr))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(cr.convert(e)):this.extend(c.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.S.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return i||l?(i.lng=Math.min(u.lng,i.lng),i.lat=Math.min(u.lat,i.lat),l.lng=Math.max(f.lng,l.lng),l.lat=Math.max(f.lat,l.lat)):(this._sw=new c.S(u.lng,u.lat),this._ne=new c.S(f.lng,f.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:l}=c.S.convert(e);let u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof cr?e:e&&new cr(e)}static fromLngLat(e,i=0){const l=360*i/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new cr(new c.S(e.lng-u,e.lat-l),new c.S(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new c.S(this._sw.lng,this._sw.lat),i=new c.S(this._ne.lng,this._ne.lat);return new cr(e,e.lng>i.lng?new c.S(i.lng+360,i.lat):i)}}class bn{constructor(e,i,l){this.bounds=cr.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),l=Math.floor(c.V(this.bounds.getWest())*i),u=Math.floor(c.U(this.bounds.getNorth())*i),f=Math.ceil(c.V(this.bounds.getEast())*i),y=Math.ceil(c.U(this.bounds.getSouth())*i);return e.x>=l&&e.x<f&&e.y>=u&&e.y<y}}class Gi extends c.E{constructor(e,i,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(i,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield ha(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new bn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(i,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((f,y)=>{e.reloadPromise={resolve:f,reject:y}})}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const f=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,f)}catch(f){if(delete e.abortController,e.aborted)return;if(f&&f.status!==404)throw f;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,i){if(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class uo extends c.E{constructor(e,i,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},i),c.e(this,c.Q(i,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield ha(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(c.e(this,i),i.bounds&&(this.tileBounds=new bn(i.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(i){this._tileJSONRequest=null,this.fire(new c.k(i))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield re.getImage(this.map._requestManager.transformRequest(i,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,f=u.gl,y=l.data;e.texture=this.map.painter.getTileTexture(y.width),e.texture?e.texture.update(y,{useMipmap:!0}):(e.texture=new c.T(u,y,f.RGBA,{useMipmap:!0}),e.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class qr extends uo{constructor(e,i,l,u){super(e,i,l,u),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(i,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield re.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const f=u.data;this.map._refreshExpiredTiles&&(u.cacheControl||u.expires)&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const y=c.b(f)&&c.W()?f:yield this.readImageNow(f),w={type:this.type,uid:e.uid,source:this.id,rawImageData:y,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const S=yield e.actor.sendAsync({type:"LDT",data:w});e.dem=S,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const i=e.width+2,l=e.height+2;try{return new c.R({width:i,height:l},yield c.Y(e,-1,-1,i,l))}catch{}}return O.getImageData(e,1)})}_getNeighboringTiles(e){const i=e.canonical,l=Math.pow(2,i.z),u=(i.x-1+l)%l,f=i.x===0?e.wrap-1:e.wrap,y=(i.x+1+l)%l,w=i.x+1===l?e.wrap+1:e.wrap,S={};return S[new c.Z(e.overscaledZ,f,i.z,u,i.y).key]={backfilled:!1},S[new c.Z(e.overscaledZ,w,i.z,y,i.y).key]={backfilled:!1},i.y>0&&(S[new c.Z(e.overscaledZ,f,i.z,u,i.y-1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,w,i.z,y,i.y-1).key]={backfilled:!1}),i.y+1<l&&(S[new c.Z(e.overscaledZ,f,i.z,u,i.y+1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,w,i.z,y,i.y+1).key]={backfilled:!1}),S}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class zi extends c.E{constructor(e,i,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=i.data,this._options=c.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId,i.clusterMaxZoom!==void 0&&this.maxzoom<=i.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${i.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(i.buffer!==void 0?i.buffer:128),tolerance:this._pixelsToTileUnits(i.tolerance!==void 0?i.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(i.clusterMaxZoom),minPoints:Math.max(2,i.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(i.clusterRadius||50),log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.$/this.tileSize)}_getClusterMaxZoom(e){const i=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${i}"`),i}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(i=>i.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const e=new cr,i=yield this.getData();let l;switch(i.type){case"FeatureCollection":l=i.features.map(u=>this.getCoordinatesFromGeometry(u.geometry)).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(i.geometry);break;default:l=this.getCoordinatesFromGeometry(i)}if(l.length==0)return e;for(let u=0;u<l.length-1;u+=2)e.extend([l[u],l[u+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,i,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:i,offset:l}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const i=c.e({type:this.type},this.workerOptions);e?i.dataDiff=e:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(O.resolveURL(this._data),"Source"),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:i});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const f={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&c.e(f,{resourceTiming:u}),this.fire(new c.l("data",Object.assign(Object.assign({},f),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},f),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:i,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,i==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class xi extends c.E{constructor(e,i,l,u){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=i}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield re.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,e&&(this.coordinates=e),this._finishLoading())}catch(i){this._request=null,this._loaded=!0,this.fire(new c.k(i))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const i=e.map(c.a0.fromLngLat);var l;return this.tileID=function(u){const f=c.a1.fromPoints(u),y=f.width(),w=f.height(),S=Math.max(y,w),M=Math.max(0,Math.floor(-Math.log(S)/Math.LN2)),k=Math.pow(2,M);return new c.a3(M,Math.floor((f.minX+f.maxX)/2*k),Math.floor((f.minY+f.maxY)/2*k))}(i),this.terrainTileRanges=this._getOverlappingTileRanges(i),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=i.map(u=>this.tileID.getTilePoint(u)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,i=e.gl;this.texture||(this.texture=new c.T(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const f=this.tiles[u];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:i,minY:l,maxX:u,maxY:f}=c.a1.fromPoints(e),y={};for(let w=0;w<=c.a2;w++){const S=Math.pow(2,w),M=Math.floor(i*S),k=Math.floor(l*S),L=Math.floor(u*S),D=Math.floor(f*S);y[w]={minTileX:M,minTileY:k,maxTileX:L,maxTileY:D}}return y}}class ks extends xi{constructor(e,i,l,u){super(e,i,l,u),this.roundZoom=!0,this.type="video",this.options=i}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const i of e.urls)this.urls.push(this.map._requestManager.transformRequest(i,"Source").url);try{const i=yield c.a4(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new c.k(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new c.k(new c.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,i=e.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const f=this.tiles[u];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class as extends xi{constructor(e,i,l,u){super(e,i,l,u),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(f=>!Array.isArray(f)||f.length!==2||f.some(y=>typeof y!="number"))||this.fire(new c.k(new c.a5(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a5(`sources.${e}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new c.k(new c.a5(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a5(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a5(`sources.${e}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,l=i.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(i,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const da={},zs=p=>{switch(p){case"geojson":return zi;case"image":return xi;case"raster":return uo;case"raster-dem":return qr;case"vector":return Gi;case"video":return ks;case"canvas":return as}return da[p]},jn="RTLPluginLoaded";class As extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=nn()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(i=>{throw this.status="error",i})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(i,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=O.resolveURL(i),!this.url)throw new Error(`requested url ${i} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(jn))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Fn=null;function Ai(){return Fn||(Fn=new As),Fn}class wn{constructor(e,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a6(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const i=e+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,i,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const y={};if(!f)return y;for(const w of u){const S=w.layerIds.map(M=>f.getLayer(M)).filter(Boolean);if(S.length!==0){w.layers=S,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(M=>S.filter(k=>k.id===M)[0]));for(const M of S)y[M.id]=w}}return y}(e.buckets,i==null?void 0:i.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof c.a8){if(this.hasSymbolBuckets=!0,!l)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof c.a8&&f.hasRTLText){this.hasRTLText=!0,Ai().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a7}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,l,u,f,y,w,S,M,k,L){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:y,tileSize:this.tileSize,pixelPosMatrix:k,transform:S,params:w,queryPadding:this.queryPadding*M,getElevation:L},e,i,l):{}}querySourceFeatures(e,i){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),f=i&&i.sourceLayer?i.sourceLayer:"",y=u._geojsonTileLayer||u[f];if(!y)return;const w=c.a9(i&&i.filter),{z:S,x:M,y:k}=this.tileID.canonical,L={z:S,x:M,y:k};for(let D=0;D<y.length;D++){const F=y.feature(D);if(w.needGeometry){const Q=c.aa(F,!0);if(!w.filter(new c.F(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!w.filter(new c.F(this.tileID.overscaledZ),F))continue;const U=l.getId(F,f),ee=new c.ab(F,S,M,k,U);ee.tile=L,e.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const l=c.ac(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(i)if(this.expirationTime<i)u=!0;else{const f=this.expirationTime-i;f?this.expirationTime=l+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!i.style.hasLayer(u))continue;const f=this.buckets[u],y=f.layers[0].sourceLayer||"_geojsonTileLayer",w=l[y],S=e[y];if(!w||!S||Object.keys(S).length===0)continue;f.update(S,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=i&&i.style&&i.style.getLayer(u);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(f)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<O.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=O.now()+e}setDependencies(e,i){const l={};for(const u of i)l[u]=!0;this.dependencies[e]=l}hasDependency(e,i){for(const l of e){const u=this.dependencies[l];if(u){for(const f of i)if(u[f])return!0}}return!1}}class pa{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const f={value:i,timeout:void 0};if(l!==void 0&&(f.timeout=setTimeout(()=>{this.remove(e,f)},l)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const l=e.wrapped().key,u=i===void 0?0:this.data[l].indexOf(i),f=this.data[l][u];return this.data[l].splice(u,1),f.timeout&&clearTimeout(f.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(f.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||i.push(u);for(const l of i)this.remove(l.value.tileID,l)}}class El{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,l){const u=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},c.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const f in this.state[e][u])l[f]||(this.deletedStates[e][u][f]=null)}else for(const f in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][f]===null&&delete this.deletedStates[e][u][f]}removeFeatureState(e,i,l){if(this.deletedStates[e]===null)return;const u=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&i!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,i){const l=String(i),u=c.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const f=this.deletedStates[e][i];if(f===null)return{};for(const y in f)delete u[y]}return u}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const y in this.stateChanges[u])this.state[u][y]||(this.state[u][y]={}),c.e(this.state[u][y],this.stateChanges[u][y]),f[y]=this.state[u][y];l[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(this.deletedStates[u]===null)for(const y in this.state[u])f[y]={},this.state[u][y]={};else for(const y in this.deletedStates[u]){if(this.deletedStates[u][y]===null)this.state[u][y]={};else for(const w of Object.keys(this.deletedStates[u][y]))delete this.state[u][y][w];f[y]=this.state[u][y]}l[u]=l[u]||{},c.e(l[u],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,i)}}const Bn=89.25;function Se(p,e){const i=c.ag(e.lat,-85.051129,c.ah);return new c.P(c.V(e.lng)*p,c.U(i)*p)}function q(p,e){return new c.a0(e.x/p,e.y/p).toLngLat()}function W(p){return p.cameraToCenterDistance*Math.min(.85*Math.tan(c.ad(90-p.pitch)),Math.tan(c.ad(Bn-p.pitch)))}function J(p,e){const i=p.canonical,l=e/c.ae(i.z),u=i.x+Math.pow(2,i.z)*p.wrap,f=c.af(new Float64Array(16));return c.M(f,f,[u*l,i.y*l,0]),c.N(f,f,[l/c.$,l/c.$,1]),f}function le(p,e,i,l,u){const f=c.a0.fromLngLat(p,e),y=u*c.ai(1,p.lat),w=y*Math.cos(c.ad(i)),S=Math.sqrt(y*y-w*w),M=S*Math.sin(c.ad(-l)),k=S*Math.cos(c.ad(-l));return new c.a0(f.x+M,f.y+k,f.z+w)}function _e(p,e,i){const l=e.intersectsFrustum(p);if(!i||l===0)return l;const u=e.intersectsPlane(i);return u===0?0:l===2&&u===2?2:1}function we(p,e,i){let l=0;const u=(i-e)/10;for(let f=0;f<10;f++)l+=u*Math.pow(Math.cos(e+(f+.5)/10*(i-e)),p);return l}function Ae(p,e){return function(i,l,u,f,y){const w=2*((p-1)/c.aj(Math.cos(c.ad(Bn-y))/Math.cos(c.ad(Bn)))-1),S=Math.acos(u/f),M=2*we(w-1,0,c.ad(y/2)),k=Math.min(c.ad(Bn),S+c.ad(y/2)),L=we(w-1,Math.min(k,S-c.ad(y/2)),k),D=Math.atan(l/u),F=Math.hypot(l,u);let U=i;return U+=c.aj(f/F/Math.max(.5,Math.cos(c.ad(y/2)))),U+=w*c.aj(Math.cos(D))/2,U-=c.aj(Math.max(1,L/M/e))/2,U}}const xe=Ae(9.314,3);function Be(p,e){const i=(e.roundZoom?Math.round:Math.floor)(p.zoom+c.aj(p.tileSize/e.tileSize));return Math.max(0,i)}function je(p,e){const i=p.getCameraFrustum(),l=p.getClippingPlane(),u=p.screenPointToMercatorCoordinate(p.getCameraPoint()),f=c.a0.fromLngLat(p.center,p.elevation);u.z=f.z+Math.cos(p.pitchInRadians)*p.cameraToCenterDistance/p.worldSize;const y=p.getCoveringTilesDetailsProvider(),w=y.allowVariableZoom(p,e),S=Be(p,e),M=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:p.maxZoom,L=Math.min(Math.max(0,S),k),D=Math.pow(2,L),F=[D*u.x,D*u.y,0],U=[D*f.x,D*f.y,0],ee=Math.hypot(f.x-u.x,f.y-u.y),Q=Math.abs(f.z-u.z),te=Math.hypot(ee,Q),ne=de=>({zoom:0,x:0,y:0,wrap:de,fullyVisible:!1}),ce=[],se=[];if(p.renderWorldCopies&&y.allowWorldCopies())for(let de=1;de<=3;de++)ce.push(ne(-de)),ce.push(ne(de));for(ce.push(ne(0));ce.length>0;){const de=ce.pop(),fe=de.x,oe=de.y;let ve=de.fullyVisible;const Re={x:fe,y:oe,z:de.zoom},Ee=y.getTileBoundingVolume(Re,de.wrap,p.elevation,e);if(!ve){const Xe=_e(i,Ee,l);if(Xe===0)continue;ve=Xe===2}const ke=y.distanceToTile2d(u.x,u.y,Re,Ee);let De=S;w&&(De=(e.calculateTileZoom||xe)(p.zoom+c.aj(p.tileSize/e.tileSize),ke,Q,te,p.fov)),De=(e.roundZoom?Math.round:Math.floor)(De),De=Math.max(0,De);const Ye=Math.min(De,k);if(de.wrap=y.getWrap(f,Re,de.wrap),de.zoom>=Ye){if(de.zoom<M)continue;const Xe=L-de.zoom,Ue=F[0]-.5-(fe<<Xe),rt=F[1]-.5-(oe<<Xe),St=e.reparseOverscaled?Math.max(de.zoom,De):de.zoom;se.push({tileID:new c.Z(de.zoom===k?St:de.zoom,de.wrap,de.zoom,fe,oe),distanceSq:c.ak([U[0]-.5-fe,U[1]-.5-oe]),tileDistanceToCamera:Math.sqrt(Ue*Ue+rt*rt)})}else for(let Xe=0;Xe<4;Xe++)ce.push({zoom:de.zoom+1,x:(fe<<1)+Xe%2,y:(oe<<1)+(Xe>>1),wrap:de.wrap,fullyVisible:ve})}return se.sort((de,fe)=>de.distanceSq-fe.distanceSq).map(de=>de.tileID)}const Me=c.a1.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class $e extends c.E{constructor(e,i,l){super(),this.id=e,this.dispatcher=l,this.on("data",u=>this._dataHandler(u)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((u,f,y,w)=>{const S=new(zs(f.type))(u,f,y,w);if(S.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${S.id}`);return S})(e,i,l,this),this._tiles={},this._cache=new pa(0,u=>this._unloadTile(u)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new El,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,i,l){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,i,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new c.k(u,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const l=this._tiles[i];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(me).map(e=>e.key)}getRenderableIds(e){const i=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&i.push(this._tiles[l]);return e?i.sort((l,u)=>{const f=l.tileID,y=u.tileID,w=new c.P(f.canonical.x,f.canonical.y)._rotate(-this.transform.bearingInRadians),S=new c.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians);return f.overscaledZ-y.overscaledZ||S.y-w.y||S.x-w.x}).map(l=>l.tileID.key):i.map(l=>l.tileID).sort(me).map(l=>l.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)e?this._reloadTile(i,"expired"):this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(e,i){return c._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=i),yield this._loadTile(l,e,i))})}_tileLoaded(e,i,l){e.timeAdded=O.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const i=this.getRenderableIds();for(let u=0;u<i.length;u++){const f=i[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const y=this.getTileByID(f);l(e,y),l(y,e)}}function l(u,f){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let y=f.tileID.canonical.x-u.tileID.canonical.x;const w=f.tileID.canonical.y-u.tileID.canonical.y,S=Math.pow(2,u.tileID.canonical.z),M=f.tileID.key;y===0&&w===0||Math.abs(w)>1||(Math.abs(y)>1&&(Math.abs(y+S)===1?y+=S:Math.abs(y-S)===1&&(y-=S)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,y,w),u.neighboringTiles&&u.neighboringTiles[M]&&(u.neighboringTiles[M].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,l,u){for(const f in this._tiles){let y=this._tiles[f];if(u[f]||!y.hasData()||y.tileID.overscaledZ<=i||y.tileID.overscaledZ>l)continue;let w=y.tileID;for(;y&&y.tileID.overscaledZ>i+1;){const M=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[M.key],y&&y.hasData()&&(w=M)}let S=w;for(;S.overscaledZ>i;)if(S=S.scaledTo(S.overscaledZ-1),e[S.key]||e[S.canonical.key]){u[w.key]=w;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=i?l:null}for(let l=e.overscaledZ-1;l>=i;l--){const u=e.scaledTo(l),f=this._getLoadedTile(u);if(f)return f}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const i=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(i*l*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(f)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const l={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+i),l[f.tileID.key]=f}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,i,l,u,f,y){const w={},S={},M=Object.keys(e),k=O.now();for(const L of M){const D=e[L],F=this._tiles[L];if(!F||F.fadeEndTime!==0&&F.fadeEndTime<=k)continue;const U=this.findLoadedParent(D,i),ee=this.findLoadedSibling(D),Q=U||ee||null;Q&&(this._addTile(Q.tileID),w[Q.tileID.key]=Q.tileID),S[L]=D}this._retainLoadedChildren(S,u,l,e);for(const L in w)e[L]||(this._coveredTiles[L]=!0,e[L]=w[L]);if(y){const L={},D={};for(const F of f)this._tiles[F.key].hasData()?L[F.key]=F:D[F.key]=F;for(const F in D){const U=D[F].children(this._source.maxzoom);this._tiles[U[0].key]&&this._tiles[U[1].key]&&this._tiles[U[2].key]&&this._tiles[U[3].key]&&(L[U[0].key]=e[U[0].key]=U[0],L[U[1].key]=e[U[1].key]=U[1],L[U[2].key]=e[U[2].key]=U[2],L[U[3].key]=e[U[3].key]=U[3],delete D[F])}for(const F in D){const U=D[F],ee=this.findLoadedParent(U,this._source.minzoom),Q=this.findLoadedSibling(U),te=ee||Q||null;if(te){L[te.tileID.key]=e[te.tileID.key]=te.tileID;for(const ne in L)L[ne].isChildOf(te.tileID)&&delete L[ne]}}for(const F in this._tiles)L[F]||(this._coveredTiles[F]=!0)}}update(e,i){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=i,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new c.Z(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(l=je(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(k=>this._source.hasTile(k)))):l=[];const u=Be(e,this._source),f=Math.max(u-$e.maxOverzooming,this._source.minzoom),y=Math.max(u+$e.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const L of l)if(L.canonical.z>this._source.minzoom){const D=L.scaledTo(L.canonical.z-1);k[D.key]=D;const F=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));k[F.key]=F}l=l.concat(Object.values(k))}const w=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=this._updateRetainedTiles(l,u);Je(this._source.type)&&this._updateCoveredAndRetainedTiles(S,f,y,u,l,i);for(const k in S)this._tiles[k].clearFadeHold();const M=c.al(this._tiles,S);for(const k of M){const L=this._tiles[k];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,i){var l;const u={},f={},y=Math.max(i-$e.maxOverzooming,this._source.minzoom),w=Math.max(i+$e.maxUnderzooming,this._source.minzoom),S={};for(const M of e){const k=this._addTile(M);u[M.key]=M,k.hasData()||i<this._source.maxzoom&&(S[M.key]=M)}this._retainLoadedChildren(S,i,w,u);for(const M of e){let k=this._tiles[M.key];if(k.hasData())continue;if(i+1>this._source.maxzoom){const D=M.children(this._source.maxzoom)[0],F=this.getTile(D);if(F&&F.hasData()){u[D.key]=D;continue}}else{const D=M.children(this._source.maxzoom);if(u[D[0].key]&&u[D[1].key]&&u[D[2].key]&&u[D[3].key])continue}let L=k.wasRequested();for(let D=M.overscaledZ-1;D>=y;--D){const F=M.scaledTo(D);if(f[F.key])break;if(f[F.key]=!0,k=this.getTile(F),!k&&L&&(k=this._addTile(F)),k){const U=k.hasData();if((U||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||L)&&(u[F.key]=F),L=k.wasRequested(),U)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}i.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(f),l)break;u=f}for(const f of i)this._loadedParentTiles[f]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const i=this._tiles[e].tileID,l=this._getLoadedTile(i);this._loadedSiblingTiles[i.key]=l}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const l=i;return i||(i=new wn(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(i,e.key,i.state)),i.uses++,this._tiles[e.key]=i,l||this._source.fire(new c.l("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=i.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}refreshTiles(e){for(const i in this._tiles)(this._isIdRenderable(i)||this._tiles[i].state=="errored")&&e.some(l=>l.equals(this._tiles[i].tileID.canonical))&&this._reloadTile(i,"expired")}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}_dataHandler(e){const i=e.sourceDataType;e.dataType==="source"&&i==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&i==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,i,l){const u=[],f=this.transform;if(!f)return u;const y=f.getCoveringTilesDetailsProvider().allowWorldCopies(),w=l?f.getCameraQueryGeometry(e):e,S=F=>f.screenPointToMercatorCoordinate(F,this.terrain),M=this.transformBbox(e,S,!y),k=this.transformBbox(w,S,!y),L=this.getIds(),D=c.a1.fromPoints(k);for(let F=0;F<L.length;F++){const U=this._tiles[L[F]];if(U.holdingForFade())continue;const ee=y?[U.tileID]:[U.tileID.unwrapTo(-1),U.tileID.unwrapTo(0)],Q=Math.pow(2,f.zoom-U.tileID.overscaledZ),te=i*U.queryPadding*c.$/U.tileSize/Q;for(const ne of ee){const ce=D.map(se=>ne.getTilePoint(new c.a0(se.x,se.y)));if(ce.expandBy(te),ce.intersects(Me)){const se=M.map(fe=>ne.getTilePoint(fe)),de=k.map(fe=>ne.getTilePoint(fe));u.push({tile:U,tileID:y?ne:ne.unwrapTo(0),queryGeometry:se,cameraQueryGeometry:de,scale:Q})}}}return u}transformBbox(e,i,l){let u=e.map(i);if(l){const f=c.a1.fromPoints(e);f.shrinkBy(.001*Math.min(f.width(),f.height()));const y=f.map(i);c.a1.fromPoints(u).covers(y)||(u=u.map(w=>w.x>.5?new c.a0(w.x-1,w.y,w.z):w))}return u}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(i),i}hasTransition(){if(this._source.hasTransition())return!0;if(Je(this._source.type)){const e=O.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=e)return!0}return!1}setFeatureState(e,i,l){this._state.updateState(e=e||"_geojsonTileLayer",i,l)}removeFeatureState(e,i,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,l)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,l){const u=this._tiles[e];u&&u.setDependencies(i,l)}reloadTilesForDependencies(e,i){for(const l in this._tiles)this._tiles[l].hasDependency(e,i)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,i))}}function me(p,e){const i=Math.abs(2*p.wrap)-+(p.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return p.overscaledZ-e.overscaledZ||l-i||e.canonical.y-p.canonical.y||e.canonical.x-p.canonical.x}function Je(p){return p==="raster"||p==="image"||p==="video"}$e.maxOverzooming=10,$e.maxUnderzooming=3;class ft{constructor(e,i){this.reset(e,i)}reset(e,i){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ag(e,0,1);let i=1,l=this._distances[i];const u=e*this.paddedLength+this.padding;for(;l<u&&i<this._distances.length;)l=this._distances[++i];const f=i-1,y=this._distances[f],w=l-y,S=w>0?(u-y)/w:0;return this.points[f].mult(1-S).add(this.points[i].mult(S))}}function tt(p,e){let i=!0;return p==="always"||p!=="never"&&e!=="never"||(i=!1),i}class lt{constructor(e,i,l){const u=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(i/l);for(let y=0;y<this.xCellCount*this.yCellCount;y++)u.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=i,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,i,l,u,f){this._forEachCell(i,l,u,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(f)}insertCircle(e,i,l,u){this._forEachCell(i-u,l-u,i+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(i),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,i,l,u,f,y){this.boxCells[f].push(y)}_insertCircleCell(e,i,l,u,f,y){this.circleCells[f].push(y)}_query(e,i,l,u,f,y,w){if(l<0||e>this.width||u<0||i>this.height)return[];const S=[];if(e<=0&&i<=0&&this.width<=l&&this.height<=u){if(f)return[{key:null,x1:e,y1:i,x2:l,y2:u}];for(let M=0;M<this.boxKeys.length;M++)S.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const k=this.circles[3*M],L=this.circles[3*M+1],D=this.circles[3*M+2];S.push({key:this.circleKeys[M],x1:k-D,y1:L-D,x2:k+D,y2:L+D})}}else this._forEachCell(e,i,l,u,this._queryCell,S,{hitTest:f,overlapMode:y,seenUids:{box:{},circle:{}}},w);return S}query(e,i,l,u){return this._query(e,i,l,u,!1,null)}hitTest(e,i,l,u,f,y){return this._query(e,i,l,u,!0,f,y).length>0}hitTestCircle(e,i,l,u,f){const y=e-l,w=e+l,S=i-l,M=i+l;if(w<0||y>this.width||M<0||S>this.height)return!1;const k=[];return this._forEachCell(y,S,w,M,this._queryCellCircle,k,{hitTest:!0,overlapMode:u,circle:{x:e,y:i,radius:l},seenUids:{box:{},circle:{}}},f),k.length>0}_queryCell(e,i,l,u,f,y,w,S){const{seenUids:M,hitTest:k,overlapMode:L}=w,D=this.boxCells[f];if(D!==null){const U=this.bboxes;for(const ee of D)if(!M.box[ee]){M.box[ee]=!0;const Q=4*ee,te=this.boxKeys[ee];if(e<=U[Q+2]&&i<=U[Q+3]&&l>=U[Q+0]&&u>=U[Q+1]&&(!S||S(te))&&(!k||!tt(L,te.overlapMode))&&(y.push({key:te,x1:U[Q],y1:U[Q+1],x2:U[Q+2],y2:U[Q+3]}),k))return!0}}const F=this.circleCells[f];if(F!==null){const U=this.circles;for(const ee of F)if(!M.circle[ee]){M.circle[ee]=!0;const Q=3*ee,te=this.circleKeys[ee];if(this._circleAndRectCollide(U[Q],U[Q+1],U[Q+2],e,i,l,u)&&(!S||S(te))&&(!k||!tt(L,te.overlapMode))){const ne=U[Q],ce=U[Q+1],se=U[Q+2];if(y.push({key:te,x1:ne-se,y1:ce-se,x2:ne+se,y2:ce+se}),k)return!0}}}return!1}_queryCellCircle(e,i,l,u,f,y,w,S){const{circle:M,seenUids:k,overlapMode:L}=w,D=this.boxCells[f];if(D!==null){const U=this.bboxes;for(const ee of D)if(!k.box[ee]){k.box[ee]=!0;const Q=4*ee,te=this.boxKeys[ee];if(this._circleAndRectCollide(M.x,M.y,M.radius,U[Q+0],U[Q+1],U[Q+2],U[Q+3])&&(!S||S(te))&&!tt(L,te.overlapMode))return y.push(!0),!0}}const F=this.circleCells[f];if(F!==null){const U=this.circles;for(const ee of F)if(!k.circle[ee]){k.circle[ee]=!0;const Q=3*ee,te=this.circleKeys[ee];if(this._circlesCollide(U[Q],U[Q+1],U[Q+2],M.x,M.y,M.radius)&&(!S||S(te))&&!tt(L,te.overlapMode))return y.push(!0),!0}}}_forEachCell(e,i,l,u,f,y,w,S){const M=this._convertToXCellCoord(e),k=this._convertToYCellCoord(i),L=this._convertToXCellCoord(l),D=this._convertToYCellCoord(u);for(let F=M;F<=L;F++)for(let U=k;U<=D;U++)if(f.call(this,e,i,l,u,this.xCellCount*U+F,y,w,S))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,i,l,u,f,y){const w=u-e,S=f-i,M=l+y;return M*M>w*w+S*S}_circleAndRectCollide(e,i,l,u,f,y,w){const S=(y-u)/2,M=Math.abs(e-(u+S));if(M>S+l)return!1;const k=(w-f)/2,L=Math.abs(i-(f+k));if(L>k+l)return!1;if(M<=S||L<=k)return!0;const D=M-S,F=L-k;return D*D+F*F<=l*l}}function yt(p,e,i){const l=c.L();if(!p){const{vecSouth:L,vecEast:D}=Ut(e),F=K();F[0]=D[0],F[1]=D[1],F[2]=L[0],F[3]=L[1],u=F,(k=(y=(f=F)[0])*(M=f[3])-(S=f[2])*(w=f[1]))&&(u[0]=M*(k=1/k),u[1]=-w*k,u[2]=-S*k,u[3]=y*k),l[0]=F[0],l[1]=F[1],l[4]=F[2],l[5]=F[3]}var u,f,y,w,S,M,k;return c.N(l,l,[1/i,1/i,1]),l}function Yt(p,e,i,l){if(p){const u=c.L();if(!e){const{vecSouth:f,vecEast:y}=Ut(i);u[0]=y[0],u[1]=y[1],u[4]=f[0],u[5]=f[1]}return c.N(u,u,[l,l,1]),u}return i.pixelsToClipSpaceMatrix}function Ut(p){const e=Math.cos(p.rollInRadians),i=Math.sin(p.rollInRadians),l=Math.cos(p.pitchInRadians),u=Math.cos(p.bearingInRadians),f=Math.sin(p.bearingInRadians),y=c.aq();y[0]=-u*l*i-f*e,y[1]=-f*l*i+u*e;const w=c.ar(y);w<1e-9?c.as(y):c.at(y,y,1/w);const S=c.aq();S[0]=u*l*e-f*i,S[1]=f*l*e+u*i;const M=c.ar(S);return M<1e-9?c.as(S):c.at(S,S,1/M),{vecEast:S,vecSouth:y}}function Ot(p,e,i,l){let u;l?(u=[p,e,l(p,e),1],c.av(u,u,i)):(u=[p,e,0,1],Ds(u,u,i));const f=u[3];return{point:new c.P(u[0]/f,u[1]/f),signedDistanceFromCamera:f,isOccluded:!1}}function gt(p,e){return .5+p/e*.5}function Rt(p,e){return p.x>=-e[0]&&p.x<=e[0]&&p.y>=-e[1]&&p.y<=e[1]}function jr(p,e,i,l,u,f,y,w,S,M,k,L,D){const F=i?p.textSizeData:p.iconSizeData,U=c.am(F,e.transform.zoom),ee=[256/e.width*2+1,256/e.height*2+1],Q=i?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;Q.clear();const te=p.lineVertexArray,ne=i?p.text.placedSymbolArray:p.icon.placedSymbolArray,ce=e.transform.width/e.transform.height;let se=!1;for(let de=0;de<ne.length;de++){const fe=ne.get(de);if(fe.hidden||fe.writingMode===c.an.vertical&&!se){On(fe.numGlyphs,Q);continue}se=!1;const oe=new c.P(fe.anchorX,fe.anchorY),ve={getElevation:D,pitchedLabelPlaneMatrix:l,lineVertexArray:te,pitchWithMap:f,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:oe,unwrappedTileID:S,width:M,height:k,translation:L},Re=Pt(fe.anchorX,fe.anchorY,ve);if(!Rt(Re.point,ee)){On(fe.numGlyphs,Q);continue}const Ee=gt(e.transform.cameraToCenterDistance,Re.signedDistanceFromCamera),ke=c.ao(F,U,fe),De=f?ke*e.transform.getPitchedTextCorrection(fe.anchorX,fe.anchorY,S)/Ee:ke*Ee,Ye=tr({projectionContext:ve,pitchedLabelPlaneMatrixInverse:u,symbol:fe,fontSize:De,flip:!1,keepUpright:y,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:Q,aspectRatio:ce,rotateToLine:w});se=Ye.useVertical,(Ye.notEnoughRoom||se||Ye.needsFlipping&&tr({projectionContext:ve,pitchedLabelPlaneMatrixInverse:u,symbol:fe,fontSize:De,flip:!0,keepUpright:y,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:Q,aspectRatio:ce,rotateToLine:w}).notEnoughRoom)&&On(fe.numGlyphs,Q)}i?p.text.dynamicLayoutVertexBuffer.updateData(Q):p.icon.dynamicLayoutVertexBuffer.updateData(Q)}function He(p,e,i,l,u,f,y,w){const S=f.glyphStartIndex+f.numGlyphs,M=f.lineStartIndex,k=f.lineStartIndex+f.lineLength,L=e.getoffsetX(f.glyphStartIndex),D=e.getoffsetX(S-1),F=Tn(p*L,i,l,u,f.segment,M,k,w,y);if(!F)return null;const U=Tn(p*D,i,l,u,f.segment,M,k,w,y);return U?w.projectionCache.anyProjectionOccluded?null:{first:F,last:U}:null}function Wr(p,e,i,l){return p===c.an.horizontal&&Math.abs(i.y-e.y)>Math.abs(i.x-e.x)*l?{useVertical:!0}:(p===c.an.vertical?e.y<i.y:e.x>i.x)?{needsFlipping:!0}:null}function tr(p){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:i,symbol:l,fontSize:u,flip:f,keepUpright:y,glyphOffsetArray:w,dynamicLayoutVertexArray:S,aspectRatio:M,rotateToLine:k}=p,L=u/24,D=l.lineOffsetX*L,F=l.lineOffsetY*L;let U;if(l.numGlyphs>1){const ee=l.glyphStartIndex+l.numGlyphs,Q=l.lineStartIndex,te=l.lineStartIndex+l.lineLength,ne=He(L,w,D,F,f,l,k,e);if(!ne)return{notEnoughRoom:!0};const ce=Ct(ne.first.point.x,ne.first.point.y,e,i),se=Ct(ne.last.point.x,ne.last.point.y,e,i);if(y&&!f){const de=Wr(l.writingMode,ce,se,M);if(de)return de}U=[ne.first];for(let de=l.glyphStartIndex+1;de<ee-1;de++){const fe=Tn(L*w.getoffsetX(de),D,F,f,l.segment,Q,te,e,k);if(!fe)return{notEnoughRoom:!0};U.push(fe)}U.push(ne.last)}else{if(y&&!f){const Q=Ke(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,te=l.lineStartIndex+l.segment+1,ne=new c.P(e.lineVertexArray.getx(te),e.lineVertexArray.gety(te)),ce=Ke(ne.x,ne.y,e),se=ce.signedDistanceFromCamera>0?ce.point:ls(e.tileAnchorPoint,ne,Q,1,e),de=Ct(Q.x,Q.y,e,i),fe=Ct(se.x,se.y,e,i),oe=Wr(l.writingMode,de,fe,M);if(oe)return oe}const ee=Tn(L*w.getoffsetX(l.glyphStartIndex),D,F,f,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,k);if(!ee||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};U=[ee]}for(const ee of U)c.au(S,ee.point,ee.angle);return{}}function ls(p,e,i,l,u){const f=p.add(p.sub(e)._unit()),y=Ke(f.x,f.y,u).point,w=i.sub(y);return i.add(w._mult(l/w.mag()))}function Rs(p,e,i){const l=e.projectionCache;if(l.projections[p])return l.projections[p];const u=new c.P(e.lineVertexArray.getx(p),e.lineVertexArray.gety(p)),f=Ke(u.x,u.y,e);if(f.signedDistanceFromCamera>0)return l.projections[p]=f.point,l.anyProjectionOccluded=l.anyProjectionOccluded||f.isOccluded,f.point;const y=p-i.direction;return ls(i.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),u,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,e)}function Ke(p,e,i){const l=p+i.translation[0],u=e+i.translation[1];let f;return i.pitchWithMap?(f=Ot(l,u,i.pitchedLabelPlaneMatrix,i.getElevation),f.isOccluded=!1):(f=i.transform.projectTileCoordinates(l,u,i.unwrappedTileID,i.getElevation),f.point.x=(.5*f.point.x+.5)*i.width,f.point.y=(.5*-f.point.y+.5)*i.height),f}function Ct(p,e,i,l){if(i.pitchWithMap){const u=[p,e,0,1];return c.av(u,u,l),i.transform.projectTileCoordinates(u[0]/u[3],u[1]/u[3],i.unwrappedTileID,i.getElevation).point}return{x:p/i.width*2-1,y:e/i.height*2-1}}function Pt(p,e,i){return i.transform.projectTileCoordinates(p,e,i.unwrappedTileID,i.getElevation)}function Ri(p,e,i){return p._unit()._perp()._mult(e*i)}function kl(p,e,i,l,u,f,y,w,S){if(w.projectionCache.offsets[p])return w.projectionCache.offsets[p];const M=i.add(e);if(p+S.direction<l||p+S.direction>=u)return w.projectionCache.offsets[p]=M,M;const k=Rs(p+S.direction,w,S),L=Ri(k.sub(i),y,S.direction),D=i.add(L),F=k.add(L);return w.projectionCache.offsets[p]=c.aw(f,M,D,F)||M,w.projectionCache.offsets[p]}function Tn(p,e,i,l,u,f,y,w,S){const M=l?p-e:p+e;let k=M>0?1:-1,L=0;l&&(k*=-1,L=Math.PI),k<0&&(L+=Math.PI);let D,F=k>0?f+u:f+u+1;w.projectionCache.cachedAnchorPoint?D=w.projectionCache.cachedAnchorPoint:(D=Ke(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=D);let U,ee,Q=D,te=D,ne=0,ce=0;const se=Math.abs(M),de=[];let fe;for(;ne+ce<=se;){if(F+=k,F<f||F>=y)return null;ne+=ce,te=Q,ee=U;const Re={absOffsetX:se,direction:k,distanceFromAnchor:ne,previousVertex:te};if(Q=Rs(F,w,Re),i===0)de.push(te),fe=Q.sub(te);else{let Ee;const ke=Q.sub(te);Ee=ke.mag()===0?Ri(Rs(F+k,w,Re).sub(Q),i,k):Ri(ke,i,k),ee||(ee=te.add(Ee)),U=kl(F,Ee,Q,f,y,ee,i,w,Re),de.push(ee),fe=U.sub(ee)}ce=fe.mag()}const oe=fe._mult((se-ne)/ce)._add(ee||te),ve=L+Math.atan2(Q.y-te.y,Q.x-te.x);return de.push(oe),{point:oe,angle:S?ve:0,path:de}}const Mt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function On(p,e){for(let i=0;i<p;i++){const l=e.length;e.resize(l+4),e.float32.set(Mt,3*l)}}function Ds(p,e,i){const l=e[0],u=e[1];return p[0]=i[0]*l+i[4]*u+i[12],p[1]=i[1]*l+i[5]*u+i[13],p[3]=i[3]*l+i[7]*u+i[15],p}const vr=100;class fa{constructor(e,i=new lt(e.width+200,e.height+200,25),l=new lt(e.width+200,e.height+200,25)){this.transform=e,this.grid=i,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+vr,this.screenBottomBoundary=e.height+vr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,i,l,u,f,y,w,S,M,k,L,D){const F=this.projectAndGetPerspectiveRatio(e.anchorPointX+S[0],e.anchorPointY+S[1],f,k,D),U=l*F.perspectiveRatio;let ee;if(y||w)ee=this._projectCollisionBox(e,U,u,f,y,w,S,F,k,L,D);else{const fe=F.x+(L?L.x*U:0),oe=F.y+(L?L.y*U:0);ee={allPointsOccluded:!1,box:[fe+e.x1*U,oe+e.y1*U,fe+e.x2*U,oe+e.y2*U]}}const[Q,te,ne,ce]=ee.box,se=y?ee.allPointsOccluded:F.isOccluded;let de=se;return de||(de=F.perspectiveRatio<this.perspectiveRatioCutoff),de||(de=!this.isInsideGrid(Q,te,ne,ce)),de||i!=="always"&&this.grid.hitTest(Q,te,ne,ce,i,M)?{box:[Q,te,ne,ce],placeable:!1,offscreen:!1,occluded:se}:{box:[Q,te,ne,ce],placeable:!0,offscreen:this.isOffscreen(Q,te,ne,ce),occluded:se}}placeCollisionCircles(e,i,l,u,f,y,w,S,M,k,L,D,F,U){const ee=[],Q=new c.P(i.anchorX,i.anchorY),te=this.getPerspectiveRatio(Q.x,Q.y,y,U),ne=(M?f*this.transform.getPitchedTextCorrection(i.anchorX,i.anchorY,y)/te:f*te)/c.aA,ce={getElevation:U,pitchedLabelPlaneMatrix:w,lineVertexArray:l,pitchWithMap:M,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Q,unwrappedTileID:y,width:this.transform.width,height:this.transform.height,translation:F},se=He(ne,u,i.lineOffsetX*ne,i.lineOffsetY*ne,!1,i,!1,ce);let de=!1,fe=!1,oe=!0;if(se){const ve=.5*L*te+D,Re=new c.P(-100,-100),Ee=new c.P(this.screenRightBoundary,this.screenBottomBoundary),ke=new ft,De=se.first,Ye=se.last;let Xe=[];for(let St=De.path.length-1;St>=1;St--)Xe.push(De.path[St]);for(let St=1;St<Ye.path.length;St++)Xe.push(Ye.path[St]);const Ue=2.5*ve;if(M){const St=this.projectPathToScreenSpace(Xe,ce);Xe=St.some(Vt=>Vt.signedDistanceFromCamera<=0)?[]:St.map(Vt=>Vt.point)}let rt=[];if(Xe.length>0){const St=Xe[0].clone(),Vt=Xe[0].clone();for(let sr=1;sr<Xe.length;sr++)St.x=Math.min(St.x,Xe[sr].x),St.y=Math.min(St.y,Xe[sr].y),Vt.x=Math.max(Vt.x,Xe[sr].x),Vt.y=Math.max(Vt.y,Xe[sr].y);rt=St.x>=Re.x&&Vt.x<=Ee.x&&St.y>=Re.y&&Vt.y<=Ee.y?[Xe]:Vt.x<Re.x||St.x>Ee.x||Vt.y<Re.y||St.y>Ee.y?[]:c.ax([Xe],Re.x,Re.y,Ee.x,Ee.y)}for(const St of rt){ke.reset(St,.25*ve);let Vt=0;Vt=ke.length<=.5*ve?1:Math.ceil(ke.paddedLength/Ue)+1;for(let sr=0;sr<Vt;sr++){const qt=sr/Math.max(Vt-1,1),or=ke.lerp(qt),Ht=or.x+vr,Wt=or.y+vr;ee.push(Ht,Wt,ve,0);const Xt=Ht-ve,Xr=Wt-ve,Lt=Ht+ve,Or=Wt+ve;if(oe=oe&&this.isOffscreen(Xt,Xr,Lt,Or),fe=fe||this.isInsideGrid(Xt,Xr,Lt,Or),e!=="always"&&this.grid.hitTestCircle(Ht,Wt,ve,e,k)&&(de=!0,!S))return{circles:[],offscreen:!1,collisionDetected:de}}}}return{circles:!S&&de||!fe||te<this.perspectiveRatioCutoff?[]:ee,offscreen:oe,collisionDetected:de}}projectPathToScreenSpace(e,i){const l=function(u,f){const y=c.L();return c.ap(y,f.pitchedLabelPlaneMatrix),u.map(w=>{const S=Ot(w.x,w.y,y,f.getElevation),M=f.transform.projectTileCoordinates(S.point.x,S.point.y,f.unwrappedTileID,f.getElevation);return M.point.x=(.5*M.point.x+.5)*f.width,M.point.y=(.5*-M.point.y+.5)*f.height,M})}(e,i);return function(u){let f=0,y=0,w=0,S=0;for(let M=0;M<u.length;M++)u[M].isOccluded?(w=M+1,S=0):(S++,S>y&&(y=S,f=w));return u.slice(f,f+y)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[],l=new c.a1;for(const L of e){const D=new c.P(L.x+vr,L.y+vr);l.extend(D),i.push(D)}const{minX:u,minY:f,maxX:y,maxY:w}=l,S=this.grid.query(u,f,y,w).concat(this.ignoredGrid.query(u,f,y,w)),M={},k={};for(const L of S){const D=L.key;if(M[D.bucketInstanceId]===void 0&&(M[D.bucketInstanceId]={}),M[D.bucketInstanceId][D.featureIndex])continue;const F=[new c.P(L.x1,L.y1),new c.P(L.x2,L.y1),new c.P(L.x2,L.y2),new c.P(L.x1,L.y2)];c.ay(i,F)&&(M[D.bucketInstanceId][D.featureIndex]=!0,k[D.bucketInstanceId]===void 0&&(k[D.bucketInstanceId]=[]),k[D.bucketInstanceId].push(D.featureIndex))}return k}insertCollisionBox(e,i,l,u,f,y){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:f,collisionGroupID:y,overlapMode:i},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,i,l,u,f,y){const w=l?this.ignoredGrid:this.grid,S={bucketInstanceId:u,featureIndex:f,collisionGroupID:y,overlapMode:i};for(let M=0;M<e.length;M+=4)w.insertCircle(S,e[M],e[M+1],e[M+2])}projectAndGetPerspectiveRatio(e,i,l,u,f){if(f){let y;u?(y=[e,i,u(e,i),1],c.av(y,y,f)):(y=[e,i,0,1],Ds(y,y,f));const w=y[3];return{x:(y[0]/w+1)/2*this.transform.width+vr,y:(-y[1]/w+1)/2*this.transform.height+vr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}{const y=this.transform.projectTileCoordinates(e,i,l,u);return{x:(y.point.x+1)/2*this.transform.width+vr,y:(1-y.point.y)/2*this.transform.height+vr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5,isOccluded:y.isOccluded,signedDistanceFromCamera:y.signedDistanceFromCamera}}}getPerspectiveRatio(e,i,l,u){const f=this.transform.projectTileCoordinates(e,i,l,u);return .5+this.transform.cameraToCenterDistance/f.signedDistanceFromCamera*.5}isOffscreen(e,i,l,u){return l<vr||e>=this.screenRightBoundary||u<vr||i>this.screenBottomBoundary}isInsideGrid(e,i,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const e=c.af([]);return c.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,i,l,u,f,y,w,S,M,k,L){let D=1,F=0,U=0,ee=1;const Q=e.anchorPointX+w[0],te=e.anchorPointY+w[1];if(y&&!f){const Xe=this.projectAndGetPerspectiveRatio(Q+1,te,u,M,L),Ue=Xe.x-S.x,rt=Math.atan((Xe.y-S.y)/Ue)+(Ue<0?Math.PI:0),St=Math.sin(rt),Vt=Math.cos(rt);D=Vt,F=St,U=-St,ee=Vt}else if(!y&&f){const Xe=Ut(this.transform);D=Xe.vecEast[0],F=Xe.vecEast[1],U=Xe.vecSouth[0],ee=Xe.vecSouth[1]}let ne=S.x,ce=S.y,se=i;f&&(ne=Q,ce=te,se=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),se*=this.transform.getPitchedTextCorrection(Q,te,u),k||(se*=c.ag(.5+S.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(ne+=D*k.x*se+U*k.y*se,ce+=F*k.x*se+ee*k.y*se);const de=e.x1*se,fe=e.x2*se,oe=(de+fe)/2,ve=e.y1*se,Re=e.y2*se,Ee=(ve+Re)/2,ke=[{offsetX:de,offsetY:ve},{offsetX:oe,offsetY:ve},{offsetX:fe,offsetY:ve},{offsetX:fe,offsetY:Ee},{offsetX:fe,offsetY:Re},{offsetX:oe,offsetY:Re},{offsetX:de,offsetY:Re},{offsetX:de,offsetY:Ee}];let De=[];for(const{offsetX:Xe,offsetY:Ue}of ke)De.push(new c.P(ne+D*Xe+U*Ue,ce+F*Xe+ee*Ue));let Ye=!1;if(f){const Xe=De.map(Ue=>this.projectAndGetPerspectiveRatio(Ue.x,Ue.y,u,M,L));Ye=Xe.some(Ue=>!Ue.isOccluded),De=Xe.map(Ue=>new c.P(Ue.x,Ue.y))}else Ye=!0;return{box:c.az(De),allPointsOccluded:!Ye}}}class ma{constructor(e,i,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?i:-i))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Nn{constructor(e,i,l,u,f){this.text=new ma(e?e.text:null,i,l,f),this.icon=new ma(e?e.icon:null,i,u,f)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ga{constructor(e,i,l){this.text=e,this.icon=i,this.skipFade=l}}class Di{constructor(e,i,l,u,f){this.bucketInstanceId=e,this.featureIndex=i,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=f}}class rr{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const i=++this.maxGroupID;this.collisionGroups[e]={ID:i,predicate:l=>l.collisionGroupID===i}}return this.collisionGroups[e]}}function gd(p,e,i,l,u){const{horizontalAlign:f,verticalAlign:y}=c.aG(p);return new c.P(-(f-.5)*e+l[0]*u,-(y-.5)*i+l[1]*u)}class _a{constructor(e,i,l,u,f){this.transform=e.clone(),this.terrain=i,this.collisionIndex=new fa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new rr(u),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=f,f&&(f.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const i=this.terrain;return i?(l,u)=>i.getElevation(e,l,u):null}getBucketParts(e,i,l,u){const f=l.getBucket(i),y=l.latestFeatureIndex;if(!f||!y||i.id!==f.layerIds[0])return;const w=l.collisionBoxArray,S=f.layers[0].layout,M=f.layers[0].paint,k=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),L=l.tileSize/c.$,D=l.tileID.toUnwrapped(),F=S.get("text-rotation-alignment")==="map",U=c.aB(l,1,this.transform.zoom),ee=c.aC(this.collisionIndex.transform,l,M.get("text-translate"),M.get("text-translate-anchor")),Q=c.aC(this.collisionIndex.transform,l,M.get("icon-translate"),M.get("icon-translate-anchor")),te=yt(F,this.transform,U);this.retainedQueryData[f.bucketInstanceId]=new Di(f.bucketInstanceId,y,f.sourceLayerIndex,f.index,l.tileID);const ne={bucket:f,layout:S,translationText:ee,translationIcon:Q,unwrappedTileID:D,pitchedLabelPlaneMatrix:te,scale:k,textPixelRatio:L,holdingForFade:l.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:c.am(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(u)for(const ce of f.sortKeyRanges){const{sortKey:se,symbolInstanceStart:de,symbolInstanceEnd:fe}=ce;e.push({sortKey:se,symbolInstanceStart:de,symbolInstanceEnd:fe,parameters:ne})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:ne})}attemptAnchorPlacement(e,i,l,u,f,y,w,S,M,k,L,D,F,U,ee,Q,te,ne,ce,se){const de=c.aD[e.textAnchor],fe=[e.textOffset0,e.textOffset1],oe=gd(de,l,u,fe,f),ve=this.collisionIndex.placeCollisionBox(i,D,S,M,k,w,y,Q,L.predicate,ce,oe,se);if((!ne||this.collisionIndex.placeCollisionBox(ne,D,S,M,k,w,y,te,L.predicate,ce,oe,se).placeable)&&ve.placeable){let Re;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(Re=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:fe,width:l,height:u,anchor:de,textBoxScale:f,prevAnchor:Re},this.markUsedJustification(U,de,F,ee),U.allowVerticalPlacement&&(this.markUsedOrientation(U,ee,F),this.placedOrientations[F.crossTileID]=ee),{shift:oe,placedGlyphBoxes:ve}}}placeLayerBucketPart(e,i,l){const{bucket:u,layout:f,translationText:y,translationIcon:w,unwrappedTileID:S,pitchedLabelPlaneMatrix:M,textPixelRatio:k,holdingForFade:L,collisionBoxArray:D,partiallyEvaluatedTextSize:F,collisionGroup:U}=e.parameters,ee=f.get("text-optional"),Q=f.get("icon-optional"),te=c.aE(f,"text-overlap","text-allow-overlap"),ne=te==="always",ce=c.aE(f,"icon-overlap","icon-allow-overlap"),se=ce==="always",de=f.get("text-rotation-alignment")==="map",fe=f.get("text-pitch-alignment")==="map",oe=f.get("icon-text-fit")!=="none",ve=f.get("symbol-z-order")==="viewport-y",Re=ne&&(se||!u.hasIconData()||Q),Ee=se&&(ne||!u.hasTextData()||ee);!u.collisionArrays&&D&&u.deserializeCollisionBoxes(D);const ke=this.retainedQueryData[u.bucketInstanceId].tileID,De=this._getTerrainElevationFunc(ke),Ye=this.transform.getFastPathSimpleProjectionMatrix(ke),Xe=(Ue,rt,St)=>{var Vt,sr;if(i[Ue.crossTileID])return;if(L)return void(this.placements[Ue.crossTileID]=new ga(!1,!1,!1));let qt=!1,or=!1,Ht=!0,Wt=null,Xt={box:null,placeable:!1,offscreen:null,occluded:!1},Xr={placeable:!1},Lt=null,Or=null,Yr=null,gs=0,_s=0,ys=0;rt.textFeatureIndex?gs=rt.textFeatureIndex:Ue.useRuntimeCollisionCircles&&(gs=Ue.featureIndex),rt.verticalTextFeatureIndex&&(_s=rt.verticalTextFeatureIndex);const En=rt.textBox;if(En){const Si=mr=>{let Qt=c.an.horizontal;if(u.allowVerticalPlacement&&!mr&&this.prevPlacement){const mi=this.prevPlacement.placedOrientations[Ue.crossTileID];mi&&(this.placedOrientations[Ue.crossTileID]=mi,Qt=mi,this.markUsedOrientation(u,Qt,Ue))}return Qt},ln=(mr,Qt)=>{if(u.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&rt.verticalTextBox){for(const mi of u.writingModes)if(mi===c.an.vertical?(Xt=Qt(),Xr=Xt):Xt=mr(),Xt&&Xt.placeable)break}else Xt=mr()},vs=Ue.textAnchorOffsetStartIndex,qs=Ue.textAnchorOffsetEndIndex;if(qs===vs){const mr=(Qt,mi)=>{const zr=this.collisionIndex.placeCollisionBox(Qt,te,k,ke,S,fe,de,y,U.predicate,De,void 0,Ye);return zr&&zr.placeable&&(this.markUsedOrientation(u,mi,Ue),this.placedOrientations[Ue.crossTileID]=mi),zr};ln(()=>mr(En,c.an.horizontal),()=>{const Qt=rt.verticalTextBox;return u.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&Qt?mr(Qt,c.an.vertical):{box:null,offscreen:null}}),Si(Xt&&Xt.placeable)}else{let mr=c.aD[(sr=(Vt=this.prevPlacement)===null||Vt===void 0?void 0:Vt.variableOffsets[Ue.crossTileID])===null||sr===void 0?void 0:sr.anchor];const Qt=(zr,cp,Rm)=>{const Ju=zr.x2-zr.x1,Ha=zr.y2-zr.y1,Oo=Ue.textBoxScale,Gn=oe&&ce==="never"?cp:null;let Kr=null,qn=te==="never"?1:2,eh="never";mr&&qn++;for(let xs=0;xs<qn;xs++){for(let th=vs;th<qs;th++){const rh=u.textAnchorOffsets.get(th);if(mr&&rh.textAnchor!==mr)continue;const Xa=this.attemptAnchorPlacement(rh,zr,Ju,Ha,Oo,de,fe,k,ke,S,U,eh,Ue,u,Rm,y,w,Gn,De);if(Xa&&(Kr=Xa.placedGlyphBoxes,Kr&&Kr.placeable))return qt=!0,Wt=Xa.shift,Kr}mr?mr=null:eh=te}return l&&!Kr&&(Kr={box:this.collisionIndex.placeCollisionBox(En,"always",k,ke,S,fe,de,y,U.predicate,De,void 0,Ye).box,offscreen:!1,placeable:!1,occluded:!1}),Kr};ln(()=>Qt(En,rt.iconBox,c.an.horizontal),()=>{const zr=rt.verticalTextBox;return u.allowVerticalPlacement&&(!Xt||!Xt.placeable)&&Ue.numVerticalGlyphVertices>0&&zr?Qt(zr,rt.verticalIconBox,c.an.vertical):{box:null,occluded:!0,offscreen:null}}),Xt&&(qt=Xt.placeable,Ht=Xt.offscreen);const mi=Si(Xt&&Xt.placeable);if(!qt&&this.prevPlacement){const zr=this.prevPlacement.variableOffsets[Ue.crossTileID];zr&&(this.variableOffsets[Ue.crossTileID]=zr,this.markUsedJustification(u,zr.anchor,Ue,mi))}}}if(Lt=Xt,qt=Lt&&Lt.placeable,Ht=Lt&&Lt.offscreen,Ue.useRuntimeCollisionCircles){const Si=u.text.placedSymbolArray.get(Ue.centerJustifiedTextSymbolIndex),ln=c.ao(u.textSizeData,F,Si),vs=f.get("text-padding");Or=this.collisionIndex.placeCollisionCircles(te,Si,u.lineVertexArray,u.glyphOffsetArray,ln,S,M,l,fe,U.predicate,Ue.collisionCircleDiameter,vs,y,De),Or.circles.length&&Or.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),qt=ne||Or.circles.length>0&&!Or.collisionDetected,Ht=Ht&&Or.offscreen}if(rt.iconFeatureIndex&&(ys=rt.iconFeatureIndex),rt.iconBox){const Si=ln=>this.collisionIndex.placeCollisionBox(ln,ce,k,ke,S,fe,de,w,U.predicate,De,oe&&Wt?Wt:void 0,Ye);Xr&&Xr.placeable&&rt.verticalIconBox?(Yr=Si(rt.verticalIconBox),or=Yr.placeable):(Yr=Si(rt.iconBox),or=Yr.placeable),Ht=Ht&&Yr.offscreen}const qa=ee||Ue.numHorizontalGlyphVertices===0&&Ue.numVerticalGlyphVertices===0,Wa=Q||Ue.numIconVertices===0;qa||Wa?Wa?qa||(or=or&&qt):qt=or&&qt:or=qt=or&&qt;const Bo=or&&Yr.placeable;if(qt&&Lt.placeable&&this.collisionIndex.insertCollisionBox(Lt.box,te,f.get("text-ignore-placement"),u.bucketInstanceId,Xr&&Xr.placeable&&_s?_s:gs,U.ID),Bo&&this.collisionIndex.insertCollisionBox(Yr.box,ce,f.get("icon-ignore-placement"),u.bucketInstanceId,ys,U.ID),Or&&qt&&this.collisionIndex.insertCollisionCircles(Or.circles,te,f.get("text-ignore-placement"),u.bucketInstanceId,gs,U.ID),l&&this.storeCollisionData(u.bucketInstanceId,St,rt,Lt,Yr,Or),Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ue.crossTileID]=new ga((qt||Re)&&!(Lt!=null&&Lt.occluded),(or||Ee)&&!(Yr!=null&&Yr.occluded),Ht||u.justReloaded),i[Ue.crossTileID]=!0};if(ve){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ue=u.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let rt=Ue.length-1;rt>=0;--rt){const St=Ue[rt];Xe(u.symbolInstances.get(St),u.collisionArrays[St],St)}}else for(let Ue=e.symbolInstanceStart;Ue<e.symbolInstanceEnd;Ue++)Xe(u.symbolInstances.get(Ue),u.collisionArrays[Ue],Ue);u.justReloaded=!1}storeCollisionData(e,i,l,u,f,y){if(l.textBox||l.iconBox){let w,S;this.collisionBoxArrays.has(e)?w=this.collisionBoxArrays.get(e):(w=new Map,this.collisionBoxArrays.set(e,w)),w.has(i)?S=w.get(i):(S={text:null,icon:null},w.set(i,S)),l.textBox&&(S.text=u.box),l.iconBox&&(S.icon=f.box)}if(y){let w=this.collisionCircleArrays[e];w===void 0&&(w=this.collisionCircleArrays[e]=[]);for(let S=0;S<y.circles.length;S+=4)w.push(y.circles[S+0]-vr),w.push(y.circles[S+1]-vr),w.push(y.circles[S+2]),w.push(y.collisionDetected?1:0)}}markUsedJustification(e,i,l,u){let f;f=u===c.an.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.aF(i)];const y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const w of y)w>=0&&(e.text.placedSymbolArray.get(w).crossTileID=f>=0&&w!==f?0:l.crossTileID)}markUsedOrientation(e,i,l){const u=i===c.an.horizontal||i===c.an.horizontalOnly?i:0,f=i===c.an.vertical?i:0,y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const w of y)e.text.placedSymbolArray.get(w).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=f)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let l=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const u=i?i.symbolFadeChange(e):1,f=i?i.opacities:{},y=i?i.variableOffsets:{},w=i?i.placedOrientations:{};for(const S in this.placements){const M=this.placements[S],k=f[S];k?(this.opacities[S]=new Nn(k,u,M.text,M.icon),l=l||M.text!==k.text.placed||M.icon!==k.icon.placed):(this.opacities[S]=new Nn(null,u,M.text,M.icon,M.skipFade),l=l||M.text||M.icon)}for(const S in f){const M=f[S];if(!this.opacities[S]){const k=new Nn(M,u,!1,!1);k.isHidden()||(this.opacities[S]=k,l=l||M.text.placed||M.icon.placed)}}for(const S in y)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=y[S]);for(const S in w)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=w[S]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:e)}updateLayerOpacities(e,i){const l={};for(const u of i){const f=u.getBucket(e);f&&u.latestFeatureIndex&&e.id===f.layerIds[0]&&this.updateBucketOpacities(f,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,i,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const f=e.layers[0],y=f.layout,w=new Nn(null,0,!1,!1,!0),S=y.get("text-allow-overlap"),M=y.get("icon-allow-overlap"),k=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),L=y.get("text-rotation-alignment")==="map",D=y.get("text-pitch-alignment")==="map",F=y.get("icon-text-fit")!=="none",U=new Nn(null,0,S&&(M||!e.hasIconData()||y.get("icon-optional")),M&&(S||!e.hasTextData()||y.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const ee=(te,ne,ce)=>{for(let se=0;se<ne/4;se++)te.opacityVertexArray.emplaceBack(ce);te.hasVisibleVertices=te.hasVisibleVertices||ce!==ya},Q=this.collisionBoxArrays.get(e.bucketInstanceId);for(let te=0;te<e.symbolInstances.length;te++){const ne=e.symbolInstances.get(te),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:se,crossTileID:de}=ne;let fe=this.opacities[de];l[de]?fe=w:fe||(fe=U,this.opacities[de]=fe),l[de]=!0;const oe=ne.numIconVertices>0,ve=this.placedOrientations[ne.crossTileID],Re=ve===c.an.vertical,Ee=ve===c.an.horizontal||ve===c.an.horizontalOnly;if(ce>0||se>0){const De=bd(fe.text);ee(e.text,ce,Re?ya:De),ee(e.text,se,Ee?ya:De);const Ye=fe.text.isHidden();[ne.rightJustifiedTextSymbolIndex,ne.centerJustifiedTextSymbolIndex,ne.leftJustifiedTextSymbolIndex].forEach(rt=>{rt>=0&&(e.text.placedSymbolArray.get(rt).hidden=Ye||Re?1:0)}),ne.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ne.verticalPlacedTextSymbolIndex).hidden=Ye||Ee?1:0);const Xe=this.variableOffsets[ne.crossTileID];Xe&&this.markUsedJustification(e,Xe.anchor,ne,ve);const Ue=this.placedOrientations[ne.crossTileID];Ue&&(this.markUsedJustification(e,"left",ne,Ue),this.markUsedOrientation(e,Ue,ne))}if(oe){const De=bd(fe.icon),Ye=!(F&&ne.verticalPlacedIconSymbolIndex&&Re);ne.placedIconSymbolIndex>=0&&(ee(e.icon,ne.numIconVertices,Ye?De:ya),e.icon.placedSymbolArray.get(ne.placedIconSymbolIndex).hidden=fe.icon.isHidden()),ne.verticalPlacedIconSymbolIndex>=0&&(ee(e.icon,ne.numVerticalIconVertices,Ye?ya:De),e.icon.placedSymbolArray.get(ne.verticalPlacedIconSymbolIndex).hidden=fe.icon.isHidden())}const ke=Q&&Q.has(te)?Q.get(te):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const De=e.collisionArrays[te];if(De){let Ye=new c.P(0,0);if(De.textBox||De.verticalTextBox){let Xe=!0;if(k){const Ue=this.variableOffsets[de];Ue?(Ye=gd(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textBoxScale),L&&Ye._rotate(D?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Xe=!1}if(De.textBox||De.verticalTextBox){let Ue;De.textBox&&(Ue=Re),De.verticalTextBox&&(Ue=Ee),zl(e.textCollisionBox.collisionVertexArray,fe.text.placed,!Xe||Ue,ke.text,Ye.x,Ye.y)}}if(De.iconBox||De.verticalIconBox){const Xe=!!(!Ee&&De.verticalIconBox);let Ue;De.iconBox&&(Ue=Xe),De.verticalIconBox&&(Ue=!Xe),zl(e.iconCollisionBox.collisionVertexArray,fe.icon.placed,Ue,ke.icon,F?Ye.x:0,F?Ye.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,i){const l=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function zl(p,e,i,l,u,f){l&&l.length!==0||(l=[0,0,0,0]);const y=l[0]-vr,w=l[1]-vr,S=l[2]-vr,M=l[3]-vr;p.emplaceBack(e?1:0,i?1:0,u||0,f||0,y,w),p.emplaceBack(e?1:0,i?1:0,u||0,f||0,S,w),p.emplaceBack(e?1:0,i?1:0,u||0,f||0,S,M),p.emplaceBack(e?1:0,i?1:0,u||0,f||0,y,M)}const Ls=Math.pow(2,25),cs=Math.pow(2,24),_d=Math.pow(2,17),yd=Math.pow(2,16),vd=Math.pow(2,9),ho=Math.pow(2,8),xd=Math.pow(2,1);function bd(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const e=p.placed?1:0,i=Math.floor(127*p.opacity);return i*Ls+e*cs+i*_d+e*yd+i*vd+e*ho+i*xd+e}const ya=0;class am{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,i,l,u,f){const y=this._bucketParts;for(;this._currentTileIndex<e.length;)if(i.getBucketParts(y,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((w,S)=>w.sortKey-S.sortKey));this._currentPartIndex<y.length;)if(i.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,f())return!0;return!1}}class wd{constructor(e,i,l,u,f,y,w,S){this.placement=new _a(e,i,y,w,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=f,this._done=!1}isDone(){return this._done}continuePlacement(e,i,l){const u=O.now(),f=()=>!this._forceFullPlacement&&O.now()-u>2;for(;this._currentPlacementIndex>=0;){const y=i[e[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=w)&&(!y.maxzoom||y.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new am(y)),this._inProgressLayer.continuePlacement(l[y.source],this.placement,this._showCollisionBoxes,y,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const po=512/c.$/2;class lu{constructor(e,i,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let f=0;f<i.length;f++){const y=i.get(f),w=y.key,S=u.get(w);S?S.push(y):u.set(w,[y])}for(const[f,y]of u){const w={positions:y.map(S=>({x:Math.floor(S.anchorX*po),y:Math.floor(S.anchorY*po)})),crossTileIDs:y.map(S=>S.crossTileID)};if(w.positions.length>128){const S=new c.aH(w.positions.length,16,Uint16Array);for(const{x:M,y:k}of w.positions)S.add(M,k);S.finish(),delete w.positions,w.index=S}this._symbolsByKey[f]=w}}getScaledCoordinates(e,i){const{x:l,y:u,z:f}=this.tileID.canonical,{x:y,y:w,z:S}=i.canonical,M=po/Math.pow(2,S-f),k=(w*c.$+e.anchorY)*M,L=u*c.$*po;return{x:Math.floor((y*c.$+e.anchorX)*M-l*c.$*po),y:Math.floor(k-L)}}findMatches(e,i,l){const u=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let f=0;f<e.length;f++){const y=e.get(f);if(y.crossTileID)continue;const w=this._symbolsByKey[y.key];if(!w)continue;const S=this.getScaledCoordinates(y,i);if(w.index){const M=w.index.range(S.x-u,S.y-u,S.x+u,S.y+u).sort();for(const k of M){const L=w.crossTileIDs[k];if(!l[L]){l[L]=!0,y.crossTileID=L;break}}}else if(w.positions)for(let M=0;M<w.positions.length;M++){const k=w.positions[M],L=w.crossTileIDs[M];if(Math.abs(k.x-S.x)<=u&&Math.abs(k.y-S.y)<=u&&!l[L]){l[L]=!0,y.crossTileID=L;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class cu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Td{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const i=Math.round((e-this.lng)/360);if(i!==0)for(const l in this.indexes){const u=this.indexes[l],f={};for(const y in u){const w=u[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+i),f[w.tileID.key]=w}this.indexes[l]=f}this.lng=e}addBucket(e,i,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let f=0;f<i.symbolInstances.length;f++)i.symbolInstances.get(f).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const f in this.indexes){const y=this.indexes[f];if(Number(f)>e.overscaledZ)for(const w in y){const S=y[w];S.tileID.isChildOf(e)&&S.findMatches(i.symbolInstances,e,u)}else{const w=y[e.scaledTo(Number(f)).key];w&&w.findMatches(i.symbolInstances,e,u)}}for(let f=0;f<i.symbolInstances.length;f++){const y=i.symbolInstances.get(f);y.crossTileID||(y.crossTileID=l.generate(),u[y.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new lu(e,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(e,i){for(const l of i.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let i=!1;for(const l in this.indexes){const u=this.indexes[l];for(const f in u)e[u[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[f]),delete u[f],i=!0)}return i}}class Al{constructor(){this.layerIndexes={},this.crossTileIDs=new cu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,i,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new Td);let f=!1;const y={};u.handleWrapJump(l);for(const w of i){const S=w.getBucket(e);S&&e.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(w.tileID,S,this.crossTileIDs)&&(f=!0),y[S.bucketInstanceId]=!0)}return u.removeStaleBuckets(y)&&(f=!0),f}pruneUnusedLayers(e){const i={};e.forEach(l=>{i[l]=!0});for(const l in this.layerIndexes)i[l]||delete this.layerIndexes[l]}}var Rl="void main() {fragColor=vec4(1.0);}";const Sn={prelude:It(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:It("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:It("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:It(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:It(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:It(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:It(Rl,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:It(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:It(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:It("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:It("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:It(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(textureSize(u_elevation_stops,0)[0]);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int num_elevation_stops=textureSize(u_elevation_stops,0)[0];int r=(num_elevation_stops-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(textureSize(u_color_stops,0)[0]);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:It("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:It(Rl,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:It(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:It(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:It(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:It(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:It(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:It(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:It(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:It(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:It(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:It(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:It(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:It(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:It(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:It(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:It(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:It(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:It("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:It("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:It("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:It("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:It(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:It("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function It(p,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),u=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),f=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=f?f.concat(u):u,w={};return{fragmentSource:p=p.replace(i,(S,M,k,L,D)=>(w[D]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${D}
in ${k} ${L} ${D};
#else
uniform ${k} ${L} u_${D};
#endif
`:`
#ifdef HAS_UNIFORM_u_${D}
    ${k} ${L} ${D} = u_${D};
#endif
`)),vertexSource:e=e.replace(i,(S,M,k,L,D)=>{const F=L==="float"?"vec2":"vec4",U=D.match(/color/)?"color":F;return w[D]?M==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${k} ${F} a_${D};
out ${k} ${L} ${D};
#else
uniform ${k} ${L} u_${D};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = a_${D};
#else
    ${k} ${L} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = unpack_mix_${U}(a_${D}, u_${D}_t);
#else
    ${k} ${L} ${D} = u_${D};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${k} ${F} a_${D};
#else
uniform ${k} ${L} u_${D};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${k} ${L} ${D} = a_${D};
#else
    ${k} ${L} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${k} ${L} ${D} = unpack_mix_${U}(a_${D}, u_${D}_t);
#else
    ${k} ${L} ${D} = u_${D};
#endif
`}),staticAttributes:l,staticUniforms:y}}class $n{constructor(e,i,l){this.vertexBuffer=e,this.indexBuffer=i,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Vn=c.aI([{name:"a_pos",type:"Int16",components:2}]);const js="#define PROJECTION_MERCATOR",uu="mercator";class hu{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return uu}get shaderDefine(){return js}get shaderPreludeCode(){return Sn.projectionMercator}get vertexShaderPreludeCode(){return Sn.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,i,l,u,f){if(this._cachedMesh)return this._cachedMesh;const y=new c.aK;y.emplaceBack(0,0),y.emplaceBack(c.$,0),y.emplaceBack(0,c.$),y.emplaceBack(c.$,c.$);const w=e.createVertexBuffer(y,Vn.members),S=c.aL.simpleSegment(0,0,4,2),M=new c.aM;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3);const k=e.createIndexBuffer(M);return this._cachedMesh=new $n(w,k,S),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class qi{constructor(e=0,i=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(i)||i<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=i,this.left=l,this.right=u}interpolate(e,i,l){return i.top!=null&&e.top!=null&&(this.top=c.C.number(e.top,i.top,l)),i.bottom!=null&&e.bottom!=null&&(this.bottom=c.C.number(e.bottom,i.bottom,l)),i.left!=null&&e.left!=null&&(this.left=c.C.number(e.left,i.left,l)),i.right!=null&&e.right!=null&&(this.right=c.C.number(e.right,i.right,l)),this}getCenter(e,i){const l=c.ag((this.left+e-this.right)/2,0,e),u=c.ag((this.top+i-this.bottom)/2,0,i);return new c.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new qi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Un(p,e){if(!p.renderWorldCopies||p.lngRange)return;const i=e.lng-p.center.lng;e.lng+=i>180?-360:i<-180?360:0}function Et(p){return Math.max(0,Math.floor(p))}class va{constructor(e,i,l,u,f,y){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=i||0,this._maxZoom=l||22,this._minPitch=u??0,this._maxPitch=f??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Et(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new qi,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,i,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Et(this._zoom),this._scale=c.ae(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new qi(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,i&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const i=c.aN(e,-180,180)*Math.PI/180;var l,u,f,y,w,S,M,k,L;this._bearingInRadians!==i&&(this._unmodified=!1,this._bearingInRadians=i,this._calcMatrices(),this._rotationMatrix=K(),l=this._rotationMatrix,f=-this._bearingInRadians,y=(u=this._rotationMatrix)[0],w=u[1],S=u[2],M=u[3],k=Math.sin(f),L=Math.cos(f),l[0]=y*L+S*k,l[1]=w*L+M*k,l[2]=y*-k+S*L,l[3]=w*-k+M*L)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const i=c.ag(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==i&&(this._unmodified=!1,this._pitchInRadians=i,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const i=e/180*Math.PI;this._rollInRadians!==i&&(this._unmodified=!1,this._rollInRadians=i,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aO(this._fovInRadians)}setFov(e){e=c.ag(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ad(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const i=this.getConstrained(this._center,e).zoom;this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this._tileZoom=Math.max(0,Math.floor(i)),this._scale=c.ae(i),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,i){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=i,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,i,l){this._unmodified=!1,this._edgeInsets.interpolate(e,i,l),this._constrain(),this._calcMatrices()}resize(e,i,l=!0){this._width=e,this._height=i,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new cr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.ah])}getConstrained(e,i){return this._callbacks.getConstrained(e,i)}getCameraQueryGeometry(e,i){if(i.length===1)return[i[0],e];{const{minX:l,minY:u,maxX:f,maxY:y}=c.a1.fromPoints(i).extend(e);return[new c.P(l,u),new c.P(f,u),new c.P(f,y),new c.P(l,y),new c.P(l,u)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:i,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(i),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.af(new Float64Array(16));c.N(e,e,[this._width/2,-this._height/2,1]),c.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.af(new Float64Array(16)),c.N(e,e,[1,-1,1]),c.M(e,e,[-1,-1,0]),c.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,i,l,u){const f=l!==void 0?l:this.bearing,y=u=u!==void 0?u:this.pitch,w=c.a0.fromLngLat(e,i),S=-Math.cos(c.ad(y)),M=Math.sin(c.ad(y)),k=M*Math.sin(c.ad(f)),L=-M*Math.cos(c.ad(f));let D=this.elevation;const F=i-D;let U;S*F>=0||Math.abs(S)<.1?(U=1e4,D=i+U*S):U=-F/S;let ee,Q,te=c.aP(1,w.y),ne=0;do{if(ne+=1,ne>10)break;Q=U/te,ee=new c.a0(w.x+k*Q,w.y+L*Q),te=1/ee.meterInMercatorCoordinateUnits()}while(Math.abs(U-Q*te)>1e-12);return{center:ee.toLngLat(),elevation:D,zoom:c.aj(this.height/2/Math.tan(this.fovInRadians/2)/Q/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const i=c.ai(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/i,u=c.a0.fromLngLat(this.center,this.elevation),f=le(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const y=this.calculateCenterFromCameraLngLatAlt(f.toLngLat(),c.aP(f.z,u.y),this.bearing,this.pitch);this._elevation=y.elevation,this._center=y.center,this.setZoom(y.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.ai(1,this.center.lat)*this.worldSize;return le(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const i=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/i,e.canonical.y/i,1/i/c.$,1/i/c.$]}}class Dl{constructor(e,i){this.min=e,this.max=i,this.center=c.aQ([],c.aR([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],l=c.aS(this.min),u=c.aS(this.max);for(let f=0;f<i.length;f++)l[f]=i[f]?this.min[f]:this.center[f],u[f]=i[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new Dl(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let i=!0;for(let l=0;l<e.planes.length;l++){const u=this.intersectsPlane(e.planes[l]);if(u===0)return 0;u===1&&(i=!1)}return i?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let i=e[3],l=e[3];for(let u=0;u<3;u++)e[u]>0?(i+=e[u]*this.min[u],l+=e[u]*this.max[u]):(l+=e[u]*this.min[u],i+=e[u]*this.max[u]);return i>=0?2:l<0?0:1}}class du{distanceToTile2d(e,i,l,u){const f=u.distanceX([e,i]),y=u.distanceY([e,i]);return Math.hypot(f,y)}getWrap(e,i,l){return l}getTileBoundingVolume(e,i,l,u){var f,y;let w=l,S=l;if(u!=null&&u.terrain){const k=new c.Z(e.z,i,e.z,e.x,e.y),L=u.terrain.getMinMaxElevation(k);w=(f=L.minElevation)!==null&&f!==void 0?f:l,S=(y=L.maxElevation)!==null&&y!==void 0?y:l}const M=1<<e.z;return new Dl([i+e.x/M,e.y/M,w],[i+(e.x+1)/M,(e.y+1)/M,S])}allowVariableZoom(e,i){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,u=c.ag(78.5-l/2,0,60);return!!i.terrain||e.pitch>u}allowWorldCopies(){return!0}prepareNextFrame(){}}class ni{constructor(e,i,l){this.points=e,this.planes=i,this.aabb=l}static fromInvProjectionMatrix(e,i=1,l=0,u,f){const y=f?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],w=Math.pow(2,l),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>function(F,U,ee,Q){const te=c.av([],F,U),ne=1/te[3]/ee*Q;return c.aX(te,te,[ne,ne,1/te[3],ne])}(D,e,i,w));u&&function(D,F,U,ee){const Q=ee?4:0,te=ee?0:4;let ne=0;const ce=[],se=[];for(let oe=0;oe<4;oe++){const ve=c.aT([],D[oe+te],D[oe+Q]),Re=c.aY(ve);c.aQ(ve,ve,1/Re),ce.push(Re),se.push(ve)}for(let oe=0;oe<4;oe++){const ve=c.aZ(D[oe+Q],se[oe],U);ne=ve!==null&&ve>=0?Math.max(ne,ve):Math.max(ne,ce[oe])}const de=function(oe,ve){const Re=c.aT([],oe[ve[0]],oe[ve[1]]),Ee=c.aT([],oe[ve[2]],oe[ve[1]]),ke=[0,0,0,0];return c.aU(ke,c.aV([],Re,Ee)),ke[3]=-c.aW(ke,oe[ve[0]]),ke}(D,F),fe=function(oe,ve){const Re=c.a_(oe),Ee=c.a$([],oe,1/Re),ke=c.aT([],ve,c.aQ([],Ee,c.aW(ve,Ee))),De=c.a_(ke);if(De>0){const Ye=Math.sqrt(1-Ee[3]*Ee[3]),Xe=c.aQ([],Ee,-Ee[3]),Ue=c.aR([],Xe,c.aQ([],ke,Ye/De));return c.b0(ve,Ue)}return null}(U,de);if(fe!==null){const oe=fe/c.aW(se[0],de);ne=Math.min(ne,oe)}for(let oe=0;oe<4;oe++){const ve=Math.min(ne,ce[oe]);D[oe+te]=[D[oe+Q][0]+se[oe][0]*ve,D[oe+Q][1]+se[oe][1]*ve,D[oe+Q][2]+se[oe][2]*ve,1]}}(S,y[0],u,f);const M=y.map(D=>{const F=c.aT([],S[D[0]],S[D[1]]),U=c.aT([],S[D[2]],S[D[1]]),ee=c.aU([],c.aV([],F,U)),Q=-c.aW(ee,S[D[1]]);return ee.concat(Q)}),k=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],L=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const D of S)for(let F=0;F<3;F++)k[F]=Math.min(k[F],D[F]),L[F]=Math.max(L[F],D[F]);return new ni(S,M,new Dl(k,L))}}class Cr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,l){return this._helper.interpolatePadding(e,i,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,l=!0){this._helper.resize(e,i,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,i){}constructor(e,i,l,u,f){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new va({calcMatrices:()=>{this._calcMatrices()},getConstrained:(y,w)=>this.getConstrained(y,w)},e,i,l,u,f),this._coveringTilesDetailsProvider=new du}clone(){const e=new Cr;return e.apply(this),e}apply(e,i,l){this._helper.apply(e,i,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const i=[new c.b1(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),u=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),f=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),y=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),w=Math.floor(Math.min(l.x,u.x,f.x,y.x)),S=Math.floor(Math.max(l.x,u.x,f.x,y.x)),M=1;for(let k=w-M;k<=S+M;k++)k!==0&&i.push(new c.b1(k,e))}return i}getCameraFrustum(){return ni.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const i=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(i,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,i){const l=c.ai(this.elevation,this.center.lat),u=this.screenPointToMercatorCoordinateAtZ(i,l),f=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),y=c.a0.fromLngLat(e),w=new c.a0(y.x-(u.x-f.x),y.y-(u.y-f.y));this.setCenter(w==null?void 0:w.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,i){return i?this.coordinatePoint(c.a0.fromLngLat(e),i.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a0.fromLngLat(e))}screenPointToLocation(e,i){var l;return(l=this.screenPointToMercatorCoordinate(e,i))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,i){if(i){const l=i.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,i){const l=i||0,u=[e.x,e.y,0,1],f=[e.x,e.y,1,1];c.av(u,u,this._pixelMatrixInverse),c.av(f,f,this._pixelMatrixInverse);const y=u[3],w=f[3],S=u[1]/y,M=f[1]/w,k=u[2]/y,L=f[2]/w,D=k===L?0:(l-k)/(L-k);return new c.a0(c.C.number(u[0]/y,f[0]/w,D)/this.worldSize,c.C.number(S,M,D)/this.worldSize,l)}coordinatePoint(e,i=0,l=this._pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,i,1];return c.av(u,u,l),new c.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this._helper._height/2-W(this));return new cr().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,i){return i?i.pointCoordinate(e)!=null:e.y>this.height/2-W(this)}calculatePosMatrix(e,i=!1,l){var u;const f=(u=e.key)!==null&&u!==void 0?u:c.b2(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),y=i?this._alignedPosMatrixCache:this._posMatrixCache;if(y.has(f)){const M=y.get(f);return l?M.f32:M.f64}const w=J(e,this.worldSize);c.O(w,i?this._alignedProjMatrix:this._viewProjMatrix,w);const S={f64:w,f32:new Float32Array(w)};return y.set(f,S),l?S.f32:S.f64}calculateFogMatrix(e){const i=e.key,l=this._fogMatrixCacheF32;if(l.has(i))return l.get(i);const u=J(e,this.worldSize);return c.O(u,this._fogMatrix,u),l.set(i,new Float32Array(u)),l.get(i)}getConstrained(e,i){i=c.ag(+i,this.minZoom,this.maxZoom);const l={center:new c.S(e.lng,e.lat),zoom:i};let u=this._helper._lngRange;this._helper._renderWorldCopies||u!==null||(u=[-179.9999999999,180-1e-10]);const f=this.tileSize*c.ae(l.zoom);let y=0,w=f,S=0,M=f,k=0,L=0;const{x:D,y:F}=this.size;if(this._helper._latRange){const ce=this._helper._latRange;y=c.U(ce[1])*f,w=c.U(ce[0])*f,w-y<F&&(k=F/(w-y))}u&&(S=c.aN(c.V(u[0])*f,0,f),M=c.aN(c.V(u[1])*f,0,f),M<S&&(M+=f),M-S<D&&(L=D/(M-S)));const{x:U,y:ee}=Se(f,e);let Q,te;const ne=Math.max(L||0,k||0);if(ne){const ce=new c.P(L?(M+S)/2:U,k?(w+y)/2:ee);return l.center=q(f,ce).wrap(),l.zoom+=c.aj(ne),l}if(this._helper._latRange){const ce=F/2;ee-ce<y&&(te=y+ce),ee+ce>w&&(te=w-ce)}if(u){const ce=(S+M)/2;let se=U;this._helper._renderWorldCopies&&(se=c.aN(U,ce-f/2,ce+f/2));const de=D/2;se-de<S&&(Q=S+de),se+de>M&&(Q=M-de)}if(Q!==void 0||te!==void 0){const ce=new c.P(Q??U,te??ee);l.center=q(f,ce).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,i,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,l,u)}_calculateNearFarZIfNeeded(e,i,l){if(!this._helper.autoCalculateNearFarZ)return;const u=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),f=e-u*this._helper._pixelPerMeter/Math.cos(i),y=u<0?f:e,w=Math.PI/2+this.pitchInRadians,S=c.ad(this.fov)*(Math.abs(Math.cos(c.ad(this.roll)))*this.height+Math.abs(Math.sin(c.ad(this.roll)))*this.width)/this.height*(.5+l.y/this.height),M=Math.sin(S)*y/Math.sin(c.ag(Math.PI-w-S,.01,Math.PI-.01)),k=W(this),L=Math.atan(k/this._helper.cameraToCenterDistance),D=c.ad(.75),F=L>D?2*L*(.5+l.y/(2*k)):D,U=Math.sin(F)*y/Math.sin(c.ag(Math.PI-w-F,.01,Math.PI-.01)),ee=Math.min(M,U);this._helper._farZ=1.01*(Math.cos(Math.PI/2-i)*ee+y),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,i=Se(this.worldSize,this.center),l=i.x,u=i.y;this._helper._pixelPerMeter=c.ai(1,this.center.lat)*this.worldSize;const f=c.ad(Math.min(this.pitch,Bn)),y=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(f));let w;this._calculateNearFarZIfNeeded(y,f,e),w=new Float64Array(16),c.b3(w,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.ap(this._invProjMatrix,w),w[8]=2*-e.x/this._helper._width,w[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b4(w),c.N(w,w,[1,-1,1]),c.M(w,w,[0,0,-this._helper.cameraToCenterDistance]),c.b5(w,w,-this.rollInRadians),c.b6(w,w,this.pitchInRadians),c.b5(w,w,-this.bearingInRadians),c.M(w,w,[-l,-u,0]),this._mercatorMatrix=c.N([],w,[this.worldSize,this.worldSize,this.worldSize]),c.N(w,w,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,w),c.M(w,w,[0,0,-this.elevation]),this._viewProjMatrix=w,this._invViewProjMatrix=c.ap([],w);const S=[0,0,-1,1];c.av(S,S,this._invViewProjMatrix),this._cameraPosition=[S[0]/S[3],S[1]/S[3],S[2]/S[3]],this._fogMatrix=new Float64Array(16),c.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,y,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-l,-u,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,w);const M=this._helper._width%2/2,k=this._helper._height%2/2,L=Math.cos(this.bearingInRadians),D=Math.sin(-this.bearingInRadians),F=l-Math.round(l)+L*M+D*k,U=u-Math.round(u)+L*k+D*M,ee=new Float64Array(w);if(c.M(ee,ee,[F>.5?F-1:F,U>.5?U-1:U,0]),this._alignedProjMatrix=ee,w=c.ap(new Float64Array(16),this._pixelMatrix),!w)throw new Error("failed to invert matrix");this._pixelMatrixInverse=w,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),i=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.av(i,i,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.ai(1,this.center.lat)*this.worldSize;return le(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,i){const l=c.a0.fromLngLat(e),u=[l.x*this.worldSize,l.y*this.worldSize,i,1];return c.av(u,u,this._viewProjMatrix),u[2]/u[3]}getProjectionData(e){const{overscaledTileID:i,aligned:l,applyTerrainMatrix:u}=e,f=this._helper.getMercatorTileCoordinates(i),y=i?this.calculatePosMatrix(i,l,!0):null;let w;return w=i&&i.terrainRttPosMatrix32f&&u?i.terrainRttPosMatrix32f:y||c.b7(),{mainMatrix:w,tileMercatorCoords:f,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,i,l){return 1}transformLightDirection(e){return c.aS(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,i,l,u){const f=this.calculatePosMatrix(l);let y;u?(y=[e,i,u(e,i),1],c.av(y,y,f)):(y=[e,i,0,1],Ds(y,y,f));const w=y[3];return{point:new c.P(y[0]/w,y[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}populateCache(e){for(const i of e)this.calculatePosMatrix(i)}getMatrixForModel(e,i){const l=c.a0.fromLngLat(e,i),u=l.meterInMercatorCoordinateUnits(),f=c.b8();return c.M(f,f,[l.x,l.y,l.z]),c.b5(f,f,Math.PI),c.b6(f,f,Math.PI/2),c.N(f,f,[-u,u,u]),f}getProjectionDataForCustomLayer(e=!0){const i=new c.Z(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:i,applyGlobeMatrix:e}),u=J(i,this.worldSize);c.O(u,this._viewProjMatrix,u),l.tileMercatorCoords=[0,0,1,1];const f=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],y=c.b9();return c.N(y,u,f),l.fallbackMatrix=y,l.mainMatrix=y,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function si(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Fr(p){if(p.useSlerp)if(p.k<1){const e=c.ba(p.startEulerAngles.roll,p.startEulerAngles.pitch,p.startEulerAngles.bearing),i=c.ba(p.endEulerAngles.roll,p.endEulerAngles.pitch,p.endEulerAngles.bearing),l=new Float64Array(4);c.bb(l,e,i,p.k);const u=c.bc(l);p.tr.setRoll(u.roll),p.tr.setPitch(u.pitch),p.tr.setBearing(u.bearing)}else p.tr.setRoll(p.endEulerAngles.roll),p.tr.setPitch(p.endEulerAngles.pitch),p.tr.setBearing(p.endEulerAngles.bearing);else p.tr.setRoll(c.C.number(p.startEulerAngles.roll,p.endEulerAngles.roll,p.k)),p.tr.setPitch(c.C.number(p.startEulerAngles.pitch,p.endEulerAngles.pitch,p.k)),p.tr.setBearing(c.C.number(p.startEulerAngles.bearing,p.endEulerAngles.bearing,p.k))}function ir(p,e,i,l,u){const f=u.padding,y=Se(u.worldSize,i.getNorthWest()),w=Se(u.worldSize,i.getNorthEast()),S=Se(u.worldSize,i.getSouthEast()),M=Se(u.worldSize,i.getSouthWest()),k=c.ad(-l),L=y.rotate(k),D=w.rotate(k),F=S.rotate(k),U=M.rotate(k),ee=new c.P(Math.max(L.x,D.x,U.x,F.x),Math.max(L.y,D.y,U.y,F.y)),Q=new c.P(Math.min(L.x,D.x,U.x,F.x),Math.min(L.y,D.y,U.y,F.y)),te=ee.sub(Q),ne=(u.width-(f.left+f.right+e.left+e.right))/te.x,ce=(u.height-(f.top+f.bottom+e.top+e.bottom))/te.y;if(ce<0||ne<0)return void si();const se=Math.min(c.aj(u.scale*Math.min(ne,ce)),p.maxZoom),de=c.P.convert(p.offset),fe=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ad(l)),oe=de.add(fe).mult(u.scale/c.ae(se));return{center:q(u.worldSize,y.add(S).div(2).sub(oe)),zoom:se,bearing:l}}class Ll{get useGlobeControls(){return!1}handlePanInertia(e,i){return{easingOffset:e,easingCenter:i.center}}handleMapControlsRollPitchBearingZoom(e,i){e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta),e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta)}handleMapControlsPan(e,i,l){e.around.distSqr(i.centerPoint)<.01||i.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,i,l,u,f){return ir(e,i,l,u,f)}handleJumpToCenterZoom(e,i){e.zoom!==(i.zoom!==void 0?+i.zoom:e.zoom)&&e.setZoom(+i.zoom),i.center!==void 0&&e.setCenter(c.S.convert(i.center))}handleEaseTo(e,i){const l=e.zoom,u=e.padding,f={roll:e.roll,pitch:e.pitch,bearing:e.bearing},y={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},w=i.zoom!==void 0,S=!e.isPaddingEqual(i.padding);let M=!1;const k=w?+i.zoom:e.zoom;let L=e.centerPoint.add(i.offsetAsPoint);const D=e.screenPointToLocation(L),{center:F,zoom:U}=e.getConstrained(c.S.convert(i.center||D),k??l);Un(e,F);const ee=Se(e.worldSize,D),Q=Se(e.worldSize,F).sub(ee),te=c.ae(U-l);return M=U!==l,{easeFunc:ne=>{if(M&&e.setZoom(c.C.number(l,U,ne)),c.bd(f,y)||Fr({startEulerAngles:f,endEulerAngles:y,tr:e,k:ne,useSlerp:f.roll!=y.roll}),S&&(e.interpolatePadding(u,i.padding,ne),L=e.centerPoint.add(i.offsetAsPoint)),i.around)e.setLocationAtPoint(i.around,i.aroundPoint);else{const ce=c.ae(e.zoom-l),se=U>l?Math.min(2,te):Math.max(.5,te),de=Math.pow(se,1-ne),fe=q(e.worldSize,ee.add(Q.mult(ne*de)).mult(ce));e.setLocationAtPoint(e.renderWorldCopies?fe.wrap():fe,L)}},isZooming:M,elevationCenter:F}}handleFlyTo(e,i){const l=i.zoom!==void 0,u=e.zoom,f=e.getConstrained(c.S.convert(i.center||i.locationAtOffset),l?+i.zoom:u),y=f.center,w=f.zoom;Un(e,y);const S=Se(e.worldSize,i.locationAtOffset),M=Se(e.worldSize,y).sub(S),k=M.mag(),L=c.ae(w-u);let D;if(i.minZoom!==void 0){const F=Math.min(+i.minZoom,u,w),U=e.getConstrained(y,F).zoom;D=c.ae(U-u)}return{easeFunc:(F,U,ee,Q)=>{e.setZoom(F===1?w:u+c.aj(U));const te=F===1?y:q(e.worldSize,S.add(M.mult(ee)).mult(U));e.setLocationAtPoint(e.renderWorldCopies?te.wrap():te,Q)},scaleOfZoom:L,targetCenter:y,scaleOfMinZoom:D,pixelPathLength:k}}}class Dt{constructor(e,i,l){this.blendFunction=e,this.blendColor=i,this.mask=l}}Dt.Replace=[1,0],Dt.disabled=new Dt(Dt.Replace,c.be.transparent,[!1,!1,!1,!1]),Dt.unblended=new Dt(Dt.Replace,c.be.transparent,[!0,!0,!0,!0]),Dt.alphaBlended=new Dt([1,771],c.be.transparent,[!0,!0,!0,!0]);const bi=2305;class bt{constructor(e,i,l){this.enable=e,this.mode=i,this.frontFace=l}}bt.disabled=new bt(!1,1029,bi),bt.backCCW=new bt(!0,1029,bi),bt.frontCCW=new bt(!0,1028,bi);class Tt{constructor(e,i,l){this.func=e,this.mask=i,this.range=l}}Tt.ReadOnly=!1,Tt.ReadWrite=!0,Tt.disabled=new Tt(519,Tt.ReadOnly,[0,1]);const Fs=7680;class mt{constructor(e,i,l,u,f,y){this.test=e,this.ref=i,this.mask=l,this.fail=u,this.depthFail=f,this.pass=y}}mt.disabled=new mt({func:519,mask:0},0,0,Fs,Fs,Fs);const Bs=new WeakMap;function hi(p){var e;if(Bs.has(p))return Bs.get(p);{const i=(e=p.getParameter(p.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Bs.set(p,i),i}}class fo{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const i=e.context,l=i.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const u=new c.aK;u.emplaceBack(-1,-1),u.emplaceBack(2,-1),u.emplaceBack(-1,2);const f=new c.aM;f.emplaceBack(0,1,2),this._fullscreenTriangle=new $n(i.createVertexBuffer(u,Vn.members),i.createIndexBuffer(f),c.aL.simpleSegment(0,0,u.length,f.length)),this._resultBuffer=new Uint8Array(4),i.activeTexture.set(l.TEXTURE1);const y=l.createTexture();l.bindTexture(l.TEXTURE_2D,y),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=i.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(y),hi(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,i){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,i),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,i=e.gl;e.activeTexture.set(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,i){const l=this._cachedRenderContext.context,u=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,u.TRIANGLES,Tt.disabled,mt.disabled,Dt.unblended,bt.disabled,((f,y)=>({u_input:f,u_output_expected:y}))(e,i),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&hi(u)){u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.readBuffer(u.COLOR_ATTACHMENT0),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null);const f=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);u.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:f}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&hi(e)){const i=e.clientWaitSync(this._readbackQueue.sync,0,0);if(i===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(i===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=fo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let i=0;return i+=e[0]/256,i+=e[1]/65536,i+=e[2]/16777216,e[3]<127&&(i=-i),i/128}}const Wi=c.$/128;function pu(p,e){const i=p.granularity!==void 0?Math.max(p.granularity,1):1,l=i+(p.generateBorders?2:0),u=i+(p.extendToNorthPole||p.generateBorders?1:0)+(p.extendToSouthPole||p.generateBorders?1:0),f=l+1,y=u+1,w=p.generateBorders?-1:0,S=p.generateBorders||p.extendToNorthPole?-1:0,M=i+(p.generateBorders?1:0),k=i+(p.generateBorders||p.extendToSouthPole?1:0),L=f*y,D=l*u*6,F=f*y>65536;if(F&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const U=F||e==="32bit",ee=new Int16Array(2*L);let Q=0;for(let ce=S;ce<=k;ce++)for(let se=w;se<=M;se++){let de=se/i*c.$;se===-1&&(de=-64),se===i+1&&(de=c.$+Wi);let fe=ce/i*c.$;ce===-1&&(fe=p.extendToNorthPole?c.bg:-64),ce===i+1&&(fe=p.extendToSouthPole?c.bh:c.$+Wi),ee[Q++]=de,ee[Q++]=fe}const te=U?new Uint32Array(D):new Uint16Array(D);let ne=0;for(let ce=0;ce<u;ce++)for(let se=0;se<l;se++){const de=se+1+ce*f,fe=se+(ce+1)*f,oe=se+1+(ce+1)*f;te[ne++]=se+ce*f,te[ne++]=fe,te[ne++]=de,te[ne++]=de,te[ne++]=fe,te[ne++]=oe}return{vertices:ee.buffer.slice(0),indices:te.buffer.slice(0),uses32bitIndices:U}}const Cn=new c.aJ({fill:new c.bi(128,2),line:new c.bi(512,0),tile:new c.bi(128,32),stencil:new c.bi(128,1),circle:3});class Sd{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Sn.projectionGlobe}get vertexShaderPreludeCode(){return Sn.projectionMercator.vertexSource}get subdivisionGranularity(){return Cn}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new fo(e));const i=c.U(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-i*Math.PI*2))-.5*Math.PI,u=this._errorMeasurement.updateErrorLoop(i,l),f=O.now();u!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=u,this._errorMeasurementLastChangeTime=f);const y=Math.min(Math.max((f-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bk(y))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,i,l,u,f){const y=(f==="stencil"?Cn.stencil:Cn.tile).getGranularityForZoomLevel(i.z);return this._getMesh(e,{granularity:y,generateBorders:l,extendToNorthPole:i.y===0&&u,extendToSouthPole:i.y===(1<<i.z)-1&&u})}_getMesh(e,i){const l=this._getMeshKey(i);if(l in this._tileMeshCache)return this._tileMeshCache[l];const u=function(f,y){const w=pu(y,"16bit"),S=c.aK.deserialize({arrayBuffer:w.vertices,length:w.vertices.byteLength/2/2}),M=c.aM.deserialize({arrayBuffer:w.indices,length:w.indices.byteLength/2/3});return new $n(f.createVertexBuffer(S,Vn.members),f.createIndexBuffer(M),c.aL.simpleSegment(0,0,S.length,M.length))}(e,i);return this._tileMeshCache[l]=u,u}recalculate(e){}hasTransition(){const e=O.now();let i=!1;return i=i||(e-this._errorMeasurementLastChangeTime)/1e3<.7,i=i||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,i}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Cd=new c.r({type:new c.D(c.v.projection.type)});class xa extends c.E{constructor(e){super(),this._transitionable=new c.t(Cd),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new hu,this._verticalPerspectiveProjection=new Sd}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bl){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,i,l,u,f){return this.currentProjection.getMeshFromTileID(e,i,l,u,f)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function ba(p){const e=mo(p.worldSize,p.center.lat);return 2*Math.PI*e}function sn(p,e,i,l,u){const f=1/(1<<u),y=e/c.$*f+l*f,w=c.bn((p/c.$*f+i*f)*Math.PI*2+Math.PI,2*Math.PI),S=2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI,M=Math.cos(S),k=new Float64Array(3);return k[0]=Math.sin(w)*M,k[1]=Math.sin(S),k[2]=Math.cos(w)*M,k}function Br(p){return function(e,i){const l=Math.cos(i),u=new Float64Array(3);return u[0]=Math.sin(e)*l,u[1]=Math.sin(i),u[2]=Math.cos(e)*l,u}(p.lng*Math.PI/180,p.lat*Math.PI/180)}function mo(p,e){return p/(2*Math.PI)/Math.cos(e*Math.PI/180)}function wa(p){const e=Math.asin(p[1])/Math.PI*180,i=Math.sqrt(p[0]*p[0]+p[2]*p[2]);if(i>1e-6){const l=p[0]/i,u=Math.acos(p[2]/i),f=(l>0?u:-u)/Math.PI*180;return new c.S(c.aN(f,-180,180),e)}return new c.S(0,e)}function go(p){return Math.cos(p*Math.PI/180)}function Pr(p,e){const i=go(p),l=go(e);return c.aj(l/i)}function Ta(p,e){const i=p.rotate(e.bearingInRadians),l=e.zoom+Pr(e.center.lat,0),u=c.bj(1/go(e.center.lat),1/go(Math.min(Math.abs(e.center.lat),60)),c.bm(l,7,3,0,1)),f=360/ba({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.S(e.center.lng-i.x*f*u,c.ag(e.center.lat+i.y*f,-85.051129,c.ah))}function _o(p){const e=.5*p,i=Math.sin(e),l=Math.cos(e);return Math.log(i+l)-Math.log(l-i)}function yo(p,e,i,l){const u=p.lat+i*l;if(Math.abs(i)>1){const f=(Math.sign(p.lat+i)!==Math.sign(p.lat)?-Math.abs(p.lat):Math.abs(p.lat))*Math.PI/180,y=Math.abs(p.lat+i)*Math.PI/180,w=_o(f+l*(y-f)),S=_o(f),M=_o(y);return new c.S(p.lng+e*((w-S)/(M-S)),u)}return new c.S(p.lng+e*l,u)}class lm{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,i,l,u){const f=`${e.z}_${e.x}_${e.y}_${u!=null&&u.terrain?"t":""}`,y=this._cache.get(f);if(y)return y;const w=this._cachePrevious.get(f);if(w)return this._cache.set(f,w),w;const S=this._boundingVolumeFactory(e,i,l,u);return this._cache.set(f,S),this._hadAnyChanges=!0,S}}class us{constructor(e,i,l,u){this.min=l,this.max=u,this.points=e,this.planes=i}static fromAabb(e,i){const l=[];for(let u=0;u<8;u++)l.push([1&~u?e[0]:i[0],(u>>1&1)==1?i[1]:e[1],(u>>2&1)==1?i[2]:e[2]]);return new us(l,[[-1,0,0,i[0]],[1,0,0,-e[0]],[0,-1,0,i[1]],[0,1,0,-e[1]],[0,0,-1,i[2]],[0,0,1,-e[2]]],e,i)}static fromCenterSizeAngles(e,i,l){const u=c.bq([],l[0],l[1],l[2]),f=c.br([],[i[0],0,0],u),y=c.br([],[0,i[1],0],u),w=c.br([],[0,0,i[2]],u),S=[...e],M=[...e];for(let L=0;L<8;L++)for(let D=0;D<3;D++){const F=e[D]+f[D]*(1&~L?-1:1)+y[D]*((L>>1&1)==1?1:-1)+w[D]*((L>>2&1)==1?1:-1);S[D]=Math.min(S[D],F),M[D]=Math.max(M[D],F)}const k=[];for(let L=0;L<8;L++){const D=[...e];c.aR(D,D,c.aQ([],f,1&~L?-1:1)),c.aR(D,D,c.aQ([],y,(L>>1&1)==1?1:-1)),c.aR(D,D,c.aQ([],w,(L>>2&1)==1?1:-1)),k.push(D)}return new us(k,[[...f,-c.aW(f,k[0])],[...y,-c.aW(y,k[0])],[...w,-c.aW(w,k[0])],[-f[0],-f[1],-f[2],-c.aW(f,k[7])],[-y[0],-y[1],-y[2],-c.aW(y,k[7])],[-w[0],-w[1],-w[2],-c.aW(w,k[7])]],S,M)}intersectsFrustum(e){let i=!0;const l=this.points.length,u=this.planes.length,f=e.planes.length,y=e.points.length;for(let w=0;w<f;w++){const S=e.planes[w];let M=0;for(let k=0;k<l;k++){const L=this.points[k];S[0]*L[0]+S[1]*L[1]+S[2]*L[2]+S[3]>=0&&M++}if(M===0)return 0;M<l&&(i=!1)}if(i)return 2;for(let w=0;w<u;w++){const S=this.planes[w];let M=0;for(let k=0;k<y;k++){const L=e.points[k];S[0]*L[0]+S[1]*L[1]+S[2]*L[2]+S[3]>=0&&M++}if(M===0)return 0}return 1}intersectsPlane(e){const i=this.points.length;let l=0;for(let u=0;u<i;u++){const f=this.points[u];e[0]*f[0]+e[1]*f[1]+e[2]*f[2]+e[3]>=0&&l++}return l===i?2:l===0?0:1}}function Sa(p,e,i){const l=p-e;return l<0?-l:Math.max(0,l-i)}function fu(p,e,i,l,u){const f=p-i;let y;return y=f<0?Math.min(-f,1+f-u):f>1?Math.min(Math.max(f-u,0),1-f):0,Math.max(y,Sa(e,l,u))}class cm{constructor(){this._boundingVolumeCache=new lm(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,i,l,u){const f=1<<l.z,y=1/f,w=l.x/f,S=l.y/f;let M=2;return M=Math.min(M,fu(e,i,w,S,y)),M=Math.min(M,fu(e,i,w+.5,-S-y,y)),M=Math.min(M,fu(e,i,w+.5,2-S-y,y)),M}getWrap(e,i,l){const u=1<<i.z,f=1/u,y=i.x/u,w=Sa(e.x,y,f),S=Sa(e.x,y-1,f),M=Sa(e.x,y+1,f),k=Math.min(w,S,M);return k===M?1:k===S?-1:0}allowVariableZoom(e,i){return Be(e,i)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,i,l,u){return this._boundingVolumeCache.getTileBoundingVolume(e,i,l,u)}_computeTileBoundingVolume(e,i,l,u){var f,y;let w=l,S=l;if(u!=null&&u.terrain){const M=new c.Z(e.z,i,e.z,e.x,e.y),k=u.terrain.getMinMaxElevation(M);w=(f=k.minElevation)!==null&&f!==void 0?f:l,S=(y=k.maxElevation)!==null&&y!==void 0?y:l}if(w/=c.bt,S/=c.bt,w+=1,S+=1,e.z<=0)return us.fromAabb([-S,-S,-S],[S,S,S]);if(e.z===1)return us.fromAabb([e.x===0?-S:0,e.y===0?0:-S,-S],[e.x===0?0:S,e.y===0?S:0,S]);{const M=[sn(0,0,e.x,e.y,e.z),sn(c.$,0,e.x,e.y,e.z),sn(c.$,c.$,e.x,e.y,e.z),sn(0,c.$,e.x,e.y,e.z)],k=[];for(const ke of M)k.push(c.aQ([],ke,S));if(S!==w)for(const ke of M)k.push(c.aQ([],ke,w));e.y===0&&k.push([0,1,0]),e.y===(1<<e.z)-1&&k.push([0,-1,0]);const L=[1,1,1],D=[-1,-1,-1];for(const ke of k)for(let De=0;De<3;De++)L[De]=Math.min(L[De],ke[De]),D[De]=Math.max(D[De],ke[De]);const F=sn(c.$/2,c.$/2,e.x,e.y,e.z),U=c.aV([],[0,1,0],F);c.aU(U,U);const ee=c.aV([],F,U);c.aU(ee,ee);const Q=c.aV([],M[2],M[1]);c.aU(Q,Q);const te=c.aV([],M[0],M[3]);c.aU(te,te),k.push(c.aQ([],F,S)),e.y>=(1<<e.z)/2&&k.push(c.aQ([],sn(c.$/2,0,e.x,e.y,e.z),S)),e.y<(1<<e.z)/2&&k.push(c.aQ([],sn(c.$/2,c.$,e.x,e.y,e.z),S));const ne=di(F,k),ce=di(ee,k),se=[-F[0],-F[1],-F[2],ne.max],de=[F[0],F[1],F[2],-ne.min],fe=[-ee[0],-ee[1],-ee[2],ce.max],oe=[ee[0],ee[1],ee[2],-ce.min],ve=[...Q,0],Re=[...te,0],Ee=[];return e.y===0?Ee.push(c.bs(Re,ve,se),c.bs(Re,ve,de)):Ee.push(c.bs(fe,ve,se),c.bs(fe,ve,de),c.bs(fe,Re,se),c.bs(fe,Re,de)),e.y===(1<<e.z)-1?Ee.push(c.bs(Re,ve,se),c.bs(Re,ve,de)):Ee.push(c.bs(oe,ve,se),c.bs(oe,ve,de),c.bs(oe,Re,se),c.bs(oe,Re,de)),new us(Ee,[se,de,fe,oe,ve,Re],L,D)}}}function di(p,e){let i=1/0,l=-1/0;for(const u of e){const f=c.aW(p,u);i=Math.min(i,f),l=Math.max(l,f)}return{min:i,max:l}}class vo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,l){return this._helper.interpolatePadding(e,i,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i){this._helper.resize(e,i)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bu(),this._projectionMatrix=c.b8(),this._globeViewProjMatrix32f=c.b7(),this._globeViewProjMatrixNoCorrection=c.b8(),this._globeViewProjMatrixNoCorrectionInverted=c.b8(),this._globeProjMatrixInverted=c.b8(),this._cameraPosition=c.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new va({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._coveringTilesDetailsProvider=new cm}clone(){const e=new vo;return e.apply(this),e}apply(e,i){this._globeLatitudeErrorCorrectionRadians=i||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bo();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:i,applyGlobeMatrix:l}=e,u=this._helper.getMercatorTileCoordinates(i);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:u,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const i=this.pitchInRadians,l=this.cameraToCenterDistance/e,u=Math.sin(i)*l,f=Math.cos(i)*l+1,y=1/Math.sqrt(u*u+f*f)*1;let w=-u,S=f;const M=Math.sqrt(w*w+S*S);w/=M,S/=M;const k=[0,w,S];c.bv(k,k,[0,0,0],-this.bearingInRadians),c.bw(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),c.bx(k,k,[0,0,0],this.center.lng*Math.PI/180);const L=1/c.aY(k);return c.aQ(k,k,L),[...k,-y*L]}isLocationOccluded(e){return!this.isSurfacePointVisible(Br(e))}transformLightDirection(e){const i=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,u=Math.cos(l),f=[Math.sin(i)*u,Math.sin(l),Math.cos(i)*u],y=[f[2],0,-f[0]],w=[0,0,0];c.aV(w,y,f),c.aU(y,y),c.aU(w,w);const S=[0,0,0];return c.aU(S,[y[0]*e[0]+w[0]*e[1]+f[0]*e[2],y[1]*e[0]+w[1]*e[1]+f[1]*e[2],y[2]*e[0]+w[2]*e[1]+f[2]*e[2]]),S}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,i,l){const u=function(w,S,M){const k=1/(1<<M.z);return new c.a0(w/c.$*k+M.x*k,S/c.$*k+M.y*k)}(e,i,l.canonical),f=(y=u.y,[c.bn(u.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI]);var y;return this.getCircleRadiusCorrection()/Math.cos(f[1])}projectTileCoordinates(e,i,l,u){const f=l.canonical,y=sn(e,i,f.x,f.y,f.z),w=1+(u?u(e,i):0)/c.bt,S=[y[0]*w,y[1]*w,y[2]*w,1];c.av(S,S,this._globeViewProjMatrixNoCorrection);const M=this._cachedClippingPlane,k=M[0]*y[0]+M[1]*y[1]+M[2]*y[2]+M[3]<0;return{point:new c.P(S[0]/S[3],S[1]/S[3]),signedDistanceFromCamera:S[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=mo(this.worldSize,this.center.lat),i=c.b9(),l=c.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b3(i,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const u=this.centerOffset;i[8]=2*-u.x/this._helper._width,i[9]=2*u.y/this._helper._height,this._projectionMatrix=c.b4(i),this._globeProjMatrixInverted=c.b9(),c.ap(this._globeProjMatrixInverted,i),c.M(i,i,[0,0,-this.cameraToCenterDistance]),c.b5(i,i,this.rollInRadians),c.b6(i,i,-this.pitchInRadians),c.b5(i,i,this.bearingInRadians),c.M(i,i,[0,0,-e]);const f=c.bo();f[0]=e,f[1]=e,f[2]=e,c.b6(l,i,this.center.lat*Math.PI/180),c.by(l,l,-this.center.lng*Math.PI/180),c.N(l,l,f),this._globeViewProjMatrixNoCorrection=l,c.b6(i,i,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.by(i,i,-this.center.lng*Math.PI/180),c.N(i,i,f),this._globeViewProjMatrix32f=new Float32Array(i),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),c.ap(this._globeViewProjMatrixNoCorrectionInverted,l);const y=c.bo();this._cameraPosition=c.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bv(this._cameraPosition,this._cameraPosition,y,-this.rollInRadians),c.bw(this._cameraPosition,this._cameraPosition,y,this.pitchInRadians),c.bv(this._cameraPosition,this._cameraPosition,y,-this.bearingInRadians),c.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bw(this._cameraPosition,this._cameraPosition,y,-this.center.lat*Math.PI/180),c.bx(this._cameraPosition,this._cameraPosition,y,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const w=c.b4(this._globeViewProjMatrixNoCorrectionInverted);c.N(w,w,[1,1,-1]),this._cachedFrustum=ni.fromInvProjectionMatrix(w,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const i=c.b9();return c.af(i),i}getVisibleUnwrappedCoordinates(e){return[new c.b1(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Br(e);c.aQ(l,l,1+i/c.bt);const u=c.bu();return c.av(u,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),u[2]/u[3]}populateCache(e){}getBounds(){const e=.5*this.width,i=.5*this.height,l=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,i),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,i)],u=[];for(const L of l)u.push(this.unprojectScreenPoint(L));let f=0,y=0,w=0,S=0;const M=this.center;for(const L of u){const D=c.bz(M.lng,L.lng),F=c.bz(M.lat,L.lat);D<y&&(y=D),D>f&&(f=D),F<S&&(S=F),F>w&&(w=F)}const k=[M.lng+y,M.lat+S,M.lng+f,M.lat+w];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new cr(k)}getConstrained(e,i){const l=c.ag(e.lat,-85.051129,c.ah),u=c.ag(+i,this.minZoom+Pr(0,l),this.maxZoom);return{center:new c.S(e.lng,l),zoom:u}}calculateCenterFromCameraLngLatAlt(e,i,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,l,u)}setLocationAtPoint(e,i){const l=Br(this.unprojectScreenPoint(i)),u=Br(e),f=c.bo();c.bA(f);const y=c.bo();c.bx(y,l,f,-this.center.lng*Math.PI/180),c.bw(y,y,f,this.center.lat*Math.PI/180);const w=u[0]*u[0]+u[2]*u[2],S=y[0]*y[0];if(w<S)return;const M=Math.sqrt(w-S),k=-M,L=c.bB(u[0],u[2],y[0],M),D=c.bB(u[0],u[2],y[0],k),F=c.bo();c.bx(F,u,f,-L);const U=c.bB(F[1],F[2],y[1],y[2]),ee=c.bo();c.bx(ee,u,f,-D);const Q=c.bB(ee[1],ee[2],y[1],y[2]),te=.5*Math.PI,ne=U>=-te&&U<=te,ce=Q>=-te&&Q<=te;let se,de;if(ne&&ce){const Re=this.center.lng*Math.PI/180,Ee=this.center.lat*Math.PI/180;c.bC(L,Re)+c.bC(U,Ee)<c.bC(D,Re)+c.bC(Q,Ee)?(se=L,de=U):(se=D,de=Q)}else if(ne)se=L,de=U;else{if(!ce)return;se=D,de=Q}const fe=se/Math.PI*180,oe=de/Math.PI*180,ve=this.center.lat;this.setCenter(new c.S(fe,c.ag(oe,-90,90))),this.setZoom(this.zoom+Pr(ve,this.center.lat))}locationToScreenPoint(e,i){const l=Br(e);if(i){const u=i.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aQ(l,l,1+u/c.bt)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const i=c.bu();return c.av(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],new c.P((.5*i[0]+.5)*this.width,(.5*-i[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,i){if(i){const l=i.pointCoordinate(e);if(l)return l}return c.a0.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,i){var l;return(l=this.screenPointToMercatorCoordinate(e,i))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,i){const l=this._cameraPosition,u=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,u)}getRayDirectionFromPixel(e){const i=c.bu();i[0]=e.x/this.width*2-1,i[1]=-1*(e.y/this.height*2-1),i[2]=1,i[3]=1,c.av(i,i,this._globeViewProjMatrixNoCorrectionInverted),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3];const l=c.bo();l[0]=i[0]-this._cameraPosition[0],l[1]=i[1]-this._cameraPosition[1],l[2]=i[2]-this._cameraPosition[2];const u=c.bo();return c.aU(u,l),u}isSurfacePointVisible(e){const i=this._cachedClippingPlane;return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const i=c.bu();return c.av(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3],i[0]>-1&&i[0]<1&&i[1]>-1&&i[1]<1&&i[2]>-1&&i[2]<1}rayPlanetIntersection(e,i){const l=c.aW(e,i),u=c.bo(),f=c.bo();c.aQ(f,i,l),c.aT(u,e,f);const y=1-c.aW(u,u);if(y<0)return null;const w=c.aW(e,e)-1,S=-l+(l<0?1:-1)*Math.sqrt(y),M=w/S,k=S;return{tMin:Math.min(M,k),tMax:Math.max(M,k)}}unprojectScreenPoint(e){const i=this._cameraPosition,l=this.getRayDirectionFromPixel(e),u=this.rayPlanetIntersection(i,l);if(u){const k=c.bo();c.aR(k,i,[l[0]*u.tMin,l[1]*u.tMin,l[2]*u.tMin]);const L=c.bo();return c.aU(L,k),wa(L)}const f=this._cachedClippingPlane,y=f[0]*l[0]+f[1]*l[1]+f[2]*l[2],w=-c.b0(f,i)/y,S=c.bo();if(w>0)c.aR(S,i,[l[0]*w,l[1]*w,l[2]*w]);else{const k=c.bo();c.aR(k,i,[2*l[0],2*l[1],2*l[2]]);const L=c.b0(this._cachedClippingPlane,k);c.aT(S,k,[this._cachedClippingPlane[0]*L,this._cachedClippingPlane[1]*L,this._cachedClippingPlane[2]*L])}const M=function(k){const L=c.bo();return L[0]=k[0]*-k[3],L[1]=k[1]*-k[3],L[2]=k[2]*-k[3],{center:L,radius:Math.sqrt(1-k[3]*k[3])}}(f);return wa(function(k,L,D){const F=c.bo();c.aT(F,D,k);const U=c.bo();return c.bp(U,k,F,L/c.a_(F)),U}(M.center,M.radius,S))}getMatrixForModel(e,i){const l=c.S.convert(e),u=1/c.bt,f=c.b8();return c.by(f,f,l.lng/180*Math.PI),c.b6(f,f,-l.lat/180*Math.PI),c.M(f,f,[0,0,1+i/c.bt]),c.b6(f,f,.5*Math.PI),c.N(f,f,[u,u,u]),f}getProjectionDataForCustomLayer(e=!0){const i=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:e});return i.tileMercatorCoords=[0,0,1,1],i}getFastPathSimpleProjectionMatrix(e){}}class Li{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,l){return this._helper.interpolatePadding(e,i,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,l=!0){this._helper.resize(e,i,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,i){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=i,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new va({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._globeness=1,this._mercatorTransform=new Cr,this._verticalPerspectiveTransform=new vo}clone(){const e=new Li;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const i=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:i.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:i.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,i,l){const u=this._mercatorTransform.getPitchedTextCorrection(e,i,l),f=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,i,l);return c.bj(u,f,this._globeness)}projectTileCoordinates(e,i,l,u){return this.currentTransform.projectTileCoordinates(e,i,l,u)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){return this.currentTransform.lngLatToCameraDepth(e,i)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,i){return this.currentTransform.getConstrained(e,i)}calculateCenterFromCameraLngLatAlt(e,i,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,l,u)}setLocationAtPoint(e,i){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,i),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,i),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,i){return this.currentTransform.locationToScreenPoint(e,i)}screenPointToMercatorCoordinate(e,i){return this.currentTransform.screenPointToMercatorCoordinate(e,i)}screenPointToLocation(e,i){return this.currentTransform.screenPointToLocation(e,i)}isPointOnMapSurface(e,i){return this.currentTransform.isPointOnMapSurface(e,i)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,i){return this.currentTransform.getMatrixForModel(e,i)}getProjectionDataForCustomLayer(e=!0){const i=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return i;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=i.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class wi{get useGlobeControls(){return!0}handlePanInertia(e,i){const l=Ta(e,i);return Math.abs(l.lng-i.center.lng)>180&&(l.lng=i.center.lng+179.5*Math.sign(l.lng-i.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,i){const l=e.around,u=i.screenPointToLocation(l);e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta);const f=i.zoom;e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta);const y=i.zoom-f;if(y===0)return;const w=c.bz(i.center.lng,u.lng),S=w/(Math.abs(w/180)+1),M=c.bz(i.center.lat,u.lat),k=i.getRayDirectionFromPixel(l),L=i.cameraPosition,D=-1*c.aW(L,k),F=c.bo();c.aR(F,L,[k[0]*D,k[1]*D,k[2]*D]);const U=c.aY(F)-1,ee=Math.exp(.5*-Math.max(U-.3,0)),Q=mo(i.worldSize,i.center.lat)/Math.min(i.width,i.height),te=c.bm(Q,.9,.5,1,.25),ne=(1-c.ae(-y))*Math.min(ee,te),ce=i.center.lat,se=i.zoom,de=new c.S(i.center.lng+S*ne,c.ag(i.center.lat+M*ne,-85.051129,c.ah));i.setLocationAtPoint(u,l);const fe=i.center,oe=c.bm(Math.abs(w),45,85,0,1),ve=c.bm(Q,.75,.35,0,1),Re=Math.pow(Math.max(oe,ve),.25),Ee=c.bz(fe.lng,de.lng),ke=c.bz(fe.lat,de.lat);i.setCenter(new c.S(fe.lng+Ee*Re,fe.lat+ke*Re).wrap()),i.setZoom(se+Pr(ce,i.center.lat))}handleMapControlsPan(e,i,l){if(!e.panDelta)return;const u=i.center.lat,f=i.zoom;i.setCenter(Ta(e.panDelta,i).wrap()),i.setZoom(f+Pr(u,i.center.lat))}cameraForBoxAndBearing(e,i,l,u,f){const y=ir(e,i,l,u,f),w=i.left/f.width*2-1,S=(f.width-i.right)/f.width*2-1,M=i.top/f.height*-2+1,k=(f.height-i.bottom)/f.height*-2+1,L=c.bz(l.getWest(),l.getEast())<0,D=L?l.getEast():l.getWest(),F=L?l.getWest():l.getEast(),U=Math.max(l.getNorth(),l.getSouth()),ee=Math.min(l.getNorth(),l.getSouth()),Q=D+.5*c.bz(D,F),te=U+.5*c.bz(U,ee),ne=f.clone();ne.setCenter(y.center),ne.setBearing(y.bearing),ne.setPitch(0),ne.setRoll(0),ne.setZoom(y.zoom);const ce=ne.modelViewProjectionMatrix,se=[Br(l.getNorthWest()),Br(l.getNorthEast()),Br(l.getSouthWest()),Br(l.getSouthEast()),Br(new c.S(F,te)),Br(new c.S(D,te)),Br(new c.S(Q,U)),Br(new c.S(Q,ee))],de=Br(y.center);let fe=Number.POSITIVE_INFINITY;for(const oe of se)w<0&&(fe=wi.getLesserNonNegativeNonNull(fe,wi.solveVectorScale(oe,de,ce,"x",w))),S>0&&(fe=wi.getLesserNonNegativeNonNull(fe,wi.solveVectorScale(oe,de,ce,"x",S))),M>0&&(fe=wi.getLesserNonNegativeNonNull(fe,wi.solveVectorScale(oe,de,ce,"y",M))),k<0&&(fe=wi.getLesserNonNegativeNonNull(fe,wi.solveVectorScale(oe,de,ce,"y",k)));if(Number.isFinite(fe)&&fe!==0)return y.zoom=ne.zoom+c.aj(fe),y;si()}handleJumpToCenterZoom(e,i){const l=e.center.lat,u=e.getConstrained(i.center?c.S.convert(i.center):e.center,e.zoom).center;e.setCenter(u.wrap());const f=i.zoom!==void 0?+i.zoom:e.zoom+Pr(l,u.lat);e.zoom!==f&&e.setZoom(f)}handleEaseTo(e,i){const l=e.zoom,u=e.center,f=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},S=i.zoom!==void 0,M=!e.isPaddingEqual(i.padding);let k=!1;const L=i.center?c.S.convert(i.center):u,D=e.getConstrained(L,l).center;Un(e,D);const F=e.clone();F.setCenter(D),F.setZoom(S?+i.zoom:l+Pr(u.lat,L.lat)),F.setBearing(i.bearing);const U=new c.P(c.ag(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),c.ag(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));F.setLocationAtPoint(D,U);const ee=(i.offset&&i.offsetAsPoint.mag())>0?F.center:D,Q=S?+i.zoom:l+Pr(u.lat,ee.lat),te=l+Pr(u.lat,0),ne=Q+Pr(ee.lat,0),ce=c.bz(u.lng,ee.lng),se=c.bz(u.lat,ee.lat),de=c.ae(ne-te);return k=Q!==l,{easeFunc:fe=>{if(c.bd(y,w)||Fr({startEulerAngles:y,endEulerAngles:w,tr:e,k:fe,useSlerp:y.roll!=w.roll}),M&&e.interpolatePadding(f,i.padding,fe),i.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(i.around,i.aroundPoint);else{const oe=ne>te?Math.min(2,de):Math.max(.5,de),ve=Math.pow(oe,1-fe),Re=yo(u,ce,se,fe*ve);e.setCenter(Re.wrap())}if(k){const oe=c.C.number(te,ne,fe)+Pr(0,e.center.lat);e.setZoom(oe)}},isZooming:k,elevationCenter:ee}}handleFlyTo(e,i){const l=i.zoom!==void 0,u=e.center,f=e.zoom,y=e.padding,w=!e.isPaddingEqual(i.padding),S=e.getConstrained(c.S.convert(i.center||i.locationAtOffset),f).center,M=l?+i.zoom:e.zoom+Pr(e.center.lat,S.lat),k=e.clone();k.setCenter(S),k.setZoom(M),k.setBearing(i.bearing);const L=new c.P(c.ag(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),c.ag(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(S,L);const D=k.center;Un(e,D);const F=function(se,de,fe){const oe=Br(de),ve=Br(fe),Re=c.aW(oe,ve),Ee=Math.acos(Re),ke=ba(se);return Ee/(2*Math.PI)*ke}(e,u,D),U=f+Pr(u.lat,0),ee=M+Pr(D.lat,0),Q=c.ae(ee-U);let te;if(typeof i.minZoom=="number"){const se=+i.minZoom+Pr(D.lat,0),de=Math.min(se,U,ee)+Pr(0,D.lat),fe=e.getConstrained(D,de).zoom+Pr(D.lat,0);te=c.ae(fe-U)}const ne=c.bz(u.lng,D.lng),ce=c.bz(u.lat,D.lat);return{easeFunc:(se,de,fe,oe)=>{const ve=yo(u,ne,ce,fe);w&&e.interpolatePadding(y,i.padding,se);const Re=se===1?D:ve;e.setCenter(Re.wrap());const Ee=U+c.aj(de);e.setZoom(se===1?M:Ee+Pr(0,Re.lat))},scaleOfZoom:Q,targetCenter:D,scaleOfMinZoom:te,pixelPathLength:F}}static solveVectorScale(e,i,l,u,f){const y=u==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],w=[l[3],l[7],l[11],l[15]],S=e[0]*y[0]+e[1]*y[1]+e[2]*y[2],M=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],k=i[0]*y[0]+i[1]*y[1]+i[2]*y[2],L=i[0]*w[0]+i[1]*w[1]+i[2]*w[2];return k+f*M===S+f*L||w[3]*(S-k)+y[3]*(L-M)+S*L==k*M?null:(k+y[3]-f*L-f*w[3])/(k-S-f*L+f*M)}static getLesserNonNegativeNonNull(e,i){return i!==null&&i>=0&&i<e?i:e}}class mu{constructor(e){this._globe=e,this._mercatorCameraHelper=new Ll,this._verticalPerspectiveCameraHelper=new wi}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,i){return this.currentHelper.handlePanInertia(e,i)}handleMapControlsRollPitchBearingZoom(e,i){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,i)}handleMapControlsPan(e,i,l){this.currentHelper.handleMapControlsPan(e,i,l)}cameraForBoxAndBearing(e,i,l,u,f){return this.currentHelper.cameraForBoxAndBearing(e,i,l,u,f)}handleJumpToCenterZoom(e,i){this.currentHelper.handleJumpToCenterZoom(e,i)}handleEaseTo(e,i){return this.currentHelper.handleEaseTo(e,i)}handleFlyTo(e,i){return this.currentHelper.handleFlyTo(e,i)}}const Ca=(p,e)=>c.y(p,e&&e.filter(i=>i.identifier!=="source.canvas")),xo=c.bD();class gu extends c.E{constructor(e,i={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new ui(Zi(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,u)=>this.getGlyphs(l,u)),this.dispatcher.registerMessageHandler("GI",(l,u)=>this.getImages(l,u)),this.imageManager=new ht,this.imageManager.setEventedParent(this),this.glyphManager=new Lr(e._requestManager,i.localIdeographFontFamily),this.lineAtlas=new xt(256,512),this.crossTileSymbolIndex=new Al,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bF()),Ai().on(jn,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const f=u.getSource();if(f&&f.vectorLayerIds)for(const y in this._layers){const w=this._layers[y];w.source===f.id&&this._validateLayer(w)}})}setGlobalStateProperty(e,i){var l,u,f;this._checkLoaded();const y=i===null?(f=(u=(l=this.stylesheet.state)===null||l===void 0?void 0:l[e])===null||u===void 0?void 0:u.default)!==null&&f!==void 0?f:null:i;if(c.bG(y,this._globalState[e]))return this;this._globalState[e]=y;const w=this._findGlobalStateAffectedSources([e]);for(const S in this.sourceCaches)w.has(S)&&(this._reloadSource(S),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const i=[];for(const u in e)!c.bG(this._globalState[u],e[u].default)&&(i.push(u),this._globalState[u]=e[u].default);const l=this._findGlobalStateAffectedSources(i);for(const u in this.sourceCaches)l.has(u)&&(this._reloadSource(u),this._changed=!0)}_findGlobalStateAffectedSources(e){if(e.length===0)return new Set;const i=new Set;for(const l in this._layers){const u=this._layers[l],f=u.getLayoutAffectingGlobalStateRefs();for(const y of e)f.has(y)&&i.add(u.source)}return i}loadURL(e,i={},l){this.fire(new c.l("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const f=this._loadStyleRequest;c.j(u,this._loadStyleRequest).then(y=>{this._loadStyleRequest=null,this._load(y.data,i,l)}).catch(y=>{this._loadStyleRequest=null,y&&!f.signal.aborted&&this.fire(new c.k(y))})}loadJSON(e,i={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,O.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(e,i,l)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(xo,{validate:!1})}_load(e,i,l){var u,f,y;const w=i.transformStyle?i.transformStyle(l,e):e;if(!i.validate||!Ca(this,c.z(w))){this._loaded=!0,this.stylesheet=w;for(const S in w.sources)this.addSource(S,w.sources[S],{validate:!1});w.sprite?this._loadSprite(w.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(w.glyphs),this._createLayers(),this.light=new xn(this.stylesheet.light),this._setProjectionInternal(((u=this.stylesheet.projection)===null||u===void 0?void 0:u.type)||"mercator"),this.sky=new st(this.stylesheet.sky),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.setGlobalState((y=this.stylesheet.state)!==null&&y!==void 0?y:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const e=c.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of e){const l=c.bI(i);l.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=l}}_loadSprite(e,i=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(f,y,w,S){return c._(this,void 0,void 0,function*(){const M=Ce(f),k=w>1?"@2x":"",L={},D={};for(const{id:F,url:U}of M){const ee=y.transformRequest(Ne(U,k,".json"),"SpriteJSON");L[F]=c.j(ee,S);const Q=y.transformRequest(Ne(U,k,".png"),"SpriteImage");D[F]=re.getImage(Q,S)}return yield Promise.all([...Object.values(L),...Object.values(D)]),function(F,U){return c._(this,void 0,void 0,function*(){const ee={};for(const Q in F){ee[Q]={};const te=O.getImageCanvasContext((yield U[Q]).data),ne=(yield F[Q]).data;for(const ce in ne){const{width:se,height:de,x:fe,y:oe,sdf:ve,pixelRatio:Re,stretchX:Ee,stretchY:ke,content:De,textFitWidth:Ye,textFitHeight:Xe}=ne[ce];ee[Q][ce]={data:null,pixelRatio:Re,sdf:ve,stretchX:Ee,stretchY:ke,content:De,textFitWidth:Ye,textFitHeight:Xe,spriteData:{width:se,height:de,x:fe,y:oe,context:te}}}}return ee})}(L,D)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(f=>{if(this._spriteRequest=null,f)for(const y in f){this._spritesImagesIds[y]=[];const w=this._spritesImagesIds[y]?this._spritesImagesIds[y].filter(S=>!(S in f)):[];for(const S of w)this.imageManager.removeImage(S),this._changedImages[S]=!0;for(const S in f[y]){const M=y==="default"?S:`${y}:${S}`;this._spritesImagesIds[y].push(M),M in this.imageManager.images?this.imageManager.updateImage(M,f[y][S],!1):this.imageManager.addImage(M,f[y][S]),i&&(this._changedImages[M]=!0)}}}).catch(f=>{this._spriteRequest=null,u=f,this.fire(new c.k(u))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(u)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const i=this.sourceCaches[e.source];if(!i)return;const l=e.sourceLayer;if(!l)return;const u=i.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,i=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(i?c.bJ(l):l);const u=[];for(const f of e)if(l[f]){const y=i?c.bJ(l[f]):l[f];u.push(y)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const i=Object.keys(this._layers);for(const l of i){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){var e,i,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((i=this.sky)===null||i===void 0)&&i.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const u in this.sourceCaches)if(this.sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const i=this._changed;if(i){const u=Object.keys(this._updatedLayers),f=Object.keys(this._removedLayers);(u.length||f.length)&&this._updateWorkerLayers(u,f);for(const y in this._updatedSources){const w=this._updatedSources[y];if(w==="reload")this._reloadSource(y);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(y)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const f=this.sourceCaches[u];l[u]=f.used,f.used=!1}for(const u of this._order){const f=this._layers[u];f.recalculate(e,this._availableImages),!f.isHidden(e.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}for(const u in l){const f=this.sourceCaches[u];!!l[u]!=!!f.used&&f.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,i&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,i){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,i={}){var l;this._checkLoaded();const u=this.serialize();if(e=i.transformStyle?i.transformStyle(u,e):e,((l=i.validate)===null||l===void 0||l)&&Ca(this,c.z(e)))return!1;(e=c.bJ(e)).layers=c.bH(e.layers);const f=c.bK(u,e),y=this._getOperationsToPerform(f);if(y.unimplemented.length>0)throw new Error(`Unimplemented: ${y.unimplemented.join(", ")}.`);if(y.operations.length===0)return!1;for(const w of y.operations)w();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const i=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,u.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,u.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,u.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,u.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,u.args));break;case"addSource":i.push(()=>this.addSource.apply(this,u.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,u.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,u.args));break;case"setLight":i.push(()=>this.setLight.apply(this,u.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,u.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,u.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,u.args));break;case"setSky":i.push(()=>this.setSky.apply(this,u.args));break;case"setProjection":this.setProjection.apply(this,u.args);break;case"setGlobalState":i.push(()=>this.setGlobalState.apply(this,u.args));break;case"setTransition":i.push(()=>{});break;default:l.push(u.command)}return{operations:i,unimplemented:l}}addImage(e,i){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,i),this._afterImageUpdated(e)}updateImage(e,i){this.imageManager.updateImage(e,i)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,i,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(c.z.source,`sources.${e}`,i,null,l))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const u=this.sourceCaches[e]=new $e(e,i,this.dispatcher);u.style=this,u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e})),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,i){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(i),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,i,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new c.k(new Error(`Layer "${u}" already exists on this map.`)));let f;if(e.type==="custom"){if(Ca(this,c.bL(e)))return;f=c.bI(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=c.bJ(e),e=c.e(e,{source:u})),this._validate(c.z.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;f=c.bI(e),this._validateLayer(f),f.setEventedParent(this,{layer:{id:u}})}const y=i?this._order.indexOf(i):this._order.length;if(i&&y===-1)this.fire(new c.k(new Error(`Cannot add layer "${u}" before non-existing layer "${i}".`)));else{if(this._order.splice(y,0,u),this._layerOrderChanged=!0,this._layers[u]=f,this._removedLayers[u]&&f.source&&f.type!=="custom"){const w=this._removedLayers[u];delete this._removedLayers[u],w.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}moveLayer(e,i){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===i)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=i?this._order.indexOf(i):this._order.length;i&&u===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${i}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const i=this._layers[e];if(!i)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));i.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,i,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===i&&u.maxzoom===l||(i!=null&&(u.minzoom=i),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,i,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!c.bG(u.filter,i))return i==null?(u.setFilter(void 0),void this._updateLayer(u)):void(this._validate(c.z.filter,`layers.${u.id}.filter`,i,null,l)||(u.setFilter(c.bJ(i)),this._updateLayer(u)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bJ(this.getLayer(e).filter)}setLayoutProperty(e,i,l,u={}){this._checkLoaded();const f=this.getLayer(e);f?c.bG(f.getLayoutProperty(i),l)||(f.setLayoutProperty(i,l,u),this._updateLayer(f)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,i){const l=this.getLayer(e);if(l)return l.getLayoutProperty(i);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,i,l,u={}){this._checkLoaded();const f=this.getLayer(e);f?c.bG(f.getPaintProperty(i),l)||(f.setPaintProperty(i,l,u)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,i){return this.getLayer(e).getPaintProperty(i)}setFeatureState(e,i){this._checkLoaded();const l=e.source,u=e.sourceLayer,f=this.sourceCaches[l];if(f===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const y=f.getSource().type;y==="geojson"&&u?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||u?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),f.setFeatureState(u,e.id,i)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,i){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const f=u.getSource().type,y=f==="vector"?e.sourceLayer:void 0;f!=="vector"||y?i&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(y,e.id,i):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const i=e.source,l=e.sourceLayer,u=this.sourceCaches[i];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bM(this.sourceCaches,f=>f.serialize()),i=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return c.bN({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,projection:u.projection,sources:e,layers:i,terrain:l},f=>f!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const i=y=>this._layers[y].type==="fill-extrusion",l={},u=[];for(let y=this._order.length-1;y>=0;y--){const w=this._order[y];if(i(w)){l[w]=y;for(const S of e){const M=S[w];if(M)for(const k of M)u.push(k)}}}u.sort((y,w)=>w.intersectionZ-y.intersectionZ);const f=[];for(let y=this._order.length-1;y>=0;y--){const w=this._order[y];if(i(w))for(let S=u.length-1;S>=0;S--){const M=u[S].feature;if(l[M.layer.id]<y)break;f.push(M),u.pop()}else for(const S of e){const M=S[w];if(M)for(const k of M)f.push(k.feature)}}return f}queryRenderedFeatures(e,i,l){i&&i.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",i.filter,null,i);const u={};if(i&&i.layers){if(!(Array.isArray(i.layers)||i.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const M of i.layers){const k=this._layers[M];if(!k)return this.fire(new c.k(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];u[k.source]=!0}}const f=[];i.availableImages=this._availableImages;const y=this._serializedAllLayers(),w=i.layers instanceof Set?i.layers:Array.isArray(i.layers)?new Set(i.layers):null,S=Object.assign(Object.assign({},i),{layers:w});for(const M in this.sourceCaches)i.layers&&!u[M]||f.push(kr(this.sourceCaches[M],this._layers,y,e,S,l,this.map.terrain?(k,L,D)=>this.map.terrain.getElevation(k,L,D):void 0));return this.placement&&f.push(function(M,k,L,D,F,U,ee){const Q={},te=U.queryRenderedSymbols(D),ne=[];for(const ce of Object.keys(te).map(Number))ne.push(ee[ce]);ne.sort(ua);for(const ce of ne){const se=ce.featureIndex.lookupSymbolFeatures(te[ce.bucketInstanceId],k,ce.bucketIndex,ce.sourceLayerIndex,F.filter,F.layers,F.availableImages,M);for(const de in se){const fe=Q[de]=Q[de]||[],oe=se[de];oe.sort((ve,Re)=>{const Ee=ce.featureSortOrder;if(Ee){const ke=Ee.indexOf(ve.featureIndex);return Ee.indexOf(Re.featureIndex)-ke}return Re.featureIndex-ve.featureIndex});for(const ve of oe)fe.push(ve)}}return function(ce,se,de){for(const fe in ce)for(const oe of ce[fe])ki(oe,de[se[fe].source]);return ce}(Q,M,L)}(this._layers,y,this.sourceCaches,e,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)}querySourceFeatures(e,i){i&&i.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",i.filter,null,i);const l=this.sourceCaches[e];return l?function(u,f){const y=u.getRenderableIds().map(M=>u.getTileByID(M)),w=[],S={};for(let M=0;M<y.length;M++){const k=y[M],L=k.tileID.canonical.key;S[L]||(S[L]=!0,k.querySourceFeatures(w,f))}return w}(l,i):[]}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const y in e)if(!c.bG(e[y],l[y])){u=!0;break}if(!u)return;const f={now:O.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(f)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,i={}){this._checkLoaded();const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const y in e)if(!c.bG(e[y],l[y])){u=!0;break}if(!u)return;const f={now:O.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,i),this.sky.updateTransitions(f)}_setProjectionInternal(e){const i=function(l){if(Array.isArray(l)){const u=new xa({type:l});return{projection:u,transform:new Li,cameraHelper:new mu(u)}}switch(l){case"mercator":return{projection:new hu,transform:new Cr,cameraHelper:new Ll};case"globe":{const u=new xa({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:u,transform:new Li,cameraHelper:new mu(u)}}case"vertical-perspective":return{projection:new Sd,transform:new vo,cameraHelper:new wi};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new hu,transform:new Cr,cameraHelper:new Ll}}}(e);this.projection=i.projection,this.map.migrateProjection(i.transform,i.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,i,l,u,f={}){return(!f||f.validate!==!1)&&Ca(this,e.call(c.z,c.e({key:i,style:this.serialize(),value:l,styleSpec:c.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ai().off(jn,this._rtlPluginLoaded);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const l=this.sourceCaches[i];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const i in this.sourceCaches)this.sourceCaches[i].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,i,l,u,f=!1){let y=!1,w=!1;const S={};for(const M of this._order){const k=this._layers[M];if(k.type!=="symbol")continue;if(!S[k.source]){const D=this.sourceCaches[k.source];S[k.source]=D.getRenderableIds(!0).map(F=>D.getTileByID(F)).sort((F,U)=>U.tileID.overscaledZ-F.tileID.overscaledZ||(F.tileID.isLessThan(U.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(k,S[k.source],e.center.lng);y=y||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((f=f||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(O.now(),e.zoom))&&(this.pauseablePlacement=new wd(e,this.map.terrain,this._order,f,i,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(O.now()),w=!0),y&&this.pauseablePlacement.placement.setStale()),w||y)for(const M of this._order){const k=this._layers[M];k.type==="symbol"&&this.placement.updateLayerOpacities(k,S[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(O.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,i){return c._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[i.source];return u&&u.setDependencies(i.tileID.key,i.type,i.icons),l})}getGlyphs(e,i){return c._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(i.stacks),u=this.sourceCaches[i.source];return u&&u.setDependencies(i.tileID.key,i.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,i={}){this._checkLoaded(),e&&this._validate(c.z.glyphs,"glyphs",e,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,i,l={},u){this._checkLoaded();const f=[{id:e,url:i}],y=[...Ce(this.stylesheet.sprite),...f];this._validate(c.z.sprite,"sprite",y,null,l)||(this.stylesheet.sprite=y,this._loadSprite(f,!0,u))}removeSprite(e){this._checkLoaded();const i=Ce(this.stylesheet.sprite);if(i.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;i.splice(i.findIndex(l=>l.id===e),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ce(this.stylesheet.sprite)}setSprite(e,i={},l){this._checkLoaded(),e&&this._validate(c.z.sprite,"sprite",e,null,i)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var um=c.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class hm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,i,l,u,f,y,w,S,M){this.context=e;let k=this.boundPaintVertexBuffers.length!==u.length;for(let L=0;!k&&L<u.length;L++)this.boundPaintVertexBuffers[L]!==u[L]&&(k=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==l||k||this.boundIndexBuffer!==f||this.boundVertexOffset!==y||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==S||this.boundDynamicVertexBuffer3!==M?this.freshBind(i,l,u,f,y,w,S,M):(e.bindVertexArray.set(this.vao),w&&w.bind(),f&&f.dynamicDraw&&f.bind(),S&&S.bind(),M&&M.bind())}freshBind(e,i,l,u,f,y,w,S){const M=e.numAttributes,k=this.context,L=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=S,i.enableAttributes(L,e);for(const D of l)D.enableAttributes(L,e);y&&y.enableAttributes(L,e),w&&w.enableAttributes(L,e),S&&S.enableAttributes(L,e),i.bind(),i.setVertexAttribPointers(L,e,f);for(const D of l)D.bind(),D.setVertexAttribPointers(L,e,f);y&&(y.bind(),y.setVertexAttribPointers(L,e,f)),u&&u.bind(),w&&(w.bind(),w.setVertexAttribPointers(L,e,f)),S&&(S.bind(),S.setVertexAttribPointers(L,e,f)),k.currentNumAttributes=M}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const dm=(p,e,i,l,u)=>({u_texture:0,u_ele_delta:p,u_fog_matrix:e,u_fog_color:i?i.properties.get("fog-color"):c.be.white,u_fog_ground_blend:i?i.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?0:i?i.calculateFogBlendOpacity(l):0,u_horizon_color:i?i.properties.get("horizon-color"):c.be.white,u_horizon_fog_blend:i?i.properties.get("horizon-fog-blend"):1,u_is_globe_mode:u?1:0}),pm={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function jl(p){const e=[];for(let i=0;i<p.length;i++){if(p[i]===null)continue;const l=p[i].split(" ");e.push(l.pop())}return e}class Fl{constructor(e,i,l,u,f,y,w,S,M=[]){const k=e.gl;this.program=k.createProgram();const L=jl(i.staticAttributes),D=l?l.getBinderAttributes():[],F=L.concat(D),U=Sn.prelude.staticUniforms?jl(Sn.prelude.staticUniforms):[],ee=w.staticUniforms?jl(w.staticUniforms):[],Q=i.staticUniforms?jl(i.staticUniforms):[],te=l?l.getBinderUniforms():[],ne=U.concat(ee).concat(Q).concat(te),ce=[];for(const Ee of ne)ce.indexOf(Ee)<0&&ce.push(Ee);const se=l?l.defines():[];hi(k)&&se.unshift("#version 300 es"),f&&se.push("#define OVERDRAW_INSPECTOR;"),y&&se.push("#define TERRAIN3D;"),S&&se.push(S),M&&se.push(...M);let de=se.concat(Sn.prelude.fragmentSource,w.fragmentSource,i.fragmentSource).join(`
`),fe=se.concat(Sn.prelude.vertexSource,w.vertexSource,i.vertexSource).join(`
`);hi(k)||(de=function(Ee){return Ee.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(de),fe=function(Ee){return Ee.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(fe));const oe=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(oe,de),k.compileShader(oe),!k.getShaderParameter(oe,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(oe)}`);k.attachShader(this.program,oe);const ve=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(ve,fe),k.compileShader(ve),!k.getShaderParameter(ve,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(ve)}`);k.attachShader(this.program,ve),this.attributes={};const Re={};this.numAttributes=F.length;for(let Ee=0;Ee<this.numAttributes;Ee++)F[Ee]&&(k.bindAttribLocation(this.program,Ee,F[Ee]),this.attributes[F[Ee]]=Ee);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(ve),k.deleteShader(oe);for(let Ee=0;Ee<ce.length;Ee++){const ke=ce[Ee];if(ke&&!Re[ke]){const De=k.getUniformLocation(this.program,ke);De&&(Re[ke]=De)}}this.fixedUniforms=u(e,Re),this.terrainUniforms=((Ee,ke)=>({u_depth:new c.bO(Ee,ke.u_depth),u_terrain:new c.bO(Ee,ke.u_terrain),u_terrain_dim:new c.bf(Ee,ke.u_terrain_dim),u_terrain_matrix:new c.bQ(Ee,ke.u_terrain_matrix),u_terrain_unpack:new c.bR(Ee,ke.u_terrain_unpack),u_terrain_exaggeration:new c.bf(Ee,ke.u_terrain_exaggeration)}))(e,Re),this.projectionUniforms=((Ee,ke)=>({u_projection_matrix:new c.bQ(Ee,ke.u_projection_matrix),u_projection_tile_mercator_coords:new c.bR(Ee,ke.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bR(Ee,ke.u_projection_clipping_plane),u_projection_transition:new c.bf(Ee,ke.u_projection_transition),u_projection_fallback_matrix:new c.bQ(Ee,ke.u_projection_fallback_matrix)}))(e,Re),this.binderUniforms=l?l.getUniforms(e,Re):[]}draw(e,i,l,u,f,y,w,S,M,k,L,D,F,U,ee,Q,te,ne,ce){const se=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(f),e.setCullFace(y),S){e.activeTexture.set(se.TEXTURE2),se.bindTexture(se.TEXTURE_2D,S.depthTexture),e.activeTexture.set(se.TEXTURE3),se.bindTexture(se.TEXTURE_2D,S.texture);for(const fe in this.terrainUniforms)this.terrainUniforms[fe].set(S[fe])}if(M)for(const fe in M)this.projectionUniforms[pm[fe]].set(M[fe]);if(w)for(const fe in this.fixedUniforms)this.fixedUniforms[fe].set(w[fe]);Q&&Q.setUniforms(e,this.binderUniforms,U,{zoom:ee});let de=0;switch(i){case se.LINES:de=2;break;case se.TRIANGLES:de=3;break;case se.LINE_STRIP:de=1}for(const fe of F.get()){const oe=fe.vaos||(fe.vaos={});(oe[k]||(oe[k]=new hm)).bind(e,this,L,Q?Q.getPaintVertexBuffers():[],D,fe.vertexOffset,te,ne,ce),se.drawElements(i,fe.primitiveLength*de,se.UNSIGNED_SHORT,fe.primitiveOffset*de*2)}}}function Bl(p,e,i){const l=1/c.aB(i,1,e.transform.tileZoom),u=Math.pow(2,i.tileID.overscaledZ),f=i.tileSize*Math.pow(2,e.transform.tileZoom)/u,y=f*(i.tileID.canonical.x+i.tileID.wrap*u),w=f*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[l,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[y>>16,w>>16],u_pixel_coord_lower:[65535&y,65535&w]}}const Pa=(p,e,i,l)=>{const u=p.style.light,f=u.properties.get("position"),y=[f.x,f.y,f.z],w=c.bU();u.properties.get("anchor")==="viewport"&&c.bV(w,p.transform.bearingInRadians),c.bW(y,y,w);const S=p.transform.transformLightDirection(y),M=u.properties.get("color");return{u_lightpos:y,u_lightpos_globe:S,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+e,u_opacity:i,u_fill_translate:l}},_u=(p,e,i,l,u,f,y)=>c.e(Pa(p,e,i,l),Bl(f,p,y),{u_height_factor:-Math.pow(2,u.overscaledZ)/y.tileSize/8}),Ol=(p,e,i,l)=>c.e(Bl(e,p,i),{u_fill_translate:l}),Pn=(p,e)=>({u_world:p,u_fill_translate:e}),fm=(p,e,i,l,u)=>c.e(Ol(p,e,i,u),{u_world:l}),yu=(p,e,i,l,u)=>{const f=p.transform;let y,w,S=0;if(i.paint.get("circle-pitch-alignment")==="map"){const M=c.aB(e,1,f.zoom);y=!0,w=[M,M],S=M/(c.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*u}else y=!1,w=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(i.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+y,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:w,u_globe_extrude_scale:S,u_translate:l}},Ma=p=>({u_pixel_extrude_scale:[1/p.width,1/p.height]}),Ia=p=>({u_viewport_size:[p.width,p.height]}),Pd=(p,e=1)=>({u_color:p,u_overlay:0,u_overlay_scale:e}),Ea=(p,e,i,l)=>{const u=c.aB(p,1,e)/(c.$*Math.pow(2,p.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.aB(p,1,e),u_intensity:i,u_globe_extrude_scale:u}},Md=(p,e,i,l)=>{const u=c.L();c.bX(u,0,p.width,p.height,0,0,1);const f=p.context.gl;return{u_matrix:u,u_world:[f.drawingBufferWidth,f.drawingBufferHeight],u_image:i,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},bo=(p,e,i)=>{const l=i.paint.get("hillshade-accent-color");let u;switch(i.paint.get("hillshade-method")){case"basic":u=4;break;case"combined":u=1;break;case"igor":u=2;break;case"multidirectional":u=3;break;default:u=0}const f=i.getIlluminationProperties();for(let y=0;y<f.directionRadians.length;y++)i.paint.get("hillshade-illumination-anchor")==="viewport"&&(f.directionRadians[y]+=p.transform.bearingInRadians);return{u_image:0,u_latrange:Id(0,e.tileID),u_exaggeration:i.paint.get("hillshade-exaggeration"),u_altitudes:f.altitudeRadians,u_azimuths:f.directionRadians,u_accent:l,u_method:u,u_highlights:f.highlightColor,u_shadows:f.shadowColor}},mm=(p,e)=>{const i=e.stride,l=c.L();return c.bX(l,0,c.$,-8192,0,0,1),c.M(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[i,i],u_zoom:p.overscaledZ,u_unpack:e.getUnpackVector()}};function Id(p,e){const i=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new c.a0(0,l/i).toLngLat().lat,new c.a0(0,(l+1)/i).toLngLat().lat]}const gm=(p,e)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_opacity:p.paint.get("color-relief-opacity")}),Nl=(p,e,i,l)=>{const u=p.transform;return{u_translation:bu(p,e,i),u_ratio:l/c.aB(e,1,u.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},vu=(p,e,i,l,u)=>c.e(Nl(p,e,i,l),{u_image:0,u_image_height:u}),Ed=(p,e,i,l,u)=>{const f=p.transform,y=xu(e,f);return{u_translation:bu(p,e,i),u_texsize:e.imageAtlasTexture.size,u_ratio:l/c.aB(e,1,f.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[y,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},kd=(p,e,i,l,u,f)=>{const y=p.lineAtlas,w=xu(e,p.transform),S=i.layout.get("line-cap")==="round",M=y.getDash(u.from,S),k=y.getDash(u.to,S),L=M.width*f.fromScale,D=k.width*f.toScale;return c.e(Nl(p,e,i,l),{u_patternscale_a:[w/L,-M.height/2],u_patternscale_b:[w/D,-k.height/2],u_sdfgamma:y.width/(256*Math.min(L,D)*p.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:k.y,u_mix:f.t})};function xu(p,e){return 1/c.aB(p,1,e.tileZoom)}function bu(p,e,i){return c.aC(p.transform,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Os=(p,e,i,l,u)=>{return{u_tl_parent:p,u_scale_parent:e,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(y=l.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(f=l.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:zd(l.paint.get("raster-hue-rotate")),u_coords_top:[u[0].x,u[0].y,u[1].x,u[1].y],u_coords_bottom:[u[3].x,u[3].y,u[2].x,u[2].y]};var f,y};function zd(p){p*=Math.PI/180;const e=Math.sin(p),i=Math.cos(p);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const wu=(p,e,i,l,u,f,y,w,S,M,k,L,D)=>{const F=y.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:F.cameraToCenterDistance,u_pitch:F.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:F.width/F.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_label_plane_matrix:w,u_coord_matrix:S,u_is_text:+k,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:f,u_texsize:L,u_texture:0,u_translation:M,u_pitched_scale:D}},wo=(p,e,i,l,u,f,y,w,S,M,k,L,D,F)=>{const U=y.transform;return c.e(wu(p,e,i,l,u,f,y,w,S,M,k,L,F),{u_gamma_scale:l?Math.cos(U.pitch*Math.PI/180)*U.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:1})},_m=(p,e,i,l,u,f,y,w,S,M,k,L,D)=>c.e(wo(p,e,i,l,u,f,y,w,S,M,!0,k,0,D),{u_texsize_icon:L,u_texture_icon:1}),$l=(p,e)=>({u_opacity:p,u_color:e}),ym=(p,e,i,l,u)=>c.e(function(f,y,w,S){const M=w.imageManager.getPattern(f.from.toString()),k=w.imageManager.getPattern(f.to.toString()),{width:L,height:D}=w.imageManager.getPixelSize(),F=Math.pow(2,S.tileID.overscaledZ),U=S.tileSize*Math.pow(2,w.transform.tileZoom)/F,ee=U*(S.tileID.canonical.x+S.tileID.wrap*F),Q=U*S.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[L,D],u_mix:y.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:y.fromScale,u_scale_b:y.toScale,u_tile_units_to_pixels:1/c.aB(S,1,w.transform.tileZoom),u_pixel_coord_upper:[ee>>16,Q>>16],u_pixel_coord_lower:[65535&ee,65535&Q]}}(i,u,e,l),{u_opacity:p}),Ad=(p,e)=>{},Rd={fillExtrusion:(p,e)=>({u_lightpos:new c.bS(p,e.u_lightpos),u_lightpos_globe:new c.bS(p,e.u_lightpos_globe),u_lightintensity:new c.bf(p,e.u_lightintensity),u_lightcolor:new c.bS(p,e.u_lightcolor),u_vertical_gradient:new c.bf(p,e.u_vertical_gradient),u_opacity:new c.bf(p,e.u_opacity),u_fill_translate:new c.bT(p,e.u_fill_translate)}),fillExtrusionPattern:(p,e)=>({u_lightpos:new c.bS(p,e.u_lightpos),u_lightpos_globe:new c.bS(p,e.u_lightpos_globe),u_lightintensity:new c.bf(p,e.u_lightintensity),u_lightcolor:new c.bS(p,e.u_lightcolor),u_vertical_gradient:new c.bf(p,e.u_vertical_gradient),u_height_factor:new c.bf(p,e.u_height_factor),u_opacity:new c.bf(p,e.u_opacity),u_fill_translate:new c.bT(p,e.u_fill_translate),u_image:new c.bO(p,e.u_image),u_texsize:new c.bT(p,e.u_texsize),u_pixel_coord_upper:new c.bT(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(p,e.u_pixel_coord_lower),u_scale:new c.bS(p,e.u_scale),u_fade:new c.bf(p,e.u_fade)}),fill:(p,e)=>({u_fill_translate:new c.bT(p,e.u_fill_translate)}),fillPattern:(p,e)=>({u_image:new c.bO(p,e.u_image),u_texsize:new c.bT(p,e.u_texsize),u_pixel_coord_upper:new c.bT(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(p,e.u_pixel_coord_lower),u_scale:new c.bS(p,e.u_scale),u_fade:new c.bf(p,e.u_fade),u_fill_translate:new c.bT(p,e.u_fill_translate)}),fillOutline:(p,e)=>({u_world:new c.bT(p,e.u_world),u_fill_translate:new c.bT(p,e.u_fill_translate)}),fillOutlinePattern:(p,e)=>({u_world:new c.bT(p,e.u_world),u_image:new c.bO(p,e.u_image),u_texsize:new c.bT(p,e.u_texsize),u_pixel_coord_upper:new c.bT(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(p,e.u_pixel_coord_lower),u_scale:new c.bS(p,e.u_scale),u_fade:new c.bf(p,e.u_fade),u_fill_translate:new c.bT(p,e.u_fill_translate)}),circle:(p,e)=>({u_camera_to_center_distance:new c.bf(p,e.u_camera_to_center_distance),u_scale_with_map:new c.bO(p,e.u_scale_with_map),u_pitch_with_map:new c.bO(p,e.u_pitch_with_map),u_extrude_scale:new c.bT(p,e.u_extrude_scale),u_device_pixel_ratio:new c.bf(p,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bf(p,e.u_globe_extrude_scale),u_translate:new c.bT(p,e.u_translate)}),collisionBox:(p,e)=>({u_pixel_extrude_scale:new c.bT(p,e.u_pixel_extrude_scale)}),collisionCircle:(p,e)=>({u_viewport_size:new c.bT(p,e.u_viewport_size)}),debug:(p,e)=>({u_color:new c.bP(p,e.u_color),u_overlay:new c.bO(p,e.u_overlay),u_overlay_scale:new c.bf(p,e.u_overlay_scale)}),depth:Ad,clippingMask:Ad,heatmap:(p,e)=>({u_extrude_scale:new c.bf(p,e.u_extrude_scale),u_intensity:new c.bf(p,e.u_intensity),u_globe_extrude_scale:new c.bf(p,e.u_globe_extrude_scale)}),heatmapTexture:(p,e)=>({u_matrix:new c.bQ(p,e.u_matrix),u_world:new c.bT(p,e.u_world),u_image:new c.bO(p,e.u_image),u_color_ramp:new c.bO(p,e.u_color_ramp),u_opacity:new c.bf(p,e.u_opacity)}),hillshade:(p,e)=>({u_image:new c.bO(p,e.u_image),u_latrange:new c.bT(p,e.u_latrange),u_exaggeration:new c.bf(p,e.u_exaggeration),u_altitudes:new c.bZ(p,e.u_altitudes),u_azimuths:new c.bZ(p,e.u_azimuths),u_accent:new c.bP(p,e.u_accent),u_method:new c.bO(p,e.u_method),u_shadows:new c.bY(p,e.u_shadows),u_highlights:new c.bY(p,e.u_highlights)}),hillshadePrepare:(p,e)=>({u_matrix:new c.bQ(p,e.u_matrix),u_image:new c.bO(p,e.u_image),u_dimension:new c.bT(p,e.u_dimension),u_zoom:new c.bf(p,e.u_zoom),u_unpack:new c.bR(p,e.u_unpack)}),colorRelief:(p,e)=>({u_image:new c.bO(p,e.u_image),u_unpack:new c.bR(p,e.u_unpack),u_dimension:new c.bT(p,e.u_dimension),u_elevation_stops:new c.bO(p,e.u_elevation_stops),u_color_stops:new c.bO(p,e.u_color_stops),u_opacity:new c.bf(p,e.u_opacity)}),line:(p,e)=>({u_translation:new c.bT(p,e.u_translation),u_ratio:new c.bf(p,e.u_ratio),u_device_pixel_ratio:new c.bf(p,e.u_device_pixel_ratio),u_units_to_pixels:new c.bT(p,e.u_units_to_pixels)}),lineGradient:(p,e)=>({u_translation:new c.bT(p,e.u_translation),u_ratio:new c.bf(p,e.u_ratio),u_device_pixel_ratio:new c.bf(p,e.u_device_pixel_ratio),u_units_to_pixels:new c.bT(p,e.u_units_to_pixels),u_image:new c.bO(p,e.u_image),u_image_height:new c.bf(p,e.u_image_height)}),linePattern:(p,e)=>({u_translation:new c.bT(p,e.u_translation),u_texsize:new c.bT(p,e.u_texsize),u_ratio:new c.bf(p,e.u_ratio),u_device_pixel_ratio:new c.bf(p,e.u_device_pixel_ratio),u_image:new c.bO(p,e.u_image),u_units_to_pixels:new c.bT(p,e.u_units_to_pixels),u_scale:new c.bS(p,e.u_scale),u_fade:new c.bf(p,e.u_fade)}),lineSDF:(p,e)=>({u_translation:new c.bT(p,e.u_translation),u_ratio:new c.bf(p,e.u_ratio),u_device_pixel_ratio:new c.bf(p,e.u_device_pixel_ratio),u_units_to_pixels:new c.bT(p,e.u_units_to_pixels),u_patternscale_a:new c.bT(p,e.u_patternscale_a),u_patternscale_b:new c.bT(p,e.u_patternscale_b),u_sdfgamma:new c.bf(p,e.u_sdfgamma),u_image:new c.bO(p,e.u_image),u_tex_y_a:new c.bf(p,e.u_tex_y_a),u_tex_y_b:new c.bf(p,e.u_tex_y_b),u_mix:new c.bf(p,e.u_mix)}),raster:(p,e)=>({u_tl_parent:new c.bT(p,e.u_tl_parent),u_scale_parent:new c.bf(p,e.u_scale_parent),u_buffer_scale:new c.bf(p,e.u_buffer_scale),u_fade_t:new c.bf(p,e.u_fade_t),u_opacity:new c.bf(p,e.u_opacity),u_image0:new c.bO(p,e.u_image0),u_image1:new c.bO(p,e.u_image1),u_brightness_low:new c.bf(p,e.u_brightness_low),u_brightness_high:new c.bf(p,e.u_brightness_high),u_saturation_factor:new c.bf(p,e.u_saturation_factor),u_contrast_factor:new c.bf(p,e.u_contrast_factor),u_spin_weights:new c.bS(p,e.u_spin_weights),u_coords_top:new c.bR(p,e.u_coords_top),u_coords_bottom:new c.bR(p,e.u_coords_bottom)}),symbolIcon:(p,e)=>({u_is_size_zoom_constant:new c.bO(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(p,e.u_is_size_feature_constant),u_size_t:new c.bf(p,e.u_size_t),u_size:new c.bf(p,e.u_size),u_camera_to_center_distance:new c.bf(p,e.u_camera_to_center_distance),u_pitch:new c.bf(p,e.u_pitch),u_rotate_symbol:new c.bO(p,e.u_rotate_symbol),u_aspect_ratio:new c.bf(p,e.u_aspect_ratio),u_fade_change:new c.bf(p,e.u_fade_change),u_label_plane_matrix:new c.bQ(p,e.u_label_plane_matrix),u_coord_matrix:new c.bQ(p,e.u_coord_matrix),u_is_text:new c.bO(p,e.u_is_text),u_pitch_with_map:new c.bO(p,e.u_pitch_with_map),u_is_along_line:new c.bO(p,e.u_is_along_line),u_is_variable_anchor:new c.bO(p,e.u_is_variable_anchor),u_texsize:new c.bT(p,e.u_texsize),u_texture:new c.bO(p,e.u_texture),u_translation:new c.bT(p,e.u_translation),u_pitched_scale:new c.bf(p,e.u_pitched_scale)}),symbolSDF:(p,e)=>({u_is_size_zoom_constant:new c.bO(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(p,e.u_is_size_feature_constant),u_size_t:new c.bf(p,e.u_size_t),u_size:new c.bf(p,e.u_size),u_camera_to_center_distance:new c.bf(p,e.u_camera_to_center_distance),u_pitch:new c.bf(p,e.u_pitch),u_rotate_symbol:new c.bO(p,e.u_rotate_symbol),u_aspect_ratio:new c.bf(p,e.u_aspect_ratio),u_fade_change:new c.bf(p,e.u_fade_change),u_label_plane_matrix:new c.bQ(p,e.u_label_plane_matrix),u_coord_matrix:new c.bQ(p,e.u_coord_matrix),u_is_text:new c.bO(p,e.u_is_text),u_pitch_with_map:new c.bO(p,e.u_pitch_with_map),u_is_along_line:new c.bO(p,e.u_is_along_line),u_is_variable_anchor:new c.bO(p,e.u_is_variable_anchor),u_texsize:new c.bT(p,e.u_texsize),u_texture:new c.bO(p,e.u_texture),u_gamma_scale:new c.bf(p,e.u_gamma_scale),u_device_pixel_ratio:new c.bf(p,e.u_device_pixel_ratio),u_is_halo:new c.bO(p,e.u_is_halo),u_translation:new c.bT(p,e.u_translation),u_pitched_scale:new c.bf(p,e.u_pitched_scale)}),symbolTextAndIcon:(p,e)=>({u_is_size_zoom_constant:new c.bO(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bO(p,e.u_is_size_feature_constant),u_size_t:new c.bf(p,e.u_size_t),u_size:new c.bf(p,e.u_size),u_camera_to_center_distance:new c.bf(p,e.u_camera_to_center_distance),u_pitch:new c.bf(p,e.u_pitch),u_rotate_symbol:new c.bO(p,e.u_rotate_symbol),u_aspect_ratio:new c.bf(p,e.u_aspect_ratio),u_fade_change:new c.bf(p,e.u_fade_change),u_label_plane_matrix:new c.bQ(p,e.u_label_plane_matrix),u_coord_matrix:new c.bQ(p,e.u_coord_matrix),u_is_text:new c.bO(p,e.u_is_text),u_pitch_with_map:new c.bO(p,e.u_pitch_with_map),u_is_along_line:new c.bO(p,e.u_is_along_line),u_is_variable_anchor:new c.bO(p,e.u_is_variable_anchor),u_texsize:new c.bT(p,e.u_texsize),u_texsize_icon:new c.bT(p,e.u_texsize_icon),u_texture:new c.bO(p,e.u_texture),u_texture_icon:new c.bO(p,e.u_texture_icon),u_gamma_scale:new c.bf(p,e.u_gamma_scale),u_device_pixel_ratio:new c.bf(p,e.u_device_pixel_ratio),u_is_halo:new c.bO(p,e.u_is_halo),u_translation:new c.bT(p,e.u_translation),u_pitched_scale:new c.bf(p,e.u_pitched_scale)}),background:(p,e)=>({u_opacity:new c.bf(p,e.u_opacity),u_color:new c.bP(p,e.u_color)}),backgroundPattern:(p,e)=>({u_opacity:new c.bf(p,e.u_opacity),u_image:new c.bO(p,e.u_image),u_pattern_tl_a:new c.bT(p,e.u_pattern_tl_a),u_pattern_br_a:new c.bT(p,e.u_pattern_br_a),u_pattern_tl_b:new c.bT(p,e.u_pattern_tl_b),u_pattern_br_b:new c.bT(p,e.u_pattern_br_b),u_texsize:new c.bT(p,e.u_texsize),u_mix:new c.bf(p,e.u_mix),u_pattern_size_a:new c.bT(p,e.u_pattern_size_a),u_pattern_size_b:new c.bT(p,e.u_pattern_size_b),u_scale_a:new c.bf(p,e.u_scale_a),u_scale_b:new c.bf(p,e.u_scale_b),u_pixel_coord_upper:new c.bT(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bT(p,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bf(p,e.u_tile_units_to_pixels)}),terrain:(p,e)=>({u_texture:new c.bO(p,e.u_texture),u_ele_delta:new c.bf(p,e.u_ele_delta),u_fog_matrix:new c.bQ(p,e.u_fog_matrix),u_fog_color:new c.bP(p,e.u_fog_color),u_fog_ground_blend:new c.bf(p,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bf(p,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bP(p,e.u_horizon_color),u_horizon_fog_blend:new c.bf(p,e.u_horizon_fog_blend),u_is_globe_mode:new c.bf(p,e.u_is_globe_mode)}),terrainDepth:(p,e)=>({u_ele_delta:new c.bf(p,e.u_ele_delta)}),terrainCoords:(p,e)=>({u_texture:new c.bO(p,e.u_texture),u_terrain_coords_id:new c.bf(p,e.u_terrain_coords_id),u_ele_delta:new c.bf(p,e.u_ele_delta)}),projectionErrorMeasurement:(p,e)=>({u_input:new c.bf(p,e.u_input),u_output_expected:new c.bf(p,e.u_output_expected)}),atmosphere:(p,e)=>({u_sun_pos:new c.bS(p,e.u_sun_pos),u_atmosphere_blend:new c.bf(p,e.u_atmosphere_blend),u_globe_position:new c.bS(p,e.u_globe_position),u_globe_radius:new c.bf(p,e.u_globe_radius),u_inv_proj_matrix:new c.bQ(p,e.u_inv_proj_matrix)}),sky:(p,e)=>({u_sky_color:new c.bP(p,e.u_sky_color),u_horizon_color:new c.bP(p,e.u_horizon_color),u_horizon:new c.bT(p,e.u_horizon),u_horizon_normal:new c.bT(p,e.u_horizon_normal),u_sky_horizon_blend:new c.bf(p,e.u_sky_horizon_blend),u_sky_blend:new c.bf(p,e.u_sky_blend)})};class Dd{constructor(e,i,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ld={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Tu{constructor(e,i,l,u){this.length=i.length,this.attributes=l,this.itemSize=i.bytesPerElement,this.dynamicDraw=u,this.context=e;const f=e.gl;this.buffer=f.createBuffer(),e.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,i){for(let l=0;l<this.attributes.length;l++){const u=i.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,i,l){for(let u=0;u<this.attributes.length;u++){const f=this.attributes[u],y=i.attributes[f.name];y!==void 0&&e.vertexAttribPointer(y,f.components,e[Ld[f.type]],!1,this.itemSize,f.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $t{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Vl extends $t{getDefault(){return c.be.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Zn extends $t{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Su extends $t{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Cu extends $t{getDefault(){return[!0,!0,!0,!0]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Pu extends $t{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class jd extends $t{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Mu extends $t{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const i=this.current;(e.func!==i.func||e.ref!==i.ref||e.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Ns extends $t{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Iu extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=e,this.dirty=!1}}class vm extends $t{getDefault(){return[0,1]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class xm extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=e,this.dirty=!1}}class bm extends $t{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class wm extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.BLEND):i.disable(i.BLEND),this.current=e,this.dirty=!1}}class Fd extends $t{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Tm extends $t{getDefault(){return c.be.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Bd extends $t{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Ul extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=e,this.dirty=!1}}class Zl extends $t{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Gl extends $t{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Eu extends $t{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class $s extends $t{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ka extends $t{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class To extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Hi extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Od extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Nd extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ku extends $t{getDefault(){return null}set(e){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Vs extends $t{getDefault(){return null}set(e){var i;if(e===this.current&&!this.dirty)return;const l=this.gl;hi(l)?l.bindVertexArray(e):(i=l.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ql extends $t{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Wl extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class za extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class So extends $t{constructor(e,i){super(e),this.context=e,this.parent=i}getDefault(){return null}}class $d extends So{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Co extends So{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Po extends So{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const zu="Framebuffer is not complete";class Au{constructor(e,i,l,u,f){this.context=e,this.width=i,this.height=l;const y=e.gl,w=this.framebuffer=y.createFramebuffer();if(this.colorAttachment=new $d(e,w),u)this.depthAttachment=f?new Po(e,w):new Co(e,w);else if(f)throw new Error("Stencil cannot be set without depth");if(y.checkFramebufferStatus(y.FRAMEBUFFER)!==y.FRAMEBUFFER_COMPLETE)throw new Error(zu)}destroy(){const e=this.context.gl,i=this.colorAttachment.get();if(i&&e.deleteTexture(i),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class kt{constructor(e){var i,l;if(this.gl=e,this.clearColor=new Vl(this),this.clearDepth=new Zn(this),this.clearStencil=new Su(this),this.colorMask=new Cu(this),this.depthMask=new Pu(this),this.stencilMask=new jd(this),this.stencilFunc=new Mu(this),this.stencilOp=new Ns(this),this.stencilTest=new Iu(this),this.depthRange=new vm(this),this.depthTest=new xm(this),this.depthFunc=new bm(this),this.blend=new wm(this),this.blendFunc=new Fd(this),this.blendColor=new Tm(this),this.blendEquation=new Bd(this),this.cullFace=new Ul(this),this.cullFaceSide=new Zl(this),this.frontFace=new Gl(this),this.program=new Eu(this),this.activeTexture=new $s(this),this.viewport=new ka(this),this.bindFramebuffer=new To(this),this.bindRenderbuffer=new Hi(this),this.bindTexture=new Od(this),this.bindVertexBuffer=new Nd(this),this.bindElementBuffer=new ku(this),this.bindVertexArray=new Vs(this),this.pixelStoreUnpack=new ql(this),this.pixelStoreUnpackPremultiplyAlpha=new Wl(this),this.pixelStoreUnpackFlipY=new za(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),hi(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=e.RGBA16F)!==null&&i!==void 0?i:u==null?void 0:u.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u==null?void 0:u.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u==null?void 0:u.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,i){return new Dd(this,e,i)}createVertexBuffer(e,i,l){return new Tu(this,e,i,l)}createRenderbuffer(e,i,l){const u=this.gl,f=u.createRenderbuffer();return this.bindRenderbuffer.set(f),u.renderbufferStorage(u.RENDERBUFFER,e,i,l),this.bindRenderbuffer.set(null),f}createFramebuffer(e,i,l,u){return new Au(this,e,i,l,u)}clear({color:e,depth:i,stencil:l}){const u=this.gl;let f=0;e&&(f|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(f|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),l!==void 0&&(f|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(f)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bG(e.blendFunction,Dt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return hi(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var i;return hi(this.gl)?this.gl.deleteVertexArray(e):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Us;function Vd(p,e,i,l,u){const f=p.context,y=p.transform,w=f.gl,S=p.useProgram("collisionBox"),M=[];let k=0,L=0;for(let te=0;te<l.length;te++){const ne=l[te],ce=e.getTile(ne).getBucket(i);if(!ce)continue;const se=u?ce.textCollisionBox:ce.iconCollisionBox,de=ce.collisionCircleArray;de.length>0&&(M.push({circleArray:de,circleOffset:L,coord:ne}),k+=de.length/4,L=k),se&&S.draw(f,w.LINES,Tt.disabled,mt.disabled,p.colorModeForRenderPass(),bt.disabled,Ma(p.transform),p.style.map.terrain&&p.style.map.terrain.getTerrainData(ne),y.getProjectionData({overscaledTileID:ne,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),i.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,null,p.transform.zoom,null,null,se.collisionVertexBuffer)}if(!u||!M.length)return;const D=p.useProgram("collisionCircle"),F=new c.b_;F.resize(4*k),F._trim();let U=0;for(const te of M)for(let ne=0;ne<te.circleArray.length/4;ne++){const ce=4*ne,se=te.circleArray[ce+0],de=te.circleArray[ce+1],fe=te.circleArray[ce+2],oe=te.circleArray[ce+3];F.emplace(U++,se,de,fe,oe,0),F.emplace(U++,se,de,fe,oe,1),F.emplace(U++,se,de,fe,oe,2),F.emplace(U++,se,de,fe,oe,3)}(!Us||Us.length<2*k)&&(Us=function(te){const ne=2*te,ce=new c.c0;ce.resize(ne),ce._trim();for(let se=0;se<ne;se++){const de=6*se;ce.uint16[de+0]=4*se+0,ce.uint16[de+1]=4*se+1,ce.uint16[de+2]=4*se+2,ce.uint16[de+3]=4*se+2,ce.uint16[de+4]=4*se+3,ce.uint16[de+5]=4*se+0}return ce}(k));const ee=f.createIndexBuffer(Us,!0),Q=f.createVertexBuffer(F,c.b$.members,!0);for(const te of M){const ne=Ia(p.transform);D.draw(f,w.TRIANGLES,Tt.disabled,mt.disabled,p.colorModeForRenderPass(),bt.disabled,ne,p.style.map.terrain&&p.style.map.terrain.getTerrainData(te.coord),null,i.id,Q,ee,c.aL.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,p.transform.zoom,null,null,null)}Q.destroy(),ee.destroy()}const Ud=c.af(new Float32Array(16));function Aa(p,e,i,l,u,f){const{horizontalAlign:y,verticalAlign:w}=c.aG(p);return new c.P((-(y-.5)*e/u+l[0])*f,(-(w-.5)*i/u+l[1])*f)}function Sm(p,e,i,l,u,f){const y=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let w=l.mult(f);i||(w=w.rotate(-u));const S=y.add(w);return Ot(S.x,S.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(i){const w=Ke(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(p),S=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return p.add(l.rotate(S))}return p.add(l)}function Cm(p,e,i,l,u,f,y,w,S,M,k,L){const D=p.text.placedSymbolArray,F=p.text.dynamicLayoutVertexArray,U=p.icon.dynamicLayoutVertexArray,ee={};F.clear();for(let Q=0;Q<D.length;Q++){const te=D.get(Q),ne=te.hidden||!te.crossTileID||p.allowVerticalPlacement&&!te.placedOrientation?null:l[te.crossTileID];if(ne){const ce=new c.P(te.anchorX,te.anchorY),se={getElevation:L,width:u.width,height:u.height,pitchedLabelPlaneMatrix:f,pitchWithMap:i,transform:u,tileAnchorPoint:ce,translation:M,unwrappedTileID:k},de=i?Pt(ce.x,ce.y,se):Ke(ce.x,ce.y,se),fe=gt(u.cameraToCenterDistance,de.signedDistanceFromCamera);let oe=c.ao(p.textSizeData,w,te)*fe/c.aA;i&&(oe*=p.tilePixelRatio/y);const{width:ve,height:Re,anchor:Ee,textOffset:ke,textBoxScale:De}=ne,Ye=Aa(Ee,ve,Re,ke,De,oe),Xe=u.getPitchedTextCorrection(ce.x+M[0],ce.y+M[1],k),Ue=Sm(de.point,se,e,Ye,-u.bearingInRadians,Xe),rt=p.allowVerticalPlacement&&te.placedOrientation===c.an.vertical?Math.PI/2:0;for(let St=0;St<te.numGlyphs;St++)c.au(F,Ue,rt);S&&te.associatedIconIndex>=0&&(ee[te.associatedIconIndex]={shiftedAnchor:Ue,angle:rt})}else On(te.numGlyphs,F)}if(S){U.clear();const Q=p.icon.placedSymbolArray;for(let te=0;te<Q.length;te++){const ne=Q.get(te);if(ne.hidden)On(ne.numGlyphs,U);else{const ce=ee[te];if(ce)for(let se=0;se<ne.numGlyphs;se++)c.au(U,ce.shiftedAnchor,ce.angle);else On(ne.numGlyphs,U)}}p.icon.dynamicLayoutVertexBuffer.updateData(U)}p.text.dynamicLayoutVertexBuffer.updateData(F)}function Zd(p,e,i){return i.iconsInText&&e?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Gd(p,e,i,l,u,f,y,w,S,M,k,L,D){const F=p.context,U=F.gl,ee=p.transform,Q=w==="map",te=S==="map",ne=w!=="viewport"&&i.layout.get("symbol-placement")!=="point",ce=Q&&!te&&!ne,se=!i.layout.get("symbol-sort-key").isConstant();let de=!1;const fe=p.getDepthModeForSublayer(0,Tt.ReadOnly),oe=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ve=[],Re=ee.getCircleRadiusCorrection();for(const Ee of l){const ke=e.getTile(Ee),De=ke.getBucket(i);if(!De)continue;const Ye=u?De.text:De.icon;if(!Ye||!Ye.segments.get().length||!Ye.hasVisibleVertices)continue;const Xe=Ye.programConfigurations.get(i.id),Ue=u||De.sdfIcons,rt=u?De.textSizeData:De.iconSizeData,St=te||ee.pitch!==0,Vt=p.useProgram(Zd(Ue,u,De),Xe),sr=c.am(rt,ee.zoom),qt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ee);let or,Ht,Wt,Xt,Xr=[0,0],Lt=null;if(u)Ht=ke.glyphAtlasTexture,Wt=U.LINEAR,or=ke.glyphAtlasTexture.size,De.iconsInText&&(Xr=ke.imageAtlasTexture.size,Lt=ke.imageAtlasTexture,Xt=St||p.options.rotating||p.options.zooming||rt.kind==="composite"||rt.kind==="camera"?U.LINEAR:U.NEAREST);else{const mr=i.layout.get("icon-size").constantOr(0)!==1||De.iconsNeedLinear;Ht=ke.imageAtlasTexture,Wt=Ue||p.options.rotating||p.options.zooming||mr||St?U.LINEAR:U.NEAREST,or=ke.imageAtlasTexture.size}const Or=c.aB(ke,1,p.transform.zoom),Yr=yt(Q,p.transform,Or),gs=c.L();c.ap(gs,Yr);const _s=Yt(te,Q,p.transform,Or),ys=c.aC(ee,ke,f,y),En=ee.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),qa=oe&&De.hasTextData(),Wa=i.layout.get("icon-text-fit")!=="none"&&qa&&De.hasIconData();if(ne){const mr=p.style.map.terrain?(mi,zr)=>p.style.map.terrain.getElevation(Ee,mi,zr):null,Qt=i.layout.get("text-rotation-alignment")==="map";jr(De,p,u,Yr,gs,te,M,Qt,Ee.toUnwrapped(),ee.width,ee.height,ys,mr)}const Bo=u&&oe||Wa,Si=ne||Bo?Ud:te?Yr:p.transform.clipSpaceToPixelsMatrix,ln=Ue&&i.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let vs;vs=Ue?De.iconsInText?_m(rt.kind,sr,ce,te,ne,Bo,p,Si,_s,ys,or,Xr,Re):wo(rt.kind,sr,ce,te,ne,Bo,p,Si,_s,ys,u,or,0,Re):wu(rt.kind,sr,ce,te,ne,Bo,p,Si,_s,ys,u,or,Re);const qs={program:Vt,buffers:Ye,uniformValues:vs,projectionData:En,atlasTexture:Ht,atlasTextureIcon:Lt,atlasInterpolation:Wt,atlasInterpolationIcon:Xt,isSDF:Ue,hasHalo:ln};if(se&&De.canOverlap){de=!0;const mr=Ye.segments.get();for(const Qt of mr)ve.push({segments:new c.aL([Qt]),sortKey:Qt.sortKey,state:qs,terrainData:qt})}else ve.push({segments:Ye.segments,sortKey:0,state:qs,terrainData:qt})}de&&ve.sort((Ee,ke)=>Ee.sortKey-ke.sortKey);for(const Ee of ve){const ke=Ee.state;if(F.activeTexture.set(U.TEXTURE0),ke.atlasTexture.bind(ke.atlasInterpolation,U.CLAMP_TO_EDGE),ke.atlasTextureIcon&&(F.activeTexture.set(U.TEXTURE1),ke.atlasTextureIcon&&ke.atlasTextureIcon.bind(ke.atlasInterpolationIcon,U.CLAMP_TO_EDGE)),ke.isSDF){const De=ke.uniformValues;ke.hasHalo&&(De.u_is_halo=1,Hl(ke.buffers,Ee.segments,i,p,ke.program,fe,k,L,De,ke.projectionData,Ee.terrainData)),De.u_is_halo=0}Hl(ke.buffers,Ee.segments,i,p,ke.program,fe,k,L,ke.uniformValues,ke.projectionData,Ee.terrainData)}}function Hl(p,e,i,l,u,f,y,w,S,M,k){const L=l.context;u.draw(L,L.gl.TRIANGLES,f,y,w,bt.backCCW,S,k,M,i.id,p.layoutVertexBuffer,p.indexBuffer,e,i.paint,l.transform.zoom,p.programConfigurations.get(i.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function Xl(p,e,i,l,u){const f=p.context,y=f.gl,w=mt.disabled,S=new Dt([y.ONE,y.ONE],c.be.transparent,[!0,!0,!0,!0]),M=e.getBucket(i);if(!M)return;const k=l.key;let L=i.heatmapFbos.get(k);L||(L=Ra(f,e.tileSize,e.tileSize),i.heatmapFbos.set(k,L)),f.bindFramebuffer.set(L.framebuffer),f.viewport.set([0,0,e.tileSize,e.tileSize]),f.clear({color:c.be.transparent});const D=M.programConfigurations.get(i.id),F=p.useProgram("heatmap",D,!u),U=p.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ee=p.style.map.terrain.getTerrainData(l);F.draw(f,y.TRIANGLES,Tt.disabled,w,S,bt.disabled,Ea(e,p.transform.zoom,i.paint.get("heatmap-intensity"),1),ee,U,i.id,M.layoutVertexBuffer,M.indexBuffer,M.segments,i.paint,p.transform.zoom,D)}function Yl(p,e,i,l,u){const f=p.context,y=f.gl,w=p.transform;f.setColorMode(p.colorModeForRenderPass());const S=Kl(f,e),M=i.key,k=e.heatmapFbos.get(M);if(!k)return;f.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,k.colorAttachment.get()),f.activeTexture.set(y.TEXTURE1),S.bind(y.LINEAR,y.CLAMP_TO_EDGE);const L=w.getProjectionData({overscaledTileID:i,applyTerrainMatrix:u,applyGlobeMatrix:!l});p.useProgram("heatmapTexture").draw(f,y.TRIANGLES,Tt.disabled,mt.disabled,p.colorModeForRenderPass(),bt.disabled,Md(p,e,0,1),null,L,e.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments,e.paint,w.zoom),k.destroy(),e.heatmapFbos.delete(M)}function Ra(p,e,i){var l,u;const f=p.gl,y=f.createTexture();f.bindTexture(f.TEXTURE_2D,y),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);const w=(l=p.HALF_FLOAT)!==null&&l!==void 0?l:f.UNSIGNED_BYTE,S=(u=p.RGBA16F)!==null&&u!==void 0?u:f.RGBA;f.texImage2D(f.TEXTURE_2D,0,S,e,i,0,f.RGBA,w,null);const M=p.createFramebuffer(e,i,!1,!1);return M.colorAttachment.set(y),M}function Kl(p,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(p,e.colorRamp,p.gl.RGBA)),e.colorRampTexture}function Ru(p,e,i,l,u){if(!i||!l||!l.imageAtlas)return;const f=l.imageAtlas.patternPositions;let y=f[i.to.toString()],w=f[i.from.toString()];if(!y&&w&&(y=w),!w&&y&&(w=y),!y||!w){const S=u.getPaintProperty(e);y=f[S],w=f[S]}y&&w&&p.setConstantPatternPositions(y,w)}function Da(p,e,i,l,u,f,y,w){const S=p.context.gl,M="fill-pattern",k=i.paint.get(M),L=k&&k.constantOr(1),D=i.getCrossfadeParameters();let F,U,ee,Q,te;const ne=p.transform,ce=i.paint.get("fill-translate"),se=i.paint.get("fill-translate-anchor");y?(U=L&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=S.LINES):(U=L?"fillPattern":"fill",F=S.TRIANGLES);const de=k.constantOr(null);for(const fe of l){const oe=e.getTile(fe);if(L&&!oe.patternsLoaded())continue;const ve=oe.getBucket(i);if(!ve)continue;const Re=ve.programConfigurations.get(i.id),Ee=p.useProgram(U,Re),ke=p.style.map.terrain&&p.style.map.terrain.getTerrainData(fe);L&&(p.context.activeTexture.set(S.TEXTURE0),oe.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Re.updatePaintBuffers(D)),Ru(Re,M,de,oe,i);const De=ne.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!w,applyTerrainMatrix:!0}),Ye=c.aC(ne,oe,ce,se);if(y){Q=ve.indexBuffer2,te=ve.segments2;const Ue=[S.drawingBufferWidth,S.drawingBufferHeight];ee=U==="fillOutlinePattern"&&L?fm(p,D,oe,Ue,Ye):Pn(Ue,Ye)}else Q=ve.indexBuffer,te=ve.segments,ee=L?Ol(p,D,oe,Ye):{u_fill_translate:Ye};const Xe=p.stencilModeForClipping(fe);Ee.draw(p.context,F,u,Xe,f,bt.backCCW,ee,ke,De,i.id,ve.layoutVertexBuffer,Q,te,i.paint,p.transform.zoom,Re)}}function Mo(p,e,i,l,u,f,y,w){const S=p.context,M=S.gl,k="fill-extrusion-pattern",L=i.paint.get(k),D=L.constantOr(1),F=i.getCrossfadeParameters(),U=i.paint.get("fill-extrusion-opacity"),ee=L.constantOr(null),Q=p.transform;for(const te of l){const ne=e.getTile(te),ce=ne.getBucket(i);if(!ce)continue;const se=p.style.map.terrain&&p.style.map.terrain.getTerrainData(te),de=ce.programConfigurations.get(i.id),fe=p.useProgram(D?"fillExtrusionPattern":"fillExtrusion",de);D&&(p.context.activeTexture.set(M.TEXTURE0),ne.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),de.updatePaintBuffers(F));const oe=Q.getProjectionData({overscaledTileID:te,applyGlobeMatrix:!w,applyTerrainMatrix:!0});Ru(de,k,ee,ne,i);const ve=c.aC(Q,ne,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Re=i.paint.get("fill-extrusion-vertical-gradient"),Ee=D?_u(p,Re,U,ve,te,F,ne):Pa(p,Re,U,ve);fe.draw(S,S.gl.TRIANGLES,u,f,y,bt.backCCW,Ee,se,oe,i.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,i.paint,p.transform.zoom,de,p.style.map.terrain&&ce.centroidVertexBuffer)}}function Io(p,e,i,l,u,f,y,w,S){var M;const k=p.style.projection,L=p.context,D=p.transform,F=L.gl,U=[`#define NUM_ILLUMINATION_SOURCES ${i.paint.get("hillshade-highlight-color").values.length}`],ee=p.useProgram("hillshade",null,!1,U),Q=!p.options.moving;for(const te of l){const ne=e.getTile(te),ce=ne.fbo;if(!ce)continue;const se=k.getMeshFromTileID(L,te.canonical,w,!0,"raster"),de=(M=p.style.map.terrain)===null||M===void 0?void 0:M.getTerrainData(te);L.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,ce.colorAttachment.get());const fe=D.getProjectionData({overscaledTileID:te,aligned:Q,applyGlobeMatrix:!S,applyTerrainMatrix:!0});ee.draw(L,F.TRIANGLES,f,u[te.overscaledZ],y,bt.backCCW,bo(p,ne,i),de,fe,i.id,se.vertexBuffer,se.indexBuffer,se.segments)}}function La(p,e,i,l,u,f,y,w,S){var M;const k=p.style.projection,L=p.context,D=p.transform,F=L.gl,U=p.useProgram("colorRelief"),ee=!p.options.moving;let Q=!0;for(const te of l){const ne=e.getTile(te),ce=ne.dem;if(Q){const Re=F.getParameter(F.MAX_TEXTURE_SIZE),{elevationTexture:Ee,colorTexture:ke}=i.getColorRampTextures(L,Re,ce.getUnpackVector());L.activeTexture.set(F.TEXTURE1),Ee.bind(F.NEAREST,F.CLAMP_TO_EDGE),L.activeTexture.set(F.TEXTURE4),ke.bind(F.LINEAR,F.CLAMP_TO_EDGE),Q=!1}if(!ce||!ce.data)continue;const se=ce.stride,de=ce.getPixels();if(L.activeTexture.set(F.TEXTURE0),L.pixelStoreUnpackPremultiplyAlpha.set(!1),ne.demTexture=ne.demTexture||p.getTileTexture(se),ne.demTexture){const Re=ne.demTexture;Re.update(de,{premultiply:!1}),Re.bind(F.LINEAR,F.CLAMP_TO_EDGE)}else ne.demTexture=new c.T(L,de,F.RGBA,{premultiply:!1}),ne.demTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE);const fe=k.getMeshFromTileID(L,te.canonical,w,!0,"raster"),oe=(M=p.style.map.terrain)===null||M===void 0?void 0:M.getTerrainData(te),ve=D.getProjectionData({overscaledTileID:te,aligned:ee,applyGlobeMatrix:!S,applyTerrainMatrix:!0});U.draw(L,F.TRIANGLES,f,u[te.overscaledZ],y,bt.backCCW,gm(i,ne.dem),oe,ve,i.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const Du=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function hs(p,e,i,l,u,f,y,w,S=!1,M=!1){const k=l[l.length-1].overscaledZ,L=p.context,D=L.gl,F=p.useProgram("raster"),U=p.transform,ee=p.style.projection,Q=p.colorModeForRenderPass(),te=!p.options.moving;for(const ne of l){const ce=p.getDepthModeForSublayer(ne.overscaledZ-k,i.paint.get("raster-opacity")===1?Tt.ReadWrite:Tt.ReadOnly,D.LESS),se=e.getTile(ne);se.registerFadeDuration(i.paint.get("raster-fade-duration"));const de=e.findLoadedParent(ne,0),fe=e.findLoadedSibling(ne),oe=Pm(se,de||fe||null,e,i,p.transform,p.style.map.terrain);let ve,Re;const Ee=i.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;L.activeTexture.set(D.TEXTURE0),se.texture.bind(Ee,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),L.activeTexture.set(D.TEXTURE1),de?(de.texture.bind(Ee,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),ve=Math.pow(2,de.tileID.overscaledZ-se.tileID.overscaledZ),Re=[se.tileID.canonical.x*ve%1,se.tileID.canonical.y*ve%1]):se.texture.bind(Ee,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),se.texture.useMipmap&&L.extTextureFilterAnisotropic&&p.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax);const ke=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ne),De=U.getProjectionData({overscaledTileID:ne,aligned:te,applyGlobeMatrix:!M,applyTerrainMatrix:!0}),Ye=Os(Re||[0,0],ve||1,oe,i,w),Xe=ee.getMeshFromTileID(L,ne.canonical,f,y,"raster");F.draw(L,D.TRIANGLES,ce,u?u[ne.overscaledZ]:mt.disabled,Q,S?bt.frontCCW:bt.backCCW,Ye,ke,De,i.id,Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}}function Pm(p,e,i,l,u,f){const y=l.paint.get("raster-fade-duration");if(!f&&y>0){const w=O.now(),S=(w-p.timeAdded)/y,M=e?(w-e.timeAdded)/y:-1,k=i.getSource(),L=Be(u,{tileSize:k.tileSize,roundZoom:k.roundZoom}),D=!e||Math.abs(e.tileID.overscaledZ-L)>Math.abs(p.tileID.overscaledZ-L),F=D&&p.refreshedUponExpiration?1:c.ag(D?S:1-M,0,1);return p.refreshedUponExpiration&&S>=1&&(p.refreshedUponExpiration=!1),e?{opacity:1,mix:1-F}:{opacity:F,mix:0}}return{opacity:1,mix:0}}const qd=new c.be(1,0,0,1),Ql=new c.be(0,1,0,1),Lu=new c.be(0,0,1,1),Wd=new c.be(1,0,1,1),Hd=new c.be(0,1,1,1);function ja(p,e,i,l){ec(p,0,e+i/2,p.transform.width,i,l)}function Jl(p,e,i,l){ec(p,e-i/2,0,i,p.transform.height,l)}function ec(p,e,i,l,u,f){const y=p.context,w=y.gl;w.enable(w.SCISSOR_TEST),w.scissor(e*p.pixelRatio,i*p.pixelRatio,l*p.pixelRatio,u*p.pixelRatio),y.clear({color:f}),w.disable(w.SCISSOR_TEST)}function Xd(p,e,i){const l=p.context,u=l.gl,f=p.useProgram("debug"),y=Tt.disabled,w=mt.disabled,S=p.colorModeForRenderPass(),M="$debug",k=p.style.map.terrain&&p.style.map.terrain.getTerrainData(i);l.activeTexture.set(u.TEXTURE0);const L=e.getTileByID(i.key).latestRawTileData,D=Math.floor((L&&L.byteLength||0)/1024),F=e.getTile(i).tileSize,U=512/Math.min(F,512)*(i.overscaledZ/p.transform.zoom)*.5;let ee=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(ee+=` => ${i.overscaledZ}`),function(te,ne){te.initDebugOverlayCanvas();const ce=te.debugOverlayCanvas,se=te.context.gl,de=te.debugOverlayCanvas.getContext("2d");de.clearRect(0,0,ce.width,ce.height),de.shadowColor="white",de.shadowBlur=2,de.lineWidth=1.5,de.strokeStyle="white",de.textBaseline="top",de.font="bold 36px Open Sans, sans-serif",de.fillText(ne,5,5),de.strokeText(ne,5,5),te.debugOverlayTexture.update(ce),te.debugOverlayTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE)}(p,`${ee} ${D}kB`);const Q=p.transform.getProjectionData({overscaledTileID:i,applyGlobeMatrix:!0,applyTerrainMatrix:!0});f.draw(l,u.TRIANGLES,y,w,Dt.alphaBlended,bt.disabled,Pd(c.be.transparent,U),null,Q,M,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),f.draw(l,u.LINE_STRIP,y,w,S,bt.disabled,Pd(c.be.red),k,Q,M,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function ur(p,e,i,l){const{isRenderingGlobe:u}=l,f=p.context,y=f.gl,w=p.transform,S=p.colorModeForRenderPass(),M=p.getDepthModeFor3D(),k=p.useProgram("terrain");f.bindFramebuffer.set(null),f.viewport.set([0,0,p.width,p.height]);for(const L of i){const D=e.getTerrainMesh(L.tileID),F=p.renderToTexture.getTexture(L),U=e.getTerrainData(L.tileID);f.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,F.texture);const ee=e.getMeshFrameDelta(w.zoom),Q=w.calculateFogMatrix(L.tileID.toUnwrapped()),te=dm(ee,Q,p.style.sky,w.pitch,u),ne=w.getProjectionData({overscaledTileID:L.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(f,y.TRIANGLES,M,mt.disabled,S,bt.backCCW,te,U,ne,"terrain",D.vertexBuffer,D.indexBuffer,D.segments)}}function ds(p,e){if(!e.mesh){const i=new c.aK;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(1,1),i.emplaceBack(-1,1);const l=new c.aM;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new $n(p.createVertexBuffer(i,Vn.members),p.createIndexBuffer(l),c.aL.simpleSegment(0,0,i.length,l.length))}return e.mesh}class Xi{constructor(e,i){this.context=new kt(e),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=$e.maxUnderzooming+$e.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Al}resize(e,i,l){if(this.width=Math.floor(e*l),this.height=Math.floor(i*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,i=new c.aK;i.emplaceBack(0,0),i.emplaceBack(c.$,0),i.emplaceBack(0,c.$),i.emplaceBack(c.$,c.$),this.tileExtentBuffer=e.createVertexBuffer(i,Vn.members),this.tileExtentSegments=c.aL.simpleSegment(0,0,4,2);const l=new c.aK;l.emplaceBack(0,0),l.emplaceBack(c.$,0),l.emplaceBack(0,c.$),l.emplaceBack(c.$,c.$),this.debugBuffer=e.createVertexBuffer(l,Vn.members),this.debugSegments=c.aL.simpleSegment(0,0,4,5);const u=new c.c5;u.emplaceBack(0,0,0,0),u.emplaceBack(c.$,0,c.$,0),u.emplaceBack(0,c.$,0,c.$),u.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=e.createVertexBuffer(u,um.members),this.rasterBoundsSegments=c.aL.simpleSegment(0,0,4,2);const f=new c.aK;f.emplaceBack(0,0),f.emplaceBack(c.$,0),f.emplaceBack(0,c.$),f.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(f,Vn.members),this.rasterBoundsSegmentsPosOnly=c.aL.simpleSegment(0,0,4,5);const y=new c.aK;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(y,Vn.members),this.viewportSegments=c.aL.simpleSegment(0,0,4,2);const w=new c.c6;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(w);const S=new c.aM;S.emplaceBack(1,0,2),S.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(S);const M=this.context.gl;this.stencilClearMode=new mt({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.tileExtentMesh=new $n(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.L();c.bX(l,0,this.width,this.height,0,0,1),c.N(l,l,[i.drawingBufferWidth,i.drawingBufferHeight,0]);const u={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,i.TRIANGLES,Tt.disabled,this.stencilClearMode,Dt.disabled,bt.disabled,null,null,u,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,i,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!i||!i.length)return;this.currentStencilSource=e.source,this.nextStencilID+i.length>256&&this.clearStencil();const u=this.context;u.setColorMode(Dt.disabled),u.setDepthMode(Tt.disabled);const f={};for(const y of i)f[y.key]=this.nextStencilID++;this._renderTileMasks(f,i,l,!0),this._renderTileMasks(f,i,l,!1),this._tileClippingMaskIDs=f}_renderTileMasks(e,i,l,u){const f=this.context,y=f.gl,w=this.style.projection,S=this.transform,M=this.useProgram("clippingMask");for(const k of i){const L=e[k.key],D=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),F=w.getMeshFromTileID(this.context,k.canonical,u,!0,"stencil"),U=S.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!l,applyTerrainMatrix:!0});M.draw(f,y.TRIANGLES,Tt.disabled,new mt({func:y.ALWAYS,mask:0},L,255,y.KEEP,y.KEEP,y.REPLACE),Dt.disabled,l?bt.disabled:bt.backCCW,null,D,U,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}_renderTilesDepthBuffer(){const e=this.context,i=e.gl,l=this.style.projection,u=this.transform,f=this.useProgram("depth"),y=this.getDepthModeFor3D(),w=je(u,{tileSize:u.tileSize});for(const S of w){const M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S),k=l.getMeshFromTileID(this.context,S.canonical,!0,!0,"raster"),L=u.getProjectionData({overscaledTileID:S,applyGlobeMatrix:!0,applyTerrainMatrix:!0});f.draw(e,i.TRIANGLES,y,mt.disabled,Dt.disabled,bt.backCCW,null,M,L,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,i=this.context.gl;return new mt({func:i.NOTEQUAL,mask:255},e,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(e){const i=this.context.gl;return new mt({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,i.KEEP,i.KEEP,i.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const i=this.context.gl,l=e.sort((y,w)=>w.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,f=l[0].overscaledZ-u+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();const y={};for(let w=0;w<f;w++)y[w+u]=new mt({func:i.GEQUAL,mask:255},w+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=f,[y,l]}return[{[u]:mt.disabled},l]}stencilConfigForOverlapTwoPass(e){const i=this.context.gl,l=e.sort((y,w)=>w.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,f=l[0].overscaledZ-u+1;if(this.clearStencil(),f>1){const y={},w={};for(let S=0;S<f;S++)y[S+u]=new mt({func:i.GREATER,mask:255},f+1+S,255,i.KEEP,i.KEEP,i.REPLACE),w[S+u]=new mt({func:i.GREATER,mask:255},1+S,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID=2*f+1,[y,w,l]}return this.nextStencilID=3,[{[u]:new mt({func:i.GREATER,mask:255},2,255,i.KEEP,i.KEEP,i.REPLACE)},{[u]:new mt({func:i.GREATER,mask:255},1,255,i.KEEP,i.KEEP,i.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Dt([e.CONSTANT_COLOR,e.ONE],new c.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Dt.unblended:Dt.alphaBlended}getDepthModeForSublayer(e,i,l){if(!this.opaquePassEnabledForLayer())return Tt.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Tt(l||this.context.gl.LEQUAL,i,[u,u])}getDepthModeFor3D(){return new Tt(this.context.gl.LEQUAL,Tt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){var l,u;this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(O.now()),this.imageManager.beginFrame();const f=this.style._order,y=this.style.sourceCaches,w={},S={},M={},k={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const D in y){const F=y[D];F.used&&F.prepare(this.context),w[D]=F.getVisibleCoordinates(!1),S[D]=w[D].slice().reverse(),M[D]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let D=0;D<f.length;D++)if(this.style._layers[f[D]].is3D()){this.opaquePassCutoff=D;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const D of f){const F=this.style._layers[D];if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const U=S[F.source];(F.type==="custom"||U.length)&&this.renderLayer(this,y[F.source],F,U,k)}if((u=this.style.projection)===null||u===void 0||u.updateGPUdependent({context:this.context,useProgram:D=>this.useProgram(D)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?c.be.black:c.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(D,F){const U=D.context,ee=U.gl,Q=((fe,oe,ve)=>{const Re=Math.cos(oe.rollInRadians),Ee=Math.sin(oe.rollInRadians),ke=W(oe),De=oe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:fe.properties.get("sky-color"),u_horizon_color:fe.properties.get("horizon-color"),u_horizon:[(oe.width/2-ke*Ee)*ve,(oe.height/2+ke*Re)*ve],u_horizon_normal:[-Ee,Re],u_sky_horizon_blend:fe.properties.get("sky-horizon-blend")*oe.height/2*ve,u_sky_blend:De}})(F,D.style.map.transform,D.pixelRatio),te=new Tt(ee.LEQUAL,Tt.ReadWrite,[0,1]),ne=mt.disabled,ce=D.colorModeForRenderPass(),se=D.useProgram("sky"),de=ds(U,F);se.draw(U,ee.TRIANGLES,te,ne,ce,bt.disabled,Q,null,void 0,"sky",de.vertexBuffer,de.indexBuffer,de.segments)}(this,this.style.sky),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const D=this.style._layers[f[this.currentLayer]],F=y[D.source],U=w[D.source];this._renderTileClippingMasks(D,U,!1),this.renderLayer(this,F,D,U,k)}this.renderPass="translucent";let L=!1;for(this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const D=this.style._layers[f[this.currentLayer]],F=y[D.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(D,k))continue;this.opaquePassEnabledForLayer()||L||(L=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const U=(D.type==="symbol"?M:S)[D.source];this._renderTileClippingMasks(D,w[D.source],!!this.renderToTexture),this.renderLayer(this,F,D,U,k)}if(k.isRenderingGlobe&&function(D,F,U){const ee=D.context,Q=ee.gl,te=D.useProgram("atmosphere"),ne=new Tt(Q.LEQUAL,Tt.ReadOnly,[0,1]),ce=D.transform,se=function(De,Ye){const Xe=De.properties.get("position"),Ue=[-Xe.x,-Xe.y,-Xe.z],rt=c.af(new Float64Array(16));return De.properties.get("anchor")==="map"&&(c.b5(rt,rt,Ye.rollInRadians),c.b6(rt,rt,-Ye.pitchInRadians),c.b5(rt,rt,Ye.bearingInRadians),c.b6(rt,rt,Ye.center.lat*Math.PI/180),c.by(rt,rt,-Ye.center.lng*Math.PI/180)),c.c4(Ue,Ue,rt),Ue}(U,D.transform),de=ce.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),fe=F.properties.get("atmosphere-blend")*de.projectionTransition;if(fe===0)return;const oe=mo(ce.worldSize,ce.center.lat),ve=ce.inverseProjectionMatrix,Re=new Float64Array(4);Re[3]=1,c.av(Re,Re,ce.modelViewProjectionMatrix),Re[0]/=Re[3],Re[1]/=Re[3],Re[2]/=Re[3],Re[3]=1,c.av(Re,Re,ve),Re[0]/=Re[3],Re[1]/=Re[3],Re[2]/=Re[3],Re[3]=1;const Ee=((De,Ye,Xe,Ue,rt)=>({u_sun_pos:De,u_atmosphere_blend:Ye,u_globe_position:Xe,u_globe_radius:Ue,u_inv_proj_matrix:rt}))(se,fe,[Re[0],Re[1],Re[2]],oe,ve),ke=ds(ee,F);te.draw(ee,Q.TRIANGLES,ne,mt.disabled,Dt.alphaBlended,bt.disabled,Ee,null,null,"atmosphere",ke.vertexBuffer,ke.indexBuffer,ke.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const D=function(F,U){let ee=null;const Q=Object.values(F._layers).flatMap(se=>se.source&&!se.isHidden(U)?[F.sourceCaches[se.source]]:[]),te=Q.filter(se=>se.getSource().type==="vector"),ne=Q.filter(se=>se.getSource().type!=="vector"),ce=se=>{(!ee||ee.getSource().maxzoom<se.getSource().maxzoom)&&(ee=se)};return te.forEach(se=>ce(se)),ee||ne.forEach(se=>ce(se)),ee}(this.style,this.transform.zoom);D&&function(F,U,ee){for(let Q=0;Q<ee.length;Q++)Xd(F,U,ee[Q])}(this,D,D.getVisibleCoordinates())}this.options.showPadding&&function(D){const F=D.transform.padding;ja(D,D.transform.height-(F.top||0),3,qd),ja(D,F.bottom||0,3,Ql),Jl(D,F.left||0,3,Lu),Jl(D,D.transform.width-(F.right||0),3,Wd);const U=D.transform.centerPoint;(function(ee,Q,te,ne){ec(ee,Q-1,te-10,2,20,ne),ec(ee,Q-10,te-1,20,2,ne)})(D,U.x,D.transform.height-U.y,Hd)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const i=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!c.c7(i,l):!c.c8(i,l)),u||(u=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),u&&(c.c9(i,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(f,y){const w=f.context,S=w.gl,M=f.transform,k=Dt.unblended,L=new Tt(S.LEQUAL,Tt.ReadWrite,[0,1]),D=y.sourceCache.getRenderableTiles(),F=f.useProgram("terrainDepth");w.bindFramebuffer.set(y.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),w.clear({color:c.be.transparent,depth:1});for(const U of D){const ee=y.getTerrainMesh(U.tileID),Q=y.getTerrainData(U.tileID),te=M.getProjectionData({overscaledTileID:U.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ne={u_ele_delta:y.getMeshFrameDelta(M.zoom)};F.draw(w,S.TRIANGLES,L,mt.disabled,k,bt.backCCW,ne,Q,te,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,f.width,f.height])}(this,this.style.map.terrain),function(f,y){const w=f.context,S=w.gl,M=f.transform,k=Dt.unblended,L=new Tt(S.LEQUAL,Tt.ReadWrite,[0,1]),D=y.getCoordsTexture(),F=y.sourceCache.getRenderableTiles(),U=f.useProgram("terrainCoords");w.bindFramebuffer.set(y.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),w.clear({color:c.be.transparent,depth:1}),y.coordsIndex=[];for(const ee of F){const Q=y.getTerrainMesh(ee.tileID),te=y.getTerrainData(ee.tileID);w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,D.texture);const ne={u_terrain_coords_id:(255-y.coordsIndex.length)/255,u_texture:0,u_ele_delta:y.getMeshFrameDelta(M.zoom)},ce=M.getProjectionData({overscaledTileID:ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(w,S.TRIANGLES,L,mt.disabled,k,bt.backCCW,ne,te,ce,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments),y.coordsIndex.push(ee.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,f.width,f.height])}(this,this.style.map.terrain))}renderLayer(e,i,l,u,f){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(u||[]).length)&&(this.id=l.id,c.ca(l)?function(y,w,S,M,k,L){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=L,F=mt.disabled,U=y.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ee,Q,te,ne,ce,se,de,fe,oe){const ve=Q.transform,Re=Q.style.map.terrain,Ee=ce==="map",ke=se==="map";for(const De of ee){const Ye=ne.getTile(De),Xe=Ye.getBucket(te);if(!Xe||!Xe.text||!Xe.text.segments.get().length)continue;const Ue=c.am(Xe.textSizeData,ve.zoom),rt=c.aB(Ye,1,Q.transform.zoom),St=yt(Ee,Q.transform,rt),Vt=te.layout.get("icon-text-fit")!=="none"&&Xe.hasIconData();if(Ue){const sr=Math.pow(2,ve.zoom-Ye.tileID.overscaledZ),qt=Re?(or,Ht)=>Re.getElevation(De,or,Ht):null;Cm(Xe,Ee,ke,oe,ve,St,sr,Ue,Vt,c.aC(ve,Ye,de,fe),De.toUnwrapped(),qt)}}}(M,y,S,w,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),k),S.paint.get("icon-opacity").constantOr(1)!==0&&Gd(y,w,S,M,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),F,U,D),S.paint.get("text-opacity").constantOr(1)!==0&&Gd(y,w,S,M,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),F,U,D),w.map.showCollisionBoxes&&(Vd(y,w,S,M,!0),Vd(y,w,S,M,!1))}(e,i,l,u,this.style.placement.variableOffsets,f):c.cb(l)?function(y,w,S,M,k){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:L}=k,D=S.paint.get("circle-opacity"),F=S.paint.get("circle-stroke-width"),U=S.paint.get("circle-stroke-opacity"),ee=!S.layout.get("circle-sort-key").isConstant();if(D.constantOr(1)===0&&(F.constantOr(1)===0||U.constantOr(1)===0))return;const Q=y.context,te=Q.gl,ne=y.transform,ce=y.getDepthModeForSublayer(0,Tt.ReadOnly),se=mt.disabled,de=y.colorModeForRenderPass(),fe=[],oe=ne.getCircleRadiusCorrection();for(let ve=0;ve<M.length;ve++){const Re=M[ve],Ee=w.getTile(Re),ke=Ee.getBucket(S);if(!ke)continue;const De=S.paint.get("circle-translate"),Ye=S.paint.get("circle-translate-anchor"),Xe=c.aC(ne,Ee,De,Ye),Ue=ke.programConfigurations.get(S.id),rt=y.useProgram("circle",Ue),St=ke.layoutVertexBuffer,Vt=ke.indexBuffer,sr=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),qt={programConfiguration:Ue,program:rt,layoutVertexBuffer:St,indexBuffer:Vt,uniformValues:yu(y,Ee,S,Xe,oe),terrainData:sr,projectionData:ne.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!L,applyTerrainMatrix:!0})};if(ee){const or=ke.segments.get();for(const Ht of or)fe.push({segments:new c.aL([Ht]),sortKey:Ht.sortKey,state:qt})}else fe.push({segments:ke.segments,sortKey:0,state:qt})}ee&&fe.sort((ve,Re)=>ve.sortKey-Re.sortKey);for(const ve of fe){const{programConfiguration:Re,program:Ee,layoutVertexBuffer:ke,indexBuffer:De,uniformValues:Ye,terrainData:Xe,projectionData:Ue}=ve.state;Ee.draw(Q,te.TRIANGLES,ce,se,de,bt.backCCW,Ye,Xe,Ue,S.id,ke,De,ve.segments,S.paint,y.transform.zoom,Re)}}(e,i,l,u,f):c.cc(l)?function(y,w,S,M,k){if(S.paint.get("heatmap-opacity")===0)return;const L=y.context,{isRenderingToTexture:D,isRenderingGlobe:F}=k;if(y.style.map.terrain){for(const U of M){const ee=w.getTile(U);w.hasRenderableParent(U)||(y.renderPass==="offscreen"?Xl(y,ee,S,U,F):y.renderPass==="translucent"&&Yl(y,S,U,D,F))}L.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(U,ee,Q,te){const ne=U.context,ce=ne.gl,se=U.transform,de=mt.disabled,fe=new Dt([ce.ONE,ce.ONE],c.be.transparent,[!0,!0,!0,!0]);(function(oe,ve,Re){const Ee=oe.gl;oe.activeTexture.set(Ee.TEXTURE1),oe.viewport.set([0,0,ve.width/4,ve.height/4]);let ke=Re.heatmapFbos.get(c.c1);ke?(Ee.bindTexture(Ee.TEXTURE_2D,ke.colorAttachment.get()),oe.bindFramebuffer.set(ke.framebuffer)):(ke=Ra(oe,ve.width/4,ve.height/4),Re.heatmapFbos.set(c.c1,ke))})(ne,U,Q),ne.clear({color:c.be.transparent});for(let oe=0;oe<te.length;oe++){const ve=te[oe];if(ee.hasRenderableParent(ve))continue;const Re=ee.getTile(ve),Ee=Re.getBucket(Q);if(!Ee)continue;const ke=Ee.programConfigurations.get(Q.id),De=U.useProgram("heatmap",ke),Ye=se.getProjectionData({overscaledTileID:ve,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Xe=se.getCircleRadiusCorrection();De.draw(ne,ce.TRIANGLES,Tt.disabled,de,fe,bt.backCCW,Ea(Re,se.zoom,Q.paint.get("heatmap-intensity"),Xe),null,Ye,Q.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,Q.paint,se.zoom,ke)}ne.viewport.set([0,0,U.width,U.height])}(y,w,S,M):y.renderPass==="translucent"&&function(U,ee){const Q=U.context,te=Q.gl;Q.setColorMode(U.colorModeForRenderPass());const ne=ee.heatmapFbos.get(c.c1);ne&&(Q.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,ne.colorAttachment.get()),Q.activeTexture.set(te.TEXTURE1),Kl(Q,ee).bind(te.LINEAR,te.CLAMP_TO_EDGE),U.useProgram("heatmapTexture").draw(Q,te.TRIANGLES,Tt.disabled,mt.disabled,U.colorModeForRenderPass(),bt.disabled,Md(U,ee,0,1),null,null,ee.id,U.viewportBuffer,U.quadTriangleIndexBuffer,U.viewportSegments,ee.paint,U.transform.zoom))}(y,S)}(e,i,l,u,f):c.cd(l)?function(y,w,S,M,k){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:L}=k,D=S.paint.get("line-opacity"),F=S.paint.get("line-width");if(D.constantOr(1)===0||F.constantOr(1)===0)return;const U=y.getDepthModeForSublayer(0,Tt.ReadOnly),ee=y.colorModeForRenderPass(),Q=S.paint.get("line-dasharray"),te=S.paint.get("line-pattern"),ne=te.constantOr(1),ce=S.paint.get("line-gradient"),se=S.getCrossfadeParameters(),de=ne?"linePattern":Q?"lineSDF":ce?"lineGradient":"line",fe=y.context,oe=fe.gl,ve=y.transform;let Re=!0;for(const Ee of M){const ke=w.getTile(Ee);if(ne&&!ke.patternsLoaded())continue;const De=ke.getBucket(S);if(!De)continue;const Ye=De.programConfigurations.get(S.id),Xe=y.context.program.get(),Ue=y.useProgram(de,Ye),rt=Re||Ue.program!==Xe,St=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ee),Vt=te.constantOr(null);if(Vt&&ke.imageAtlas){const Wt=ke.imageAtlas,Xt=Wt.patternPositions[Vt.to.toString()],Xr=Wt.patternPositions[Vt.from.toString()];Xt&&Xr&&Ye.setConstantPatternPositions(Xt,Xr)}const sr=ve.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),qt=ve.getPixelScale(),or=ne?Ed(y,ke,S,qt,se):Q?kd(y,ke,S,qt,Q,se):ce?vu(y,ke,S,qt,De.lineClipsArray.length):Nl(y,ke,S,qt);if(ne)fe.activeTexture.set(oe.TEXTURE0),ke.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Ye.updatePaintBuffers(se);else if(Q&&(rt||y.lineAtlas.dirty))fe.activeTexture.set(oe.TEXTURE0),y.lineAtlas.bind(fe);else if(ce){const Wt=De.gradients[S.id];let Xt=Wt.texture;if(S.gradientVersion!==Wt.version){let Xr=256;if(S.stepInterpolant){const Lt=w.getSource().maxzoom,Or=Ee.canonical.z===Lt?Math.ceil(1<<y.transform.maxZoom-Ee.canonical.z):1;Xr=c.ag(c.c2(De.maxLineLength/c.$*1024*Or),256,fe.maxTextureSize)}Wt.gradient=c.c3({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Xr,image:Wt.gradient||void 0,clips:De.lineClipsArray}),Wt.texture?Wt.texture.update(Wt.gradient):Wt.texture=new c.T(fe,Wt.gradient,oe.RGBA),Wt.version=S.gradientVersion,Xt=Wt.texture}fe.activeTexture.set(oe.TEXTURE0),Xt.bind(S.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}const Ht=y.stencilModeForClipping(Ee);Ue.draw(fe,oe.TRIANGLES,U,Ht,ee,bt.disabled,or,St,sr,S.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,S.paint,y.transform.zoom,Ye,De.layoutVertexBuffer2),Re=!1}}(e,i,l,u,f):c.ce(l)?function(y,w,S,M,k){const L=S.paint.get("fill-color"),D=S.paint.get("fill-opacity");if(D.constantOr(1)===0)return;const{isRenderingToTexture:F}=k,U=y.colorModeForRenderPass(),ee=S.paint.get("fill-pattern"),Q=y.opaquePassEnabledForLayer()&&!ee.constantOr(1)&&L.constantOr(c.be.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===Q){const te=y.getDepthModeForSublayer(1,y.renderPass==="opaque"?Tt.ReadWrite:Tt.ReadOnly);Da(y,w,S,M,te,U,!1,F)}if(y.renderPass==="translucent"&&S.paint.get("fill-antialias")){const te=y.getDepthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Tt.ReadOnly);Da(y,w,S,M,te,U,!0,F)}}(e,i,l,u,f):c.cf(l)?function(y,w,S,M,k){const L=S.paint.get("fill-extrusion-opacity");if(L===0)return;const{isRenderingToTexture:D}=k;if(y.renderPass==="translucent"){const F=new Tt(y.context.gl.LEQUAL,Tt.ReadWrite,y.depthRangeFor3D);if(L!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))Mo(y,w,S,M,F,mt.disabled,Dt.disabled,D),Mo(y,w,S,M,F,y.stencilModeFor3D(),y.colorModeForRenderPass(),D);else{const U=y.colorModeForRenderPass();Mo(y,w,S,M,F,mt.disabled,U,D)}}}(e,i,l,u,f):c.cg(l)?function(y,w,S,M,k){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const{isRenderingToTexture:L}=k,D=y.context,F=y.style.projection.useSubdivision,U=y.getDepthModeForSublayer(0,Tt.ReadOnly),ee=y.colorModeForRenderPass();if(y.renderPass==="offscreen")(function(Q,te,ne,ce,se,de,fe){const oe=Q.context,ve=oe.gl;for(const Re of ne){const Ee=te.getTile(Re),ke=Ee.dem;if(!ke||!ke.data||!Ee.needsHillshadePrepare)continue;const De=ke.dim,Ye=ke.stride,Xe=ke.getPixels();if(oe.activeTexture.set(ve.TEXTURE1),oe.pixelStoreUnpackPremultiplyAlpha.set(!1),Ee.demTexture=Ee.demTexture||Q.getTileTexture(Ye),Ee.demTexture){const rt=Ee.demTexture;rt.update(Xe,{premultiply:!1}),rt.bind(ve.NEAREST,ve.CLAMP_TO_EDGE)}else Ee.demTexture=new c.T(oe,Xe,ve.RGBA,{premultiply:!1}),Ee.demTexture.bind(ve.NEAREST,ve.CLAMP_TO_EDGE);oe.activeTexture.set(ve.TEXTURE0);let Ue=Ee.fbo;if(!Ue){const rt=new c.T(oe,{width:De,height:De,data:null},ve.RGBA);rt.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),Ue=Ee.fbo=oe.createFramebuffer(De,De,!0,!1),Ue.colorAttachment.set(rt.texture)}oe.bindFramebuffer.set(Ue.framebuffer),oe.viewport.set([0,0,De,De]),Q.useProgram("hillshadePrepare").draw(oe,ve.TRIANGLES,se,de,fe,bt.disabled,mm(Ee.tileID,ke),null,null,ce.id,Q.rasterBoundsBuffer,Q.quadTriangleIndexBuffer,Q.rasterBoundsSegments),Ee.needsHillshadePrepare=!1}})(y,w,M,S,U,mt.disabled,ee),D.viewport.set([0,0,y.width,y.height]);else if(y.renderPass==="translucent")if(F){const[Q,te,ne]=y.stencilConfigForOverlapTwoPass(M);Io(y,w,S,ne,Q,U,ee,!1,L),Io(y,w,S,ne,te,U,ee,!0,L)}else{const[Q,te]=y.getStencilConfigForOverlapAndUpdateStencilID(M);Io(y,w,S,te,Q,U,ee,!1,L)}}(e,i,l,u,f):c.ch(l)?function(y,w,S,M,k){if(y.renderPass!=="translucent"||!M.length)return;const{isRenderingToTexture:L}=k,D=y.style.projection.useSubdivision,F=y.getDepthModeForSublayer(0,Tt.ReadOnly),U=y.colorModeForRenderPass();if(D){const[ee,Q,te]=y.stencilConfigForOverlapTwoPass(M);La(y,w,S,te,ee,F,U,!1,L),La(y,w,S,te,Q,F,U,!0,L)}else{const[ee,Q]=y.getStencilConfigForOverlapAndUpdateStencilID(M);La(y,w,S,Q,ee,F,U,!1,L)}}(e,i,l,u,f):c.ci(l)?function(y,w,S,M,k){if(y.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!M.length)return;const{isRenderingToTexture:L}=k,D=w.getSource(),F=y.style.projection.useSubdivision;if(D instanceof xi)hs(y,w,S,M,null,!1,!1,D.tileCoords,D.flippedWindingOrder,L);else if(F){const[U,ee,Q]=y.stencilConfigForOverlapTwoPass(M);hs(y,w,S,Q,U,!1,!0,Du,!1,L),hs(y,w,S,Q,ee,!0,!0,Du,!1,L)}else{const[U,ee]=y.getStencilConfigForOverlapAndUpdateStencilID(M);hs(y,w,S,ee,U,!1,!0,Du,!1,L)}}(e,i,l,u,f):c.cj(l)?function(y,w,S,M,k){const L=S.paint.get("background-color"),D=S.paint.get("background-opacity");if(D===0)return;const{isRenderingToTexture:F}=k,U=y.context,ee=U.gl,Q=y.style.projection,te=y.transform,ne=te.tileSize,ce=S.paint.get("background-pattern");if(y.isPatternMissing(ce))return;const se=!ce&&L.a===1&&D===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==se)return;const de=mt.disabled,fe=y.getDepthModeForSublayer(0,se==="opaque"?Tt.ReadWrite:Tt.ReadOnly),oe=y.colorModeForRenderPass(),ve=y.useProgram(ce?"backgroundPattern":"background"),Re=M||je(te,{tileSize:ne,terrain:y.style.map.terrain});ce&&(U.activeTexture.set(ee.TEXTURE0),y.imageManager.bind(y.context));const Ee=S.getCrossfadeParameters();for(const ke of Re){const De=te.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),Ye=ce?ym(D,y,ce,{tileID:ke,tileSize:ne},Ee):$l(D,L),Xe=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ke),Ue=Q.getMeshFromTileID(U,ke.canonical,!1,!0,"raster");ve.draw(U,ee.TRIANGLES,fe,de,oe,bt.backCCW,Ye,Xe,De,S.id,Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}}(e,0,l,u,f):c.ck(l)&&function(y,w,S,M){const{isRenderingGlobe:k}=M,L=y.context,D=S.implementation,F=y.style.projection,U=y.transform,ee=U.getProjectionDataForCustomLayer(k),Q={farZ:U.farZ,nearZ:U.nearZ,fov:U.fov*Math.PI/180,modelViewProjectionMatrix:U.modelViewProjectionMatrix,projectionMatrix:U.projectionMatrix,shaderData:{variantName:F.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${F.shaderPreludeCode.vertexSource}`,define:F.shaderDefine},defaultProjectionData:ee},te=D.renderingMode?D.renderingMode:"2d";if(y.renderPass==="offscreen"){const ne=D.prerender;ne&&(y.setCustomLayerDefaults(),L.setColorMode(y.colorModeForRenderPass()),ne.call(D,L.gl,Q),L.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),L.setColorMode(y.colorModeForRenderPass()),L.setStencilMode(mt.disabled);const ne=te==="3d"?y.getDepthModeFor3D():y.getDepthModeForSublayer(0,Tt.ReadOnly);L.setDepthMode(ne),D.render(L.gl,Q),L.setDirty(),y.setBaseState(),L.bindFramebuffer.set(null)}}(e,0,l,f))}saveTileTexture(e){const i=this._tileTextures[e.size[0]];i?i.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const i=this._tileTextures[e];return i&&i.length>0?i.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const i=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!i||!l}useProgram(e,i,l=!1,u=[]){this.cache=this.cache||{};const f=!!this.style.map.terrain,y=this.style.projection,w=l?Sn.projectionMercator:y.shaderPreludeCode,S=l?js:y.shaderDefine,M=e+(i?i.cacheKey:"")+`/${l?uu:y.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(f?"/terrain":"")+(u?`/${u.join("/")}`:"");return this.cache[M]||(this.cache[M]=new Fl(this.context,Sn[e],i,Rd[e],this._showOverdrawInspector,f,w,S,u)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:i}=this.context.gl;return this.width!==e||this.height!==i}}function tc(p,e){let i,l=!1,u=null,f=null;const y=()=>{u=null,l&&(p.apply(f,i),u=setTimeout(y,e),l=!1)};return(...w)=>(l=!0,f=this,i=w,u||y(),u)}class Fa{constructor(e){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let l;return i.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(l=u)}),(l&&l[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(!this._isValidHash(i))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:l,pitch:+(i[4]||0)}),!0},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,i)},this._removeHash=()=>{const i=this._getCurrentHash();if(i.length===0)return;const l=i.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let f=window.location.hash.replace(u,"");f.startsWith("#&")?f=f.slice(0,1)+f.slice(2):f==="#"&&(f="");let y=window.location.href.replace(/(#.+)?$/,f);y=y.replace("&&","&"),window.history.replaceState(window.history.state,null,y)},this._updateHash=tc(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const i=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,u),y=Math.round(i.lng*f)/f,w=Math.round(i.lat*f)/f,S=this._map.getBearing(),M=this._map.getPitch();let k="";if(k+=e?`/${y}/${w}/${l}`:`${l}/${w}/${y}`,(S||M)&&(k+="/"+Math.round(10*S)/10),M&&(k+=`/${Math.round(M)}`),this._hashName){const L=this._hashName;let D=!1;const F=window.location.hash.slice(1).split("&").map(U=>{const ee=U.split("=")[0];return ee===L?(D=!0,`${ee}=${k}`):U}).filter(U=>U);return D||F.push(`${L}=${k}`),`#${F.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.S(+e[2],+e[1])}catch{return!1}const i=+e[0],l=+(e[3]||0),u=+(e[4]||0);return i>=this._map.getMinZoom()&&i<=this._map.getMaxZoom()&&l>=-180&&l<=180&&u>=this._map.getMinPitch()&&u<=this._map.getMaxPitch()}}const Eo={linearity:.3,easing:c.cl(0,0,.3,1)},ko=c.e({deceleration:2500,maxSpeed:1400},Eo),ju=c.e({deceleration:20,maxSpeed:1400},Eo),Ba=c.e({deceleration:1e3,maxSpeed:360},Eo),Fu=c.e({deceleration:1e3,maxSpeed:90},Eo),Yd=c.e({deceleration:1e3,maxSpeed:360},Eo);class Kd{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:O.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=O.now();for(;e.length>0&&i-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:f}of this._inertiaBuffer)i.zoom+=f.zoomDelta||0,i.bearing+=f.bearingDelta||0,i.pitch+=f.pitchDelta||0,i.roll+=f.rollDelta||0,f.panDelta&&i.pan._add(f.panDelta),f.around&&(i.around=f.around),f.pinchAround&&(i.pinchAround=f.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(i.pan.mag()){const f=Ao(i.pan.mag(),l,c.e({},ko,e||{})),y=i.pan.mult(f.amount/i.pan.mag()),w=this._map.cameraHelper.handlePanInertia(y,this._map.transform);u.center=w.easingCenter,u.offset=w.easingOffset,zo(u,f)}if(i.zoom){const f=Ao(i.zoom,l,ju);u.zoom=this._map.transform.zoom+f.amount,zo(u,f)}if(i.bearing){const f=Ao(i.bearing,l,Ba);u.bearing=this._map.transform.bearing+c.ag(f.amount,-179,179),zo(u,f)}if(i.pitch){const f=Ao(i.pitch,l,Fu);u.pitch=this._map.transform.pitch+f.amount,zo(u,f)}if(i.roll){const f=Ao(i.roll,l,Yd);u.roll=this._map.transform.roll+c.ag(f.amount,-179,179),zo(u,f)}if(u.zoom||u.bearing){const f=i.pinchAround===void 0?i.around:i.pinchAround;u.around=f?this._map.unproject(f):this._map.getCenter()}return this.clear(),c.e(u,{noMoveStart:!0})}}function zo(p,e){(!p.duration||p.duration<e.duration)&&(p.duration=e.duration,p.easing=e.easing)}function Ao(p,e,i){const{maxSpeed:l,linearity:u,deceleration:f}=i,y=c.ag(p*u/(e/1e3),-l,l),w=Math.abs(y)/(f*u);return{easing:i.easing,duration:1e3*w,amount:y*(w/2)}}class Ti extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,l,u={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const f=H.mousePos(i.getCanvas(),l),y=i.unproject(f);super(e,c.e({point:f,lngLat:y,originalEvent:l},u)),this._defaultPrevented=!1,this.target=i}}class on extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,l){const u=e==="touchend"?l.changedTouches:l.touches,f=H.touchPos(i.getCanvasContainer(),u),y=f.map(S=>i.unproject(S)),w=f.reduce((S,M,k,L)=>S.add(M.div(L.length)),new c.P(0,0));super(e,{points:f,point:w,lngLats:y,lngLat:i.unproject(w),originalEvent:l}),this._defaultPrevented=!1}}class Bu extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Qd{constructor(e,i){this._map=e,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Bu(e.type,this._map,e))}mousedown(e,i){return this._mousedownPos=i,this._firePreventable(new Ti(e.type,this._map,e))}mouseup(e){this._map.fire(new Ti(e.type,this._map,e))}click(e,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new Ti(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ti(e.type,this._map,e))}mouseover(e){this._map.fire(new Ti(e.type,this._map,e))}mouseout(e){this._map.fire(new Ti(e.type,this._map,e))}touchstart(e){return this._firePreventable(new on(e.type,this._map,e))}touchmove(e){this._map.fire(new on(e.type,this._map,e))}touchend(e){this._map.fire(new on(e.type,this._map,e))}touchcancel(e){this._map.fire(new on(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jd{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ti(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ti("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ti(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ro{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class Ou{constructor(e,i){this._map=e,this._tr=new Ro(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,i){this.isEnabled()&&e.shiftKey&&e.button===0&&(H.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(e,i){if(!this._active)return;const l=i;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=H.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const f=Math.min(u.x,l.x),y=Math.max(u.x,l.x),w=Math.min(u.y,l.y),S=Math.max(u.y,l.y);H.setTransform(this._box,`translate(${f}px,${w}px)`),this._box.style.width=y-f+"px",this._box.style.height=S-w+"px"}mouseupWindow(e,i){if(!this._active||e.button!==0)return;const l=this._startPos,u=i;if(this.reset(),H.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:f=>f.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(H.remove(this._box),this._box=null),H.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,i){return this._map.fire(new c.l(e,{originalEvent:i}))}}function rc(p,e){if(p.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${e.length}`);const i={};for(let l=0;l<p.length;l++)i[p[l].identifier]=e[l];return i}class ep{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,i,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const f=new c.P(0,0);for(const y of u)f._add(y);return f.div(u.length)}(i),this.touches=rc(l,i)))}touchmove(e,i,l){if(this.aborted||!this.centroid)return;const u=rc(l,i);for(const f in this.touches){const y=u[f];(!y||y.dist(this.touches[f])>30)&&(this.aborted=!0)}}touchend(e,i,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class ic{constructor(e){this.singleTap=new ep(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,i,l){this.singleTap.touchstart(e,i,l)}touchmove(e,i,l){this.singleTap.touchmove(e,i,l)}touchend(e,i,l){const u=this.singleTap.touchend(e,i,l);if(u){const f=e.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(u)<30;if(f&&y||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class nc{constructor(e){this._tr=new Ro(e),this._zoomIn=new ic({numTouches:1,numTaps:2}),this._zoomOut=new ic({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,i,l){this._zoomIn.touchstart(e,i,l),this._zoomOut.touchstart(e,i,l)}touchmove(e,i,l){this._zoomIn.touchmove(e,i,l),this._zoomOut.touchmove(e,i,l)}touchend(e,i,l){const u=this._zoomIn.touchend(e,i,l),f=this._zoomOut.touchend(e,i,l),y=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:y.zoom+1,around:y.unproject(u)},{originalEvent:e})}):f?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:y.zoom-1,around:y.unproject(f)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Do{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const i=this._moveFunction(...e);if(i.bearingDelta||i.pitchDelta||i.rollDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(e,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(i)?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,i){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=Array.isArray(i)?i[0]:i;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&H.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Yi=0,an=2,tp={[Yi]:1,[an]:2};class pi{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const i=H.mouseButton(e);this._eventButton=i}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(i,l){const u=tp[l];return i.buttons===void 0||(i.buttons&u)!==u}(e,this._eventButton)}isValidEndEvent(e){return H.mouseButton(e)===this._eventButton}}class Lo{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Mm{constructor(e=new pi({checkCorrectEvent:()=>!0}),i=new Lo){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=i}_executeRelevantHandler(e,i,l){return e instanceof MouseEvent?i(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.startMove(i),i=>this.oneFingerTouchMoveStateManager.startMove(i))}endMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.endMove(i),i=>this.oneFingerTouchMoveStateManager.endMove(i))}isValidStartEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidStartEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidStartEvent(i))}isValidMoveEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidMoveEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(i))}isValidEndEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidEndEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidEndEvent(i))}}const sc=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=e=>{e.preventDefault()}};class Im{constructor(e,i){this._clickTolerance=e.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,i,l){return this._calculateTransform(e,i,l)}touchmove(e,i,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,i,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,i,l){this._calculateTransform(e,i,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,i,l){l.length>0&&(this._active=!0);const u=rc(l,i),f=new c.P(0,0),y=new c.P(0,0);let w=0;for(const M in u){const k=u[M],L=this._touches[M];L&&(f._add(k),y._add(k.sub(L)),w++,u[M]=k)}if(this._touches=u,this._shouldBePrevented(w)||!y.mag())return;const S=y.div(w);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:f.div(w),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,i,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([i[0],i[1]]))}touchmove(e,i,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,f]=this._firstTwoTouches,y=Oa(l,i,u),w=Oa(l,i,f);if(!y||!w)return;const S=this._aroundCenter?null:y.add(w).div(2);return this._move([y,w],S,e)}touchend(e,i,l){if(!this._firstTwoTouches)return;const[u,f]=this._firstTwoTouches,y=Oa(l,i,u),w=Oa(l,i,f);y&&w||(this._active&&H.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Oa(p,e,i){for(let l=0;l<p.length;l++)if(p[l].identifier===i)return e[l]}function jo(p,e){return Math.log(p/e)/Math.LN2}class Mn extends Nu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,i){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(jo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:jo(this._distance,l),pinchAround:i}}}function et(p,e){return 180*p.angleWith(e)/Math.PI}class $u extends Nu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,i,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:et(this._vector,u),pinchAround:i}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const i=25/(Math.PI*this._minDiameter)*360,l=et(e,this._startVector);return Math.abs(l)<i}}function Na(p){return Math.abs(p.y)>Math.abs(p.x)}class Vu extends Nu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,i,l){super.touchstart(e,i,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Na(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,i,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),f=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,f,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+f.y)/2*-.5}):void 0}gestureBeginsVertically(e,i,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,f=i.mag()>=2;if(!u&&!f)return;if(!u||!f)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const y=e.y>0==i.y>0;return Na(e)&&Na(i)&&y}}const $a={panStep:100,bearingStep:15,pitchStep:10};class Fo{constructor(e){this._tr=new Ro(e);const i=$a;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let i=0,l=0,u=0,f=0,y=0;switch(e.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),f=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),f=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),y=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:w=>{const S=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:Uu,zoom:i?Math.round(S.zoom)+i*(e.shiftKey?2:1):S.zoom,bearing:S.bearing+l*this._bearingStep,pitch:S.pitch+u*this._pitchStep,offset:[-f*this._panStep,-y*this._panStep],center:S.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Uu(p){return p*(2-p)}const zt=4.000244140625,Zu=1/450;class rp{constructor(e,i){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Ro(e),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Zu}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let i=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=O.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,i!==0&&i%zt==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=H.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.S.convert(l.center)):i,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const w=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=w),typeof this._targetZoom=="number"&&(this._targetZoom+=w)}if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>zt?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&S!==0&&(S=1/S);const M=typeof this._targetZoom!="number"?e.scale:c.ae(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),c.aj(M*S)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,u=this._easing;let f,y=!1;if(this._type==="wheel"&&l&&u){const w=O.now()-this._lastWheelEventTime,S=Math.min((w+5)/200,1),M=u(S);f=c.C.number(l,i,M),S<1?this._frameId||(this._frameId=!0):y=!0}else f=i,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=f,{noInertia:!0,needsRenderFrame:!y,zoomDelta:f-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=c.cn;if(this._prevEase){const l=this._prevEase,u=(O.now()-l.start)/l.duration,f=l.easing(u+.01)-l.easing(u),y=.27/Math.sqrt(f*f+1e-4)*.01,w=Math.sqrt(.0729-y*y);i=c.cl(y,w,.25,1)}return this._prevEase={start:O.now(),duration:e,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class oc{constructor(e,i){this._clickZoom=e,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Em{constructor(e){this._tr=new Ro(e),this.reset()}reset(){this._active=!1}dblclick(e,i){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class km{constructor(){this._tap=new ic({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,i,l){if(!this._swipePoint)if(this._tapTime){const u=i[0],f=e.timeStamp-this._tapTime<500,y=this._tapPoint.dist(u)<30;f&&y?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,i,l)}touchmove(e,i,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=i[0],f=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(e,i,l)}touchend(e,i,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,i,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gu{constructor(e,i,l){this._el=e,this._mousePan=i,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ac{constructor(e,i,l,u){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=i,this._mousePitch=l,this._mouseRoll=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class qu{constructor(e,i,l,u){this._el=e,this._touchZoom=i,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ip{constructor(e,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=H.create("div","maplibregl-cooperative-gesture-screen",e);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=i,this._container.appendChild(u);const f=document.createElement("div");f.className="maplibregl-mobile-message",f.textContent=l,this._container.appendChild(f),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(H.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,i){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:i})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Va=p=>p.zoom||p.drag||p.roll||p.pitch||p.rotate;class zm extends c.l{}function Wu(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta||p.rollDelta}class ps{constructor(e,i){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,f)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=u.type==="renderFrame"?void 0:u,w={needsRenderFrame:!1},S={},M={};for(const{handlerName:D,handler:F,allowed:U}of this._handlers){if(!F.isEnabled())continue;let ee;if(this._blockedByActive(M,U,D))F.reset();else if(F[f||u.type]){if(c.co(u,f||u.type)){const Q=H.mousePos(this._map.getCanvas(),u);ee=F[f||u.type](u,Q)}else if(c.cp(u,f||u.type)){const Q=this._getMapTouches(u.touches),te=H.touchPos(this._map.getCanvas(),Q);ee=F[f||u.type](u,te,Q)}else c.cq(f||u.type)||(ee=F[f||u.type](u));this.mergeHandlerResult(w,S,ee,D,y),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()}(ee||F.isActive())&&(M[D]=F)}const k={};for(const D in this._previousActiveHandlers)M[D]||(k[D]=y);this._previousActiveHandlers=M,(Object.keys(k).length||Wu(w))&&(this._changes.push([w,S,k]),this._triggerRenderFrame()),(Object.keys(M).length||Wu(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:L}=w;L&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],L(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kd(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,f,y]of this._listeners)H.addEventListener(u,f,u===document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[e,i,l]of this._listeners)H.removeEventListener(e,i,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const i=this._map,l=i.getCanvasContainer();this._add("mapEvent",new Qd(i,e));const u=i.boxZoom=new Ou(i,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const f=i.cooperativeGestures=new ip(i,e.cooperativeGestures);this._add("cooperativeGestures",f),e.cooperativeGestures&&f.enable();const y=new nc(i),w=new Em(i);i.doubleClickZoom=new oc(w,y),this._add("tapZoom",y),this._add("clickZoom",w),e.interactive&&e.doubleClickZoom&&i.doubleClickZoom.enable();const S=new km;this._add("tapDragZoom",S);const M=i.touchPitch=new Vu(i);this._add("touchPitch",M),e.interactive&&e.touchPitch&&i.touchPitch.enable(e.touchPitch);const k=()=>i.project(i.getCenter()),L=function({enable:se,clickTolerance:de,aroundCenter:fe=!0,minPixelCenterThreshold:oe=100,rotateDegreesPerPixelMoved:ve=.8},Re){const Ee=new pi({checkCorrectEvent:ke=>H.mouseButton(ke)===0&&ke.ctrlKey||H.mouseButton(ke)===2&&!ke.ctrlKey});return new Do({clickTolerance:de,move:(ke,De)=>{const Ye=Re();if(fe&&Math.abs(Ye.y-ke.y)>oe)return{bearingDelta:c.cm(new c.P(ke.x,De.y),De,Ye)};let Xe=(De.x-ke.x)*ve;return fe&&De.y<Ye.y&&(Xe=-Xe),{bearingDelta:Xe}},moveStateManager:Ee,enable:se,assignEvents:sc})}(e,k),D=function({enable:se,clickTolerance:de,pitchDegreesPerPixelMoved:fe=-.5}){const oe=new pi({checkCorrectEvent:ve=>H.mouseButton(ve)===0&&ve.ctrlKey||H.mouseButton(ve)===2});return new Do({clickTolerance:de,move:(ve,Re)=>({pitchDelta:(Re.y-ve.y)*fe}),moveStateManager:oe,enable:se,assignEvents:sc})}(e),F=function({enable:se,clickTolerance:de,rollDegreesPerPixelMoved:fe=.3},oe){const ve=new pi({checkCorrectEvent:Re=>H.mouseButton(Re)===2&&Re.ctrlKey});return new Do({clickTolerance:de,move:(Re,Ee)=>{const ke=oe();let De=(Ee.x-Re.x)*fe;return Ee.y<ke.y&&(De=-De),{rollDelta:De}},moveStateManager:ve,enable:se,assignEvents:sc})}(e,k);i.dragRotate=new ac(e,L,D,F),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",D,["mouseRotate","mouseRoll"]),this._add("mouseRoll",F,["mousePitch"]),e.interactive&&e.dragRotate&&i.dragRotate.enable();const U=function({enable:se,clickTolerance:de}){const fe=new pi({checkCorrectEvent:oe=>H.mouseButton(oe)===0&&!oe.ctrlKey});return new Do({clickTolerance:de,move:(oe,ve)=>({around:ve,panDelta:ve.sub(oe)}),activateOnStart:!0,moveStateManager:fe,enable:se,assignEvents:sc})}(e),ee=new Im(e,i);i.dragPan=new Gu(l,U,ee),this._add("mousePan",U),this._add("touchPan",ee,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&i.dragPan.enable(e.dragPan);const Q=new $u,te=new Mn;i.touchZoomRotate=new qu(l,te,Q,S),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&i.touchZoomRotate.enable(e.touchZoomRotate);const ne=i.scrollZoom=new rp(i,()=>this._triggerRenderFrame());this._add("scrollZoom",ne,["mousePan"]),e.interactive&&e.scrollZoom&&i.scrollZoom.enable(e.scrollZoom);const ce=i.keyboard=new Fo(i);this._add("keyboard",ce),e.interactive&&e.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new Jd(i))}_add(e,i,l){this._handlers.push({handlerName:e,handler:i,allowed:l}),this._handlersById[e]=i}stop(e){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Va(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,i,l){for(const u in e)if(u!==l&&(!i||i.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const i=[];for(const l of e)this._el.contains(l.target)&&i.push(l);return i}mergeHandlerResult(e,i,l,u,f){if(!l)return;c.e(e,l);const y={handlerName:u,originalEvent:l.originalEvent||f};l.zoomDelta!==void 0&&(i.zoom=y),l.panDelta!==void 0&&(i.drag=y),l.rollDelta!==void 0&&(i.roll=y),l.pitchDelta!==void 0&&(i.pitch=y),l.bearingDelta!==void 0&&(i.rotate=y)}_applyChanges(){const e={},i={},l={};for(const[u,f,y]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.rollDelta&&(e.rollDelta=(e.rollDelta||0)+u.rollDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),c.e(i,f),c.e(l,y);this._updateMapTransform(e,i,l),this._changes=[]}_updateMapTransform(e,i,l){const u=this._map,f=u._getTransformForUpdate(),y=u.terrain;if(!(Wu(e)||y&&this._terrainMovement))return this._fireEvents(i,l,!0);u._stop(!0);let{panDelta:w,zoomDelta:S,bearingDelta:M,pitchDelta:k,rollDelta:L,around:D,pinchAround:F}=e;F!==void 0&&(D=F),D=D||u.transform.centerPoint,y&&!f.isPointOnMapSurface(D)&&(D=f.centerPoint);const U={panDelta:w,zoomDelta:S,rollDelta:L,pitchDelta:k,bearingDelta:M,around:D};this._map.cameraHelper.useGlobeControls&&!f.isPointOnMapSurface(D)&&(D=f.centerPoint);const ee=D.distSqr(f.centerPoint)<.01?f.center:f.screenPointToLocation(w?D.sub(w):D);y?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(U,f),this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?f.setCenter(f.screenPointToLocation(f.centerPoint.sub(w))):this._map.cameraHelper.handleMapControlsPan(U,f,ee):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(U,f,ee))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(U,f),this._map.cameraHelper.handleMapControlsPan(U,f,ee)),u._applyUpdatedTransform(f),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(i,l,!0)}_fireEvents(e,i,l){const u=Va(this._eventsInProgress),f=Va(e),y={};for(const L in e){const{originalEvent:D}=e[L];this._eventsInProgress[L]||(y[`${L}start`]=D),this._eventsInProgress[L]=e[L]}!u&&f&&this._fireEvent("movestart",f.originalEvent);for(const L in y)this._fireEvent(L,y[L]);f&&this._fireEvent("move",f.originalEvent);for(const L in e){const{originalEvent:D}=e[L];this._fireEvent(L,D)}const w={};let S;for(const L in this._eventsInProgress){const{handlerName:D,originalEvent:F}=this._eventsInProgress[L];this._handlersById[D].isActive()||(delete this._eventsInProgress[L],S=i[D]||F,w[`${L}end`]=S)}for(const L in w)this._fireEvent(L,w[L]);const M=Va(this._eventsInProgress),k=(u||f)&&!M;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const L=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&L.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(L)}if(l&&k){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),D=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;!L||!L.essential&&O.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:S})),D(this._map.getBearing())&&this._map.resetNorth()):(D(L.bearing||this._map.getBearing())&&(L.bearing=0),L.freezeElevation=!0,this._map.easeTo(L,{originalEvent:S})),this._updatingCamera=!1}}_fireEvent(e,i){this._map.fire(new c.l(e,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new zm("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class er extends c.E{constructor(e,i,l){super(),this._renderFrameCallback=()=>{const u=Math.min((O.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=i,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,i){e.apply(this.transform),this.transform=e,this.cameraHelper=i}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,i){return this.jumpTo({center:e},i)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,i){return this.jumpTo({elevation:e},i),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,i,l){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},i),l)}panTo(e,i,l){return this.easeTo(c.e({center:e},i),l)}getZoom(){return this.transform.zoom}setZoom(e,i){return this.jumpTo({zoom:e},i),this}zoomTo(e,i,l){return this.easeTo(c.e({zoom:e},i),l)}zoomIn(e,i){return this.zoomTo(this.getZoom()+1,e,i),this}zoomOut(e,i){return this.zoomTo(this.getZoom()-1,e,i),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,i){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",i)).fire(new c.l("move",i)).fire(new c.l("moveend",i))),this}getBearing(){return this.transform.bearing}setBearing(e,i){return this.jumpTo({bearing:e},i),this}getPadding(){return this.transform.padding}setPadding(e,i){return this.jumpTo({padding:e},i),this}rotateTo(e,i,l){return this.easeTo(c.e({bearing:e},i),l)}resetNorth(e,i){return this.rotateTo(0,c.e({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),i),this}snapToNorth(e,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,i):this}getPitch(){return this.transform.pitch}setPitch(e,i){return this.jumpTo({pitch:e},i),this}getRoll(){return this.transform.roll}setRoll(e,i){return this.jumpTo({roll:e},i),this}cameraForBounds(e,i){e=cr.convert(e).adjustAntiMeridian();const l=i&&i.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,i)}_cameraForBoxAndBearing(e,i,l,u){const f={top:0,bottom:0,right:0,left:0};if(typeof(u=c.e({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const M=u.padding;u.padding={top:M,bottom:M,right:M,left:M}}const y=c.e(f,u.padding);u.padding=y;const w=this.transform,S=new cr(e,i);return this.cameraHelper.cameraForBoxAndBearing(u,y,S,l,w)}fitBounds(e,i,l){return this._fitInternal(this.cameraForBounds(e,i),i,l)}fitScreenCoordinates(e,i,l,u,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(i)),l,u),u,f)}_fitInternal(e,i,l){return e?(delete(i=c.e(e,i)).padding,i.linear?this.easeTo(i,l):this.flyTo(i,l)):this}jumpTo(e,i){this.stop();const l=this._getTransformForUpdate();let u=!1,f=!1,y=!1;const w=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const S=l.zoom!==w;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(u=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(f=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(y=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",i)).fire(new c.l("move",i)),S&&this.fire(new c.l("zoomstart",i)).fire(new c.l("zoom",i)).fire(new c.l("zoomend",i)),u&&this.fire(new c.l("rotatestart",i)).fire(new c.l("rotate",i)).fire(new c.l("rotateend",i)),f&&this.fire(new c.l("pitchstart",i)).fire(new c.l("pitch",i)).fire(new c.l("pitchend",i)),y&&this.fire(new c.l("rollstart",i)).fire(new c.l("roll",i)).fire(new c.l("rollend",i)),this.fire(new c.l("moveend",i))}calculateCameraOptionsFromTo(e,i,l,u=0){const f=c.a0.fromLngLat(e,i),y=c.a0.fromLngLat(l,u),w=y.x-f.x,S=y.y-f.y,M=y.z-f.z,k=Math.hypot(w,S,M);if(k===0)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(w,S),D=c.aj(this.transform.cameraToCenterDistance/k/this.transform.tileSize),F=180*Math.atan2(w,-S)/Math.PI;let U=180*Math.acos(L/k)/Math.PI;return U=M<0?90-U:90+U,{center:y.toLngLat(),elevation:u,zoom:D,pitch:U,bearing:F}}calculateCameraOptionsFromCameraLngLatAltRotation(e,i,l,u,f){const y=this.transform.calculateCenterFromCameraLngLatAlt(e,i,l,u);return{center:y.center,elevation:y.elevation,zoom:y.zoom,bearing:l,pitch:u,roll:f}}easeTo(e,i){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.cn},e)).animate===!1||!e.essential&&O.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),u=this.getBearing(),f=l.pitch,y=l.roll,w="bearing"in e?this._normalizeBearing(e.bearing,u):u,S="pitch"in e?+e.pitch:f,M="roll"in e?this._normalizeBearing(e.roll,y):y,k="padding"in e?e.padding:l.padding,L=c.P.convert(e.offset);let D,F;e.around&&(D=c.S.convert(e.around),F=l.locationToScreenPoint(D));const U={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ee=this.cameraHelper.handleEaseTo(l,{bearing:w,pitch:S,roll:M,padding:k,around:D,aroundPoint:F,offsetAsPoint:L,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||u!==w,this._pitching=this._pitching||S!==f,this._rolling=this._rolling||M!==y,this._padding=!l.isPaddingEqual(k),this._zooming=this._zooming||ee.isZooming,this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,U),this.terrain&&this._prepareElevation(ee.elevationCenter),this._ease(Q=>{ee.easeFunc(Q),this.terrain&&!e.freezeElevation&&this._updateElevation(Q),this._applyUpdatedTransform(l),this._fireMoveEvents(i)},Q=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i,Q)},e),this}_prepareEase(e,i,l={}){this._moving=!0,i||l.moving||this.fire(new c.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&i!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(i-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=i}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const i=e.getCameraLngLat(),l=e.getCameraAltitude(),u=this.terrain?this.terrain.getElevationForLngLatZoom(i,e.zoom):0;if(l<u){const f=this.calculateCameraOptionsFromTo(i,u,e.center,e.elevation);return{pitch:f.pitch,zoom:f.zoom}}return{}}_applyUpdatedTransform(e){const i=[];if(i.push(u=>this._elevateCameraIfInsideTerrain(u)),this.transformCameraUpdate&&i.push(u=>this.transformCameraUpdate(u)),!i.length)return;const l=e.clone();for(const u of i){const f=l.clone(),{center:y,zoom:w,roll:S,pitch:M,bearing:k,elevation:L}=u(f);y&&f.setCenter(y),L!==void 0&&f.setElevation(L),w!==void 0&&f.setZoom(w),S!==void 0&&f.setRoll(S),M!==void 0&&f.setPitch(M),k!==void 0&&f.setBearing(k),l.apply(f)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const l=this._zooming,u=this._rotating,f=this._pitching,y=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",e)),u&&this.fire(new c.l("rotateend",e)),f&&this.fire(new c.l("pitchend",e)),y&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,i){if(!e.essential&&O.prefersReducedMotion){const De=c.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(De,i)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cn},e);const l=this._getTransformForUpdate(),u=l.bearing,f=l.pitch,y=l.roll,w=l.padding,S="bearing"in e?this._normalizeBearing(e.bearing,u):u,M="pitch"in e?+e.pitch:f,k="roll"in e?this._normalizeBearing(e.roll,y):y,L="padding"in e?e.padding:l.padding,D=c.P.convert(e.offset);let F=l.centerPoint.add(D);const U=l.screenPointToLocation(F),ee=this.cameraHelper.handleFlyTo(l,{bearing:S,pitch:M,roll:k,padding:L,locationAtOffset:U,offsetAsPoint:D,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let Q=e.curve;const te=Math.max(l.width,l.height),ne=te/ee.scaleOfZoom,ce=ee.pixelPathLength;typeof ee.scaleOfMinZoom=="number"&&(Q=Math.sqrt(te/ee.scaleOfMinZoom/ce*2));const se=Q*Q;function de(De){const Ye=(ne*ne-te*te+(De?-1:1)*se*se*ce*ce)/(2*(De?ne:te)*se*ce);return Math.log(Math.sqrt(Ye*Ye+1)-Ye)}function fe(De){return(Math.exp(De)-Math.exp(-De))/2}function oe(De){return(Math.exp(De)+Math.exp(-De))/2}const ve=de(!1);let Re=function(De){return oe(ve)/oe(ve+Q*De)},Ee=function(De){return te*((oe(ve)*(fe(Ye=ve+Q*De)/oe(Ye))-fe(ve))/se)/ce;var Ye},ke=(de(!0)-ve)/Q;if(Math.abs(ce)<2e-6||!isFinite(ke)){if(Math.abs(te-ne)<1e-6)return this.easeTo(e,i);const De=ne<te?-1:1;ke=Math.abs(Math.log(ne/te))/Q,Ee=()=>0,Re=Ye=>Math.exp(De*Q*Ye)}return e.duration="duration"in e?+e.duration:1e3*ke/("screenSpeed"in e?+e.screenSpeed/Q:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=u!==S,this._pitching=M!==f,this._rolling=k!==y,this._padding=!l.isPaddingEqual(L),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(ee.targetCenter),this._ease(De=>{const Ye=De*ke,Xe=1/Re(Ye),Ue=Ee(Ye);this._rotating&&l.setBearing(c.C.number(u,S,De)),this._pitching&&l.setPitch(c.C.number(f,M,De)),this._rolling&&l.setRoll(c.C.number(y,k,De)),this._padding&&(l.interpolatePadding(w,L,De),F=l.centerPoint.add(D)),ee.easeFunc(De,Xe,Ue,F),this.terrain&&!e.freezeElevation&&this._updateElevation(De),this._applyUpdatedTransform(l),this._fireMoveEvents(i)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,i){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,i)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,i,l){l.animate===!1||l.duration===0?(e(1),i()):(this._easeStart=O.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,i){e=c.aN(e,-180,180);const l=Math.abs(e-i);return Math.abs(e-360-i)<l&&(e-=360),Math.abs(e+360-i)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(e),this.transform.tileZoom):null}}const Ua={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class lc{constructor(e=Ua){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=H.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=H.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=H.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){H.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,i){const l=this._map._getUIString(`AttributionControl.${i}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(u=>typeof u!="string"?"":u)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const i=this._map.style.sourceCaches;for(const u in i){const f=i[u];if(f.used||f.usedForTerrain){const y=f.getSource();y.attribution&&e.indexOf(y.attribution)<0&&e.push(y.attribution)}}e=e.filter(u=>String(u).trim()),e.sort((u,f)=>u.length-f.length),e=e.filter((u,f)=>{for(let y=f+1;y<e.length;y++)if(e[y].indexOf(u)>=0)return!1;return!0});const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=H.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Hu{constructor(e={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const l=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=H.create("div","maplibregl-ctrl");const i=H.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){H.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class np{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const i=++this._id;return this._queue.push({callback:e,id:i,cancelled:!1}),i}remove(e){const i=this._currentlyRunning,l=i?this._queue.concat(i):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const l of i)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var sp=c.aI([{name:"a_pos3d",type:"Int16",components:3}]);class Am extends c.E{constructor(e){super(),this._lastTilesetChange=O.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,i){this.sourceCache.update(e,i),this._renderableTilesKeys=[];const l={};for(const u of je(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.terrainRttPosMatrix32f=new Float64Array(16),c.bX(u.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[u.key]=new wn(u,this.tileSize),this._lastTilesetChange=O.now());for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const i in this._tiles){const l=this._tiles[i];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,i){return i?this._getTerrainCoordsForTileRanges(e,i):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const i={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID,f=e.clone(),y=c.b9();if(u.canonical.equals(e.canonical))c.bX(y,0,c.$,c.$,0,0,1);else if(u.canonical.isChildOf(e.canonical)){const w=u.canonical.z-e.canonical.z,S=u.canonical.x-(u.canonical.x>>w<<w),M=u.canonical.y-(u.canonical.y>>w<<w),k=c.$>>w;c.bX(y,0,k,k,0,0,1),c.M(y,y,[-S*k,-M*k,0])}else{if(!e.canonical.isChildOf(u.canonical))continue;{const w=e.canonical.z-u.canonical.z,S=e.canonical.x-(e.canonical.x>>w<<w),M=e.canonical.y-(e.canonical.y>>w<<w),k=c.$>>w;c.bX(y,0,c.$,c.$,0,0,1),c.M(y,y,[S*k,M*k,0]),c.N(y,y,[1/2**w,1/2**w,0])}}f.terrainRttPosMatrix32f=new Float32Array(y),i[l]=f}return i}_getTerrainCoordsForTileRanges(e,i){const l={};for(const u of this._renderableTilesKeys){const f=this._tiles[u].tileID;if(!this._isWithinTileRanges(f,i))continue;const y=e.clone(),w=c.b9();if(f.canonical.z===e.canonical.z){const S=e.canonical.x-f.canonical.x,M=e.canonical.y-f.canonical.y;c.bX(w,0,c.$,c.$,0,0,1),c.M(w,w,[S*c.$,M*c.$,0])}else if(f.canonical.z>e.canonical.z){const S=f.canonical.z-e.canonical.z,M=f.canonical.x-(f.canonical.x>>S<<S),k=f.canonical.y-(f.canonical.y>>S<<S),L=e.canonical.x-(f.canonical.x>>S),D=e.canonical.y-(f.canonical.y>>S),F=c.$>>S;c.bX(w,0,F,F,0,0,1),c.M(w,w,[-M*F+L*c.$,-k*F+D*c.$,0])}else{const S=e.canonical.z-f.canonical.z,M=e.canonical.x-(e.canonical.x>>S<<S),k=e.canonical.y-(e.canonical.y>>S<<S),L=(e.canonical.x>>S)-f.canonical.x,D=(e.canonical.y>>S)-f.canonical.y,F=c.$<<S;c.bX(w,0,F,F,0,0,1),c.M(w,w,[M*c.$+L*F,k*c.$+D*F,0])}y.terrainRttPosMatrix32f=new Float32Array(w),l[u]=y}return l}getSourceTile(e,i){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let f=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!f||!f.dem)&&i)for(;u>=l.minzoom&&(!f||!f.dem);)f=this.sourceCache.getTileByID(e.scaledTo(u--).key);return f}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,i){return i[e.canonical.z]&&e.canonical.x>=i[e.canonical.z].minTileX&&e.canonical.x<=i[e.canonical.z].maxTileX&&e.canonical.y>=i[e.canonical.z].minTileY&&e.canonical.y<=i[e.canonical.z].maxTileY}}class In{constructor(e,i,l){this._meshCache={},this.painter=e,this.sourceCache=new Am(i),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,i,l,u=c.$){var f;if(!(i>=0&&i<u&&l>=0&&l<u))return 0;const y=this.getTerrainData(e),w=(f=y.tile)===null||f===void 0?void 0:f.dem;if(!w)return 0;const S=c.cr([],[i/u*c.$,l/u*c.$],y.u_terrain_matrix),M=[S[0]*w.dim,S[1]*w.dim],k=Math.floor(M[0]),L=Math.floor(M[1]),D=M[0]-k,F=M[1]-L;return w.get(k,L)*(1-D)*(1-F)+w.get(k+1,L)*D*(1-F)+w.get(k,L+1)*(1-D)*F+w.get(k+1,L+1)*D*F}getElevationForLngLatZoom(e,i){if(!c.cs(i,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:f}=this._getOverscaledTileIDFromLngLatZoom(e,i);return this.getElevation(l,u%c.$,f%c.$,c.$)}getElevation(e,i,l,u=c.$){return this.getDEMElevation(e,i,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,f=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(u,f,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(u,new c.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.af([])}const i=this.sourceCache.getSourceTile(e,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const u=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new c.T(u,i.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),i.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const l=i&&i+i.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let f=e.canonical.z-i.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?f=e.canonical.z-u:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const y=e.canonical.x-(e.canonical.x>>f<<f),w=e.canonical.y-(e.canonical.y>>f<<f),S=c.ct(new Float64Array(16),[1/(c.$<<f),1/(c.$<<f),0]);c.M(S,S,[y*c.$,w*c.$,0]),this._demMatrixCache[e.key]={matrix:S,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(e){const i=this.painter,l=i.width/devicePixelRatio,u=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(i.context,{width:l,height:u,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(i.context,{width:l,height:u,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let f=0,y=0;f<this._coordsTextureSize;f++)for(let w=0;w<this._coordsTextureSize;w++,y+=4)i[y+0]=255&w,i[y+1]=255&f,i[y+2]=w>>8<<4|f>>8,i[y+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),u=new c.T(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const i=new Uint8Array(4),l=this.painter.context,u=l.gl,f=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),y=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(f,w-y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,i),l.bindFramebuffer.set(null);const S=i[0]+(i[2]>>4<<8),M=i[1]+((15&i[2])<<8),k=this.coordsIndex[255-i[3]],L=k&&this.sourceCache.getTileByID(k);if(!L)return null;const D=this._coordsTextureSize,F=(1<<L.tileID.canonical.z)*D;return new c.a0((L.tileID.canonical.x*D+S)/F+L.tileID.wrap,(L.tileID.canonical.y*D+M)/F,this.getElevation(L.tileID,S,M,D))}depthAtPoint(e){const i=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,i),l.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(e){var i;const l=((i=this.painter.style.projection)===null||i===void 0?void 0:i.transitionState)>0,u=l&&e.canonical.y===0,f=l&&e.canonical.y===(1<<e.canonical.z)-1,y=`m_${u?"n":""}_${f?"s":""}`;if(this._meshCache[y])return this._meshCache[y];const w=this.painter.context,S=new c.cu,M=new c.aM,k=this.meshSize,L=c.$/k,D=k*k;for(let oe=0;oe<=k;oe++)for(let ve=0;ve<=k;ve++)S.emplaceBack(ve*L,oe*L,0);for(let oe=0;oe<D;oe+=k+1)for(let ve=0;ve<k;ve++)M.emplaceBack(ve+oe,k+ve+oe+1,k+ve+oe+2),M.emplaceBack(ve+oe,k+ve+oe+2,ve+oe+1);const F=S.length,U=F+(k+1),ee=(k+1)*k,Q=u?c.bg:0,te=u?0:1,ne=f?c.bh:c.$,ce=f?0:1;for(let oe=0;oe<=k;oe++)S.emplaceBack(oe*L,Q,te);for(let oe=0;oe<=k;oe++)S.emplaceBack(oe*L,ne,ce);for(let oe=0;oe<k;oe++)M.emplaceBack(ee+oe,U+oe,U+oe+1),M.emplaceBack(ee+oe,U+oe+1,ee+oe+1),M.emplaceBack(0+oe,F+oe+1,F+oe),M.emplaceBack(0+oe,0+oe+1,F+oe+1);const se=S.length,de=se+2*(k+1);for(const oe of[0,1])for(let ve=0;ve<=k;ve++)for(const Re of[0,1])S.emplaceBack(oe*c.$,ve*L,Re);for(let oe=0;oe<2*k;oe+=2)M.emplaceBack(se+oe,se+oe+1,se+oe+3),M.emplaceBack(se+oe,se+oe+3,se+oe+2),M.emplaceBack(de+oe,de+oe+3,de+oe+1),M.emplaceBack(de+oe,de+oe+2,de+oe+3);const fe=new $n(w.createVertexBuffer(S,sp.members),w.createIndexBuffer(M),c.aL.simpleSegment(0,0,S.length,M.length));return this._meshCache[y]=fe,fe}getMeshFrameDelta(e){return 2*Math.PI*c.bt/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,i){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,i);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const i=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return i&&i.dem&&(l.minElevation=i.dem.min*this.exaggeration,l.maxElevation=i.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,i){const l=c.a0.fromLngLat(e.wrap()),u=(1<<i)*c.$,f=l.x*u,y=l.y*u,w=Math.floor(f/c.$),S=Math.floor(y/c.$);return{tileID:new c.Z(i,0,i,w,S),mercatorX:f,mercatorY:y}}}class cc{constructor(e,i,l){this._context=e,this._size=i,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(l.texture),{id:e,fbo:i,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>e.id!==i),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const nt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class pt{constructor(e,i){this.painter=e,this.terrain=i,this.pool=new cc(e.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(i)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const u=e.sourceCaches[l].getVisibleCoordinates(),f=e.sourceCaches[l].getSource(),y=f instanceof xi?f.terrainTileRanges:null;for(const w of u){const S=this.terrain.sourceCache.getTerrainCoords(w,y);for(const M in S)this._coordsAscending[l][M]||(this._coordsAscending[l][M]=[]),this._coordsAscending[l][M].push(S[M])}}this._coordsAscendingStr={};for(const l of e._order){const u=e._layers[l],f=u.source;if(nt[u.type]&&!this._coordsAscendingStr[f]){this._coordsAscendingStr[f]={};for(const y in this._coordsAscending[f])this._coordsAscendingStr[f][y]=this._coordsAscending[f][y].map(w=>w.key).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsAscendingStr){const f=this._coordsAscendingStr[u][l.tileID.key];f&&f!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e,i){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},i),{isRenderingToTexture:!0}),u=e.type,f=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(nt[u]&&(this._prevType&&nt[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(e.id),!y))return!0;if(nt[this._prevType]||nt[u]&&y){this._prevType=u;const w=this._stacks.length-1,S=this._stacks[w]||[];for(const M of this._renderableTiles){if(this.pool.isFull()&&(ur(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(M),M.rtt[w]){const L=this.pool.getObjectForId(M.rtt[w].id);if(L.stamp===M.rtt[w].stamp){this.pool.useObject(L);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),M.rtt[w]={id:k.id,stamp:k.stamp},f.context.bindFramebuffer.set(k.fbo.framebuffer),f.context.clear({color:c.be.transparent,stencil:0}),f.currentStencilSource=void 0;for(let L=0;L<S.length;L++){const D=f.style._layers[S[L]],F=D.source?this._coordsAscending[D.source][M.tileID.key]:[M.tileID];f.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),f._renderTileClippingMasks(D,F,!0),f.renderLayer(f,f.style.sourceCaches[D.source],D,F,l),D.source&&(M.rttCoords[D.source]=this._coordsAscendingStr[D.source][M.tileID.key])}}return ur(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),nt[u]}return!1}}const uc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Xu=Z,Za={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ua,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},fi={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class op{constructor(e,i,l=!1){this.mousedown=f=>{this.startMove(f,H.mousePos(this.element,f)),H.addEventListener(window,"mousemove",this.mousemove),H.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=f=>{this.move(f,H.mousePos(this.element,f))},this.mouseup=f=>{this._rotatePitchHanlder.dragEnd(f),this.offTemp()},this.touchstart=f=>{f.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=H.touchPos(this.element,f.targetTouches)[0],this.startMove(f,this._startPos),H.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),H.addEventListener(window,"touchend",this.touchend))},this.touchmove=f=>{f.targetTouches.length!==1?this.reset():(this._lastPos=H.touchPos(this.element,f.targetTouches)[0],this.move(f,this._lastPos))},this.touchend=f=>{f.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=i;const u=new Mm;this._rotatePitchHanlder=new Do({clickTolerance:3,move:(f,y)=>{const w=i.getBoundingClientRect(),S=new c.P((w.bottom-w.top)/2,(w.right-w.left)/2);return{bearingDelta:c.cm(new c.P(f.x,y.y),y,S),pitchDelta:l?-.5*(y.y-f.y):void 0}},moveStateManager:u,enable:!0,assignEvents:()=>{}}),this.map=e,H.addEventListener(i,"mousedown",this.mousedown),H.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),H.addEventListener(i,"touchcancel",this.reset)}startMove(e,i){this._rotatePitchHanlder.dragStart(e,i),H.disableDrag()}move(e,i){const l=this.map,{bearingDelta:u,pitchDelta:f}=this._rotatePitchHanlder.dragMove(e,i)||{};u&&l.setBearing(l.getBearing()+u),f&&l.setPitch(l.getPitch()+f)}off(){const e=this.element;H.removeEventListener(e,"mousedown",this.mousedown),H.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),H.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),H.removeEventListener(window,"touchend",this.touchend),H.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){H.enableDrag(),H.removeEventListener(window,"mousemove",this.mousemove),H.removeEventListener(window,"mouseup",this.mouseup),H.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),H.removeEventListener(window,"touchend",this.touchend)}}let Hr;function ap(p,e,i,l=!1){if(l||!i.getCoveringTilesDetailsProvider().allowWorldCopies())return p==null?void 0:p.wrap();const u=new c.S(p.lng,p.lat);if(p=new c.S(p.lng,p.lat),e){const f=new c.S(p.lng-360,p.lat),y=new c.S(p.lng+360,p.lat),w=i.locationToScreenPoint(p).distSqr(e);i.locationToScreenPoint(f).distSqr(e)<w?p=f:i.locationToScreenPoint(y).distSqr(e)<w&&(p=y)}for(;Math.abs(p.lng-i.center.lng)>180;){const f=i.locationToScreenPoint(p);if(f.x>=0&&f.y>=0&&f.x<=i.width&&f.y<=i.height)break;p.lng>i.center.lng?p.lng-=360:p.lng+=360}return p.lng!==u.lng&&i.isPointOnMapSurface(i.locationToScreenPoint(p))?p:u}const Zs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function nr(p,e,i){const l=p.classList;for(const u in Zs)l.remove(`maplibregl-${i}-anchor-${u}`);l.add(`maplibregl-${i}-anchor-${e}`)}class hr extends c.E{constructor(e){if(super(),this._onKeyPress=i=>{const l=i.code,u=i.charCode||i.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=i=>{const l=i.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=i=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=ap(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(u=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||i&&i.type!=="moveend"||(this._pos=this._pos.round()),H.setTransform(this._element,`${Zs[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${f} ${u}`),O.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=H.create("div");const i=H.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${l}px`),i.setAttributeNS(null,"width",`${u}px`),i.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const f=H.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");const y=H.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");const w=H.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const S=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const te of S){const ne=H.createNS("http://www.w3.org/2000/svg","ellipse");ne.setAttributeNS(null,"opacity","0.04"),ne.setAttributeNS(null,"cx","10.5"),ne.setAttributeNS(null,"cy","5.80029008"),ne.setAttributeNS(null,"rx",te.rx),ne.setAttributeNS(null,"ry",te.ry),w.appendChild(ne)}const M=H.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const k=H.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(k);const L=H.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"opacity","0.25"),L.setAttributeNS(null,"fill","#000000");const D=H.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),L.appendChild(D);const F=H.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(6.0, 7.0)"),F.setAttributeNS(null,"fill","#FFFFFF");const U=H.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ee=H.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");const Q=H.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#FFFFFF"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962"),U.appendChild(ee),U.appendChild(Q),y.appendChild(w),y.appendChild(M),y.appendChild(L),y.appendChild(F),y.appendChild(U),i.appendChild(y),i.setAttributeNS(null,"height",l*this._scale+"px"),i.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(i),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),nr(this._element,this._anchor,"marker"),e&&e.className)for(const i of e.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),H.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var i,l;const u=(i=this._map)===null||i===void 0?void 0:i.terrain,f=this._map.transform.isLocationOccluded(this._lngLat);if(!u||f){const F=f?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==F&&(this._element.style.opacity=F))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const y=this._map,w=y.terrain.depthAtPoint(this._pos),S=y.terrain.getElevationForLngLatZoom(this._lngLat,y.transform.tileZoom);if(y.transform.lngLatToCameraDepth(this._lngLat,S)-w<.006)return void(this._element.style.opacity=this._opacity);const M=-this._offset.y/y.transform.pixelsPerMeter,k=Math.sin(y.getPitch()*Math.PI/180)*M,L=y.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),D=y.transform.lngLatToCameraDepth(this._lngLat,S+k)-L>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&D&&this._popup.remove(),this._element.style.opacity=D?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,i){return(this._opacity===void 0||e===void 0&&i===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const lp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let fs=0,ms=!1;const Yu={maxWidth:100,unit:"metric"};function hc(p,e,i){const l=i&&i.maxWidth||100,u=p._container.clientHeight/2,f=p._container.clientWidth/2,y=p.unproject([f-l/2,u]),w=p.unproject([f+l/2,u]),S=Math.round(p.project(w).x-p.project(y).x),M=Math.min(l,S,p._container.clientWidth),k=y.distanceTo(w);if(i&&i.unit==="imperial"){const L=3.2808*k;L>5280?Gs(e,M,L/5280,p._getUIString("ScaleControl.Miles")):Gs(e,M,L,p._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?Gs(e,M,k/1852,p._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Gs(e,M,k/1e3,p._getUIString("ScaleControl.Kilometers")):Gs(e,M,k,p._getUIString("ScaleControl.Meters"))}function Gs(p,e,i,l){const u=function(f){const y=Math.pow(10,`${Math.floor(f)}`.length-1);let w=f/y;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(S){const M=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*M)/M}(w),y*w}(i);p.style.width=e*(u/i)+"px",p.innerHTML=`${u}&nbsp;${l}`}const Ga={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Ku=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function dc(p){if(p){if(typeof p=="number"){const e=Math.round(Math.abs(p)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,p),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-p),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(p,0),right:new c.P(-p,0)}}if(p instanceof c.P||Array.isArray(p)){const e=c.P.convert(p);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(p.center||[0,0]),top:c.P.convert(p.top||[0,0]),"top-left":c.P.convert(p["top-left"]||[0,0]),"top-right":c.P.convert(p["top-right"]||[0,0]),bottom:c.P.convert(p.bottom||[0,0]),"bottom-left":c.P.convert(p["bottom-left"]||[0,0]),"bottom-right":c.P.convert(p["bottom-right"]||[0,0]),left:c.P.convert(p.left||[0,0]),right:c.P.convert(p.right||[0,0])}}return dc(new c.P(0,0))}const Qu=Z;b.AJAXError=c.cy,b.Event=c.l,b.Evented=c.E,b.LngLat=c.S,b.MercatorCoordinate=c.a0,b.Point=c.P,b.addProtocol=c.cz,b.config=c.a,b.removeProtocol=c.cA,b.AttributionControl=lc,b.BoxZoomHandler=Ou,b.CanvasSource=as,b.CooperativeGesturesHandler=ip,b.DoubleClickZoomHandler=oc,b.DragPanHandler=Gu,b.DragRotateHandler=ac,b.EdgeInsets=qi,b.FullscreenControl=class extends c.E{constructor(p={}){super(),this._onFullscreenChange=()=>{var e;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=i==null?void 0:i.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=H.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){H.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=H.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);H.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},b.GeoJSONSource=zi,b.GeolocateControl=class extends c.E{constructor(p){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const i=new c.S(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),f=c.e({bearing:u},this.options.fitBoundsOptions),y=cr.fromLngLat(i,l);this._map.fitBounds(y,f,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const i=new c.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&ms)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=H.create("button","maplibregl-ctrl-geolocate",this._container),H.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=H.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new hr({element:this._dotElement}),this._circleElement=H.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},lp,p)}onAdd(p){return this._map=p,this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(Hr!==void 0&&!e)return Hr;if(window.navigator.permissions===void 0)return Hr=!!window.navigator.geolocation,Hr;try{Hr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Hr=!!window.navigator.geolocation}return Hr})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),H.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,fs=0,ms=!1}_isOutOfMapMaxBounds(p){const e=this._map.getMaxBounds(),i=p.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),e=p.getSouthEast(),i=p.getNorthEast(),l=e.distanceTo(i),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":fs--,ms=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),fs++,fs>1?(p={maximumAge:6e5,timeout:0},ms=!0):(p=this.options.positionOptions,ms=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},b.GlobeControl=class{constructor(){this._toggleProjection=()=>{var p;const e=(p=this._map.getProjection())===null||p===void 0?void 0:p.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var p;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((p=this._map.getProjection())===null||p===void 0?void 0:p.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(p){return this._map=p,this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=H.create("button","maplibregl-ctrl-globe",this._container),H.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){H.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},b.Hash=Fa,b.ImageSource=xi,b.KeyboardHandler=Fo,b.LngLatBounds=cr,b.LogoControl=Hu,b.Map=class extends er{constructor(p){var e,i;c.cv.mark(c.cw.create);const l=Object.assign(Object.assign(Object.assign({},Za),p),{canvasContextAttributes:Object.assign(Object.assign({},Za.canvasContextAttributes),p.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const u=new Cr,f=new Ll;if(l.minZoom!==void 0&&u.setMinZoom(l.minZoom),l.maxZoom!==void 0&&u.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&u.setMinPitch(l.minPitch),l.maxPitch!==void 0&&u.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&u.setRenderWorldCopies(l.renderWorldCopies),super(u,f,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new np,this._controls=[],this._mapId=c.a6(),this._contextLost=w=>{w.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:w}))},this._contextRestored=w=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:w}))},this._onMapScroll=w=>{if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},uc),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=re.addThrottleControl(()=>this.isMoving()),this._requestManager=new Te(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let w=!1;const S=tc(M=>{this._trackResize&&!this._removed&&(this.resize(M),this.redraw())},50);this._resizeObserver=new ResizeObserver(M=>{w?S(M):w=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ps(this,l),this._hash=l.hash&&new Fa(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const y=typeof l.style=="string"||((i=(e=l.style)===null||e===void 0?void 0:e.projection)===null||i===void 0?void 0:i.type)!=="globe";this.resize(null,y),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new lc(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Hu,l.logoPosition),this.on("style.load",()=>{if(y||this._resizeTransform(),this.transform.unmodified){const w=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(w)}}),this.on("data",w=>{this._update(w.dataType==="style"),this.fire(new c.l(`${w.dataType}data`,w))}),this.on("dataloading",w=>{this.fire(new c.l(`${w.dataType}dataloading`,w))}),this.on("dataabort",w=>{this.fire(new c.l("sourcedataabort",w))})}_getMapId(){return this._mapId}setGlobalStateProperty(p,e){return this.style.setGlobalStateProperty(p,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(p,e){if(e===void 0&&(e=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=p.onAdd(this);this._controls.push(p);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(i,l.firstChild):l.appendChild(i),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(p);return e>-1&&this._controls.splice(e,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,e,i,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,e,i,l)}resize(p,e=!0){const[i,l]=this._containerDimensions(),u=this._getClampedPixelRatio(i,l);if(this._resizeCanvas(i,l,u),this.painter.resize(i,l,u),this.painter.overLimit()){const y=this.painter.context.gl;this._maxCanvasSize=[y.drawingBufferWidth,y.drawingBufferHeight];const w=this._getClampedPixelRatio(i,l);this._resizeCanvas(i,l,w),this.painter.resize(i,l,w)}this._resizeTransform(e);const f=!this._moving;return f&&(this.stop(),this.fire(new c.l("movestart",p)).fire(new c.l("move",p))),this.fire(new c.l("resize",p)),f&&this.fire(new c.l("moveend",p)),this}_resizeTransform(p=!0){var e;const[i,l]=this._containerDimensions();this.transform.resize(i,l,p),(e=this._requestedCameraState)===null||e===void 0||e.resize(i,l,p)}_getClampedPixelRatio(p,e){const{0:i,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),f=p*u,y=e*u;return Math.min(f>i?i/f:1,y>l?l/y:1)*u}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(cr.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.setMinZoom(p),this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.setMaxZoom(p),this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.setMinPitch(p),this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(p>=this.transform.minPitch)return this.transform.setMaxPitch(p),this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.setRenderWorldCopies(p),this._update()}project(p){return this.transform.locationToScreenPoint(c.S.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.screenPointToLocation(c.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,e,i){if(p==="mouseenter"||p==="mouseover"){let l=!1;return{layers:e,listener:i,delegates:{mousemove:f=>{const y=e.filter(S=>this.getLayer(S)),w=y.length!==0?this.queryRenderedFeatures(f.point,{layers:y}):[];w.length?l||(l=!0,i.call(this,new Ti(p,this,f.originalEvent,{features:w}))):l=!1},mouseout:()=>{l=!1}}}}if(p==="mouseleave"||p==="mouseout"){let l=!1;return{layers:e,listener:i,delegates:{mousemove:y=>{const w=e.filter(S=>this.getLayer(S));(w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[]).length?l=!0:l&&(l=!1,i.call(this,new Ti(p,this,y.originalEvent)))},mouseout:y=>{l&&(l=!1,i.call(this,new Ti(p,this,y.originalEvent)))}}}}{const l=u=>{const f=e.filter(w=>this.getLayer(w)),y=f.length!==0?this.queryRenderedFeatures(u.point,{layers:f}):[];y.length&&(u.features=y,i.call(this,u),delete u.features)};return{layers:e,listener:i,delegates:{[p]:l}}}}_saveDelegatedListener(p,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(e)}_removeDelegatedListener(p,e,i){if(!this._delegatedListeners||!this._delegatedListeners[p])return;const l=this._delegatedListeners[p];for(let u=0;u<l.length;u++){const f=l[u];if(f.listener===i&&f.layers.length===e.length&&f.layers.every(y=>e.includes(y))){for(const y in f.delegates)this.off(y,f.delegates[y]);return void l.splice(u,1)}}}on(p,e,i){if(i===void 0)return super.on(p,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(p,l,i);this._saveDelegatedListener(p,u);for(const f in u.delegates)this.on(f,u.delegates[f]);return{unsubscribe:()=>{this._removeDelegatedListener(p,l,i)}}}once(p,e,i){if(i===void 0)return super.once(p,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(p,l,i);for(const f in u.delegates){const y=u.delegates[f];u.delegates[f]=(...w)=>{this._removeDelegatedListener(p,l,i),y(...w)}}this._saveDelegatedListener(p,u);for(const f in u.delegates)this.once(f,u.delegates[f]);return this}off(p,e,i){return i===void 0?super.off(p,e):(this._removeDelegatedListener(p,typeof e=="string"?[e]:e,i),this)}queryRenderedFeatures(p,e){if(!this.style)return[];let i;const l=p instanceof c.P||Array.isArray(p),u=l?p:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:p)||{},u instanceof c.P||typeof u[0]=="number")i=[c.P.convert(u)];else{const f=c.P.convert(u[0]),y=c.P.convert(u[1]);i=[f,new c.P(y.x,f.y),y,new c.P(f.x,y.y),f]}return this.style.queryRenderedFeatures(i,e,this.transform)}querySourceFeatures(p,e){return this.style.querySourceFeatures(p,e)}setStyle(p,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(p,e))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const e=this._locale[p];if(e==null)throw new Error(`Missing UI string '${p}'`);return e}_updateStyle(p,e){var i,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(p,e));const u=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new gu(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,e,u):this.style.loadJSON(p,e,u),this):((l=(i=this.style)===null||i===void 0?void 0:i.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new gu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,e){if(typeof p=="string"){const i=this._requestManager.transformRequest(p,"Style");c.j(i,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new c.k(l))})}else typeof p=="object"&&this._updateDiff(p,e)}_updateDiff(p,e){try{this.style.setState(p,e)&&this._update(!0)}catch(i){c.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(p,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(p,e){return this._lazyInitEmptyStyle(),this.style.addSource(p,e),this._update(!0)}isSourceLoaded(p){const e=this.style&&this.style.sourceCaches[p];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const e=this.style.sourceCaches[p.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);this.terrain===null&&e.reload();for(const i in this.style._layers){const l=this.style._layers[i];l.type==="hillshade"&&l.source===p.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===p.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new In(this.painter,e,p),this.painter.renderToTexture=new pt(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=i=>{var l;i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==p.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=i.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:p})),this}getTerrain(){var p,e;return(e=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const e in p){const i=p[e]._tiles;for(const l in i){const u=i[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}setSourceTileLodParams(p,e,i){if(i){const l=this.getSource(i);if(!l)throw new Error(`There is no source with ID "${i}", cannot set LOD parameters`);l.calculateTileZoom=Ae(Math.max(1,p),Math.max(1,e))}else for(const l in this.style.sourceCaches)this.style.sourceCaches[l].getSource().calculateTileZoom=Ae(Math.max(1,p),Math.max(1,e));return this._update(!0),this}refreshTiles(p,e){const i=this.style.sourceCaches[p];if(!i)throw new Error(`There is no source cache with ID "${p}", cannot refresh tile`);e===void 0?i.reload(!0):i.refreshTiles(e.map(l=>new c.a3(l.z,l.x,l.y)))}addImage(p,e,i={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:f,stretchY:y,content:w,textFitWidth:S,textFitHeight:M}=i;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:L,data:D}=e,F=e;return this.style.addImage(p,{data:new c.R({width:k,height:L},new Uint8Array(D)),pixelRatio:l,stretchX:f,stretchY:y,content:w,textFitWidth:S,textFitHeight:M,sdf:u,version:0,userImage:F}),F.onAdd&&F.onAdd(this,p),this}}{const{width:k,height:L,data:D}=O.getImageData(e);this.style.addImage(p,{data:new c.R({width:k,height:L},D),pixelRatio:l,stretchX:f,stretchY:y,content:w,textFitWidth:S,textFitHeight:M,sdf:u,version:0})}}updateImage(p,e){const i=this.style.getImage(p);if(!i)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||c.b(e)?O.getImageData(e):e,{width:u,height:f,data:y}=l;if(u===void 0||f===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==i.data.width||f!==i.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(e instanceof HTMLImageElement||c.b(e));return i.data.replace(y,w),this.style.updateImage(p,i),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p){return re.getImage(this._requestManager.transformRequest(p,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(p,e){return this._lazyInitEmptyStyle(),this.style.addLayer(p,e),this._update(!0)}moveLayer(p,e){return this.style.moveLayer(p,e),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,e,i){return this.style.setLayerZoomRange(p,e,i),this._update(!0)}setFilter(p,e,i={}){return this.style.setFilter(p,e,i),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,e,i,l={}){return this.style.setPaintProperty(p,e,i,l),this._update(!0)}getPaintProperty(p,e){return this.style.getPaintProperty(p,e)}setLayoutProperty(p,e,i,l={}){return this.style.setLayoutProperty(p,e,i,l),this._update(!0)}getLayoutProperty(p,e){return this.style.getLayoutProperty(p,e)}setGlyphs(p,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,e,i,l=>{l||this._update(!0)}),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,e,i=>{i||this._update(!0)}),this}setLight(p,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(p,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(p,e){return this.style.setFeatureState(p,e),this._update()}removeFeatureState(p,e){return this.style.removeFeatureState(p,e),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,e=0;return this._container&&(p=this._container.clientWidth||400,e=this._container.clientHeight||300),[p,e]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const e=this._canvasContainer=H.create("div","maplibregl-canvas-container",p);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=H.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),l=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],l);const u=this._controlContainer=H.create("div","maplibregl-control-container",p),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{f[y]=H.create("div",`maplibregl-ctrl-${y} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,e,i){this._canvas.width=Math.floor(i*p),this._canvas.height=Math.floor(i*e),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const p=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:p},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let i=null;if(i=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,p):this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p),!i){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new Xi(i,this.transform),ue.testSupport(i)}migrateProjection(p,e){super.migrateProjection(p,e),this.painter.transform=p,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){var e,i,l,u,f;const y=this._idleTriggered?this._fadeDuration:0,w=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let S=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const L=this.transform.zoom,D=O.now();this.style.zoomHistory.update(L,D);const F=new c.F(L,{now:D,fadeDuration:y,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),U=F.crossFadingFactor();U===1&&U===this._crossFadingFactor||(S=!0,this._crossFadingFactor=U),this.style.update(F)}const M=((i=this.style.projection)===null||i===void 0?void 0:i.transitionState)>0!==w;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((u=this.style.projection)===null||u===void 0?void 0:u.transitionState,(f=this.style.projection)===null||f===void 0?void 0:f.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||M)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,y,this._crossSourceCollisions,M),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cv.mark(c.cw.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||S)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,c.cv.mark(c.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),re.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),H.remove(this._canvasContainer),H.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cv.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,O.frame(this._frameRequest,p=>{c.cv.frame(p),this._frameRequest=null;try{this._render(p)}catch(e){if(!c.cx(e)&&!function(i){return i.message===zu}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return Xu}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(p){return this._lazyInitEmptyStyle(),this.style.setProjection(p),this._update(!0)}},b.MapMouseEvent=Ti,b.MapTouchEvent=on,b.MapWheelEvent=Bu,b.Marker=hr,b.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const e=this._map.getZoom(),i=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,i)=>{const l=this._map._getUIString(`NavigationControl.${i}`);e.title=l,e.setAttribute("aria-label",l)},this.options=c.e({},fi,p),this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),H.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),H.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=H.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new op(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){H.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,e){const i=H.create("button",p,this._container);return i.type="button",i.addEventListener("click",e),i}},b.Popup=class extends c.E{constructor(p){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&H.remove(this._content),this._container&&(H.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=H.create("div","maplibregl-popup",this._map.getContainer()),this._tip=H.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const y of this.options.className.split(" "))this._container.classList.add(y);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=ap(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const i=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const u=dc(this.options.offset);if(!l){const y=this._container.offsetWidth,w=this._container.offsetHeight;let S;S=i.y+u.bottom.y<w?["top"]:i.y>this._map.transform.height-w?["bottom"]:[],i.x<y/2?S.push("left"):i.x>this._map.transform.width-y/2&&S.push("right"),l=S.length===0?"bottom":S.join("-")}let f=i.add(u[l]);this.options.subpixelPositioning||(f=f.round()),H.setTransform(this._container,`${Zs[l]} translate(${f.x}px,${f.y}px)`),nr(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Ga),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=c.S.convert(p),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const e=document.createDocumentFragment(),i=document.createElement("body");let l;for(i.innerHTML=p;l=i.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=H.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){return this._container&&this._container.classList.add(p),this}removeClassName(p){return this._container&&this._container.classList.remove(p),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}setSubpixelPositioning(p){this.options.subpixelPositioning=p}_createCloseButton(){this.options.closeButton&&(this._closeButton=H.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Ku);p&&p.focus()}},b.RasterDEMTileSource=qr,b.RasterTileSource=uo,b.ScaleControl=class{constructor(p){this._onMove=()=>{hc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,hc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Yu),p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){H.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},b.ScrollZoomHandler=rp,b.Style=gu,b.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=p}onAdd(p){return this._map=p,this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=H.create("button","maplibregl-ctrl-terrain",this._container),H.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){H.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},b.TwoFingersTouchPitchHandler=Vu,b.TwoFingersTouchRotateHandler=$u,b.TwoFingersTouchZoomHandler=Mn,b.TwoFingersTouchZoomRotateHandler=qu,b.VectorTileSource=Gi,b.VideoSource=ks,b.addSourceType=(p,e)=>c._(void 0,void 0,void 0,function*(){if(zs(p))throw new Error(`A source type called "${p}" already exists.`);((i,l)=>{da[i]=l})(p,e)}),b.clearPrewarmedResources=function(){const p=ii;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(wt),ii=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},b.createTileMesh=pu,b.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},b.getRTLTextPluginStatus=function(){return Ai().getRTLTextPluginStatus()},b.getVersion=function(){return Qu},b.getWorkerCount=function(){return Ft.workerCount},b.getWorkerUrl=function(){return c.a.WORKER_URL},b.importScriptInWorkers=function(p){return nn().broadcast("IS",p)},b.prewarm=function(){Zi().acquire(wt)},b.setMaxParallelImageRequests=function(p){c.a.MAX_PARALLEL_IMAGE_REQUESTS=p},b.setRTLTextPlugin=function(p,e){return Ai().setRTLTextPlugin(p,e)},b.setWorkerCount=function(p){Ft.workerCount=p},b.setWorkerUrl=function(p){c.a.WORKER_URL=p}});var C=d;return C})})(Vw);var dA=Vw.exports;const n1=H_(dA);function pA(){const{contactPage:{maps:r}}=Ie.useContext(Nt);return Ie.useEffect(()=>{const o=new n1.Map({container:"map",center:[r.longitude,r.latitude],zoom:5,style:"https://api.maptiler.com/maps/streets/style.json?key=9NAUkIN5vfKH5gFPW07o"});new n1.Marker().setLngLat([r.longitude,r.latitude]).addTo(o)},[]),z.jsx("div",{id:"map",style:{height:"100%",width:"100%"}})}function fA(){const{contactPage:{secTitle:r}}=Ie.useContext(Nt);return Ie.useEffect(()=>{window.scroll(0,0)},[]),z.jsxs(z.Fragment,{children:[z.jsx(Ky,{secTitle:r}),z.jsx("section",{className:`${Ss.contactUs} section`,children:z.jsxs(_r,{children:[z.jsx("div",{className:`${Ss.inner}`,children:z.jsxs(jt,{children:[z.jsx(_t,{lg:6,children:z.jsx(pA,{})}),z.jsx(_t,{lg:6,children:z.jsx(aA,{})})]})}),z.jsx(hA,{})]})})]})}function mA(){return z.jsx(aP,{children:z.jsx(mI,{children:z.jsx(nk,{children:z.jsxs(bM,{children:[z.jsx(ll,{path:"/",element:z.jsx(i1,{})}),z.jsx(ll,{path:"/blog",element:z.jsx(Fz,{})}),z.jsx(ll,{path:"/portfolio",element:z.jsx(qz,{})}),z.jsx(ll,{path:"/404",element:z.jsx(Qz,{})}),z.jsx(ll,{path:"/contact",element:z.jsx(fA,{})}),z.jsx(ll,{path:"*",element:z.jsx(i1,{})})]})})})})}function gA(){return z.jsx(aI,{children:z.jsx(mA,{})})}yw(document.getElementById("root")).render(z.jsx(GM,{children:z.jsx(gA,{})}));
